<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">

<pmc-articleset><article article-type="research-article" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<?properties open_access?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">Algorithms Mol Biol</journal-id>
<journal-id journal-id-type="iso-abbrev">Algorithms Mol Biol</journal-id>
<journal-title-group>
<journal-title>Algorithms for Molecular Biology : AMB</journal-title>
</journal-title-group>
<issn pub-type="epub">1748-7188</issn>
<publisher>
<publisher-name>BioMed Central</publisher-name>
<publisher-loc>London</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="pmid">31572486</article-id>
<article-id pub-id-type="pmc">6757390</article-id>
<article-id pub-id-type="publisher-id">154</article-id>
<article-id pub-id-type="doi">10.1186/s13015-019-0154-7</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Software Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Bayesian localization of CNV candidates in WGS data within minutes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6935-1517</contrib-id>
<name>
<surname>Wiedenhoeft</surname>
<given-names>John</given-names>
</name>
<address>
<email>john.wiedenhoeft@med.uni-goettingen.de</email>
</address>
<xref ref-type="aff" rid="Aff1">1</xref>
<xref ref-type="aff" rid="Aff2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Cagan</surname>
<given-names>Alex</given-names>
</name>
<xref ref-type="aff" rid="Aff3">3</xref>
<xref ref-type="aff" rid="Aff4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kozhemyakina</surname>
<given-names>Rimma</given-names>
</name>
<xref ref-type="aff" rid="Aff5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gulevich</surname>
<given-names>Rimma</given-names>
</name>
<xref ref-type="aff" rid="Aff5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Schliep</surname>
<given-names>Alexander</given-names>
</name>
<xref ref-type="aff" rid="Aff1">1</xref>
<xref ref-type="aff" rid="Aff2">2</xref>
</contrib>
<aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9919 9582</institution-id><institution-id institution-id-type="GRID">grid.8761.8</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>University of Gothenburg | Chalmers, </institution></institution-wrap>Rännvägen 6, 412 58 Gothenburg, Sweden </aff>
<aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1936 8796</institution-id><institution-id institution-id-type="GRID">grid.430387.b</institution-id><institution>Department of Computer Science, </institution><institution>Rutgers University, </institution></institution-wrap>Piscataway, NJ 08854 USA </aff>
<aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2159 1813</institution-id><institution-id institution-id-type="GRID">grid.419518.0</institution-id><institution>Max Planck Institute for Evolutionary Anthropology, </institution></institution-wrap>04103 Leipzig, Germany </aff>
<aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0606 5382</institution-id><institution-id institution-id-type="GRID">grid.10306.34</institution-id><institution>Wellcome Trust Sanger Institute, </institution></institution-wrap>Hinxton, CB10 1SA UK </aff>
<aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.418953.2</institution-id><institution>Institute of Cytology and Genetics of the Siberian Branch of the Russian Academy of Sciences, </institution></institution-wrap>Novosibirsk, 630090 Russia </aff>
</contrib-group>
<pub-date pub-type="epub">
<day>23</day>
<month>9</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="pmc-release">
<day>23</day>
<month>9</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<year>2019</year>
</pub-date>
<volume>14</volume>
<elocation-id>20</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>9</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>8</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-statement>© The Author(s) 2019</copyright-statement>
<license license-type="OpenAccess">
<license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
</license>
</permissions>
<abstract id="Abs1">
<sec>
<title>Background</title>
<p id="Par1">Full Bayesian inference for detecting copy number variants (CNV) from whole-genome sequencing (WGS) data is still largely infeasible due to computational demands. A recently introduced approach to perform Forward–Backward Gibbs sampling using dynamic Haar wavelet compression has alleviated issues of convergence and, to some extent, speed. Yet, the problem remains challenging in practice.</p>
</sec>
<sec>
<title>Results</title>
<p id="Par2">In this paper, we propose an improved algorithmic framework for this approach. We provide new space-efficient data structures to query sufficient statistics in logarithmic time, based on a linear-time, in-place transform of the data, which also improves on the compression ratio. We also propose a new approach to efficiently store and update marginal state counts obtained from the Gibbs sampler.</p>
</sec>
<sec>
<title>Conclusions</title>
<p id="Par3">Using this approach, we discover several CNV candidates in two rat populations divergently selected for tame and aggressive behavior, consistent with earlier results concerning the <italic>domestication syndrome</italic> as well as experimental observations. Computationally, we observe a 29.5-fold decrease in memory, an average 5.8-fold speedup, as well as a 191-fold decrease in minor page faults. We also observe that metrics varied greatly in the old implementation, but not the new one. We conjecture that this is due to the better compression scheme. The fully Bayesian segmentation of the entire WGS data set required 3.5 min and 1.24 GB of memory, and can hence be performed on a commodity laptop.</p>
</sec>
<sec>
<title>Electronic supplementary material</title>
<p>The online version of this article (10.1186/s13015-019-0154-7) contains supplementary material, which is available to authorized users.</p>
</sec>
</abstract>
<kwd-group xml:lang="en">
<title>Keywords</title>
<kwd>HMM</kwd>
<kwd>Wavelet</kwd>
<kwd>CNV</kwd>
<kwd>Bayesian inference</kwd>
</kwd-group>
<funding-group>
<award-group>
<funding-source>
<institution>Institute of Cytology and Genetics of the Siberian Branch of the Russian Academy of Sciences</institution>
</funding-source>
<award-id>N 0324-2018-0016</award-id>
<principal-award-recipient>
<name>
<surname>Gulevich</surname>
<given-names>Rimma</given-names>
</name>
</principal-award-recipient>
</award-group>
</funding-group>
<funding-group>
<award-group>
<funding-source>
<institution-wrap>
<institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>1 U01 CA198952-01</award-id>
<principal-award-recipient>
<name>
<surname>Schliep</surname>
<given-names>Alexander</given-names>
</name>
</principal-award-recipient>
</award-group>
</funding-group>
<custom-meta-group>
<custom-meta>
<meta-name>issue-copyright-statement</meta-name>
<meta-value>© The Author(s) 2019</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="Sec1">
<title>Background</title>
<p id="Par5">Hidden Markov models (HMM) are arguably among the central methods for signal processing. In bioinformatics, they are commonly used for the detection of copy-number variations (CNV), which have been recognized to play an important role in cancer progression [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>] and neuropsychiatric disorders [<xref ref-type="bibr" rid="CR4">4</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. Depending on the application and experimental platform, the number of states would be chosen between 3 for simple gains and losses, to around 10 for complex genomic alterations in certain cancers. Since CNV can disrupt or duplicate genes and regulatory elements, effects such as loss-of-function, chimeric proteins, as well as gene dosage can lead to variations in phenotype. Copy-number variants fixed in divergently selected populations can be used as candidates for genetic causes underlying phenotypic adaptations.</p>
<p id="Par6">The challenges in HMM segmentation of WGS data are two-fold. First, though the advantages of Bayesian segmentation over frequentist approaches have previously been noted [<xref ref-type="bibr" rid="CR6">6</xref>–<xref ref-type="bibr" rid="CR10">10</xref>], inference is computationally demanding on WGS-scale data; in particular, Bayesian methods which rely on Markov Chain Monte Carlo (MCMC) approximations are infeasible on standard computers, in terms of memory requirements, speed and convergence characteristics. Second, HMM assume piecewise constant data with variates conditionally independent given the true segmentation, which means that any long-range bias violates the model assumptions. Unfortunately, this is the case when using read-depth data from WGS experiments for CNV estimation. The number of reads mapped to any given position is confounded by amplification bias due to primer affinity and GC content, as well as computational bias incurred during read mapping. This can lead to multiple shifts in segment means, as well as non-linear long-range effects in the signal which would be modeled more accurately as piecewise higher-order polynomials. Removing such effects computationally, e.g. by regression methods such as loess [<xref ref-type="bibr" rid="CR11">11</xref>], is non-trivial, as it requires the separation of three signals: additive experimental noise, a smooth long-range bias as well as the sequence of true means. In other words, it is hard to differentiate between shifts in signal averages which are due to bias and those that represent actual CN changes.</p>
<p id="Par7">The contributions of this paper aim to address these issues. On the matter of efficient computation, it was recently shown that Bayesian inference of the hidden state sequence using Forward–Backward Gibbs sampling (FBG) [<xref ref-type="bibr" rid="CR12">12</xref>] can be made feasible for large data sets by using a dynamic compression scheme based on Haar wavelet regression [<xref ref-type="bibr" rid="CR6">6</xref>]. In this approach, data is presented to the Gibbs sampler in a compressed form, and the sampler adapts the compression dynamically according to the noise level it obtains in each sampling step. This has led to drastic improvements in speed and convergence behavior of FBG. Conceptually, the approach allows the software to “zoom in” on candidate regions for CNV and concentrate its computational efforts there, while ignoring long diploid segments. While the issue of convergence has been addressed and overall speed has been improved [<xref ref-type="bibr" rid="CR6">6</xref>], memory usage remains an obstacle when analyzing WGS data. Here, we present a novel algorithmic framework to implement the dynamic wavelet compression approach for HMM inference using FBG. We provide new data structures to efficiently store and update marginal state counts for compression block structures, and to efficiently query sufficient statistics at different wavelet resolution levels. We derive a linear time, in-place algorithm for the data transform required for its construction, based on the <italic>lifting scheme</italic> [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
<p id="Par8">On the matter of providing FBG with data that fits its model to a reasonable degree, we noticed that it is common practice to sequence sample and control in a multiplexed fashion, often for cost reasons. Using differential read counts from the same, multiplexed sequencing run, see [<xref ref-type="bibr" rid="CR14">14</xref>] for instance, cancels out any additive coverage bias. This not only reduces the potential for false CNV calls due to systematic shifts in the data, but also obviously decreases the conditional dependence of the observed variates given the true segmentation labels. Using such data is therefore a more appropriate input to HMM methods. Aside from these general considerations, wavelet compression acts favorably on such data: regression relies on a property of wavelets called <italic>polynomial suppression</italic>. If the underlying signal is a polynomial of a degree up to a certain constant, wavelets are orthogonal to it and hence removed during regression. This yields a separation of signal and noise. Higher-order polynomials due to long-range experimental bias however would incur additional discontinuities in the regression, leading to lower compression ratios, higher memory requirements, and, consequently, longer running times of FBG.</p>
<p id="Par9">In order to benchmark our method and demonstrate its applicability to real data, we used it to obtain CNV candidates from differential read depth data for rat populations divergently selected for tame and aggressive behavior (Fig. <xref ref-type="fig" rid="Fig1">1</xref>). As expected for a behavioral phenotype, the results are significantly enriched for annotations of neuronal development and function, showing that results are consistent with a hypothesis that CNV play a role in the <italic>domestication syndrome</italic>. To the best of our knowledge, this is the first time fully Bayesian inference on several hundreds of millions of latent state variables has been performed on a commodity laptop within minutes.<fig id="Fig1"><label>Fig. 1</label><caption><p>Pipeline for CNV calls in rat populations, divergently selected for tame and aggressive behavior. After individual barcoding and multiplex sequencing, counts of mapped start positions for the tame population are subtracted from those in the aggressive population. This removes shared additive bias from the data. Afterwards, due to low coverage, the data is averaged over 20 positions to make the noise approximately Gaussian. Then, the data is transformed into a breakpoint array data structure, comprised of sufficient statistics as well as a pointer structure to facilitate rapid creation of compressed data blocks depending on a given threshold. The breakpoint array generates block boundaries corresponding to discontinuities obtained in Haar wavelet regression. The universal threshold is used for compression, based on the lowest sampled noise variance in the emission parameters of the HMM during Forward–Backward Gibbs sampling</p></caption><graphic id="MO1" xlink:href="13015_2019_154_Fig1_HTML"></graphic></fig></p>
<p id="Par10">As was shown previously [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], compressing the observed data into blocks of sufficient statistics can significantly speed up Bayesian inference, in particular Forward–Backward Gibbs sampling (FBG). While [<xref ref-type="bibr" rid="CR7">7</xref>] used a static compression heuristic based on <italic>kd</italic>-trees, we used the discontinuities in the Haar wavelet regression as block boundaries, based on the smallest emission variance among all latent states sampled in each FBG iteration [<xref ref-type="bibr" rid="CR6">6</xref>]. We used a data structure termed <italic>wavelet tree</italic> to solve the problem of querying sufficient statistics for each block for a given resolution/noise level, without explicitly computing the wavelet regression. We will show that this data structure induces superfluous block boundaries, leading to suboptimal compression ratios, and replace it by a new data structure called a <italic>breakpoint array</italic>. For that, as well as to elucidate the reasoning behind the use of differential read depth data to maximize compression and avoid bias in HMM inference, we briefly review the principles of function regression using wavelet shrinkage: Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^2({\mathbb {R}}) :=L^2({\mathbb {R}}, {\mathcal {B}}({\mathbb {R}}), \lambda )$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">B</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq1.gif"></inline-graphic></alternatives></inline-formula> be the space of square-integrable functions over the reals. This is a Hilbert space with inner product <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle f, g \right\rangle :=\int _{-\infty }^\infty f(x)g(x)dx$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mfenced close="〉" open="〈" separators=""><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mfenced><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq2.gif"></inline-graphic></alternatives></inline-formula>. As we are only concerned with functions over subsets of <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {R}}$$\end{document}</tex-math><mml:math id="M6"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq3.gif"></inline-graphic></alternatives></inline-formula>, the inner product commutes without involving the complex conjugate. The inner product induces the norm <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\| f \right\| :=\sqrt{\left\langle f, f \right\rangle }$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mi>f</mml:mi></mml:mfenced><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mfenced close="〉" open="〈" separators=""><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mfenced></mml:msqrt></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq4.gif"></inline-graphic></alternatives></inline-formula>. Two functions <italic>f</italic>, <italic>g</italic> are said to be <italic>orthogonal</italic> iff <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle f, g \right\rangle =0$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mfenced close="〉" open="〈" separators=""><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq5.gif"></inline-graphic></alternatives></inline-formula>, and a function <italic>f</italic> is called <italic>normal</italic> iff <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\| f \right\| = 1$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mi>f</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq6.gif"></inline-graphic></alternatives></inline-formula>. <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^2({\mathbb {R}})$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq7.gif"></inline-graphic></alternatives></inline-formula> contains all continuous and piecewise continuous functions, including all piecewise constant functions. Let<disp-formula id="Equ2"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi (t) :={\left\{ \begin{array}{ll} 1 &amp; \quad 0\le t&lt;\frac{1}{2}\\ -1 &amp; \quad \frac{1}{2} \le t &lt; 1\\ 0 &amp; \quad \text {elsewhere} \end{array}\right. }$$\end{document}</tex-math><mml:math display="block" id="M16"><mml:mrow><mml:mi>ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>≤</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow></mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mtext>elsewhere</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic position="anchor" xlink:href="13015_2019_154_Article_Equ2.gif"></graphic></alternatives></disp-formula>be the Haar wavelet [<xref ref-type="bibr" rid="CR15">15</xref>], and <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ \psi _{j,k} (t) :=\frac{1}{\sqrt{2^j}} \psi \left( \frac{t- 2^j k}{2^j}\right) \right\}$$\end{document}</tex-math><mml:math id="M18"><mml:mfenced close="}" open="{" separators=""><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup></mml:msqrt></mml:mfrac><mml:mi>ψ</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup><mml:mi>k</mml:mi></mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup></mml:mfrac></mml:mfenced></mml:mfenced></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq8.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${j, k\in {\mathbb {Z}}}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq9.gif"></inline-graphic></alternatives></inline-formula> (depicted in Fig. <xref ref-type="fig" rid="Fig2">2</xref>, top). Since <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\| \psi _{j,k} \right\| = 1$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq10.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle \psi _{j,k}, \psi _{j'k'} \right\rangle = 0$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mfenced close="〉" open="〈" separators=""><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq11.gif"></inline-graphic></alternatives></inline-formula> for <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(j,k)\ne (j',k')$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>≠</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq12.gif"></inline-graphic></alternatives></inline-formula>, this forms an orthonormal basis of <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^2({\mathbb {R}})$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq13.gif"></inline-graphic></alternatives></inline-formula>, where a function <italic>y</italic> is represented as the linear combination <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y = \sum _{j, k\in {\mathbb {Z}}} \left\langle \psi _{j,k}, y \right\rangle \psi _{j,k}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow></mml:msub><mml:mfenced close="〉" open="〈" separators=""><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq14.gif"></inline-graphic></alternatives></inline-formula>. The set of detail coefficients <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{j,k}:=\left\langle \psi _{j,k}, y \right\rangle$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="〉" open="〈" separators=""><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>y</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq15.gif"></inline-graphic></alternatives></inline-formula> is called the wavelet transform of <italic>y</italic>. A wavelet is said to have <italic>m vanishing moments</italic> if <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle p^i, \psi \right\rangle = 0, 0\le i &lt; m, p \text { constant,}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mfenced close="〉" open="〈" separators=""><mml:msup><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mspace width="0.333333em"></mml:mspace><mml:mtext>constant,</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq16.gif"></inline-graphic></alternatives></inline-formula> it follows that <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi$$\end{document}</tex-math><mml:math id="M36"><mml:mi>ψ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq17.gif"></inline-graphic></alternatives></inline-formula> is orthogonal to any polynomial of degree less than <italic>m</italic>, since <inline-formula id="IEq18"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle \sum _{i=1}^{m-1} p^i, \psi \right\rangle = \sum _{i=1}^{m-1}\left\langle p^i, \psi \right\rangle = 0$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mfenced close="〉" open="〈" separators=""><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfenced close="〉" open="〈" separators=""><mml:msup><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>ψ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq18.gif"></inline-graphic></alternatives></inline-formula>. This property is called <italic>polynomial suppression</italic> [<xref ref-type="bibr" rid="CR16">16</xref>]. The Haar wavelet has one vanishing moment, so it is orthogonal only to constant functions.<fig id="Fig2"><label>Fig. 2</label><caption><p>The top subplots show the Haar wavelet basis for <inline-formula id="IEq49"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T=16$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq49.gif"></inline-graphic></alternatives></inline-formula>. The bottom subplot shows the corresponding wavelet tree. In the tree layout induced by the lifting scheme, the position of a coefficient equals that of the central discontinuity of its associated Haar wavelet. For instance, <inline-formula id="IEq50"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\psi }} _{2,0}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq50.gif"></inline-graphic></alternatives></inline-formula> has positive support on <inline-formula id="IEq51"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y }[0], \mathbf{y }[1]$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq51.gif"></inline-graphic></alternatives></inline-formula>, and negative support on <inline-formula id="IEq52"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y }[2], \mathbf{y }[3]$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq52.gif"></inline-graphic></alternatives></inline-formula>, with <inline-formula id="IEq53"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^+_{2,0}=0$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq53.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq54"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^\pm _{2,0}=2$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>±</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq54.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq55"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^-_{2,0}=4$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>-</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq55.gif"></inline-graphic></alternatives></inline-formula>. In this example, nodes for which <inline-formula id="IEq56"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{} d_{j,k} \right| &gt;\lambda$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq56.gif"></inline-graphic></alternatives></inline-formula> are shown in black, i. e. <inline-formula id="IEq57"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{} d_{1,0} \right| &gt;\lambda$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq57.gif"></inline-graphic></alternatives></inline-formula>, inducing block boundaries at 0, 1 and 2, and <inline-formula id="IEq58"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{} d_{1,7} \right| &gt;\lambda$$\end{document}</tex-math><mml:math id="M58"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq58.gif"></inline-graphic></alternatives></inline-formula>, inducing block boundaries at 14, 15 and 16 (indicated by thin solid vertical lines), creating 5 blocks in total. The wavelet tree data structure is subcompressive, as it induces additional breakpoints. <inline-formula id="IEq59"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i,k}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq59.gif"></inline-graphic></alternatives></inline-formula> denotes the maximum of all <inline-formula id="IEq60"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{} d_{j',k'} \right|$$\end{document}</tex-math><mml:math id="M62"><mml:mfenced close="|" open="|" separators=""><mml:mrow></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq60.gif"></inline-graphic></alternatives></inline-formula> in the subtree. Nodes in gray indicate the case where <inline-formula id="IEq61"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{} d_{j,k} \right| &lt;\lambda$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq61.gif"></inline-graphic></alternatives></inline-formula>, yet <inline-formula id="IEq62"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{i,k}&gt;\lambda$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq62.gif"></inline-graphic></alternatives></inline-formula>, hence inducing additional block boundaries, indicated here by dotted lines, at 2, 4, 8, 12 an 14. This yields a total of 8 blocks</p></caption><graphic id="MO4" xlink:href="13015_2019_154_Fig2_HTML"></graphic></fig></p>
<p id="Par11">For computational applications, a vector <inline-formula id="IEq19"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{f }$$\end{document}</tex-math><mml:math id="M68"><mml:mi mathvariant="bold">f</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq19.gif"></inline-graphic></alternatives></inline-formula> is obtained by sampling <italic>f</italic> at equidistant intervals. The discrete versions of the wavelets are then obtained as <inline-formula id="IEq20"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\psi }} _{j,k}[t]:=\psi _{j,k}(t)$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq20.gif"></inline-graphic></alternatives></inline-formula> for <inline-formula id="IEq21"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t\in {\mathbb {N}}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq21.gif"></inline-graphic></alternatives></inline-formula>. These inherit properties such as orthogonality, finite energy and vanishing moments from their continuous counterparts. Let<disp-formula id="Equ3"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} b_{j,k}^+ :=2^j k \quad \quad b_{j,k}^\pm :=2^j \left( k+\frac{1}{2}\right) \quad \quad b_{j,k}^- :=2^j (k+1) \end{aligned}$$\end{document}</tex-math><mml:math display="block" id="M74"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup><mml:mi>k</mml:mi><mml:mspace width="1em"></mml:mspace><mml:mspace width="1em"></mml:mspace><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup><mml:mfenced close=")" open="(" separators=""><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mfenced><mml:mspace width="1em"></mml:mspace><mml:mspace width="1em"></mml:mspace><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic position="anchor" xlink:href="13015_2019_154_Article_Equ3.gif"></graphic></alternatives></disp-formula>be the position after the left, central and right discontinuity of <inline-formula id="IEq22"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\psi }} _{j,k}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq22.gif"></inline-graphic></alternatives></inline-formula>, respectively.</p>
<p id="Par12">The Haar wavelet transform is an orthogonal transform, represented by a matrix <inline-formula id="IEq23"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {W}$$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="script">W</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq23.gif"></inline-graphic></alternatives></inline-formula> with rows <inline-formula id="IEq24"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\psi }} _{j,k}$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq24.gif"></inline-graphic></alternatives></inline-formula> Let the observed signal be a sampling of a function <italic>f</italic> corrupted by centered Gaussian noise, i.e. <inline-formula id="IEq25"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y } = \mathbf{f } + {\varvec{\epsilon }}, {\varvec{\epsilon }}[t] \sim _{\text {i.i.d.}} N(0, \sigma ^2).$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:msub><mml:mo>∼</mml:mo><mml:mtext>i.i.d.</mml:mtext></mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq25.gif"></inline-graphic></alternatives></inline-formula> Since the wavelet transform is linear, it acts on the signal and noise component independently, i.e. <inline-formula id="IEq26"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {W} \mathbf{y } = \mathcal {W} (\mathbf{f } + {\varvec{\epsilon }}) = \mathcal {W} \mathbf{f } + \mathcal {W} {\varvec{\epsilon }}.$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi mathvariant="script">W</mml:mi><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">f</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mi mathvariant="bold">f</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq26.gif"></inline-graphic></alternatives></inline-formula> The central idea in wavelet shrinkage is that <inline-formula id="IEq27"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle \mathbf{f }, {\varvec{\psi }} _{j,k} \right\rangle =0$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mfenced close="〉" open="〈" separators=""><mml:mi mathvariant="bold">f</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq27.gif"></inline-graphic></alternatives></inline-formula> if <inline-formula id="IEq28"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{f }$$\end{document}</tex-math><mml:math id="M88"><mml:mi mathvariant="bold">f</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq28.gif"></inline-graphic></alternatives></inline-formula> is polynomial over the entire support of <inline-formula id="IEq29"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\psi }} _{j,k}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq29.gif"></inline-graphic></alternatives></inline-formula> due to polynomial suppression, and, in particular, the support does not span a discontinuity in <inline-formula id="IEq30"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{f }$$\end{document}</tex-math><mml:math id="M92"><mml:mi mathvariant="bold">f</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq30.gif"></inline-graphic></alternatives></inline-formula>. Furthermore, due to orthogonality of <inline-formula id="IEq31"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {W}$$\end{document}</tex-math><mml:math id="M94"><mml:mi mathvariant="script">W</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq31.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq32"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {W} {\varvec{\epsilon }}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi mathvariant="script">W</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq32.gif"></inline-graphic></alternatives></inline-formula> is again a random vector of i.i.d. random variables distributed as <inline-formula id="IEq33"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N(0, \sigma ^2)$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq33.gif"></inline-graphic></alternatives></inline-formula>, so the noise is maintained under the wavelet transform. In general, orthogonal maps preserve the <inline-formula id="IEq34"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L^2$$\end{document}</tex-math><mml:math id="M100"><mml:msup><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq34.gif"></inline-graphic></alternatives></inline-formula> norm, so <inline-formula id="IEq35"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\| \mathcal {W} {\varvec{\epsilon }} \right\| = \left\| {\varvec{\epsilon }} \right\|$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mi mathvariant="script">W</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="∥" open="∥"><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq35.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq36"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\| \mathcal {W} \mathbf{y } \right\| = \left\| \mathbf{y } \right\|$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mi mathvariant="script">W</mml:mi><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="∥" open="∥"><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq36.gif"></inline-graphic></alternatives></inline-formula>. It follows that for piecewise polynomial functions with only a few discontinuities, <inline-formula id="IEq37"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle \mathbf{y }, {\varvec{\psi }} _{j,k} \right\rangle = \left\langle {\varvec{\epsilon }}, {\varvec{\psi }} _{j,k} \right\rangle$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mfenced close="〉" open="〈" separators=""><mml:mi mathvariant="bold">y</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="〉" open="〈" separators=""><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq37.gif"></inline-graphic></alternatives></inline-formula> for most <italic>j</italic>, <italic>k</italic>, i.e. most wavelet coefficients are only non-zero due to noise. The idea is then to find a way to create a vector <inline-formula id="IEq38"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{w }$$\end{document}</tex-math><mml:math id="M108"><mml:mi mathvariant="bold">w</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq38.gif"></inline-graphic></alternatives></inline-formula> by setting a suitable set of coefficients in <inline-formula id="IEq39"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {W} \mathbf{f }$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi mathvariant="script">W</mml:mi><mml:mi mathvariant="bold">f</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq39.gif"></inline-graphic></alternatives></inline-formula> to zero, and then use the inverse wavelet transform as a regression <inline-formula id="IEq40"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\mathbf{f }} :=\mathcal {W} ^\intercal \mathbf{w }$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup><mml:mi mathvariant="bold">w</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq40.gif"></inline-graphic></alternatives></inline-formula>. The simplest method is to use the <italic>universal threshold</italic>
<inline-formula id="IEq41"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _u :=\sqrt{2\ln T}\sigma$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mo>ln</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq41.gif"></inline-graphic></alternatives></inline-formula> [<xref ref-type="bibr" rid="CR17">17</xref>], which can be interpreted as the expected maximum deviation of <italic>T</italic> such Gaussian random variables from their mean, as derived by Cramér–Chernoff’s method [<xref ref-type="bibr" rid="CR18">18</xref>]. Hence, removing coefficients of absolute value below <inline-formula id="IEq42"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _u$$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>λ</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq42.gif"></inline-graphic></alternatives></inline-formula> removes all noise coefficients with high probability [<xref ref-type="bibr" rid="CR17">17</xref>]. Using different variances, the resulting <inline-formula id="IEq43"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\mathbf{f }}$$\end{document}</tex-math><mml:math id="M118"><mml:mover accent="true"><mml:mi mathvariant="bold">f</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq43.gif"></inline-graphic></alternatives></inline-formula> are piecewise constant functions, whose discontinuities we interpret as block boundaries in a compression scheme. In our approach, <inline-formula id="IEq44"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^2$$\end{document}</tex-math><mml:math id="M120"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq44.gif"></inline-graphic></alternatives></inline-formula> is the minimum variance of all emission parameters in the HMM as sampled at each iteration. The existence of a discontinuity obviously depends on the magnitude of the wavelet coefficients involved: if <inline-formula id="IEq45"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{} d_{j,k} \right| &gt;\lambda _u$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq45.gif"></inline-graphic></alternatives></inline-formula>, then there are block boundaries before data positions <inline-formula id="IEq46"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{j,k}^+$$\end{document}</tex-math><mml:math id="M124"><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq46.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq47"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{j,k}^\pm$$\end{document}</tex-math><mml:math id="M126"><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq47.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq48"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b_{j,k}^-$$\end{document}</tex-math><mml:math id="M128"><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq48.gif"></inline-graphic></alternatives></inline-formula>.</p>
</sec>
<sec id="Sec2">
<title>Implementation</title>
<sec id="Sec3">
<title>Block generators</title>
<p id="Par14">In order to avoid recomputing the wavelet regression explicitly for a new threshold in each FBG iteration, consider the following abstract data structure:</p>
<sec id="FPar1">
<title>
<bold>Definition 2.1</bold>
</title>
<p id="Par15">(<italic>Block generator</italic>) Let <inline-formula id="IEq63"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }$$\end{document}</tex-math><mml:math id="M130"><mml:mi mathvariant="bold">b</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq63.gif"></inline-graphic></alternatives></inline-formula> be a vector of breakpoint weights. For a threshold <inline-formula id="IEq64"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M132"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq64.gif"></inline-graphic></alternatives></inline-formula>, let <inline-formula id="IEq65"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{Y }_\lambda$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq65.gif"></inline-graphic></alternatives></inline-formula> be a partition of <inline-formula id="IEq66"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y }$$\end{document}</tex-math><mml:math id="M136"><mml:mi mathvariant="bold">y</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq66.gif"></inline-graphic></alternatives></inline-formula> into blocks such that there is a block boundary between positions <inline-formula id="IEq67"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq67.gif"></inline-graphic></alternatives></inline-formula> and <italic>t</italic> if <inline-formula id="IEq68"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }[t]\ge \lambda$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>≥</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq68.gif"></inline-graphic></alternatives></inline-formula>. We call a data structure a <italic>block generator</italic> if it can, for any threshold <inline-formula id="IEq69"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M142"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq69.gif"></inline-graphic></alternatives></inline-formula>, generate an ordered sequence of sufficient statistics that represents <inline-formula id="IEq70"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{Y }_\lambda$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq70.gif"></inline-graphic></alternatives></inline-formula>. A block generator is called <italic>compressive</italic> if, for all <inline-formula id="IEq71"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M146"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq71.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq72"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }[t]&lt;\lambda$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq72.gif"></inline-graphic></alternatives></inline-formula> implies that no breakpoint is created between <inline-formula id="IEq73"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq73.gif"></inline-graphic></alternatives></inline-formula> and <italic>t</italic>. It is called <italic>subcompressive</italic> if for some <inline-formula id="IEq74"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M152"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq74.gif"></inline-graphic></alternatives></inline-formula> such a superfluous block boundary is created. A block generator is called <italic>space-efficient</italic> if it stores no more than <italic>T</italic> sufficient statistics, where <italic>T</italic> is the number of input data points.</p>
<p>This definition of a block generator implies that <inline-formula id="IEq75"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{Y }_{\lambda _1}$$\end{document}</tex-math><mml:math id="M154"><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq75.gif"></inline-graphic></alternatives></inline-formula> is a subdivision of <inline-formula id="IEq76"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{Y }_{\lambda _2}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mi mathvariant="bold">Y</mml:mi><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq76.gif"></inline-graphic></alternatives></inline-formula> if <inline-formula id="IEq77"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda _1 \le \lambda _2$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq77.gif"></inline-graphic></alternatives></inline-formula>. For sufficiently small thresholds, we require sufficient statistics for each data point, hence any block generator implementation will have to store a minimum of <italic>T</italic> sufficient statistics. On the other hand, if all entries in <inline-formula id="IEq78"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }$$\end{document}</tex-math><mml:math id="M160"><mml:mi mathvariant="bold">b</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq78.gif"></inline-graphic></alternatives></inline-formula> are unique, each breakpoint subdivides a block defined by a higher threshold, and a simple induction argument shows that a block generator has to be able to generate <inline-formula id="IEq79"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2T-1$$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq79.gif"></inline-graphic></alternatives></inline-formula> different blocks and their sufficient statistics: starting with a single block of size <italic>T</italic> and a sorted sequence of threshold values in <inline-formula id="IEq80"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }$$\end{document}</tex-math><mml:math id="M164"><mml:mi mathvariant="bold">b</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq80.gif"></inline-graphic></alternatives></inline-formula>, each threshold creates two new blocks by subdividing one block in the previous partition.</p>
<p>We previously defined the <italic>wavelet tree</italic> data structure to serve as a block generator; for details, see [<xref ref-type="bibr" rid="CR6">6</xref>]. It is based on the observation that the non-zero support intervals of wavelet basis functions are nested along scales (cf. Fig. <xref ref-type="fig" rid="Fig2">2</xref>). Each node corresponds to a basis function, with its position corresponding to the position of the wavelet’s central discontinuity. The wavelet tree stores the maximum absolute coefficient <inline-formula id="IEq81"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{ij}$$\end{document}</tex-math><mml:math id="M166"><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq81.gif"></inline-graphic></alternatives></inline-formula> of its subtree in the node. To obtain the sufficient statistics for a block at a given noise level, the tree is traversed in DFS order. Whenever a node is encountered for which <inline-formula id="IEq82"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{ij}&lt;\lambda$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq82.gif"></inline-graphic></alternatives></inline-formula>, none of its descendants can have a higher value, and hence no additional discontinuities. The subtree is pruned from the DFS, creating a single block for the sufficient statistics of its leaf nodes. On the other hand, if <inline-formula id="IEq83"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{ij} \ge \lambda$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq83.gif"></inline-graphic></alternatives></inline-formula>, the search recurses on the subtrees, creating additional block boundaries between leaves.</p>
<p>Unfortunately, the wavelet tree is subcompressive, as demonstrated by the counterexample in Fig. <xref ref-type="fig" rid="Fig2">2</xref>, as well as memory-inefficient, since it stores <inline-formula id="IEq84"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2T-1$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq84.gif"></inline-graphic></alternatives></inline-formula> statistics. It should be noted that, while the wavelet tree stores as many sufficient statistics as needed for <italic>T</italic> data points, the fact that it is subcompressive implies that the block structures it creates differ from those of a compressive block generator, and hence these are <italic>not</italic> the same <inline-formula id="IEq85"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2T-1$$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq85.gif"></inline-graphic></alternatives></inline-formula> statistics that would occur in across all block structures a compressive block generator would yield.</p>
<p>In order to provide an efficient implementation, we separate a block generator into two sub-structures: a <italic>breakpoint array</italic> to derive a sequence of start and end positions for blocks, and an <italic>integral array</italic> to query the sufficient statistics for each block.</p>
</sec>
<sec id="Sec4">
<title>Integral array for block statistics</title>
<p id="Par20">Let a data structure <inline-formula id="IEq86"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D(\mathbf{y })$$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq86.gif"></inline-graphic></alternatives></inline-formula> support the following query: given a start index <italic>s</italic> and an end index <italic>e</italic>, with <inline-formula id="IEq87"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s&lt;e$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq87.gif"></inline-graphic></alternatives></inline-formula>, return the sufficient statistics in the half-open interval [<italic>s</italic>, <italic>e</italic>), i. e. <inline-formula id="IEq88"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{i=s}^{e-1}\mathbf{T }(\mathbf{y }[i])$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq88.gif"></inline-graphic></alternatives></inline-formula>. A trivial implementation of such a data structure would be to store the statistics of each input position, and then iterate through the array and calculate their cumulative sums between breakpoints. This is obviously costly for huge data, as it incurs <inline-formula id="IEq89"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Theta (N)$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq89.gif"></inline-graphic></alternatives></inline-formula> time complexity for a block of size <italic>N</italic>. Constant-time queries could be made by pre-computing all <inline-formula id="IEq90"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T^2$$\end{document}</tex-math><mml:math id="M184"><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq90.gif"></inline-graphic></alternatives></inline-formula> statistics, which is obviously prohibitive for large data.</p>
<p id="Par21">The basic idea for querying sufficient statistics comes from a simple data structure in image processing called a <italic>summed-area table</italic> or <italic>integral image</italic> [<xref ref-type="bibr" rid="CR19">19</xref>], which is used to query the sum of a rectangular region in constant time. As its one-dimensional equivalent, let <inline-formula id="IEq91"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }$$\end{document}</tex-math><mml:math id="M186"><mml:mi mathvariant="bold">v</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq91.gif"></inline-graphic></alternatives></inline-formula> be an <italic>integral array</italic> such that<disp-formula id="Equ4"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }[t]={\left\{ \begin{array}{ll} \mathbf{T }(0)&amp; \quad t=0\\ \sum _{i=0}^{t-1} \mathbf{T }(\mathbf{y }[t]) &amp; \quad t&gt;0. \end{array}\right. }$$\end{document}</tex-math><mml:math display="block" id="M188"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow></mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic position="anchor" xlink:href="13015_2019_154_Article_Equ4.gif"></graphic></alternatives></disp-formula>For any arbitrary start and end positions <italic>s</italic>, <italic>e</italic>, the sufficient statistics of the block [<italic>s</italic>, <italic>e</italic>) can be calculated in constant time as<disp-formula id="Equ5"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \sum _{t=s}^{e-1} \mathbf{T }(\mathbf{y }[t]) = \left( \sum _{t=0}^{s-1} \mathbf{T }(\mathbf{y }[t])\right) - \left( \sum _{i=0}^{e-1} \mathbf{T }(\mathbf{y }[t])\right) = \mathbf{v }[e] - \mathbf{v }[s]. \end{aligned}$$\end{document}</tex-math><mml:math display="block" id="M190"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic position="anchor" xlink:href="13015_2019_154_Article_Equ5.gif"></graphic></alternatives></disp-formula>In contrast to image processing, where integral arrays are constructed over integer data, sufficient statistics require floating-point values for most distributions. Unfortunately, this incurs numeric problems for large data sizes. An IEEE 754 single-precision float has between 6 and 9 significant digits. Assuming that values for sufficient statistics are on the order of 1, the further back a data point is in <inline-formula id="IEq92"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }$$\end{document}</tex-math><mml:math id="M192"><mml:mi mathvariant="bold">v</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq92.gif"></inline-graphic></alternatives></inline-formula>, the more of its significant digits is used to store the sum. Neighboring entries will be similar or even equal, leading to catastrophic cancellation for short segments. For instance, values above <inline-formula id="IEq93"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M194"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq93.gif"></inline-graphic></alternatives></inline-formula>17 million are rounded to multiples of 2, so that even if each entry was 1.0, blocks of size 1 would be queried as 0.</p>
<p id="Par22">To alleviate this, we subdivide <inline-formula id="IEq105"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }$$\end{document}</tex-math><mml:math id="M196"><mml:mi mathvariant="bold">v</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq105.gif"></inline-graphic></alternatives></inline-formula> into non-overlapping <italic>cells</italic> of size <italic>c</italic>, and compute partial cumulative sums of sufficient statistics within each cell; for convenience, we compute these sums from high to low indices, see Fig. <xref ref-type="fig" rid="Fig3">3</xref>. It is then easy to see that <inline-formula id="IEq106"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{t=s}^{e-1} \mathbf{T }(\mathbf{y }[t]) = \left( \sum _j \mathbf{v }[j]\right) - \mathbf{v }[e]$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq106.gif"></inline-graphic></alternatives></inline-formula> for <inline-formula id="IEq107"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j\in \left\{ s\right\} \cup \left\{ i\,\big |\, s&lt;i\le e, i\equiv 0\,\, (\text {mod } c)\right\}$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mi>s</mml:mi></mml:mfenced><mml:mo>∪</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mi>i</mml:mi><mml:mspace width="0.166667em"></mml:mspace><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">|</mml:mo></mml:mrow><mml:mspace width="0.166667em"></mml:mspace><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>≡</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"></mml:mspace><mml:mspace width="0.166667em"></mml:mspace><mml:mo stretchy="false">(</mml:mo><mml:mtext>mod</mml:mtext><mml:mspace width="0.333333em"></mml:mspace><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq107.gif"></inline-graphic></alternatives></inline-formula>. In our implementation, we used <inline-formula id="IEq108"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c=2^{16}=65,\!536$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mn>16</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>65</mml:mn><mml:mo>,</mml:mo><mml:mspace width="-0.166667em"></mml:mspace><mml:mn>536</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq108.gif"></inline-graphic></alternatives></inline-formula>.<fig id="Fig3"><label>Fig. 3</label><caption><p>An illustration of an integral array <inline-formula id="IEq94"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }$$\end{document}</tex-math><mml:math id="M204"><mml:mi mathvariant="bold">v</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq94.gif"></inline-graphic></alternatives></inline-formula>, using cell size <inline-formula id="IEq95"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c=4$$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq95.gif"></inline-graphic></alternatives></inline-formula>. Columns represent data positions, and contain all positions <italic>i</italic> which are added up and stored at <inline-formula id="IEq96"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }[t]$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq96.gif"></inline-graphic></alternatives></inline-formula>; for instance, <inline-formula id="IEq97"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }[9] = \sum _{i=9}^{11} \mathbf{T }(\mathbf{y }[i])$$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>9</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow><mml:mn>11</mml:mn></mml:msubsup><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq97.gif"></inline-graphic></alternatives></inline-formula>. The statistics of a block [<italic>s</italic>, <italic>e</italic>) are obtained by adding <italic>v</italic>[<italic>s</italic>], <inline-formula id="IEq98"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }[m]$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq98.gif"></inline-graphic></alternatives></inline-formula> for all <inline-formula id="IEq99"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s&lt;m&lt;e$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq99.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq100"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m\equiv 0\mod c$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi>m</mml:mi><mml:mo>≡</mml:mo><mml:mn>0</mml:mn><mml:mspace width="3.33333pt"></mml:mspace><mml:mo>mod</mml:mo><mml:mspace width="0.277778em"></mml:mspace><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq100.gif"></inline-graphic></alternatives></inline-formula>, and subtracting <inline-formula id="IEq101"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }[e]$$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq101.gif"></inline-graphic></alternatives></inline-formula> iff <inline-formula id="IEq102"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e\not \equiv 0\mod c$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>e</mml:mi><mml:mo>≢</mml:mo><mml:mn>0</mml:mn><mml:mspace width="3.33333pt"></mml:mspace><mml:mo>mod</mml:mo><mml:mspace width="0.277778em"></mml:mspace><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq102.gif"></inline-graphic></alternatives></inline-formula>. For instance, block [3, 10) is obtained as <inline-formula id="IEq103"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{v }[3]+\mathbf{v }[4]+ \mathbf{v }[8]-\mathbf{v }[10]$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>4</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>8</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>-</mml:mo><mml:mi mathvariant="bold">v</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>10</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq103.gif"></inline-graphic></alternatives></inline-formula>, yielding <inline-formula id="IEq104"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum _{t=3}^9 \mathbf{T }(y[t])$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mn>9</mml:mn></mml:msubsup><mml:mi mathvariant="bold">T</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq104.gif"></inline-graphic></alternatives></inline-formula></p></caption><graphic id="MO7" xlink:href="13015_2019_154_Fig3_HTML"></graphic></fig></p>
</sec>
<sec id="Sec5">
<title>Breakpoint array for block boundaries</title>
<p id="Par23">In order to create a block generator, the integral array has to be supplemented with a data structure which yields start and end positions <inline-formula id="IEq109"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_k(\lambda )$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq109.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq110"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_k(\lambda )$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq110.gif"></inline-graphic></alternatives></inline-formula> for subsequent blocks <italic>k</italic>. Since <inline-formula id="IEq111"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_k(\lambda )=s_{k+1}(\lambda )$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq111.gif"></inline-graphic></alternatives></inline-formula>, it suffices to implement an iterator over <inline-formula id="IEq112"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_k$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq112.gif"></inline-graphic></alternatives></inline-formula> for increasing <italic>k</italic>, where <inline-formula id="IEq113"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_0 = 0$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq113.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq114"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_k = e_k(\lambda ) = s_{k+1}(\lambda )$$\end{document}</tex-math><mml:math id="M236"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq114.gif"></inline-graphic></alternatives></inline-formula>. We use a simple array of pointers to facilitate these queries:</p>
<sec id="FPar2">
<title>
<bold>Definition 2.2</bold>
</title>
<p id="Par24">(<italic>Breakpoint array</italic>) Let <inline-formula id="IEq115"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b } \in {\mathbb {R}} ^T$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mi mathvariant="bold">b</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq115.gif"></inline-graphic></alternatives></inline-formula> be a vector of breakpoint weights, and <inline-formula id="IEq116"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{p } \in {\mathbb {Z}} ^T_+$$\end{document}</tex-math><mml:math id="M240"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">Z</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq116.gif"></inline-graphic></alternatives></inline-formula> be a vector of pointers. A data structure <inline-formula id="IEq117"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(\mathbf{b }, \mathbf{p })$$\end{document}</tex-math><mml:math id="M242"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq117.gif"></inline-graphic></alternatives></inline-formula> is called a <italic>breakpoint array</italic> of input data <inline-formula id="IEq118"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y }$$\end{document}</tex-math><mml:math id="M244"><mml:mi mathvariant="bold">y</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq118.gif"></inline-graphic></alternatives></inline-formula> if and only if <inline-formula id="IEq119"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall t&lt;i&lt;t+\mathbf{p } [t]: \mathbf{b } [t] &gt;\mathbf{b } [i]$$\end{document}</tex-math><mml:math id="M246"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>:</mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mi mathvariant="bold">b</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq119.gif"></inline-graphic></alternatives></inline-formula>. We call each interval <inline-formula id="IEq120"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[t, \dots , \mathbf{p } [t]-1]$$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq120.gif"></inline-graphic></alternatives></inline-formula> a <italic>stretch at t</italic>. A breakpoint array is called <italic>maximal</italic> if for all <italic>T</italic> there exist no <inline-formula id="IEq121"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n &gt; \mathbf{p } [t]$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq121.gif"></inline-graphic></alternatives></inline-formula> such that setting <inline-formula id="IEq122"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{p } [t]$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq122.gif"></inline-graphic></alternatives></inline-formula> to <italic>n</italic> would still result in a valid breakpoint array.</p>
<graphic id="MO9" position="anchor" xlink:href="13015_2019_154_Figa_HTML"></graphic>
<p>A breakpoint array can be constructed in linear time <italic>O</italic>(<italic>T</italic>) (Algorithm 1), based on a linear-time algorithm to calculate the pointers to the next element at least as large as the current one, which is well established in algorithmic folklore. It is modified here to use the distance to that element instead of a direct pointer (line 20, which would normally read <inline-formula id="IEq124"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{p }[i] \leftarrow t$$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">←</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq124.gif"></inline-graphic></alternatives></inline-formula>). The stack is changed to a deque to accommodate the inclusion of a maximum jump size <italic>m</italic>. The front of the deque is popped and its pointer set whenever it is <italic>m</italic> positions away, which happens at most <italic>T</italic> times.</p>
<p>For each <italic>t</italic>, <inline-formula id="IEq125"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{p } [t]$$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq125.gif"></inline-graphic></alternatives></inline-formula> points to the beginning of next stretch. Within each stretch, the highest breakpoint weight is located at its first position; when searching for weights below a given threshold <inline-formula id="IEq126"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M258"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq126.gif"></inline-graphic></alternatives></inline-formula>, once the first weight is found to be below <inline-formula id="IEq127"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M260"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq127.gif"></inline-graphic></alternatives></inline-formula>, all others can be safely ignored, leading to a simple query: Starting at <inline-formula id="IEq128"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{k}(\lambda )+1$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq128.gif"></inline-graphic></alternatives></inline-formula>, follow pointers until a weight above threshold is encountered (see Fig. <xref ref-type="fig" rid="Fig4">4</xref>). In order to derive complexity results, we require the following result:<fig id="Fig4"><label>Fig. 4</label><caption><p>An example of generating blocks following pointers in a breakpoint array. The top figure represents the input data <inline-formula id="IEq123"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y }$$\end{document}</tex-math><mml:math id="M264"><mml:mi mathvariant="bold">y</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq123.gif"></inline-graphic></alternatives></inline-formula>, the bottom figure represents the absolute wavelet coefficients, as well as the pointers (grey lines) and the path taken by the query (red). Whenever a value above the threshold (horizontal blue line) is found, a breakpoint is returned (vertical blue lines)</p></caption><graphic id="MO8" xlink:href="13015_2019_154_Fig4_HTML"></graphic></fig></p>
</sec>
<sec id="FPar3">
<title>
<bold>Theorem 2.1</bold>
</title>
<p id="Par28">(Left-to-right maxima [<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>]) <italic>For a vector</italic>
<inline-formula id="IEq129"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{x },$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq129.gif"></inline-graphic></alternatives></inline-formula>
<italic>let</italic>
<inline-formula id="IEq130"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{x }[t]$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq130.gif"></inline-graphic></alternatives></inline-formula>
<italic>be called a</italic>
<italic>left-to-right maximum</italic>
<italic>of</italic>
<inline-formula id="IEq131"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{x }$$\end{document}</tex-math><mml:math id="M270"><mml:mi mathvariant="bold">x</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq131.gif"></inline-graphic></alternatives></inline-formula>
<italic>iff</italic>
<inline-formula id="IEq132"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall i&lt;t: \mathbf{x }[i]&lt;\mathbf{x }[t].$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>:</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq132.gif"></inline-graphic></alternatives></inline-formula>
<italic>Let</italic>
<inline-formula id="IEq133"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{\mathbf{x }}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq133.gif"></inline-graphic></alternatives></inline-formula>
<italic>count the number of left-to-right maximal elements in</italic>
<inline-formula id="IEq134"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{x }.$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq134.gif"></inline-graphic></alternatives></inline-formula>
<italic>For a random permutation of</italic>
<inline-formula id="IEq135"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{x }$$\end{document}</tex-math><mml:math id="M278"><mml:mi mathvariant="bold">x</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq135.gif"></inline-graphic></alternatives></inline-formula>
<italic>with</italic>
<inline-formula id="IEq136"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{} \mathbf{x } \right| =N$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mrow></mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq136.gif"></inline-graphic></alternatives></inline-formula>
<italic>elements,</italic>
<inline-formula id="IEq137"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {E}}\left[ m_{\mathbf{x }}\right] = \sum _{i=1}^N\frac{1}{N} \rightarrow \ln N$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:msub><mml:mi>m</mml:mi><mml:mi mathvariant="bold">x</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mo stretchy="false">→</mml:mo><mml:mo>ln</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq137.gif"></inline-graphic></alternatives></inline-formula>
<italic>as</italic>
<inline-formula id="IEq138"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\rightarrow \infty.$$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mi>∞</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq138.gif"></inline-graphic></alternatives></inline-formula>
<italic>Due to symmetry, the same result holds for minima and right-to-left extrema.</italic></p>
<p>Following pointers in <inline-formula id="IEq139"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{p }$$\end{document}</tex-math><mml:math id="M286"><mml:mi mathvariant="bold">p</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq139.gif"></inline-graphic></alternatives></inline-formula> creates a sequence of left-to-right maxima. For a block of size <italic>N</italic>, starting at <inline-formula id="IEq140"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_k(\lambda )$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq140.gif"></inline-graphic></alternatives></inline-formula>, there are <inline-formula id="IEq141"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M:=N-2$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mi>M</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq141.gif"></inline-graphic></alternatives></inline-formula> elements in <inline-formula id="IEq142"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I:=[e_k(\lambda )+1, \dots , e_k(\lambda )+N=e_{k+1}(\lambda ))$$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:mi>I</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq142.gif"></inline-graphic></alternatives></inline-formula> which can appear in any order, which implies that <inline-formula id="IEq143"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$e_{k+1}(\lambda )$$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq143.gif"></inline-graphic></alternatives></inline-formula> can be found in <inline-formula id="IEq144"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log N)$$\end{document}</tex-math><mml:math id="M296"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq144.gif"></inline-graphic></alternatives></inline-formula> expected time. Likewise, the maximum expected stack size in the constructor (Algorithm 1) is <inline-formula id="IEq145"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ln T$$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:mo>ln</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq145.gif"></inline-graphic></alternatives></inline-formula>: assume <inline-formula id="IEq146"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m=\infty$$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq146.gif"></inline-graphic></alternatives></inline-formula>. An element at <italic>t</italic> is pushed whenever there exists an index <italic>j</italic> on the stack such that <inline-formula id="IEq147"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall i=j, \dots , \text {top}: \mathbf{w }[i] &lt; \mathbf{w }[t]$$\end{document}</tex-math><mml:math id="M302"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mtext>top</mml:mtext><mml:mo>:</mml:mo><mml:mi mathvariant="bold">w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="bold">w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq147.gif"></inline-graphic></alternatives></inline-formula>. Given the smallest such <italic>j</italic>, the stacks are popped until <inline-formula id="IEq148"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {top} = j-1$$\end{document}</tex-math><mml:math id="M304"><mml:mrow><mml:mtext>top</mml:mtext><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq148.gif"></inline-graphic></alternatives></inline-formula>, and <inline-formula id="IEq149"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{w }[j-1] &gt; \mathbf{w }[t]$$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:mi mathvariant="bold">w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mi mathvariant="bold">w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq149.gif"></inline-graphic></alternatives></inline-formula>. Therefore, the stack contains the right-to-left minima of <inline-formula id="IEq150"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{w }[1:t]$$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mi mathvariant="bold">w</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq150.gif"></inline-graphic></alternatives></inline-formula> after pushing index <italic>t</italic>, and the claim follows from Theorem <xref ref-type="sec" rid="FPar3">2.1</xref> for <inline-formula id="IEq151"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=T$$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq151.gif"></inline-graphic></alternatives></inline-formula>. For any <inline-formula id="IEq152"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m&lt;\infty$$\end{document}</tex-math><mml:math id="M312"><mml:mrow><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq152.gif"></inline-graphic></alternatives></inline-formula>, the front of the deque gets popped, thus only decreasing the stack size. For the size <inline-formula id="IEq153"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{hg}$$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hg</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq153.gif"></inline-graphic></alternatives></inline-formula> of the human genome (3.5 billion), the expected maximum stack size is <inline-formula id="IEq154"><alternatives><tex-math id="M315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;22$$\end{document}</tex-math><mml:math id="M316"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq154.gif"></inline-graphic></alternatives></inline-formula>, a negligible overhead. We noticed that, for noisy data, most entries in <inline-formula id="IEq155"><alternatives><tex-math id="M317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{p }$$\end{document}</tex-math><mml:math id="M318"><mml:mi mathvariant="bold">p</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq155.gif"></inline-graphic></alternatives></inline-formula> are much smaller than <italic>T</italic>, and using pointer-sized integers such as size_t in C++ (typically 8 byte on 64-bit systems), would be wasteful. Instead, we use a 2-byte unsigned integer type to accommodate jumps up to <inline-formula id="IEq156"><alternatives><tex-math id="M319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m=65, 536$$\end{document}</tex-math><mml:math id="M320"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>65</mml:mn><mml:mo>,</mml:mo><mml:mn>536</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq156.gif"></inline-graphic></alternatives></inline-formula>. The resulting breakpoint array is not maximal anymore, but maintains its space-efficiency and compressivity. The query overhead is minimal in practice; even in case of a single block for genome sized data, <inline-formula id="IEq157"><alternatives><tex-math id="M321">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{T_{hg}}{65, 536} &lt; 54$$\end{document}</tex-math><mml:math id="M322"><mml:mrow><mml:mfrac><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="italic">hg</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mn>65</mml:mn><mml:mo>,</mml:mo><mml:mn>536</mml:mn></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mn>54</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq157.gif"></inline-graphic></alternatives></inline-formula>.</p>
</sec>
</sec>
<sec id="Sec6">
<title>Haar breakpoint weights</title>
<p id="Par30">Having established a data structure to iterate over blocks for any given compression level, we now define a vector <inline-formula id="IEq158"><alternatives><tex-math id="M323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_H$$\end{document}</tex-math><mml:math id="M324"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq158.gif"></inline-graphic></alternatives></inline-formula> of breakpoint weights for the Haar wavelet transform, i. e. <inline-formula id="IEq159"><alternatives><tex-math id="M325">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_H[t] &gt; \lambda$$\end{document}</tex-math><mml:math id="M326"><mml:mrow><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq159.gif"></inline-graphic></alternatives></inline-formula> iff Haar wavelet regression with threshold <inline-formula id="IEq160"><alternatives><tex-math id="M327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M328"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq160.gif"></inline-graphic></alternatives></inline-formula> contains a discontinuity between <inline-formula id="IEq161"><alternatives><tex-math id="M329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M330"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq161.gif"></inline-graphic></alternatives></inline-formula> an <italic>t</italic>, and therefore a block boundary in Haar wavelet compression. This is the case if the absolute value of any coefficient of wavelets who have any of their discontinuities at <italic>t</italic> as above the threshold, so we define, for any <inline-formula id="IEq162"><alternatives><tex-math id="M331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = b^\pm _{j,k} \in [0, T)$$\end{document}</tex-math><mml:math id="M332"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq162.gif"></inline-graphic></alternatives></inline-formula>,<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M333">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \mathbf{b }_H[t]:=\max _{j,k} \left\{ \left|{} \left\langle {\varvec{\psi }} _{j,k}, \mathbf{y } \right\rangle \right| \,\big |\, t\in \left\{ b^+_{j,k}, b^\pm _{j,k}, b^-_{j,k} \right\} \right\} \end{aligned}$$\end{document}</tex-math><mml:math display="block" id="M334"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="true">max</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mfenced close="}" open="{" separators=""><mml:mfenced close="|" open="|" separators=""><mml:mrow></mml:mrow><mml:mfenced close="〉" open="〈" separators=""><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced></mml:mfenced><mml:mspace width="0.166667em"></mml:mspace><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">|</mml:mo></mml:mrow><mml:mspace width="0.166667em"></mml:mspace><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic position="anchor" xlink:href="13015_2019_154_Article_Equ1.gif"></graphic></alternatives></disp-formula>for <inline-formula id="IEq163"><alternatives><tex-math id="M335">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t&gt;0$$\end{document}</tex-math><mml:math id="M336"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq163.gif"></inline-graphic></alternatives></inline-formula> or <inline-formula id="IEq164"><alternatives><tex-math id="M337">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^-_{j,k} &lt; T$$\end{document}</tex-math><mml:math id="M338"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq164.gif"></inline-graphic></alternatives></inline-formula>. Additionally, there is always a block boundary before the first position, so <inline-formula id="IEq165"><alternatives><tex-math id="M339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_H[0]:=\infty$$\end{document}</tex-math><mml:math id="M340"><mml:mrow><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq165.gif"></inline-graphic></alternatives></inline-formula>. Furthermore, if <italic>T</italic> is not a power of 2, some wavelets have incomplete support. As their magnitude is unknown without padding the data, we assume that their detail coefficient is potentially larger than any threshold, inducing a breakpoint at the central discontinuity, so <inline-formula id="IEq166"><alternatives><tex-math id="M341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_H\left[ b^\pm _{j,k}\right] :=\infty$$\end{document}</tex-math><mml:math id="M342"><mml:mrow><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup></mml:mfenced><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq166.gif"></inline-graphic></alternatives></inline-formula> for <inline-formula id="IEq167"><alternatives><tex-math id="M343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^-_{j,k}\ge T$$\end{document}</tex-math><mml:math id="M344"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq167.gif"></inline-graphic></alternatives></inline-formula>. A breakpoint array initialized with these weights is called a <italic>Haar breakpoint array</italic>.</p>
<p id="Par31">We will show that <inline-formula id="IEq168"><alternatives><tex-math id="M345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_H$$\end{document}</tex-math><mml:math id="M346"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq168.gif"></inline-graphic></alternatives></inline-formula> can be computed in-place and in linear time. For that purpose, we first define the <italic>maxlet array</italic> as a generalization of the Haar transform to arbitrary data sizes and absolute values: For <inline-formula id="IEq169"><alternatives><tex-math id="M347">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^\pm _{j,k} \in [0, T)$$\end{document}</tex-math><mml:math id="M348"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq169.gif"></inline-graphic></alternatives></inline-formula>, let<disp-formula id="Equ6"><alternatives><tex-math id="M349">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_M\left[ b^\pm _{j,k}\right] = {\left\{ \begin{array}{ll} \infty &amp; \quad t=0 \vee b^-_{j,k}\ge T \\ \left| \left\langle {\varvec{\psi }} _{j,k}, \mathbf{y } \right\rangle \right| &amp; \quad t&gt;0 \vee b^-_{j,k} &lt; T. \end{array}\right. }$$\end{document}</tex-math><mml:math display="block" id="M350"><mml:mrow><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mi>∞</mml:mi></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>∨</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow></mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:mfenced close="〉" open="〈" separators=""><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi></mml:mfenced></mml:mfenced></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>∨</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>T</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic position="anchor" xlink:href="13015_2019_154_Article_Equ6.gif"></graphic></alternatives></disp-formula>We later define the <italic>Haar boundary transform</italic> to compute <inline-formula id="IEq170"><alternatives><tex-math id="M351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_H$$\end{document}</tex-math><mml:math id="M352"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq170.gif"></inline-graphic></alternatives></inline-formula> from <inline-formula id="IEq171"><alternatives><tex-math id="M353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_M$$\end{document}</tex-math><mml:math id="M354"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq171.gif"></inline-graphic></alternatives></inline-formula>. In order to compute <inline-formula id="IEq172"><alternatives><tex-math id="M355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_M$$\end{document}</tex-math><mml:math id="M356"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq172.gif"></inline-graphic></alternatives></inline-formula> in-place, we cannot use the pyramid algorithm as in [<xref ref-type="bibr" rid="CR6">6</xref>], since it requires padding of the data to a size <inline-formula id="IEq173"><alternatives><tex-math id="M357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'\in 2^{\mathbb {N}}$$\end{document}</tex-math><mml:math id="M358"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi mathvariant="double-struck">N</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq173.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq174"><alternatives><tex-math id="M359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T\le T'\le 2T$$\end{document}</tex-math><mml:math id="M360"><mml:mrow><mml:mi>T</mml:mi><mml:mo>≤</mml:mo><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq174.gif"></inline-graphic></alternatives></inline-formula>, as well as an auxiliary array of size <inline-formula id="IEq175"><alternatives><tex-math id="M361">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T'$$\end{document}</tex-math><mml:math id="M362"><mml:msup><mml:mi>T</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq175.gif"></inline-graphic></alternatives></inline-formula>, thereby increasing the memory by up to a factor of 4. Instead, we use a more recent in-place calculation of the Haar wavelet transform based on the lifting scheme [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. It is based on the following recursions:<disp-formula id="Equ7"><alternatives><tex-math id="M363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&amp; c_{j,k} :={\left\{ \begin{array}{ll} \mathbf{y }[k] &amp; \quad j=0\\ \sum _{t=b^+_{j,k}}^{b^-_{j,k} -1} \mathbf{y }[t] = c_{j-1, 2k} + c_{j-1, 2k+1} &amp; \quad j&gt;0\text {, and}\\ \end{array}\right. }\\&amp; d_{j,k} :=\frac{1}{\sqrt{2^j}}\left( c_{j-1, 2k} + c_{j-1, 2k+1}\right) . \end{aligned}$$\end{document}</tex-math><mml:math display="block" id="M364"><mml:mrow><mml:mtable><mml:mtr><mml:mtd></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow></mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mi>j</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mtext>, and</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup></mml:msqrt></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic position="anchor" xlink:href="13015_2019_154_Article_Equ7.gif"></graphic></alternatives></disp-formula>These relations are illustrated in Fig. <xref ref-type="fig" rid="Fig5">5</xref> using dotted edges, with <inline-formula id="IEq176"><alternatives><tex-math id="M365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{j,k}=w_{j,k}$$\end{document}</tex-math><mml:math id="M366"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq176.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq177"><alternatives><tex-math id="M367">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{0,k} = y_{k} = \mathbf{y }[k]$$\end{document}</tex-math><mml:math id="M368"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq177.gif"></inline-graphic></alternatives></inline-formula>. By storing <inline-formula id="IEq178"><alternatives><tex-math id="M369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{j,k}$$\end{document}</tex-math><mml:math id="M370"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq178.gif"></inline-graphic></alternatives></inline-formula> at index <inline-formula id="IEq179"><alternatives><tex-math id="M371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^+_{j,k}$$\end{document}</tex-math><mml:math id="M372"><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq179.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq180"><alternatives><tex-math id="M373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{j,k}$$\end{document}</tex-math><mml:math id="M374"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq180.gif"></inline-graphic></alternatives></inline-formula> at index <inline-formula id="IEq181"><alternatives><tex-math id="M375">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^\pm _{j,k}$$\end{document}</tex-math><mml:math id="M376"><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq181.gif"></inline-graphic></alternatives></inline-formula>, this yields a simple in-place algorithm which never overwrites <inline-formula id="IEq182"><alternatives><tex-math id="M377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{j,k}$$\end{document}</tex-math><mml:math id="M378"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq182.gif"></inline-graphic></alternatives></inline-formula> once it is calculated. Notice that detail coefficients <inline-formula id="IEq183"><alternatives><tex-math id="M379">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d_{j,k}$$\end{document}</tex-math><mml:math id="M380"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq183.gif"></inline-graphic></alternatives></inline-formula> are stored at the position <inline-formula id="IEq184"><alternatives><tex-math id="M381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^\pm _{j,k}$$\end{document}</tex-math><mml:math id="M382"><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq184.gif"></inline-graphic></alternatives></inline-formula> corresponding to the central discontinuity in their corresponding wavelet, and that this corresponds to an in-order DFS layout of the wavelet tree without the leaves corresponding to the input data, with the leftmost leaf at index 1 (Fig. <xref ref-type="fig" rid="Fig5">5</xref>, bold lines); the tree is created from the leaves up, and from left to right. A straightforward modification of the lifting scheme to calculate <inline-formula id="IEq185"><alternatives><tex-math id="M383">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_M$$\end{document}</tex-math><mml:math id="M384"><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq185.gif"></inline-graphic></alternatives></inline-formula> is shown in Algorithm 2, where line 13 is changed to yield the absolute value, and lines 9, 14 and 15 are added to ensure <inline-formula id="IEq186"><alternatives><tex-math id="M385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_H\left[ b^\pm _{j,k}\right] :=\infty$$\end{document}</tex-math><mml:math id="M386"><mml:mrow><mml:msub><mml:mi mathvariant="bold">b</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close="]" open="[" separators=""><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup></mml:mfenced><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq186.gif"></inline-graphic></alternatives></inline-formula> for <inline-formula id="IEq187"><alternatives><tex-math id="M387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b^-_{j,k}\ge T$$\end{document}</tex-math><mml:math id="M388"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>-</mml:mo></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq187.gif"></inline-graphic></alternatives></inline-formula>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Illustration of the various algorithms necessary to create the Haar breakpoint array in-place. The top figure represents the transformation of an input array <inline-formula id="IEq188"><alternatives><tex-math id="M389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{y }$$\end{document}</tex-math><mml:math id="M390"><mml:mi mathvariant="bold">y</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq188.gif"></inline-graphic></alternatives></inline-formula> at level 0 into various other forms. The terms <inline-formula id="IEq189"><alternatives><tex-math id="M391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c_{j,k}$$\end{document}</tex-math><mml:math id="M392"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq189.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq190"><alternatives><tex-math id="M393">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_{j,k}$$\end{document}</tex-math><mml:math id="M394"><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq190.gif"></inline-graphic></alternatives></inline-formula> represent values associated with the scale and detail coefficients of the wavelet transform, respectively. The wavelet tree (bold lines) represents the nested nature of the support intervals: the horizontal position of <inline-formula id="IEq191"><alternatives><tex-math id="M395">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _{j,k}$$\end{document}</tex-math><mml:math id="M396"><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq191.gif"></inline-graphic></alternatives></inline-formula> represents the position <italic>t</italic> of central discontinuity <inline-formula id="IEq192"><alternatives><tex-math id="M397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{b }_{j,k}^\pm$$\end{document}</tex-math><mml:math id="M398"><mml:msubsup><mml:mi mathvariant="bold">b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>±</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq192.gif"></inline-graphic></alternatives></inline-formula> of <inline-formula id="IEq193"><alternatives><tex-math id="M399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\psi }} _{j,k}$$\end{document}</tex-math><mml:math id="M400"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">ψ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq193.gif"></inline-graphic></alternatives></inline-formula>, and its vertical position represents the resolution level <italic>i</italic>. The support interval for each wavelet corresponds to all descendants at level 0. The tree nodes contain the output arrays of the various transforms. Dotted lines indicate the recursive relations in the lifting scheme, as used by the in-place Haar wavelet transform and the maxlet transform. The solid lines (including tree edges) indicate the dependencies in the Haar boundary transform. In the bottom figure, white bullets represent maxlet coefficients, black bullets represent their changed values after the Haar boundary transform, and lines indicate breakpoint array pointers</p></caption><graphic id="MO13" xlink:href="13015_2019_154_Fig5_HTML"></graphic></fig></p>
<graphic id="MO14" position="anchor" xlink:href="13015_2019_154_Figb_HTML"></graphic>
<p id="Par32">To derive Haar breakpoint weight from the maxlet transform, we introduce the <italic>Haar boundary transform</italic> (Algorithm 3), which performs the necessary maximum computations for Eq. <xref ref-type="" rid="Equ1">1</xref> in-place and in linear time <italic>O</italic>(<italic>T</italic>). In Fig. <xref ref-type="fig" rid="Fig5">5</xref> (top), the set of nodes considered in Eq. <xref ref-type="" rid="Equ1">1</xref> are the direct descendants of a node along the solid lines. Algorithm 3 is simple: it iterates over the scales <italic>j</italic> in a top-down fashion (Fig. <xref ref-type="fig" rid="Fig5">5</xref>), and writes the maxima of all required nodes at lower levels <inline-formula id="IEq194"><alternatives><tex-math id="M401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ell \le j$$\end{document}</tex-math><mml:math id="M402"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>≤</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq194.gif"></inline-graphic></alternatives></inline-formula> to the current array position. Since it never reads values from levels <inline-formula id="IEq195"><alternatives><tex-math id="M403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&gt;j$$\end{document}</tex-math><mml:math id="M404"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq195.gif"></inline-graphic></alternatives></inline-formula>, no extra memory is required, and the algorithm is in-place. Since any node is considered at most twice for updating a node on a higher level, the running time of the Haar boundary transform is also linear, <italic>O</italic>(<italic>T</italic>).</p>
<graphic id="MO15" position="anchor" xlink:href="13015_2019_154_Figc_HTML"></graphic>
</sec>
</sec>
<sec id="Sec7">
<title>Compressed marginal records</title>
<p id="Par33">In order to keep track of the states sampled for each position during Gibbs sampling, we require the following data structure:</p>
<sec id="FPar4">
<title>
<bold>Definition 2.3</bold>
</title>
<p id="Par34">(<italic>Marginal records</italic>) Let <inline-formula id="IEq196"><alternatives><tex-math id="M405">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t\in [0, \ldots , T)$$\end{document}</tex-math><mml:math id="M406"><mml:mrow><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq196.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq197"><alternatives><tex-math id="M407">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s_{\max }$$\end{document}</tex-math><mml:math id="M408"><mml:msub><mml:mi>s</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq197.gif"></inline-graphic></alternatives></inline-formula> the largest state sampled during FBG, and <inline-formula id="IEq198"><alternatives><tex-math id="M409">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s\in [0, \ldots , s_{\max }]$$\end{document}</tex-math><mml:math id="M410"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mo movablelimits="true">max</mml:mo></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq198.gif"></inline-graphic></alternatives></inline-formula>. A <italic>marginal record</italic> is a data structure which allows to store and query the number of times state <italic>s</italic> was observed at data index <italic>t</italic>.</p>
<p>The previous solution to recording marginal state counts was inefficient. Since nodes in the wavelet tree corresponded to compression blocks, counts were stored directly in the nodes. For <italic>n</italic> latent HMM states, this required allocation of 2<italic>Tn</italic> array elements, which was wasteful since the quick convergence of HaMMLET meant that many blocks would never be sampled, or only be assigned to a small subset of CNV states. Such a preallocation approach also requires the number of states to be known in advance, and precludes further extensions to priors on the state number such as the Dirichlet Process. Though we resorted to dynamic allocation, the necessary variables for housekeeping still incurred large overhead.</p>
<p>For static compression blocks, marginals can simply be stored in a set of arrays with an additional array containing block sizes, essentially a run-length encoding (RLE), as illustrated by the right column of Fig. <xref ref-type="fig" rid="Fig6">6</xref>. This approach however is complicated by the use of dynamic compression: at each new iteration, a different block structure is created, which requires existing RLE segments to be split into multiple parts, each of which will have counts for a different state added. This could be solved trivially using a linked list implementation, in which new segments are inserted with the appropriate updates of its neighbors size. This approach is obviously wasteful.<fig id="Fig6"><label>Fig. 6</label><caption><p>A small three-step example of recording marginal counts using Algorithm 4. Starting at position <inline-formula id="IEq199"><alternatives><tex-math id="M411">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 0$$\end{document}</tex-math><mml:math id="M412"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq199.gif"></inline-graphic></alternatives></inline-formula>, 7 observations of state 5 are inserted. In the count queue, black boxes indicate that state counts of zero have been skipped; those numbers encode the next higher state that has a non-zero count. White boxes indicate the counts for the state. For instance, the right-most part of the count queue in the top subfigure is stored as <inline-formula id="IEq200"><alternatives><tex-math id="M413">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(0, -1, -2, 4, -7)$$\end{document}</tex-math><mml:math id="M414"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>7</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq200.gif"></inline-graphic></alternatives></inline-formula>, indicating that there is 1 count for state 0, 2 counts for state 1, and 7 counts for state 4. The segment starts at position <inline-formula id="IEq201"><alternatives><tex-math id="M415">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=9$$\end{document}</tex-math><mml:math id="M416"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq201.gif"></inline-graphic></alternatives></inline-formula>, and has a length of 1. Note that 0 is used to mark the start of a new segment. Each segment has a total of 10 counts already recorded. Arrows indicate contiguous elements in the count queue. With every iteration, a segment is moved to the back with the new state count included. Note that in the last iteration, the segment <inline-formula id="IEq202"><alternatives><tex-math id="M417">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=6, \dots , 8$$\end{document}</tex-math><mml:math id="M418"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq202.gif"></inline-graphic></alternatives></inline-formula> is split. After finishing this step, the next count would be recorded starting at position <inline-formula id="IEq203"><alternatives><tex-math id="M419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=7$$\end{document}</tex-math><mml:math id="M420"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq203.gif"></inline-graphic></alternatives></inline-formula>. Notice how each run of zeros in the state queue is represented by a single number, thus allowing for arbitrarily large state indices without much overhead</p></caption><graphic id="MO16" xlink:href="13015_2019_154_Fig6_HTML"></graphic></fig></p>
<p>To get around these issues, we developed an encoding for marginal records that stores counts sequentially in a vector of integers in a highly compressed fashion with minimum overhead. Adding records for run-length encoded state sequences is performed using a queue with iterator access to its front elements, such as implemented by the C++ STL deque, and requires a single pass over the state records and is therefore linear. The memory overhead is 2 bytes per segment, plus one bit for every 32 integers. Encoding for marginal counts for a single position is performed using a sequence <inline-formula id="IEq204"><alternatives><tex-math id="M421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbf{c }$$\end{document}</tex-math><mml:math id="M422"><mml:mi mathvariant="bold">c</mml:mi></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq204.gif"></inline-graphic></alternatives></inline-formula> of signed integers. A negative number is used to store the counts for a state. The state <italic>s</italic>(<italic>i</italic>) of a position <italic>i</italic> is recursively defined as<disp-formula id="Equ8"><alternatives><tex-math id="M423">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} s(0) = 0\quad \quad s(i) :={\left\{ \begin{array}{ll} s(i-1) &amp;{} c[i-1]&lt;0\\ \mathbf{c }[i-1] &amp;{} c[i-1]&gt;0. \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math display="block" id="M424"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="1em"></mml:mspace><mml:mspace width="1em"></mml:mspace><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow></mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow></mml:mrow><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow></mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic position="anchor" xlink:href="13015_2019_154_Article_Equ8.gif"></graphic></alternatives></disp-formula>Positive entries are called <italic>index values</italic>. We further require that all index values must be in strictly increasing order, and that no unnecessary index is used, i. e. we require <inline-formula id="IEq205"><alternatives><tex-math id="M425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall \mathbf{c }[i]&gt;0: s(i-1)+1 &lt; \mathbf{c }[i]$$\end{document}</tex-math><mml:math id="M426"><mml:mrow><mml:mo>∀</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:mi mathvariant="bold">c</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq205.gif"></inline-graphic></alternatives></inline-formula>. In other words, runs of states having observed counts are represented as runs of negative numbers, and runs of zero-counts are represented as a single number indicating the state label of the next higher state with non-zero counts. For instance, the count vector (2, 0, 0, 8, 1, 4, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0) would be encoded as <inline-formula id="IEq206"><alternatives><tex-math id="M427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(-2, 3, -8, -1, -4, 9, -5)$$\end{document}</tex-math><mml:math id="M428"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>8</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>9</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq206.gif"></inline-graphic></alternatives></inline-formula>, and the corresponding states are (0, 1, 3, 4, 5, 6, 9), though 1 and 6 are somewhat inconsequential as they have no counts associated with them; note that the decision to use negative signs for counts instead of index values is arbitrary in principle, but leads to using fewer negations in the implementation. In settings where quick convergence is expected, the number of zeros is expected to be high, leading to good compression under this scheme. In general, assume that the marginals contain <italic>M</italic> distinct segments after running FBG, and the HMM has <italic>S</italic> states. Then, the queue can contain no more than <inline-formula id="IEq207"><alternatives><tex-math id="M429">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(2S + 1)M$$\end{document}</tex-math><mml:math id="M430"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq207.gif"></inline-graphic></alternatives></inline-formula> entries: for each segment, one zero to mark the beginning of a segment, and up to one positive and negative value per state. If the number of latent HMM states is limited to <italic>S</italic>, then there can be no more than <italic>S</italic> non-zero entries per segment. Hence, for reasonably high compression ratios, this amounts to small memory usage. For instance, at a compression ratio of 300 for a human genome at base-level resolution and 10 latent HMM states, marginal records using 2-byte signed integers require less than 234  MB. In practice, not every segment will contain 11 values, due to fast convergence, and the numbers get even smaller. Compared to the storage requirements of the block generator, this is negligible.</p>
<graphic id="MO18" position="anchor" xlink:href="13015_2019_154_Figd_HTML"></graphic>
</sec>
</sec>
</sec>
<sec id="Sec8">
<title>Results and discussion</title>
<p id="Par38">In order to verify that the higher compression did not adversely affect the segmentation quality, we re-ran the evaluation on the 129,000 simulated datasets in [<xref ref-type="bibr" rid="CR6">6</xref>] using our new implementation of HaMMLET. The F-measures and plots are virtually identical to Fig.  <xref ref-type="fig" rid="Fig5">5</xref> in that paper, and are therefore not shown here (see Web Supplement).</p>
<p id="Par39">In the following subsections, we present a case study of CNV inference on differential WGS read depth data using HaMMLET with the Haar breakpoint array.</p>
<sec id="Sec9">
<title>Experiment background</title>
<p id="Par40">The domestication of a handful of animal species, starting in the early holocene, has played a crucial role in the development of complex human societies [<xref ref-type="bibr" rid="CR23">23</xref>]. While we have learned a great deal about when and where animal domestication occurred, the genetic changes that underlie the phenotypic differences between domestic animals and their wild progenitors remain relatively unknown. It has been observed that domestic animal species tend to share a suite of behavioral, physiological and morphological traits that are absent or rarely observed in their wild progenitors [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. These traits include changes in pigmentation, craniofacial anatomy, hormonal levels, seasonal reproduction cycles and increased docility [<xref ref-type="bibr" rid="CR26">26</xref>]. This suite of changes is referred to as the “domestication syndrome”. A long-standing question in evolutionary biology is whether these convergent changes are the result of genetic drift, artificial selection by humans for each individual trait, or pleiotropic effects of selection for a few or even a single trait. A proponent of the latter hypothesis was the Academician Dmitry K. Belyaev. He hypothesised that selection for tameness at the start of the domestication process had pleiotropic effects that explained many of the features of the domestication syndrome. To test his hypothesis, he began a program of experimental domestication of the silver fox (<italic>Vulpes vulpes</italic>) in Novosibirsk, Siberia in 1959. Foxes obtained for fur farms were selectively bred for their behavioral response to an approaching human. One line of foxes was bred for tame behavior towards humans while a control line was selected for a fearful and aggressive response towards humans, to maintain the wild-type behavior despite being maintained in captive conditions. After just a few generations of selective breeding the tame line began to show many of the traits associated with the domestication syndrome, including changes in pigmentation, morphology and behavior [<xref ref-type="bibr" rid="CR27">27</xref>–<xref ref-type="bibr" rid="CR29">29</xref>].</p>
<p id="Par41">The same experimental setup of artificially selecting two lines, one for tame and one for fearful and aggressive behavior towards humans was also repeated by the same research group in the brown Norway rat (<italic>Rattus norvegicus</italic>) with similar results [<xref ref-type="bibr" rid="CR30">30</xref>]. These results seem to confirm Belyaev’s hypothesis that selection for tameness alone could explain many of the features of the domestication syndrome. However, the specific genetic changes that underlie these changes remain unknown. Knowledge of the genetic variants that have been selected in these lines could lead to mechanistic insights into the domestication process. Genomic structural variants are of particular interest as they are known to have played a role in the adaptation of other domestic animals [<xref ref-type="bibr" rid="CR31">31</xref>] and structural variants that affect multiple functional genomic loci are one possible explanation for the rapid response to selection observed in these lines. To address this issue we analysed whole-genome data that was generated from multiple individuals from the tame and aggressive lines of rats.</p>
</sec>
<sec id="Sec10">
<title>Sample origins and data generation</title>
<p id="Par42">DNA samples were obtained from two rat lines originating from a shared wild source population and subsequently maintained in isolation and divergently selected for <inline-formula id="IEq208"><alternatives><tex-math id="M431">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M432"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq208.gif"></inline-graphic></alternatives></inline-formula>70 generations for their behavioral response to humans. 20 samples were obtained from the tame line, which has been selected for a reduced fear response towards an approaching human hand. 20 samples were obtained from the aggressive line, which has been selected for an increase in fearful and aggressive behavior towards an approaching human hand. DNA extraction was carried out at the Institute of Cytology and Genetics, the Siberian Branch of the Russian Academy of Sciences, Novosibirsk and at the Max Planck Institute for Evolutionary Anthropology (MPI-EVA), Germany.</p>
<p id="Par43">For all samples, sequencing libraries were generated consisting of 125 bp double-indexed paired-end reads. Samples were pooled into a single library in order to avoid any batch effects during sequencing. Sequencing was performed on a combination of the Illumina Genome Analyzer II and High-Seq platforms. Library preparation and sequencing was carried out at the MPI-EVA. The rats have a mean coverage of <inline-formula id="IEq209"><alternatives><tex-math id="M433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim$$\end{document}</tex-math><mml:math id="M434"><mml:mo>∼</mml:mo></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq209.gif"></inline-graphic></alternatives></inline-formula>4× per individual. Base calling was done using freeIbis [<xref ref-type="bibr" rid="CR32">32</xref>]. Adapters were removed and potentially chimeric sequences flagged using leeHom with default parameters [<xref ref-type="bibr" rid="CR33">33</xref>]. Reads were demultiplexed using deML using default quality thresholds [<xref ref-type="bibr" rid="CR34">34</xref>]. Reads were then mapped to the <italic>Rattus norvegicus</italic> reference assembly rno5, using the BWA with default parameters [<xref ref-type="bibr" rid="CR35">35</xref>]. Duplicate read removal was performed with Picard (<ext-link ext-link-type="uri" xlink:href="http://broadinstitute.github.io/picard/">http://broadinstitute.github.io/picard/</ext-link>). Local indel realignment was performed using GATK [<xref ref-type="bibr" rid="CR36">36</xref>]. Lowest mapping positions were recorded for each read, and their counts were accumulated. Start counts for the tame population were subtracted from their counterparts in the aggressive population, yielding 1,880,703,547 data points. Due to the low coverage, the data showed highly discrete noise, and hence the data was averaged over non-overlapping windows of 20 positions to approximate Gaussian noise, resulting in 94,035,178 input positions. We then ran HaMMLET with 8 CNV states and automatic priors, see [<xref ref-type="bibr" rid="CR6">6</xref>].</p>
</sec>
<sec id="Sec11">
<title>Computational benchmarks</title>
<p id="Par44">On a computer with Intel Xeon CPU E7-8890 v4 (2.20 GHz) and 1 TB RAM, running Ubuntu 14.04.5 LTS, full Bayesian inference with HaMMLET for 200 iterations with a burn-in of 1800 for an 8-state-model required 3 min 41 s and 1.3 GB RAM on a single core. By comparison, the previously published version of HaMMLET took 1 h 5 min 27 s, using 40 GB RAM, a 17.8-fold speedup.</p>
<p id="Par45">For a broader evaluation, we have created 100 replicates of the data by splitting it into 2500 chunks of equal sizes, which we then permuted randomly. We measured the memory usage (maximum resident set size), running time as well as cache behavior (minor page faults), see the boxplots in Fig. <xref ref-type="fig" rid="Fig7">7</xref>). The smaller savings in runtime compared to the original data can be attributed to the fact that permutation of the data is likely to disrupt long highly compressible sections of the data.<fig id="Fig7"><label>Fig. 7</label><caption><p>Comparison of benchmarks for running time, memory usage and cache behavior between the old and new versions of HaMMLET on the rat population WGS data set. The new approach yields a 17.8-fold speedup and 32.2-fold memory reduction. Notice that the number of minor page faults decreases by two orders of magnitude, indicating much better cache behavior due to the use of new data structures and an improved implementation. The number of major page faults is zero in both implementations. The wavelet tree benchmarks also contain one outlier with 2.4 billion page faults and 6.4 h runtime, likely due to undercompression. No such anomaly was observed for the breakpoint array</p></caption><graphic id="MO19" xlink:href="13015_2019_154_Fig7_HTML"></graphic></fig></p>
<p id="Par46">While the RAM usage remains almost constant among replicates within each implementation, we noticed that runtime and cache behavior varied widely in the old, but not the new implementation. We attribute this to the fact that the old compression scheme is suboptimal, yielding smaller blocks and hence more randomized assignment to states, leading to slower mixing properties of the Gibbs sampler. Notice that the data contains outliers which are likely to result from sampling small emission variances due to short compression blocks.</p>
</sec>
<sec id="Sec12">
<title>Biological results</title>
<p id="Par47">We consider all genomic segments with an absolute state mean <inline-formula id="IEq210"><alternatives><tex-math id="M435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 1$$\end{document}</tex-math><mml:math id="M436"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq210.gif"></inline-graphic></alternatives></inline-formula> as containing putative structural variation segregating between the tame and aggressive rat lines. This results in 10,083,374 regions with a mean size of 407 base pairs. We identify all genes that are within or overlap these regions by <inline-formula id="IEq211"><alternatives><tex-math id="M437">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 1$$\end{document}</tex-math><mml:math id="M438"><mml:mrow><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq211.gif"></inline-graphic></alternatives></inline-formula> base pair using Ensembl’s Variant Effect Predictor [<xref ref-type="bibr" rid="CR37">37</xref>]. We find 1036 genes with at least partial overlap with these regions.</p>
<p id="Par48">To investigate the potential phenotypic consequences of these structural variants we performed GO gene enrichment analysis using the software Webgestalt [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. We tested for enrichment of GO categories using all genes overlapping these structural variants using all genes in the rat genome as background. We consider as significantly enriched all pathways with p-value <inline-formula id="IEq212"><alternatives><tex-math id="M439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$&lt;0.05$$\end{document}</tex-math><mml:math id="M440"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq212.gif"></inline-graphic></alternatives></inline-formula> after using the Benjamini and Hochberg procedure to correct for multiple hypothesis testing [<xref ref-type="bibr" rid="CR40">40</xref>]. We identify many significantly enriched pathways (Additional file <xref ref-type="media" rid="MOESM1">1</xref>: Table S1). We now briefly discuss some of these pathways and the genes within them and how they may inform us about the genetic changes underlying the phenotypic differences between these lines.</p>
<p id="Par49">The most significantly enriched pathway is “Synapse assembly” (p-value = 0.0028), with five genes that are in putative structural variants segregating between the tame and aggressive rat lines. Some of these genes are associated with phenotypes that may be involved in the behavioral differences observed between the tame and aggressive rat lines. For example, one of the genes is the neuronal cadherin gene Cdh2. Missense mutations in this gene are associated with obsessive-compulsive behavior and Tourette disorder phenotypes in humans [<xref ref-type="bibr" rid="CR41">41</xref>] and this gene has been associated with anxiety in mice [<xref ref-type="bibr" rid="CR42">42</xref>]. Another gene encodes the ephrin receptor Ephb1. The ephrin receptor-ligand system is involved in the regulation of several developmental processes in the nervous system. Notably, mice with null mutations for this gene exhibit neuronal loss in the substantia nigra and display spontaneous locomotor hyperactivity [<xref ref-type="bibr" rid="CR43">43</xref>]. This is interesting given that the tame and aggressive rats have differences in their activity in an open-field test [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
<p id="Par50">We also observe multiple additional enriched pathways involved in neuronal development and function, e.g. “transmission of nerve impulse”, “regulation of neurological system process”, “dendrite morphogenesis”. Therefore, we suspect that many of these segregating structural variants may have been targeted by selection and are contributing the phenotypic differences between these lines. Future study of the variants identified here may lead to insights into the domestication process. A more detailed evaluation of our finding will be published elsewhere. Plots of segmentation results for the entire genome can be found in the web supplement at <ext-link ext-link-type="uri" xlink:href="https://schlieplab.org/Supplements/rats/">https://schlieplab.org/Supplements/rats/</ext-link>.</p>
</sec>
</sec>
<sec id="Sec13">
<title>Conclusion</title>
<p id="Par51">We have presented an new wavelet compression scheme for HaMMLET. The compression is optimal in that it does not introduce unnecessary block boundaries in addition to the wavelet regression discontinuities. This leads to much more stable benchmarks and reliable performance. Additional improvements, such as a memory-efficient data structure for marginal state records, allow for Bayesian inference of a hidden Markov model of genome-sized data, such as for CNV calling, on standard consumer hardware. Future applications include inference on multivariate data. By computing detail coefficients in post-order DFS across all dimensions simultaneously, and the maxlet transform has a straightforward generalization to higher dimensions with only <inline-formula id="IEq213"><alternatives><tex-math id="M441">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$O(\log T)$$\end{document}</tex-math><mml:math id="M442"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>log</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq213.gif"></inline-graphic></alternatives></inline-formula> overhead, instead of the naive <inline-formula id="IEq214"><alternatives><tex-math id="M443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Theta (T)$$\end{document}</tex-math><mml:math id="M444"><mml:mrow><mml:mi mathvariant="normal">Θ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13015_2019_154_Article_IEq214.gif"></inline-graphic></alternatives></inline-formula> incurred by aggregating maxima in a second array.</p>
</sec>
<sec id="Sec14">
<title>Availability and requirements</title>
<p id="Par52">
<def-list><def-item><term><bold>Project name:</bold></term><def><p id="Par53">HaMMLET</p></def></def-item><def-item><term><bold>Project home page:</bold></term><def><p id="Par54">
<ext-link ext-link-type="uri" xlink:href="https://schlieplab.org/Software/HaMMLET/">https://schlieplab.org/Software/HaMMLET/</ext-link>
</p></def></def-item><def-item><term><bold>Operating system:</bold></term><def><p id="Par55">Platform-independent</p></def></def-item><def-item><term><bold>Programming language:</bold></term><def><p id="Par56">C++</p></def></def-item><def-item><term><bold>Other requirements:</bold></term><def><p id="Par57">C++11-compliant compiler. For plotting: Python 2.7, Matplotlib</p></def></def-item><def-item><term><bold>License:</bold></term><def><p id="Par58">GNU GPL.</p></def></def-item></def-list>
</p>
</sec>
<sec sec-type="supplementary-material">
<title>Additional file</title>
<sec id="Sec22">
<p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="13015_2019_154_MOESM1_ESM.pdf"><caption><p><bold>Additional file 1: Table S1.</bold> Significantly enriched GO categories.</p></caption></media></supplementary-material>
</p>
</sec>
</sec>
</body>
<back>
<fn-group>
<fn>
<p>
<bold>Publisher's Note</bold>
</p>
<p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
</fn>
</fn-group>
<ack>
<title>Acknowledgements</title>
<p>JW would like to thank Janet Kelso, Svante Pääbo, and everyone at the Max Planck Institute for Evolutionary Anthropology in Leipzig for their kind hospitality and support.</p>
</ack>
<notes notes-type="author-contribution">
<title>Authors' contributions</title>
<p>JW and AS conceived the computational approach. JW designed and implemented the software. RG, RK and AC performed the experiments and analysis. JW, AC and AS wrote the manuscript. All authors read and approved the final manuscript.</p>
</notes>
<notes notes-type="funding-information">
<title>Funding</title>
<p>Funding was provided through NIH grant 1 U01 CA198952-01 and The Federal Research Center Institute of Cytology and Genetics Grant N 0324-2018-0016.</p>
</notes>
<notes notes-type="data-availability">
<title>Availability of data and materials</title>
<p><ext-link ext-link-type="uri" xlink:href="https://schlieplab.org/Supplements/rats/">https://schlieplab.org/Supplements/rats/</ext-link>.</p>
</notes>
<notes notes-type="COI-statement">
<title>Competing interests</title>
<p id="Par62">The authors declare that they have no competing interests.</p>
</notes>
<ref-list id="Bib1">
<title>References</title>
<ref id="CR1">
<label>1.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Fröhling</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Döhner</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>Chromosomal abnormalities in cancer</article-title>
<source/>N Engl J Med
          <year>2008</year>
<volume>359</volume>
<issue>7</issue>
<fpage>722</fpage>
<lpage>734</lpage>
<pub-id pub-id-type="doi">10.1056/NEJMra0803109</pub-id>
<pub-id pub-id-type="pmid">18703475</pub-id>
</element-citation>
</ref>
<ref id="CR2">
<label>2.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Garraway</surname>
<given-names>LA</given-names>
</name>
<name>
<surname>Lander</surname>
<given-names>ES</given-names>
</name>
</person-group>
<article-title>Lessons from the cancer genome</article-title>
<source/>Cell
          <year>2013</year>
<volume>153</volume>
<issue>1</issue>
<fpage>17</fpage>
<lpage>37</lpage>
<pub-id pub-id-type="doi">10.1016/j.cell.2013.03.002</pub-id>
<pub-id pub-id-type="pmid">23540688</pub-id>
</element-citation>
</ref>
<ref id="CR3">
<label>3.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Nakagawa</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Wardell</surname>
<given-names>CP</given-names>
</name>
<name>
<surname>Furuta</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Taniguchi</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Fujimoto</surname>
<given-names>A</given-names>
</name>
</person-group>
<article-title>Cancer whole-genome sequencing: present and future</article-title>
<source/>Oncogene
          <year>2015</year>
<volume>34</volume>
<issue>49</issue>
<fpage>5943</fpage>
<lpage>5950</lpage>
<pub-id pub-id-type="doi">10.1038/onc.2015.90</pub-id>
<pub-id pub-id-type="pmid">25823020</pub-id>
</element-citation>
</ref>
<ref id="CR4">
<label>4.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Malhotra</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Sebat</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Cnvs: Harbingers of a rare variant revolution in psychiatric genetics</article-title>
<source/>Cell
          <year>2012</year>
<volume>148</volume>
<issue>6</issue>
<fpage>1223</fpage>
<lpage>1241</lpage>
<pub-id pub-id-type="doi">10.1016/j.cell.2012.02.039</pub-id>
<pub-id pub-id-type="pmid">22424231</pub-id>
</element-citation>
</ref>
<ref id="CR5">
<label>5.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Chung</surname>
<given-names>BH-Y</given-names>
</name>
<name>
<surname>Tao</surname>
<given-names>VQ</given-names>
</name>
<name>
<surname>Tso</surname>
<given-names>WW-Y</given-names>
</name>
</person-group>
<article-title>Copy number variation and autism: new insights and clinical implications</article-title>
<source/>J Formos Med Assoc
          <year>2014</year>
<volume>113</volume>
<issue>7</issue>
<fpage>400</fpage>
<lpage>408</lpage>
<pub-id pub-id-type="doi">10.1016/j.jfma.2013.01.005</pub-id>
<pub-id pub-id-type="pmid">24961180</pub-id>
</element-citation>
</ref>
<ref id="CR6">
<label>6.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wiedenhoeft</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Brugel</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Schliep</surname>
<given-names>A</given-names>
</name>
</person-group>
<article-title>Fast Bayesian inference of copy number variants using hidden Markov models with wavelet compression</article-title>
<source/>PLoS Computat Biol
          <year>2016</year>
<volume>12</volume>
<issue>5</issue>
<fpage>1</fpage>
<lpage>28</lpage>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1004871</pub-id>
</element-citation>
</ref>
<ref id="CR7">
<label>7.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Mahmud</surname>
<given-names>MP</given-names>
</name>
<name>
<surname>Schliep</surname>
<given-names>A</given-names>
</name>
</person-group>
<article-title>Fast MCMC sampling for hidden Markov models to determine copy number variations</article-title>
<source/>BMC Bioinform
          <year>2011</year>
<volume>12</volume>
<fpage>428</fpage>
<pub-id pub-id-type="doi">10.1186/1471-2105-12-428</pub-id>
</element-citation>
</ref>
<ref id="CR8">
<label>8.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Shah</surname>
<given-names>SP</given-names>
</name>
<name>
<surname>Lam</surname>
<given-names>WL</given-names>
</name>
<name>
<surname>Ng</surname>
<given-names>RT</given-names>
</name>
<name>
<surname>Murphy</surname>
<given-names>KP</given-names>
</name>
</person-group>
<article-title>Modeling recurrent DNA copy number alterations in array CGH data</article-title>
<source/>Bioinformatics
          <year>2007</year>
<volume>23</volume>
<issue>13</issue>
<fpage>450</fpage>
<lpage>8</lpage>
<pub-id pub-id-type="doi">10.1093/bioinformatics/btm221</pub-id>
<pub-id pub-id-type="pmid">17150994</pub-id>
</element-citation>
</ref>
<ref id="CR9">
<label>9.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Rydén</surname>
<given-names>T</given-names>
</name>
</person-group>
<article-title>EM versus Markov Chain Monte Carlo for estimation of hidden Markov models: a computational perspective</article-title>
<source/>Bayesian Anal
          <year>2008</year>
<volume>3</volume>
<issue>4</issue>
<fpage>659</fpage>
<lpage>688</lpage>
<pub-id pub-id-type="doi">10.1214/08-BA326</pub-id>
</element-citation>
</ref>
<ref id="CR10">
<label>10.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Scott</surname>
<given-names>SL</given-names>
</name>
</person-group>
<article-title>Bayesian methods for hidden Markov models: recursive computing in the 21st century</article-title>
<source/>J Am Stat Assoc
          <year>2002</year>
<volume>97</volume>
<issue>457</issue>
<fpage>337</fpage>
<lpage>351</lpage>
<pub-id pub-id-type="doi">10.1198/016214502753479464</pub-id>
</element-citation>
</ref>
<ref id="CR11">
<label>11.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Cleveland</surname>
<given-names>WS</given-names>
</name>
<name>
<surname>Grosse</surname>
<given-names>E</given-names>
</name>
</person-group>
<article-title>Computational methods for local regression</article-title>
<source/>Stat Comput
          <year>1991</year>
<volume>1</volume>
<issue>1</issue>
<fpage>47</fpage>
<lpage>62</lpage>
<pub-id pub-id-type="doi">10.1007/BF01890836</pub-id>
</element-citation>
</ref>
<ref id="CR12">
<label>12.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Chib</surname>
<given-names>S</given-names>
</name>
</person-group>
<article-title>Calculating posterior distributions and modal estimates in markov mixture models</article-title>
<source/>J Econom
          <year>1996</year>
<volume>75</volume>
<issue>1</issue>
<fpage>79</fpage>
<lpage>97</lpage>
<pub-id pub-id-type="doi">10.1016/0304-4076(95)01770-4</pub-id>
</element-citation>
</ref>
<ref id="CR13">
<label>13.</label>
<mixed-citation publication-type="other">Sweldens W. Lifting scheme: a new philosophy in biorthogonal wavelet constructions. In: Laine AF, Unser MA, editors. Wavelet applications in signal and image processing III. Bellingham: International Society for Optics and Photonics; 1995. p. 68–79. 10.1117/12.217619. <ext-link ext-link-type="uri" xlink:href="http://proceedings.spiedigitallibrary.org/proceeding.aspx?articleid=1007578">http://proceedings.spiedigitallibrary.org/proceeding.aspx?articleid=1007578</ext-link>.</mixed-citation>
</ref>
<ref id="CR14">
<label>14.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Daines</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Wang</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Li</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Han</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Gibbs</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Chen</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>High-throughput multiplex sequencing to discover copy number variants in drosophila</article-title>
<source/>Genetics
          <year>2009</year>
<volume>182</volume>
<issue>4</issue>
<fpage>935</fpage>
<lpage>941</lpage>
<pub-id pub-id-type="doi">10.1534/genetics.109.103218</pub-id>
<pub-id pub-id-type="pmid">19528327</pub-id>
</element-citation>
</ref>
<ref id="CR15">
<label>15.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Haar</surname>
<given-names>A</given-names>
</name>
</person-group>
<article-title>Zur Theorie der orthogonalen Funktionensysteme</article-title>
<source/>Mathematische Annalen
          <year>1910</year>
<volume>69</volume>
<issue>3</issue>
<fpage>331</fpage>
<lpage>371</lpage>
<pub-id pub-id-type="doi">10.1007/BF01456326</pub-id>
</element-citation>
</ref>
<ref id="CR16">
<label>16.</label>
<mixed-citation publication-type="other">Mallat SG. A wavelet tour of signal processing: the sparse way. Burlington: Academic Press; 2009. <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id=1525499">http://dl.acm.org/citation.cfm?id=1525499</ext-link>.</mixed-citation>
</ref>
<ref id="CR17">
<label>17.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Donoho</surname>
<given-names>DL</given-names>
</name>
<name>
<surname>Johnstone</surname>
<given-names>IM</given-names>
</name>
</person-group>
<article-title>Ideal spatial adaptation by wavelet shrinkage</article-title>
<source/>Biometrika
          <year>1994</year>
<volume>81</volume>
<issue>3</issue>
<fpage>425</fpage>
<lpage>455</lpage>
<pub-id pub-id-type="doi">10.1093/biomet/81.3.425</pub-id>
</element-citation>
</ref>
<ref id="CR18">
<label>18.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Massart</surname>
<given-names>P</given-names>
</name>
</person-group>
<article-title>Concentration inequalities and model selection</article-title>
<source/>Lect Notes Math
          <year>2003</year>
<volume>1896</volume>
<fpage>1</fpage>
<lpage>324</lpage>
<pub-id pub-id-type="doi">10.1007/978-3-540-48503-2</pub-id>
</element-citation>
</ref>
<ref id="CR19">
<label>19.</label>
<mixed-citation publication-type="other">Lewis JP. Fast template matching. In: Vision interface 95. Quebec City: Canadian Image Processing and Pattern Recognition Society; 1995. p. 120–3. <ext-link ext-link-type="uri" xlink:href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.157.3888">http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.157.3888</ext-link>.</mixed-citation>
</ref>
<ref id="CR20">
<label>20.</label>
<element-citation publication-type="book">
<person-group person-group-type="author">
<name>
<surname>Lovász</surname>
<given-names>L</given-names>
</name>
</person-group>
<source/>Combinatorial problems and exercises
          <year>1993</year>
<publisher-loc>Providence</publisher-loc>
<publisher-name>American Mathematical Society</publisher-name>
<fpage>639</fpage>
</element-citation>
</ref>
<ref id="CR21">
<label>21.</label>
<element-citation publication-type="book">
<person-group person-group-type="author">
<name>
<surname>Knuth</surname>
<given-names>DE</given-names>
</name>
</person-group>
<source/>The art of computer programming
          <year>1997</year>
<publisher-loc>Upper Saddle River</publisher-loc>
<publisher-name>Addison-Wesley Professional</publisher-name>
</element-citation>
</ref>
<ref id="CR22">
<label>22.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Sweldens</surname>
<given-names>W</given-names>
</name>
</person-group>
<article-title>The lifting scheme: a construction of second generation wavelets</article-title>
<source/>SIAM J Math Anal
          <year>1998</year>
<volume>29</volume>
<issue>2</issue>
<fpage>511</fpage>
<lpage>546</lpage>
<pub-id pub-id-type="doi">10.1137/S0036141095289051</pub-id>
</element-citation>
</ref>
<ref id="CR23">
<label>23.</label>
<element-citation publication-type="book">
<person-group person-group-type="author">
<name>
<surname>Diamond</surname>
<given-names>JM</given-names>
</name>
</person-group>
<source/>Guns, germs and steel: a short history of everybody for the last 13,000 years
          <year>1998</year>
<publisher-loc>New York</publisher-loc>
<publisher-name>Random House</publisher-name>
</element-citation>
</ref>
<ref id="CR24">
<label>24.</label>
<element-citation publication-type="book">
<person-group person-group-type="author">
<name>
<surname>Darwin</surname>
<given-names>C</given-names>
</name>
</person-group>
<source/>The variation in animals and plants under domestication
          <year>1868</year>
<publisher-loc>London</publisher-loc>
<publisher-name>John Murray</publisher-name>
</element-citation>
</ref>
<ref id="CR25">
<label>25.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wilkins</surname>
<given-names>AS</given-names>
</name>
<name>
<surname>Wrangham</surname>
<given-names>RW</given-names>
</name>
<name>
<surname>Fitch</surname>
<given-names>WT</given-names>
</name>
</person-group>
<article-title>The “domestication syndrome” in mammals: a unified explanation based on neural crest cell behavior and genetics</article-title>
<source/>Genetics
          <year>2014</year>
<volume>197</volume>
<issue>3</issue>
<fpage>795</fpage>
<lpage>808</lpage>
<pub-id pub-id-type="doi">10.1534/genetics.114.165423</pub-id>
<pub-id pub-id-type="pmid">25024034</pub-id>
</element-citation>
</ref>
<ref id="CR26">
<label>26.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Sánchez-Villagra</surname>
<given-names>MR</given-names>
</name>
<name>
<surname>Geiger</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Schneider</surname>
<given-names>RA</given-names>
</name>
</person-group>
<article-title>The taming of the neural crest: a developmental perspective on the origins of morphological covariation in domesticated mammals</article-title>
<source/>R S Open Sci
          <year>2016</year>
<volume>3</volume>
<issue>6</issue>
<fpage>160107</fpage>
<pub-id pub-id-type="doi">10.1098/rsos.160107</pub-id>
</element-citation>
</ref>
<ref id="CR27">
<label>27.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Belyaev</surname>
<given-names>DK</given-names>
</name>
</person-group>
<article-title>Domestication of animals</article-title>
<source/>Sci J
          <year>1969</year>
<volume>5</volume>
<issue>1</issue>
<fpage>47</fpage>
<lpage>52</lpage>
</element-citation>
</ref>
<ref id="CR28">
<label>28.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Trut</surname>
<given-names>LN</given-names>
</name>
<name>
<surname>Plyusnina</surname>
<given-names>IZ</given-names>
</name>
<name>
<surname>Oskina</surname>
<given-names>IN</given-names>
</name>
</person-group>
<article-title>An experiment on fox domestication and debatable issues of evolution of the dog</article-title>
<source/>Russ J Genet
          <year>2004</year>
<volume>40</volume>
<issue>6</issue>
<fpage>644</fpage>
<lpage>655</lpage>
<pub-id pub-id-type="doi">10.1023/B:RUGE.0000033312.92773.c1</pub-id>
</element-citation>
</ref>
<ref id="CR29">
<label>29.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Trut</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Oskina</surname>
<given-names>I</given-names>
</name>
<name>
<surname>Kharlamova</surname>
<given-names>A</given-names>
</name>
</person-group>
<article-title>Animal evolution during domestication: the domesticated fox as a model</article-title>
<source/>BioEssays
          <year>2009</year>
<volume>31</volume>
<issue>3</issue>
<fpage>349</fpage>
<lpage>60</lpage>
<pub-id pub-id-type="doi">10.1002/bies.200800070</pub-id>
<pub-id pub-id-type="pmid">19260016</pub-id>
</element-citation>
</ref>
<ref id="CR30">
<label>30.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Albert</surname>
<given-names>FW</given-names>
</name>
<name>
<surname>Shchepina</surname>
<given-names>O</given-names>
</name>
<name>
<surname>Winter</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Römpler</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Teupser</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Palme</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Ceglarek</surname>
<given-names>U</given-names>
</name>
<name>
<surname>Kratzsch</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Sohr</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Trut</surname>
<given-names>LN</given-names>
</name>
<name>
<surname>Thiery</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Morgenstern</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Plyusnina</surname>
<given-names>IZ</given-names>
</name>
<name>
<surname>Schöneberg</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Pääbo</surname>
<given-names>S</given-names>
</name>
</person-group>
<article-title>Phenotypic differences in behavior, physiology and neurochemistry between rats selected for tameness and for defensive aggression towards humans</article-title>
<source/>Horm Behav
          <year>2008</year>
<volume>53</volume>
<issue>3</issue>
<fpage>413</fpage>
<lpage>421</lpage>
<pub-id pub-id-type="doi">10.1016/j.yhbeh.2007.11.010</pub-id>
<pub-id pub-id-type="pmid">18177873</pub-id>
</element-citation>
</ref>
<ref id="CR31">
<label>31.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Axelsson</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Ratnakumar</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Arendt</surname>
<given-names>M-L</given-names>
</name>
<name>
<surname>Maqbool</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Webster</surname>
<given-names>MT</given-names>
</name>
<name>
<surname>Perloski</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Liberg</surname>
<given-names>O</given-names>
</name>
<name>
<surname>Arnemo</surname>
<given-names>JM</given-names>
</name>
<name>
<surname>Hedhammar</surname>
<given-names>Å</given-names>
</name>
<name>
<surname>Lindblad-Toh</surname>
<given-names>K</given-names>
</name>
</person-group>
<article-title>The genomic signature of dog domestication reveals adaptation to a starch-rich diet</article-title>
<source/>Nature
          <year>2013</year>
<volume>495</volume>
<issue>7441</issue>
<fpage>360</fpage>
<lpage>364</lpage>
<pub-id pub-id-type="doi">10.1038/nature11837</pub-id>
<pub-id pub-id-type="pmid">23354050</pub-id>
</element-citation>
</ref>
<ref id="CR32">
<label>32.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Renaud</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Kircher</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Stenzel</surname>
<given-names>U</given-names>
</name>
<name>
<surname>Kelso</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>freeibis: an efficient basecaller with calibrated quality scores for illumina sequencers</article-title>
<source/>Bioinformatics
          <year>2013</year>
<volume>29</volume>
<issue>9</issue>
<fpage>1208</fpage>
<lpage>1209</lpage>
<pub-id pub-id-type="doi">10.1093/bioinformatics/btt117</pub-id>
<pub-id pub-id-type="pmid">23471300</pub-id>
</element-citation>
</ref>
<ref id="CR33">
<label>33.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Renaud</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Stenzel</surname>
<given-names>U</given-names>
</name>
<name>
<surname>Kelso</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>leeHom: adaptor trimming and merging for illumina sequencing reads</article-title>
<source/>Nucleic Acids Res
          <year>2014</year>
<volume>42</volume>
<issue>18</issue>
<fpage>141</fpage>
<pub-id pub-id-type="doi">10.1093/nar/gku699</pub-id>
</element-citation>
</ref>
<ref id="CR34">
<label>34.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Renaud</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Stenzel</surname>
<given-names>U</given-names>
</name>
<name>
<surname>Maricic</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Wiebe</surname>
<given-names>V</given-names>
</name>
<name>
<surname>Kelso</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>deML: robust demultiplexing of illumina sequences using a likelihood-based approach</article-title>
<source/>Bioinformatics
          <year>2015</year>
<volume>31</volume>
<issue>5</issue>
<fpage>770</fpage>
<lpage>772</lpage>
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu719</pub-id>
<pub-id pub-id-type="pmid">25359895</pub-id>
</element-citation>
</ref>
<ref id="CR35">
<label>35.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Li</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Durbin</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>Fast and accurate short read alignment with burrows-wheeler transform</article-title>
<source/>Bioinformatics
          <year>2009</year>
<volume>25</volume>
<issue>14</issue>
<fpage>1754</fpage>
<lpage>1760</lpage>
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
<pub-id pub-id-type="pmid">19451168</pub-id>
</element-citation>
</ref>
<ref id="CR36">
<label>36.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>McKenna</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Hanna</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Banks</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Sivachenko</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Cibulskis</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Kernytsky</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Garimella</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Altshuler</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Gabriel</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Daly</surname>
<given-names>M</given-names>
</name>
<name>
<surname>DePristo</surname>
<given-names>MA</given-names>
</name>
</person-group>
<article-title>The genome analysis toolkit: a mapreduce framework for analyzing next-generation DNA sequencing data</article-title>
<source/>Genome Res
          <year>2010</year>
<volume>20</volume>
<issue>9</issue>
<fpage>1297</fpage>
<lpage>303</lpage>
<pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
<pub-id pub-id-type="pmid">20644199</pub-id>
</element-citation>
</ref>
<ref id="CR37">
<label>37.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>McLare</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Gil</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Hunt</surname>
<given-names>SE</given-names>
</name>
<name>
<surname>Riat</surname>
<given-names>HS</given-names>
</name>
<name>
<surname>Ritchie</surname>
<given-names>GRS</given-names>
</name>
<name>
<surname>Thormann</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Flicek</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Cunningham</surname>
<given-names>F</given-names>
</name>
</person-group>
<article-title>The ensembl variant effect predictor</article-title>
<source/>Genome Biol
          <year>2016</year>
<volume>17</volume>
<issue>1</issue>
<fpage>122</fpage>
<pub-id pub-id-type="doi">10.1038/513S8a</pub-id>
<pub-id pub-id-type="pmid">27268795</pub-id>
</element-citation>
</ref>
<ref id="CR38">
<label>38.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Zhang</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Kirov</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Snoddy</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>WebGestalt: an integrated system for exploring gene sets in various biological contexts</article-title>
<source/>Nucleic Acids Res
          <year>2005</year>
<volume>33</volume>
<issue>Web Server</issue>
<fpage>741</fpage>
<lpage>748</lpage>
<pub-id pub-id-type="doi">10.1093/nar/gki475</pub-id>
</element-citation>
</ref>
<ref id="CR39">
<label>39.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wang</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Duncan</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Shi</surname>
<given-names>Z</given-names>
</name>
<name>
<surname>Zhang</surname>
<given-names>B</given-names>
</name>
</person-group>
<article-title>WEB-based gene set analysis toolkit (WebGestalt): update 2013</article-title>
<source/>Nucleic Acids Res
          <year>2013</year>
<volume>41</volume>
<issue>W1</issue>
<fpage>77</fpage>
<lpage>83</lpage>
<pub-id pub-id-type="doi">10.1093/nar/gkt439</pub-id>
</element-citation>
</ref>
<ref id="CR40">
<label>40.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Benjamini</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Hochberg</surname>
<given-names>Y</given-names>
</name>
</person-group>
<article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
<source/>J R Stat Soc Ser B
          <year>1995</year>
<volume>57</volume>
<issue>1</issue>
<fpage>289</fpage>
<lpage>300</lpage>
</element-citation>
</ref>
<ref id="CR41">
<label>41.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Moya</surname>
<given-names>PR</given-names>
</name>
<name>
<surname>Dodman</surname>
<given-names>NH</given-names>
</name>
<name>
<surname>Timpano</surname>
<given-names>KR</given-names>
</name>
<name>
<surname>Rubenstein</surname>
<given-names>LM</given-names>
</name>
<name>
<surname>Rana</surname>
<given-names>Z</given-names>
</name>
<name>
<surname>Fried</surname>
<given-names>RL</given-names>
</name>
<name>
<surname>Reichardt</surname>
<given-names>LF</given-names>
</name>
<name>
<surname>Heiman</surname>
<given-names>GA</given-names>
</name>
<name>
<surname>Tischfield</surname>
<given-names>JA</given-names>
</name>
<name>
<surname>King</surname>
<given-names>RA</given-names>
</name>
<name>
<surname>Galdzicka</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Ginns</surname>
<given-names>EI</given-names>
</name>
<name>
<surname>Wendland</surname>
<given-names>JR</given-names>
</name>
</person-group>
<article-title>Rare missense neuronal cadherin gene (CDH2) variants in specific obsessive-compulsive disorder and tourette disorder phenotypes</article-title>
<source/>Eur J Hum Genet
          <year>2013</year>
<volume>21</volume>
<issue>8</issue>
<fpage>850</fpage>
<lpage>854</lpage>
<pub-id pub-id-type="doi">10.1038/ejhg.2012.245</pub-id>
<pub-id pub-id-type="pmid">23321619</pub-id>
</element-citation>
</ref>
<ref id="CR42">
<label>42.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Donner</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Pirkola</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Silander</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Kananen</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Terwilliger</surname>
<given-names>JD</given-names>
</name>
<name>
<surname>Lönnqvist</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Peltonen</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Hovatta</surname>
<given-names>I</given-names>
</name>
</person-group>
<article-title>An association analysis of murine anxiety genes in humans implicates novel candidate genes for anxiety disorders</article-title>
<source/>Biol Psychiatry
          <year>2008</year>
<volume>64</volume>
<issue>8</issue>
<fpage>672</fpage>
<lpage>80</lpage>
<pub-id pub-id-type="doi">10.1016/j.biopsych.2008.06.002</pub-id>
<pub-id pub-id-type="pmid">18639233</pub-id>
</element-citation>
</ref>
<ref id="CR43">
<label>43.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Richards</surname>
<given-names>AB</given-names>
</name>
<name>
<surname>Scheel</surname>
<given-names>TA</given-names>
</name>
<name>
<surname>Wang</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Henkemeyer</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Kromer</surname>
<given-names>LF</given-names>
</name>
</person-group>
<article-title>EphB1 null mice exhibit neuronal loss in substantia nigra pars reticulata and spontaneous locomotor hyperactivity</article-title>
<source/>Eur J Neurosci
          <year>2007</year>
<volume>25</volume>
<issue>9</issue>
<fpage>2619</fpage>
<lpage>2628</lpage>
<pub-id pub-id-type="doi">10.1111/j.1460-9568.2007.05523.x</pub-id>
<pub-id pub-id-type="pmid">17561836</pub-id>
</element-citation>
</ref>
</ref-list>
</back>
</article>
</pmc-articleset>