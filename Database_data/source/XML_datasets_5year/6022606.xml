<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">

<pmc-articleset><article article-type="research-article" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<?properties open_access?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
<journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
<journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
<journal-title-group>
<journal-title>Bioinformatics</journal-title>
</journal-title-group>
<issn pub-type="ppub">1367-4803</issn>
<issn pub-type="epub">1367-4811</issn>
<publisher>
<publisher-name>Oxford University Press</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="pmid">29949981</article-id>
<article-id pub-id-type="pmc">6022606</article-id>
<article-id pub-id-type="doi">10.1093/bioinformatics/bty237</article-id>
<article-id pub-id-type="publisher-id">bty237</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Ismb 2018–Intelligent Systems for Molecular Biology Proceedings</subject>
<subj-group subj-group-type="category-toc-heading">
<subject>Comparative and Functional Genomics</subject>
</subj-group>
</subj-group>
</article-categories>
<title-group>
<article-title>Covariate-dependent negative binomial factor analysis of RNA sequencing data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Zamani Dadaneh</surname>
<given-names>Siamak</given-names>
</name>
<xref ref-type="aff" rid="bty237-aff1">1</xref>
<xref ref-type="corresp" rid="bty237-cor1"></xref>
<!--<email>siamak@tamu.edu</email>-->
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhou</surname>
<given-names>Mingyuan</given-names>
</name>
<xref ref-type="aff" rid="bty237-aff2">2</xref>
<xref ref-type="corresp" rid="bty237-cor1"></xref>
<!--<email>mingyuan.zhou@mccombs.utexas.edu</email>-->
</contrib>
<contrib contrib-type="author">
<name>
<surname>Qian</surname>
<given-names>Xiaoning</given-names>
</name>
<xref ref-type="aff" rid="bty237-aff1">1</xref>
<xref ref-type="corresp" rid="bty237-cor1"></xref>
<!--<email>xqian@ece.tamu.edu</email>-->
</contrib>
</contrib-group>
<aff id="bty237-aff1"><label>1</label>Department of Electrical and Computer Engineering, TEES-AgriLife Center for Bioinformatics and Genomic Systems Engineering, Texas A&amp;M University, College Station, TX, USA</aff>
<aff id="bty237-aff2"><label>2</label>Department of Information, Risk, and Operations Management, The University of Texas at Austin, Austin, TX, USA</aff>
<author-notes>
<corresp id="bty237-cor1">To whom correspondence should be addressed. <email>siamak@tamu.edu</email> or <email>mingyuan.zhou@mccombs.utexas.edu</email> or <email>xqian@ece.tamu.edu</email></corresp>
</author-notes>
<pub-date pub-type="ppub">
<day>01</day>
<month>7</month>
<year>2018</year>
</pub-date>
<pub-date iso-8601-date="2018-06-27" pub-type="epub">
<day>27</day>
<month>6</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="pmc-release">
<day>27</day>
<month>6</month>
<year>2018</year>
</pub-date>
<!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
<volume>34</volume>
<issue>13</issue>
<issue-title>ISMB 2018 Proceedings July 6 to July 10, 2018, Chicago, IL, United States</issue-title>
<fpage>i61</fpage>
<lpage>i69</lpage>
<permissions>
<copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
<copyright-year>2018</copyright-year>
<license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
<license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
</license>
</permissions>
<self-uri xlink:href="bty237.pdf"></self-uri>
<abstract>
<title>Abstract</title>
<sec id="s1">
<title>Motivation</title>
<p>High-throughput sequencing technologies, in particular RNA sequencing (RNA-seq), have become the basic practice for genomic studies in biomedical research. In addition to studying genes individually, for example, through differential expression analysis, investigating co-ordinated expression variations of genes may help reveal the underlying cellular mechanisms to derive better understanding and more effective prognosis and intervention strategies. Although there exists a variety of co-expression network based methods to analyze microarray data for this purpose, instead of blindly extending these methods for microarray data that may introduce unnecessary bias, it is crucial to develop methods well adapted to RNA-seq data to identify the functional modules of genes with similar expression patterns.</p>
</sec>
<sec id="s2">
<title>Results</title>
<p>We have developed a fully Bayesian covariate-dependent negative binomial factor analysis (dNBFA) method—dNBFA—for RNA-seq count data, to capture coordinated gene expression changes, while considering effects from covariates reflecting different influencing factors. Unlike existing co-expression network based methods, our proposed model does not require multiple <italic>ad-hoc</italic> choices on data processing, transformation, as well as co-expression measures and can be directly applied to RNA-seq data. Furthermore, being capable of incorporating covariate information, the proposed method can tackle setups with complex confounding factors in different experiment designs. Finally, the natural model parameterization removes the need for a normalization preprocessing step, as commonly adopted to compensate for the effect of sequencing-depth variations. Efficient Bayesian inference of model parameters is derived by exploiting conditional conjugacy via novel data augmentation techniques. Experimental results on several real-world RNA-seq datasets on complex diseases suggest dNBFA as a powerful tool for discovering the gene modules with significant differential expression and meaningful biological insight.</p>
</sec>
<sec id="s3">
<title>Availability and implementation</title>
<p>dNBFA is implemented in R language and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/siamakz/dNBFA">https://github.com/siamakz/dNBFA</ext-link>.</p>
</sec>
</abstract>
<funding-group>
<award-group award-type="grant">
<funding-source>
<named-content content-type="funder-name">NSF</named-content>
<named-content content-type="funder-identifier">10.13039/100000001</named-content>
</funding-source>
<award-id>CCF-1553281</award-id>
</award-group>
<award-group award-type="grant">
<funding-source>
<named-content content-type="funder-name">USDA</named-content>
<named-content content-type="funder-identifier">10.13039/100000199</named-content>
</funding-source>
</award-group>
<award-group award-type="grant">
<funding-source>
<named-content content-type="funder-name">NIFA</named-content>
<named-content content-type="funder-identifier">10.13039/100005825</named-content>
</funding-source>
<award-id>06-505570-01006</award-id>
</award-group>
<award-group award-type="grant">
<funding-source>
<named-content content-type="funder-name">TEES-AgriLife Center for Bioinformatics and Genomic Systems Engineering</named-content>
</funding-source>
</award-group>
<award-group award-type="grant">
<funding-source>
<named-content content-type="funder-name">CBGSE</named-content>
</funding-source>
</award-group>
</funding-group>
<counts>
<page-count count="9"></page-count>
</counts>
</article-meta>
</front>
<body>
<sec>
<title>1 Introduction</title>
<p>High-throughput sequencing technology has emerged as a powerful tool for life science research (<xref ref-type="bibr" rid="bty237-B32">Wang <italic>et al.</italic>, 2009</xref>). In particular, RNA sequencing (RNA-seq), which measures the expression of each gene (transcript) or genomic feature of interest by counting the number of sequence reads mapped to them, has been widely adopted for genotype-phenotype association studies. A large body of statistical tools and frameworks have been developed for identifying the genes that are differentially expressed between different groups of samples, either based on their genotypes, phenotypic traits, or treatment conditions (<xref ref-type="bibr" rid="bty237-B10">Dadaneh <italic>et al.</italic>, 2017</xref>; <xref ref-type="bibr" rid="bty237-B19">Law <italic>et al.</italic>, 2014</xref>; <xref ref-type="bibr" rid="bty237-B21">Love <italic>et al.</italic>, 2014</xref>; <xref ref-type="bibr" rid="bty237-B26">Robinson <italic>et al.</italic>, 2010</xref>).</p>
<p>Living systems are complex and their behavior is coordinated by multiple components. Especially, when studying complex disease, phenotypic changes have been shown to be associated with co-ordinated regulation in functional modules of interacting genes (pathways or sub-networks) rather than statistically significant changes in individual genes (<xref ref-type="bibr" rid="bty237-B22">Nam and Kim, 2008</xref>). Therefore, a class of approaches has been developed to detect genes with similar expression patterns as potential functional modules. Weighted Gene Co-Expression Network Analysis (WGCNA; <xref ref-type="bibr" rid="bty237-B18">Langfelder and Horvath, 2008</xref>), a popular tool for gene co-expression network analysis, first constructs an adjacency matrix based on the pairwise co-expression measures, for example, based on the correlation between gene expressions across samples; then it assigns genes to different modules using the hierarchical clustering algorithm. DiffCoEx (<xref ref-type="bibr" rid="bty237-B27">Tesson <italic>et al.</italic>, 2010</xref>) builds on WGCNA, and by computing the matrix of adjacency differences between different experiment conditions, aims at identifying differentially co-expressed genes. Several <italic>targeted</italic> methods also have been proposed for studying co-expression changes across conditions, relying on pre-defined gene modules (<xref ref-type="bibr" rid="bty237-B7">Cho <italic>et al.</italic>, 2009</xref>; <xref ref-type="bibr" rid="bty237-B8">Choi <italic>et al.</italic>, 2005</xref>; <xref ref-type="bibr" rid="bty237-B9">Choi and Kendziorski, 2009</xref>). For instance, <xref ref-type="bibr" rid="bty237-B9">Choi and Kendziorski (2009)</xref> focuses on the analysis of modules based on known gene annotations, such as gene ontology categories.</p>
<p>All of the aforementioned methods were proposed for data generated from microarray based experiments; and thus there remains a lack of tools for gene module detection specifically designed for RNA-seq count data. Furthermore, the existing methods often require prior knowledge from either manual annotations or other module identification methods. They need to be supplied with prepared lists of genes as candidate functional modules. For example, <xref ref-type="bibr" rid="bty237-B20">Lei <italic>et al.</italic> (2017)</xref> have proposed a network module-based generalized linear model for identifying differentially expressed pre-defined gene sets.</p>
<p>A suitable method for gene module identification based on RNA-seq data should explicitly model highly over-dispersed count data that are often skewed (<xref ref-type="bibr" rid="bty237-B11">Datta and Nettleton, 2014</xref>) to avoid potential bias introduced by inappropriate modeling. One of the most popular solutions to account for over-dispersion due to biological variability is using the negative binomial (NB) distribution, which possesses a quadratic variance-mean relationship. More importantly, the number of <italic>ad-hoc</italic> choices in modeling and data analytics should be minimized. Many existing methods, which often take two stages to first construct co-expression networks based on expression profile data and then identify co-expressed modules based on different clustering methods, may lead to uncertain results sensitive to different choices. Last but not least, when dealing with RNA-seq data, the variability of the sequencing depths across samples needs to be taken into account.</p>
<p>In this paper, we propose a novel covariate-dependent NB factorization model for identifying gene modules in RNA-seq experiments. The proposed method, directly applied to gene counts from RNA-seq, obviates the need for multiple <italic>ad-hoc</italic> steps as required in co-expression network analyses of WGCNA (<xref ref-type="bibr" rid="bty237-B18">Langfelder and Horvath, 2008</xref>) and DiffCoEx (<xref ref-type="bibr" rid="bty237-B27">Tesson <italic>et al.</italic>, 2010</xref>). In addition, by employing a flexible regression model for the scale parameter of the gamma distribution in our fully Bayesian NB factor analysis model, dNBFA is capable of tackling RNA-seq experiments with complex confounding factors and quantifies the impact of these factors on the identified modules. Finally, similar to the mechanisms employed in <xref ref-type="bibr" rid="bty237-B10">Dadaneh <italic>et al.</italic> (2017)</xref>, this new approach does not require an <italic>ad-hoc</italic> normalization step, as the model accounts for the sequencing-depth heterogeneity of different samples automatically.</p>
<p>For posterior inference of the model parameters of dNBFA, closed-form Gibbs sampling update equations are derived by exploiting novel data augmentation techniques. More specifically, we apply the augmentation technique of <xref ref-type="bibr" rid="bty237-B35">Zhou and Carin (2015)</xref> for the NB distribution, and the Polya-Gamma (PG) distributed auxiliary variable technique of <xref ref-type="bibr" rid="bty237-B24">Polson <italic>et al.</italic> (2013)</xref> for the closed-form inference of regression coefficients, removing the need for non-trivial Metropolis-Hastings correction steps (<xref ref-type="bibr" rid="bty237-B6">Chib and Greenberg, 1995</xref>). Experimental results on various RNA-seq datasets demonstrate the superior performance of dNBFA in finding more biologically significant modules, in comparison to the <italic>two-stage</italic> methods, such as WGCNA and DiffCoEx.</p>
<p>The remainder of this paper is organized as follows. In Section 2, we introduce the model and its Gibbs sampling inference for covariate-dependent NB factor analysis of RNA-seq data. In Section 3, we present our experimental results on multiple The Cancer Genome Atlas (TCGA) cancer datasets as well as a Autism study dataset, which demonstrate that not only the modules identified by dNBFA are more differentially expressed, but also the incorporation of confounding factors in dNBFA may increase the chance for relevant biological discoveries tailored to the designed experiments. We conclude the paper in Section 4.</p>
</sec>
<sec>
<title>2 Materials and methods</title>
<sec>
<title>2.1 NB factor analysis</title>
<p>In this section, we first present the Negative Binomial Factor Analysis (NBFA) method for count data (<xref ref-type="bibr" rid="bty237-B34">Zhou, 2017</xref>), and demonstrate how it can be applied in the context of RNA-seq data analysis for the identification of gene modules. Let <italic>n<sub>vj</sub></italic> denote the number of sequencing reads mapped to gene <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> in sequencing sample <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, and let the <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mi>V</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> vector <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> contain all the gene counts for sample <italic>j</italic>. The NB distribution is a popular choice to model RNA-seq count data, allowing one to account for over-dispersion due to technical and biological variations (<xref ref-type="bibr" rid="bty237-B2">Anders and Huber, 2010</xref>; <xref ref-type="bibr" rid="bty237-B10">Dadaneh <italic>et al.</italic>, 2017</xref>; <xref ref-type="bibr" rid="bty237-B26">Robinson <italic>et al.</italic>, 2010</xref>). Under the NBFA model (<xref ref-type="bibr" rid="bty237-B34">Zhou, 2017</xref>), the sample counts are factorized as
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mi mathvariant="bold">n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">Φ</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="italic">p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the NB distribution with the probability mass function (PMF) <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>!</mml:mo><mml:mo>Γ</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac><mml:msup><mml:mi>p</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>r</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mo>Γ</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> is the gamma function and <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:mi mathvariant="bold">Φ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>K</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>∈</mml:mo><mml:msubsup><mml:mo>ℝ</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>×</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the factor loading matrix, <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mi mathvariant="bold">Θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mi>J</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>∈</mml:mo><mml:msubsup><mml:mo>ℝ</mml:mo><mml:mo>+</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the factor score matrix and <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:msub><mml:mo>ℝ</mml:mo><mml:mo>+</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>x</mml:mi><mml:mo>:</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. For each latent factor, <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> encodes the weights of the <italic>V</italic> genes associated with factor <italic>k</italic> and <inline-formula id="IE13"><mml:math id="IM13"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> encodes the popularity of <italic>K</italic> factors in sample <italic>j</italic>. The NBFA can be augmented as
<disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
<p>From biological perspectives, <italic>K</italic> factors can correspond to the underlying biological processes (BPs) or functional modules related to genotypic, phenotypic, or treatment condition changes. The corresponding sub-counts <italic>n<sub>vjk</sub></italic> can be viewed as the result of the contribution of underlying BP <italic>k</italic> to the expression of gene <italic>v</italic> in sample <italic>j</italic>. The probability parameter <italic>p<sub>j</sub></italic>, which only depends on the sample index, can be considered as a parameter reflecting the potential heterogeneity of counts, due to the variation of the sequencing depths across different samples.</p>
<p>More precisely, using <xref ref-type="disp-formula" rid="E2">Equation (2)</xref> and the formula for the mean of the NB distribution, the expected expression of gene <italic>v</italic> in sample <italic>j</italic> can be expressed as <inline-formula id="IE14"><mml:math id="IM14"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="true">[</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">]</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. The term <inline-formula id="IE15"><mml:math id="IM15"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> can be interpreted as the effect of the sequencing-depth heterogeneity of sample <italic>j</italic> on the corresponding gene expression in this sample. This approach removes the need for an <italic>ad-hoc</italic> normalization step, as the model accounts for the sequencing-depth heterogeneity of different samples automatically, similar to the mechanisms employed in <xref ref-type="bibr" rid="bty237-B10">Dadaneh <italic>et al.</italic> (2017)</xref>. The remaining term in this expectation, <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, can represent the true abundance of gene <italic>v</italic> in sample <italic>j</italic>. Specifically, it comprises of contributions from all latent factors, where each contribution is encoded as the product of the gene association with latent factors as modules and the contribution of those modules to sample <italic>j</italic>.</p>
<p>NBFA proceeds by placing the Dirichlet and gamma prior distributions on <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>θ<sub>kj</sub></italic>, respectively, and appropriate prior distributions on the other model parameters. A Gibbs sampling algorithm that exploits novel data augmentation techniques has been derived for inferring the model parameters (<xref ref-type="bibr" rid="bty237-B34">Zhou, 2017</xref>).</p>
</sec>
<sec>
<title>2.2 Covariate-dependent NBFA</title>
<p>In real-world RNA-seq experiments, it is often desirable to identify the functional modules corresponding to critical BPs specific to the behavior of interest by the design of experiments. Often, the presence of potential confounding factors also requires that the developed factor analysis method based on RNA-seq data can take them into account (when the corresponding conditions are given) to derive correct functional module results. The aforementioned NBFA model neglects such information about sequencing samples from designed experiments. In order to empower the NBFA model in tackling the setups with complex experiment design, we extend its framework to make it capable of incorporating the external covariate information (e.g. phenotypes, treatments and other confounding factors) into the factor analysis model to derive the new covariate-dependent NBFA (dNBFA) model.</p>
<p>The graphical representation of dNBFA is illustrated as a hierarchical model in <xref ref-type="fig" rid="bty237-F1">Figure 1</xref>. In the first layer of dNBFA, similar to NBFA, the gene counts are modeled using the same NB distribution as in <xref ref-type="disp-formula" rid="E2">Equation (2)</xref>. Then, in the next layer we place a gamma prior distribution on <italic>θ<sub>kj</sub></italic> as
<disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mi>P</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> vector of covariates for sample <italic>j</italic>, reflecting the corresponding experiment design. In this model, both numerical and categorical covariates can be used.
</p>
<fig id="bty237-F1" orientation="portrait" position="float">
<label>Fig. 1.</label>
<caption>
<p>Graphical representation of the dNBFA model</p>
</caption>
<graphic xlink:href="bty237f1"></graphic>
</fig>
<p>Employing the law of total expectation, and removing the sequencing depth effect by the related terms containing <italic>p<sub>j</sub></italic>, we have <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="true">[</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">]</mml:mo><mml:mo>∝</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. This new layer of model, splits the effect of the latent factor <italic>k</italic> on sample <italic>j</italic> into two parts; <italic>r<sub>k</sub></italic>, which can be considered as representing the baseline expression of the factor <italic>k</italic> across all samples, and the exponential term <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, which adjusts the effect of the latent factor on the sample according to its traits. We note that including an intercept in <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> may weaken the identifiably of <italic>r<sub>k</sub></italic>, as in the expectation of the count <italic>n<sub>vjk</sub></italic> a product term <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mo>β</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> depending only on latent factor <italic>k</italic> appears. Thus in all subsequent experiments a separate intercept term is not used when considering covariate effects. The parameters of the dNBFA model with their interpretations in the context of RNA-seq experiments are presented in <xref ref-type="table" rid="bty237-T1">Table 1</xref>.
<table-wrap id="bty237-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Parameters of covariate-dNBFA and their interpretations in the context of RNA-seq data</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1" valign="top"/><col align="left" span="1" valign="top"/><col align="left" span="1" valign="top"/></colgroup><thead><tr><th align="left" colspan="1" rowspan="1">Parameter</th><th align="left" colspan="1" rowspan="1">Constraint</th><th align="left" colspan="1" rowspan="1">Interpretation</th></tr></thead><tbody><tr><td colspan="1" rowspan="1"><italic>r<sub>k</sub></italic></td><td colspan="1" rowspan="1"><inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td colspan="1" rowspan="1">Module baseline expression</td></tr><tr><td colspan="1" rowspan="1"><italic>p<sub>j</sub></italic></td><td colspan="1" rowspan="1"><inline-formula id="IE25"><mml:math id="IM25"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula></td><td colspan="1" rowspan="1">Sequencing depth</td></tr><tr><td colspan="1" rowspan="1"><inline-formula id="IE26"><mml:math id="IM26"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td colspan="1" rowspan="1"><inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>V</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td colspan="1" rowspan="1">Gene-module association</td></tr><tr><td colspan="1" rowspan="1"><italic>θ<sub>kj</sub></italic></td><td colspan="1" rowspan="1"><inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula></td><td colspan="1" rowspan="1">Popularity of factor <italic>k</italic> in sample <italic>j</italic></td></tr><tr><td colspan="1" rowspan="1"><italic>β<sub>kp</sub></italic></td><td colspan="1" rowspan="1"><inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:msub><mml:mo>β</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mo>ℝ</mml:mo></mml:mrow></mml:math></inline-formula></td><td colspan="1" rowspan="1">Impact of covariate <italic>p</italic> on expression of factor <italic>k</italic></td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p><italic>Note</italic>: The inputs of dNBFA are gene counts <italic>n<sub>vj</sub></italic> and vector of covariates <inline-formula id="IE30"><mml:math id="IM30"><mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p></fn></table-wrap-foot></table-wrap></p>
<p>We place independent zero-mean normal distributions on the components of the regression coefficient parameters as
<disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:munderover><mml:mi mathvariant="normal">N</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mo>α</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <italic>α<sub>p</sub></italic> is the precision parameter of the normal distribution. By assuming identical precisions for components of the regression coefficients across all latent factors, dNBFA burrows statistical strengths to infer these precision parameters.</p>
<p>Similar to NBFA, a Dirichlet prior distribution with the smoothing parameter <italic>η</italic> is imposed on the gene-module association parameters <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Dir</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mo>η</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
The Dirichlet smoothing parameter <italic>η</italic> controls the sparsity of the inferred latent factors. Generally speaking, the smaller <italic>η</italic> is, the more sparse and specific the inferred factors are encouraged to be.</p>
<p>A challenge in NB factorization is how to determine the number of latent factors <italic>K</italic>. To address this issue, one can employ a reasonably large <italic>K</italic> and then according to the inference step for <italic>r<sub>k</sub></italic> [refer to <xref ref-type="disp-formula" rid="E13">Equation (12)</xref> below], the baseline expression inferred for non-important latent factors vanishes as the number of assigned gene sub-counts to it decreases.</p>
<p>We complete the model by placing conjugate priors on hyperparameters. Specifically, we exploit the gamma-Poisson conjugacy, beta-NB conjugacy with respect to the probability parameter and gamma–gamma conjugacy with respect to the scale parameter of the gamma distribution. The complete dNBFA model is presented below:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>γ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Dir</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mo>η</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>P</mml:mi></mml:munderover><mml:mi mathvariant="normal">N</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mo>α</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mo>γ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
<p>Throughout the experiments in this paper, we set the hyperparameters as <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. In the following section, we provide an efficient inference algorithm that adopts novel data augmentation techniques tailored to our dNBFA model.</p>
</sec>
<sec>
<title>2.3 Inference via Gibbs sampling</title>
<p>By utilizing a few data augmentation techniques (<xref ref-type="bibr" rid="bty237-B24">Polson <italic>et al.</italic>, 2013</xref>; <xref ref-type="bibr" rid="bty237-B36">Zhou <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="bty237-B35">Zhou and Carin, 2015</xref>), we derive an efficient Gibbs sampling algorithm for inferring the model parameters in <xref ref-type="disp-formula" rid="E6">Equation (6)</xref>, as described below. Algorithm 1 summarizes all the steps in the Gibbs sampling algorithm.</p>
<p>
<bold>Sample</bold>
<inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>
<bold>and <italic>θ<sub>kj</sub></italic></bold>. We start with the data augmentation technique developed for inferring the NB dispersion parameter (<xref ref-type="bibr" rid="bty237-B35">Zhou and Carin, 2015</xref>). More precisely, the NB random variable <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> can be generated from a compound Poisson distribution as
<disp-formula id="E7"><mml:math id="M7"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>ℓ</mml:mo></mml:munderover><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo>ℓ</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Pois</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mo>−</mml:mo><mml:mi>r</mml:mi><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:mi>u</mml:mi><mml:mo>∼</mml:mo><mml:mo> </mml:mo><mml:mtext>Log</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> corresponds to the logarithmic random variable (<xref ref-type="bibr" rid="bty237-B17">Johnson <italic>et al.</italic>, 2005</xref>), with the PMF <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>U</mml:mi></mml:msub><mml:mo stretchy="true">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mi>u</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>u</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. As shown in <xref ref-type="bibr" rid="bty237-B35">Zhou and Carin (2015)</xref>, given <italic>n</italic> and <italic>r</italic>, the distribution of <inline-formula id="IE38"><mml:math id="IM38"><mml:mo>ℓ</mml:mo></mml:math></inline-formula> is a Chinese Restaurant Table (CRT) distribution, <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mo>ℓ</mml:mo><mml:mo>|</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>CRT</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, which can be generated as <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:mo>ℓ</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
<p>Utilizing the above data augmentation technique, for each observed count <italic>n<sub>vj</sub></italic>, a latent count is sampled as
<disp-formula id="E8"><label>(7)</label><mml:math id="M8"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>CRT</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
These counts are then further split into latent sub-counts [Proposition 3 of <xref ref-type="bibr" rid="bty237-B34">Zhou (2017)</xref>] using a multinomial distribution:
<disp-formula id="E9"><label>(8)</label><mml:math id="M9"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Mult</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
<p>These latent counts can be considered as being generated as <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Pois</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>. Hence, using gamma-Poisson conjugacy, <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>θ<sub>kj</sub></italic> are updated as
<disp-formula id="E10"><label>(9)</label><mml:math id="M10"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Dir</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:mo>η</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>J</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE45"><mml:math id="IM45"><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>V</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>.</p>
<p>
<bold>Sample <italic>r<sub>k</sub></italic> and <italic>γ</italic><sub>0</sub></bold>. Let us denote <inline-formula id="IE46"><mml:math id="IM46"><mml:mrow><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Starting with <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Pois</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, marginalizing out <italic>θ<sub>kj</sub></italic> leads to
<disp-formula id="E11"><label>(10)</label><mml:math id="M11"><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Employing the CRT augmentation technique as
<disp-formula id="E12"><label>(11)</label><mml:math id="M12"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>CRT</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
the Gibbs sampling update for <italic>r<sub>k</sub></italic> can be written as
<disp-formula id="E13"><label>(12)</label><mml:math id="M13"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>γ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Following a similar procedure for <italic>γ</italic><sub>0</sub>, first we draw
<disp-formula id="E14"><label>(13)</label><mml:math id="M14"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>CRT</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
and then we update the conditional posterior of <italic>γ</italic><sub>0</sub> as
<disp-formula id="E15"><label>(14)</label><mml:math id="M15"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mo>~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo></mml:mrow></mml:mstyle><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>/</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE48"><mml:math id="IM48"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>.</p>
<p>
<bold>Sample</bold>
<inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. For the regression coefficients modeling potential covariate effects, the lack of conditional conjugacy precludes immediate closed-form inference. Therefore, we adopt another data augmentation technique, specifically designed for dNBFA, to infer the regression coefficients <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, relying on the PG data augmentation of (<xref ref-type="bibr" rid="bty237-B24">Polson <italic>et al.</italic>, 2013</xref>; <xref ref-type="bibr" rid="bty237-B36">Zhou <italic>et al.</italic>, 2012</xref>). Denote <italic>ω<sub>kj</sub></italic> as a random variable drawn from the PG distribution as <inline-formula id="IE51"><mml:math id="IM51"><mml:mrow><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>PG</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p>
<p>Since <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">]</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>cosh</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, the likelihood of <italic>ψ<sub>kj</sub></italic> in <xref ref-type="disp-formula" rid="E11">Equation (10)</xref> can be expressed as
<disp-formula id="E16"><label>(15)</label><mml:math id="M16"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>∝</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∝</mml:mo><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="true">[</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">]</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
Exploiting the exponential tilting of the PG distribution in <xref ref-type="bibr" rid="bty237-B24">Polson <italic>et al.</italic> (2013)</xref>, we draw <italic>ω<sub>kj</sub></italic> as
<disp-formula id="E17"><label>(16)</label><mml:math id="M17"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>PG</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>ψ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Given the values of the auxiliary variables <italic>ω<sub>kj</sub></italic> for <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:math></inline-formula> and the prior in <xref ref-type="disp-formula" rid="E6">Equation (6)</xref>, the conditional posterior of <inline-formula id="IE54"><mml:math id="IM54"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can be updated as
<disp-formula id="E18"><label>(17)</label><mml:math id="M18"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="normal">N</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>Σ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:msub><mml:mo>Σ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtext>diag</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>α</mml:mo><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>α</mml:mo><mml:mi>P</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE56"><mml:math id="IM56"><mml:mrow><mml:msub><mml:mo>μ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mo>Σ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">[</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mo>ω</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">x</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
<p>
<bold>Sample <italic>η</italic></bold>. To derive the update steps for Dirichlet hyperparameters, we note that the likelihood for <inline-formula id="IE57"><mml:math id="IM57"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> is
<disp-formula id="E19"><label>(18)</label><mml:math id="M19"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mtext>Mult</mml:mtext></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
Marginalizing out <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mo>ϕ</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> from <xref ref-type="disp-formula" rid="E19">Equation (18)</xref>, the likelihood for <italic>η</italic> can be expressed as
<disp-formula id="E20"><label>(19)</label><mml:math id="M20"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>η</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mtext>DirMult</mml:mtext></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>V</mml:mi><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
where DirMult denotes the Dirichlet-Multinomial distribution (<xref ref-type="bibr" rid="bty237-B34">Zhou, 2017</xref>). Since the product of <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>η</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE60"><mml:math id="IM60"><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:mtext>Beta</mml:mtext></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> can be written as
<disp-formula id="E21"><label>(20)</label><mml:math id="M21"><mml:mrow><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:mo>η</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:mtext>Beta</mml:mtext></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>∝</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∏</mml:mo><mml:mi>v</mml:mi></mml:munder><mml:mrow><mml:mtext>NB</mml:mtext></mml:mrow></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mo>η</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>
we can further apply the data augmentation technique for the NB distribution of <xref ref-type="bibr" rid="bty237-B35">Zhou and Carin (2015)</xref> to derive closed-form update equations for <italic>η</italic> as
<disp-formula id="E22"><label>(21)</label><mml:math id="M22"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mo>·</mml:mo><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mi>V</mml:mi><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>CRT</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>·</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>η</mml:mo><mml:mo stretchy="true">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:mo>η</mml:mo><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mi>V</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo><mml:mo> </mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
<p>
<bold>Sample <italic>α<sub>p</sub></italic>, <italic>p<sub>j</sub></italic> and <italic>c</italic><sub>0</sub></bold>. Using appropriate conditional conjugacies, we can sample the remaining parameters as
<disp-formula id="E23"><label>(22)</label><mml:math id="M23"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mo>α</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mo>β</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>V</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mo>θ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mo>−</mml:mo><mml:mo stretchy="true">)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mo stretchy="true">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mo>γ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
<p>The Gibbs sampling steps in <xref ref-type="disp-formula" rid="E8">Equations (7)</xref> to <xref ref-type="disp-formula" rid="E23">(22)</xref> are summarized in Algorithm 1.
<boxed-text id="bty237-BOX1" orientation="portrait" position="float"><label>Algorithm 1 </label><caption><p>dNBFA model inference</p></caption><p><bold>Inputs</bold>: RNA-seq counts, design matrix of covariate effects, <italic>N</italic></p><p><bold>Outputs</bold>: gene module membership matrix</p><p> <italic>Initialize</italic> model parameters</p><p> # Do Gibbs sampling:</p><p> <bold>for</bold><italic>iter</italic> = 1 to <italic>N</italic><bold>do</bold></p><p>  Sample <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:msub><mml:mo>ℓ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> using the CRT distribution [<xref ref-type="disp-formula" rid="E8">Equation (7)</xref>]</p><p>  Update <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>θ<sub>kj</sub></italic> using the gamma-Poisson conjugacy [<xref ref-type="disp-formula" rid="E10">Equation (9)</xref>]</p><p>  Sample <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>ℓ</mml:mi><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> using the CRT distribution [<xref ref-type="disp-formula" rid="E12">Equation (11)</xref>]</p><p>  Update <italic>r<sub>k</sub></italic> and <italic>γ</italic><sub>0</sub> using the gamma-Poisson conjugacy [<xref ref-type="disp-formula" rid="E13">Equation (12)</xref>,<xref ref-type="disp-formula" rid="E15">(14)</xref>]</p><p>  Sample auxiliary variables <italic>ω<sub>kj</sub></italic>, using the PG distribution [<xref ref-type="disp-formula" rid="E17">Equation (16)</xref>]</p><p>  Update regression coefficients [<xref ref-type="disp-formula" rid="E18">Equation (17)</xref>]</p><p>  Update <italic>η</italic> using auxiliary beta distributed random variables [<xref ref-type="disp-formula" rid="E22">Equation (21)</xref>]</p><p>  Update <italic>α<sub>p</sub></italic>, <italic>p<sub>j</sub></italic> and <italic>c</italic><sub>0</sub> [<xref ref-type="disp-formula" rid="E23">Equation (22)</xref>]</p><p><bold>end for</bold></p></boxed-text></p>
</sec>
</sec>
<sec>
<title>3 Results</title>
<p>We evaluate our dNBFA for covariate-dependent factor analysis based on two sets of real-world RNA-seq data studying complex diseases, and compare its performance with those of WGCNA (<xref ref-type="bibr" rid="bty237-B18">Langfelder and Horvath, 2008</xref>) and DiffCoEx (<xref ref-type="bibr" rid="bty237-B27">Tesson <italic>et al.</italic>, 2010</xref>), two commonly adopted two-stage co-expression network based methods.</p>
<p>The first set of RNA-seq data was extracted from TCGA [<xref ref-type="bibr" rid="bty237-B5">Cancer Genome Atlas (TCGA) Research Network and others, 2008</xref>], including three datasets on breast invasive carcinoma (BRCA), lung squamous cell carcinoma (LUSC) and kidney renal clear cell carcinoma (KIRC). These data were retrieved using the TCGA2STAT R package (<xref ref-type="bibr" rid="bty237-B31">Wan <italic>et al.</italic>, 2015</xref>). Using TCGA data we expect to illustrate the higher differential expression significance of gene modules identified by dNBFA with respect to the disease factor compared to the results from WGCNA and DiffCoEx.</p>
<p>The second experiment was performed on a RNA-seq dataset of the Autism study in <xref ref-type="bibr" rid="bty237-B13">Gupta <italic>et al.</italic> (2014)</xref>, where samples were obtained from three brain regions: the cerebral cortex Brodmann area (BA) 19, anterior prefrontal cortex (BA10) and a part of the frontal cortex (BA44). For this dataset, we demonstrate how incorporating covariate information may enhance the chance of achieving meaningful biological discoveries.</p>
<p>For both TCGA and Autism experiments, dNBFA was run using 3000 MCMC iterations, where after the first 1000 burn-in iterations, the posterior samples with the highest likelihood were collected as the point estimates of model parameters. The total number of latent factors for both TCGA and Autism were initially set as <italic>K</italic> = 250, and after the parameter inference, only the top 100 factors with non-negligible baseline expressions were kept for further analyses. In addition, to determine module membership, for each latent factor <italic>k</italic>, only the top 20 genes with highest <inline-formula id="IE64"><mml:math id="IM64"><mml:mrow><mml:msub><mml:mo>ϕ</mml:mo><mml:mrow><mml:mi>v</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> were considered as members of module <italic>k</italic>. It should be noted that when an evaluation metric that can take advantage of the whole association matrix <inline-formula id="IE65"><mml:math id="IM65"><mml:mi mathvariant="bold">Φ</mml:mi></mml:math></inline-formula> exists, this <italic>ad-hoc</italic> step of using a cut-off for the gene-association parameter can be avoided.</p>
<p>For WGCNA, the adjacency matrix was built by first computing the pairwise Pearson correlation coefficients between gene expression profiles and then applying the soft threshold <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:mo>β</mml:mo><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:math></inline-formula> for TCGA and Autism data, respectively. The gene modules were identified by applying a hierarchical clustering algorithm to the derived topological overlap dissimilarity matrix (<xref ref-type="bibr" rid="bty237-B25">Ravasz <italic>et al.</italic>, 2002</xref>). A similar procedure was followed for DiffCoEx, except that the topological overlap matrix was built upon the matrix of adjacency difference (<xref ref-type="bibr" rid="bty237-B27">Tesson <italic>et al.</italic>, 2010</xref>). Our experiments show that the discovered modules by WGCNA and DiffCoEx comprise of large lists of genes, where no further modeling capability is provided to narrow down the gene sets for more consequent exploratory analysis.</p>
<sec>
<title>3.1 TCGA data</title>
<p>For all TCGA datasets, we have filtered out the genes whose total read counts across all samples are less than 50, resulting in roughly 20 000 genes in each dataset. The total numbers of samples for BRCA, LUSC and KIRC datasets are, respectively, 40, 34 and 40, where in each case the number of primary tumor and normal samples are equal.</p>
<p>Based on the resulting RNA-seq count data, dNBFA, WGCNA and DiffCoEx have been applied to derive functional gene modules using the aforementioned settings. To assess the significance of differential expression of identified modules with respect to the disease status of samples, we follow the framework of <xref ref-type="bibr" rid="bty237-B18">Langfelder and Horvath (2008)</xref>. More precisely, for each detected module, first the <italic>eigengene</italic> (<xref ref-type="bibr" rid="bty237-B18">Langfelder and Horvath, 2008</xref>) is computed via the first principal component of the expression matrix of the corresponding derived module. The module eigengene is used to summarize and represent the expression profiles of the module genes (<xref ref-type="bibr" rid="bty237-B16">Horvath and Dong, 2008</xref>). Then, the association of the eigengene expression with the disease status is evaluated and finally the significance of the association is assessed based on the student’s <italic>t</italic>-test.</p>
<p>We calculate the <italic>P</italic>-values for gene modules identified by dNBFA, WGCNA and DiffCoEx, applied to the three TCGA datasets. The sorted <italic>P</italic>-values [based on -log(<italic>P</italic>-value)] are illustrated in <xref ref-type="fig" rid="bty237-F2">Figure 2</xref>. The eigengenes of the modules detected by dNBFA are remarkably more differentially expressed than those detected by WGCNA and DiffCoEx in all three TCGA datasets. To further investigate the results, we present the per-sample eigengenes of the module ranked 10th for differential expression, which was identified by dNBFA, WGCNA and DiffCoEx for the three TCGA datasets in <xref ref-type="fig" rid="bty237-F3">Figure 3</xref>. The per-sample eigengenes of dNBFA modules are more consistently differentially expressed with respect to the disease status covariate for all three TCGA datasets, while per-sample eigengenes of WGCNA and DiffCoEx demonstrate higher variations within each group of samples with the same disease status. To ensure that the gene modules detected by dNBFA are not redundant, we also have examined the modules for significant overlap. Except a minor overlap between two modules, the rest of the modules identified by dNBFA are completely disjoint. These results suggest that dNBFA can be a powerful untargeted module identification tool, without pre-defined gene lists, for genomic experiments that study coordinated gene expression pattern changes across multiple groups.
</p>
<fig id="bty237-F2" orientation="portrait" position="float">
<label>Fig. 2.</label>
<caption>
<p>Significance of differential expression for eigengenes associated with gene modules identified by dNBFA, WGCNA and DiffCoEx applied to three TCGA datasets. The panels show the sorted negative logarithm of <italic>P</italic>-values of the derived modules. <italic>P</italic>-values are calculated using the student’s <italic>t</italic>-test on association between module eigengene expression and the samples’ condition factor (cancerous versus normal)</p>
</caption>
<graphic xlink:href="bty237f2"></graphic>
</fig>
<fig id="bty237-F3" orientation="portrait" position="float">
<label>Fig. 3.</label>
<caption>
<p>Per-sample eigengene expression of modules with the 10th lowest <italic>P</italic>-values discovered by dNBFA, WGCNA and DiffCoEx, across cancerous and normal samples for the three TCGA datasets. In each figure the y-axis is the eigengene expression, and the x-axis is the sample number. Red and blue bars correspond to the normal and cancer groups, respectively. Figures in top, middle and bottom rows are the results of dNBFA, DiffCoEx and WGCNA, respectively. Figures in left, middle and right columns correspond to BRCA, LUSC and KIRC datasets, respectively</p>
</caption>
<graphic xlink:href="bty237f3"></graphic>
</fig>
<p>To further verify the advantages of dNBFA that it avoids overfitting when the initial number of modules <italic>K</italic> is set high, we present in <xref ref-type="fig" rid="bty237-F4">Figure 4</xref> the learned <italic>r<sub>k’</sub></italic>s, representing the baseline expression associated with the derived modules, for three TCGA datasets. Only the top 40 <italic>r<sub>k’</sub></italic>s are included in this figure. For all datasets, only a fraction of modules have significantly large baseline expression; and thus in practice, a threshold can be used to extract the modules that contribute significantly to coordinated gene expression changes specific to the experiment design factors of interest.
</p>
<fig id="bty237-F4" orientation="portrait" position="float">
<label>Fig. 4.</label>
<caption>
<p>Inferred baseline expression <italic>r<sub>k</sub></italic> for modules detected by dNBFA in the three TCGA datasets. Only the top 40 <italic>r<sub>k’</sub></italic>s are included in this figure</p>
</caption>
<graphic xlink:href="bty237f4"></graphic>
</fig>
<p>For the analysis of the real-world TCGA dataset on a single cluster node with Intel Xeon 2.5 GHz E5–2670 v2 processor, on average it took around 8 h for both the dNBFA and NBFA methods with 3000 MCMC iterations and about 1 h for both WGCNA and DiffCoEx.</p>
</sec>
<sec>
<title>3.2 Autism data</title>
<p>Autism is a neuro-developmental disorder, in which the affected individuals are characterized by impairments in social and communicative developments (<xref ref-type="bibr" rid="bty237-B13">Gupta <italic>et al.</italic>, 2014</xref>). To apply dNBFA to the RNA-seq dataset of the Autism study in <xref ref-type="bibr" rid="bty237-B13">Gupta <italic>et al.</italic> (2014)</xref>, we first discard the samples with low sequencing depths, resulting in a dataset with 36 samples from the control group and 23 Autism samples. The following analyses are performed using a subset of 12 010 genes that have a count of at least three per sample across 90% of the samples. In this experiment, site of sample collection, age, sex and brain region are available as the covariate information in factor analysis. To examine how this information can alter the NB factor analysis results, in the first set of experiments we use the covariates to apply dNBFA; and in the second set of experiments, we neglect all covariate information and run the naive NBFA on the dataset.</p>
<p>We perform gene set enrichment analysis on the discovered modules by applying dNBFA and NBFA, respectively, to the Autism data, covering molecular function (MF), cellular component (CC) and BP ontology domains. We calculate the significance of GO terms using Fisher’s exact test and depict the sorted negative logarithm of <italic>P</italic>-values for both dNBFA and NBFA in <xref ref-type="fig" rid="bty237-F5">Figure 5</xref>. The modules detected by dNBFA have, in general, lower <italic>P</italic>-values than those identified by NBFA without covariates, suggesting that incorporating covariate information may increase the chance of discovering biologically meaningful modules.
</p>
<fig id="bty237-F5" orientation="portrait" position="float">
<label>Fig. 5.</label>
<caption>
<p>Negative logarithm of <italic>P</italic>-values for GO term enrichment analysis of modules detected by dNBFA and NBFA, applied to Autism RNA-seq data. For dNBFA, site of sample collection, age, sex and brain region are used as covariate information, while no such information is incorporated for NBFA </p>
</caption>
<graphic xlink:href="bty237f5"></graphic>
</fig>
<p>To investigate the gene ontology results more thoroughly, the top 10 GO terms with the lowest <italic>P</italic>-values are presented in <xref ref-type="table" rid="bty237-T2">Tables 2</xref> and <xref ref-type="table" rid="bty237-T3">3</xref> for dNBFA and NBFA methods, respectively. In these tables, each row is the most significant GO term corresponding to one module identified by dNBFA or NBFA. The top modules discovered by dNBFA provide more explicit connections to neural system. Especially, the top module identified by dNBFA, which was not detected by NBFA, is associated with GO term ‘<italic>type I interferon signaling pathway</italic>’, where type I Interferon responses in the brain are classically attributed to viral infections (<xref ref-type="bibr" rid="bty237-B12">Delhaye <italic>et al.</italic>, 2006</xref>), which in turn are connected to Autism (<xref ref-type="bibr" rid="bty237-B23">Patterson, 2011</xref>). Another important module detected only by dNBFA, the third module in <xref ref-type="table" rid="bty237-T2">Table 2</xref>, is related to adaptive immune response which is closely correlated to the development of Autism spectrum disorders (<xref ref-type="bibr" rid="bty237-B3">Ashwood <italic>et al.</italic>, 2006</xref>; <xref ref-type="bibr" rid="bty237-B15">Heuer <italic>et al.</italic>, 2008</xref>). More precisely, this module includes the human leukocyte antigen (HLA) genes that play an instrumental role in many innate and adaptive immune responses (<xref ref-type="bibr" rid="bty237-B29">Torres <italic>et al.</italic>, 2012</xref>). Many reports have provided the evidence on associations between Autism and HLA genes/haplotypes, suggesting an underlying dysregulation of the immune system mediated by HLA genes (<xref ref-type="bibr" rid="bty237-B28">Torres <italic>et al.</italic>, 2002</xref>; <xref ref-type="bibr" rid="bty237-B29">Torres <italic>et al.</italic>, 2012</xref>; <xref ref-type="bibr" rid="bty237-B33">Warren <italic>et al.</italic>, 1996</xref>). A third important module identified only by dNBFA is associated with GO term ‘<italic>neuron differentiation</italic> (GO: 0030182, <italic>P</italic>-value = 1.4 × 10<sup>–08</sup>). Specifically, this module includes calmodulin 1 (CALM1) gene. Significant defects in CALM1 interaction modules, which regulate voltage-independent calcium-activated action potentials at the neuronal synapse, are reported in autistic patients (<xref ref-type="bibr" rid="bty237-B14">Hadley <italic>et al.</italic>, 2014</xref>).
<table-wrap id="bty237-T2" orientation="portrait" position="float"><label>Table 2.</label><caption><p>Top enriched GO terms identified by dNBFA algorithm applied to Autism RNA-seq data</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1" valign="top"/><col align="left" span="1" valign="top"/><col align="left" span="1" valign="top"/><col align="char" char="." span="1" valign="top"/></colgroup><thead><tr><th align="left" colspan="1" rowspan="1">GO-ID</th><th align="left" colspan="1" rowspan="1">Aspect</th><th align="left" colspan="1" rowspan="1">Term</th><th align="left" colspan="1" rowspan="1"><italic>P</italic>-value</th></tr></thead><tbody><tr><td colspan="1" rowspan="1">GO: 0060337</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1">Type I interferon signaling pathway</td><td colspan="1" rowspan="1">4.377782e–15</td></tr><tr><td colspan="1" rowspan="1">GO: 0043209</td><td colspan="1" rowspan="1">CC</td><td colspan="1" rowspan="1">Myelin sheath</td><td colspan="1" rowspan="1">1.522628e–14</td></tr><tr><td colspan="1" rowspan="1">GO: 0002460</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1"><xref ref-type="table-fn" rid="tblfn2"><sup>a</sup></xref>See blow</td><td colspan="1" rowspan="1">9.487407e–13</td></tr><tr><td colspan="1" rowspan="1">GO: 0061024</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1">Membrane organization</td><td colspan="1" rowspan="1">2.250911e–11</td></tr><tr><td colspan="1" rowspan="1">GO: 0044456</td><td colspan="1" rowspan="1">CC</td><td colspan="1" rowspan="1">Synapse part</td><td colspan="1" rowspan="1">4.010908e–10</td></tr><tr><td colspan="1" rowspan="1">GO: 0005575</td><td colspan="1" rowspan="1">CC</td><td colspan="1" rowspan="1">Cellular component</td><td colspan="1" rowspan="1">4.950009e–10</td></tr><tr><td colspan="1" rowspan="1">GO: 0033693</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1">Neurofilament bundle assembly</td><td colspan="1" rowspan="1">3.982179e–09</td></tr><tr><td colspan="1" rowspan="1">GO: 0031720</td><td colspan="1" rowspan="1">MF</td><td colspan="1" rowspan="1">Haptoglobin binding</td><td colspan="1" rowspan="1">3.982179e–09</td></tr><tr><td colspan="1" rowspan="1">GO: 0000982</td><td colspan="1" rowspan="1">MF</td><td colspan="1" rowspan="1"><xref ref-type="table-fn" rid="tblfn3"><sup>b</sup></xref>See blow</td><td colspan="1" rowspan="1">6.267732e–09</td></tr><tr><td colspan="1" rowspan="1">GO: 0001504</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1">Neurotransmitter uptake</td><td colspan="1" rowspan="1">1.015843e–08</td></tr></tbody></table><table-wrap-foot><fn id="tblfn2"><label>a</label><p>Adaptive immune response based on somatic recombination of immune receptors built from immunoglobulin superfamily domains.</p></fn><fn id="tblfn3"><label>b</label><p>Transcription factor activity, RNA polymerase II core promoter proximal region sequence-specific binding.</p></fn></table-wrap-foot></table-wrap><table-wrap id="bty237-T3" orientation="portrait" position="float"><label>Table 3.</label><caption><p>Top enriched GO terms identified by NBFA algorithm applied to Autism RNA-seq data</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" span="1" valign="top"/><col align="left" span="1" valign="top"/><col align="left" span="1" valign="top"/><col align="char" char="." span="1" valign="top"/></colgroup><thead><tr><th align="left" colspan="1" rowspan="1">GO-ID</th><th align="left" colspan="1" rowspan="1">Aspect</th><th align="left" colspan="1" rowspan="1">Term</th><th align="left" colspan="1" rowspan="1"><italic>P</italic>-value</th></tr></thead><tbody><tr><td colspan="1" rowspan="1">GO: 0022625</td><td colspan="1" rowspan="1">CC</td><td colspan="1" rowspan="1">Cytosolic large ribosomal subunit</td><td colspan="1" rowspan="1">6.175728e–17</td></tr><tr><td colspan="1" rowspan="1">GO: 0097458</td><td colspan="1" rowspan="1">CC</td><td colspan="1" rowspan="1">Neuron part</td><td colspan="1" rowspan="1">1.134089e–10</td></tr><tr><td colspan="1" rowspan="1">GO: 0006735</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1">NADH regeneration</td><td colspan="1" rowspan="1">1.153145e–10</td></tr><tr><td colspan="1" rowspan="1">GO: 0005575</td><td colspan="1" rowspan="1">CC</td><td colspan="1" rowspan="1">Cellular component</td><td colspan="1" rowspan="1">4.950009e–10</td></tr><tr><td colspan="1" rowspan="1">GO: 0051050</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1">Positive regulation of transport</td><td colspan="1" rowspan="1">7.042487e–08</td></tr><tr><td colspan="1" rowspan="1">GO: 0007399</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1">Nervous system development</td><td colspan="1" rowspan="1">1.841155e–07</td></tr><tr><td colspan="1" rowspan="1">GO: 0065010</td><td colspan="1" rowspan="1">CC</td><td colspan="1" rowspan="1">Extracellular membrane-bounded organelle</td><td colspan="1" rowspan="1">5.614232e–07</td></tr><tr><td colspan="1" rowspan="1">GO: 0017111</td><td colspan="1" rowspan="1">MF</td><td colspan="1" rowspan="1">Nucleoside-triphosphatase activity</td><td colspan="1" rowspan="1">1.144582e–06</td></tr><tr><td colspan="1" rowspan="1">GO: 0048630</td><td colspan="1" rowspan="1">BP</td><td colspan="1" rowspan="1">Skeletal muscle tissue growth</td><td colspan="1" rowspan="1">1.586369e–05</td></tr><tr><td colspan="1" rowspan="1">GO: 0071208</td><td colspan="1" rowspan="1">MF</td><td colspan="1" rowspan="1">Histone pre-mRNA DCP binding</td><td colspan="1" rowspan="1">1.586369e–05</td></tr></tbody></table></table-wrap></p>
<p>Other GO terms directly related to the nervous system associated with the top modules discovered by dNBFA include ‘<italic>Myelin sheath</italic>’, ‘<italic>synapse part</italic>’, ‘<italic>neurofilament bundle assembl</italic>’ and ‘<italic>neurotransmitter uptake</italic>’. Specifically, the decreased thickness of myelin in the orbitofrontal cortex region is closely related to Autism disorders (<xref ref-type="bibr" rid="bty237-B37">Zikopoulos and Barbas, 2010</xref>). In addition, the module detected by dNBFA corresponding to GO term ‘<italic>synapse part</italic>’ has the highest association with the gene SNAP-25, whose reduced expression level is responsible for the cognitive deficits in children affected by Autism spectrum disorders (<xref ref-type="bibr" rid="bty237-B4">Braida <italic>et al.</italic>, 2015</xref>).</p>
<p>Examining the detected modules by both dNBFA and NBFA, we observe that multiple GO terms relevant to Autism, such as ‘<italic>myelin sheath</italic>’, ‘<italic>NADH regeneration</italic>’ and ‘<italic>nervous system development</italic>’, are revealed by both algorithms. NADH is mainly involved in catabolic reactions (energy metabolism and mitochondrial function), whose decreased level has been reported in some children with Autism (<xref ref-type="bibr" rid="bty237-B1">Adams <italic>et al.</italic>, 2011</xref>). On the other hand, defects in Autism appear closely tied to late developmental steps of nervous system that depend on synaptic activity and activity-dependent transcriptional changes (<xref ref-type="bibr" rid="bty237-B30">Walsh <italic>et al.</italic>, 2008</xref>). Hence the relevance of the discovered GO terms by both dNBFA and NBFA to Autism is confirmed.</p>
<p>Finally, by examining the trace plots of model parameters, such as <italic>c</italic><sub>0</sub> and <italic>r<sub>k</sub></italic>, we find that the Markov chains for the dNBFA method converge fast and mix well, supporting the practice of performing downstream analysis with 3000 MCMC iterations.</p>
<p>In summary, both NBFA and dNBFA methods emerge as useful module identification tools in RNA-seq data analysis, as in comparison to other available methods for gene module detection, they require minimum user adjustments. Specifically, the experimental results on the Autism dataset show that the incorporation of covariate information by dNBFA may lead to the discovery of more significant Autism-relevant modules, which otherwise would be missed by NBFA.</p>
</sec>
</sec>
<sec>
<title>4 Conclusions</title>
<p>We propose a novel Bayesian covariate-dependent negative binomial factor analysis (dNBFA) method for analyzing RNA-seq count data. Our experimental results on real-world RNA-seq data demonstrate that dNBFA is capable of handling complex experiments involving multiple factors. What’s more, dNBFA does not require any <italic>ad-hoc</italic> data normalization, data preprocessing, or co-expression network construction steps. By taking advantage of novel data augmentation techniques, dNBFA possesses efficient closed-form Gibbs sampling update equations. Experimental results on multiple RNA-seq data studying complex diseases, both cancer and Autism, demonstrate that our dNBFA can be directly applied to RNA-seq data to derive meaningful functional modules and it has potential advantages over existing two-stage co-expression network based methods.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgement</title>
<p>The authors thank Texas A&amp;M High Performance Research Computing and Texas Advanced Computing Center for providing computational resources to perform experiments in this paper.</p>
<sec>
<title>Funding</title>
<p>This work was supported in part by the NSF Award CCF-1553281, the USDA NIFA Award 06-505570-01006 and the TEES-AgriLife Center for Bioinformatics and Genomic Systems Engineering (CBGSE).</p>
<p>
<italic>Conflict of Interest</italic>: none declared.</p>
</sec>
</ack>
<ref-list>
<title>References</title>
<ref id="bty237-B1">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Adams</surname><given-names>J.B.</given-names></name></person-group>
<etal>et al</etal> (<year>2011</year>) 
<article-title>Nutritional and metabolic status of children with autism vs. neurotypical children, and the association with autism severity</article-title>. <source/>Nutr. Metab., <volume>8</volume>, <fpage>34.</fpage></mixed-citation>
</ref>
<ref id="bty237-B2">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Anders</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Differential expression analysis for sequence count data</article-title>. <source/>Genome Biol., <volume>11</volume>, <fpage>R106.</fpage><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
</ref>
<ref id="bty237-B3">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ashwood</surname><given-names>P.</given-names></name></person-group>
<etal>et al</etal> (<year>2006</year>) 
<article-title>The immune response in autism: a new frontier for autism research</article-title>. <source/>J. Leukocyte Biol., <volume>80</volume>, <fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">16698940</pub-id></mixed-citation>
</ref>
<ref id="bty237-B4">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Braida</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>Association between SNAP-25 gene polymorphisms and cognition in autism: functional consequences and potential therapeutic strategies</article-title>. <source/>Trans. Psychiatry, <volume>5</volume>, <fpage>e500.</fpage></mixed-citation>
</ref>
<ref id="bty237-B5">
<mixed-citation publication-type="journal">
<collab>Cancer Genome Atlas (TCGA) Research Network and Others</collab>. (<year>2008</year>) 
<article-title>Comprehensive genomic characterization defines human glioblastoma genes and core pathways</article-title>. <source/>Nature, <volume>455</volume>, <fpage>1061</fpage>.<pub-id pub-id-type="pmid">18772890</pub-id></mixed-citation>
</ref>
<ref id="bty237-B6">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Chib</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Greenberg</surname><given-names>E.</given-names></name></person-group> (<year>1995</year>) 
<article-title>Understanding the Metropolis-Hastings algorithm</article-title>. <source/>Am. Stat., <volume>49</volume>, <fpage>327</fpage>–<lpage>335</lpage>.</mixed-citation>
</ref>
<ref id="bty237-B7">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Cho</surname><given-names>S.B.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>Identifying set-wise differential co-expression in gene expression microarray data</article-title>. <source/>BMC Bioinformatics, <volume>10</volume>, <fpage>109.</fpage><pub-id pub-id-type="pmid">19371436</pub-id></mixed-citation>
</ref>
<ref id="bty237-B8">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Choi</surname><given-names>J.K.</given-names></name></person-group>
<etal>et al</etal> (<year>2005</year>) 
<article-title>Differential coexpression analysis using microarray data and its application to human cancer</article-title>. <source/>Bioinformatics, <volume>21</volume>, <fpage>4348</fpage>–<lpage>4355</lpage>.<pub-id pub-id-type="pmid">16234317</pub-id></mixed-citation>
</ref>
<ref id="bty237-B9">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Choi</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Kendziorski</surname><given-names>C.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Statistical methods for gene set co-expression analysis</article-title>. <source/>Bioinformatics, <volume>25</volume>, <fpage>2780</fpage>–<lpage>2786</lpage>.<pub-id pub-id-type="pmid">19689953</pub-id></mixed-citation>
</ref>
<ref id="bty237-B10">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Dadaneh</surname><given-names>S.Z.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>BNP-Seq: Bayesian nonparametric differential expression analysis of sequencing count data</article-title>. <source/>J. Am. Stat. Assoc., in press. doi: 10.1080/01621459.2017.1328358.</mixed-citation>
</ref>
<ref id="bty237-B11">
<mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Datta</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Nettleton</surname><given-names>D.</given-names></name></person-group> (<year>2014</year>) <source/>Statistical Analysis of Next Generation Sequencing Data. 
<publisher-name>Springer</publisher-name>, New York City, USA.</mixed-citation>
</ref>
<ref id="bty237-B12">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Delhaye</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2006</year>) 
<article-title>Neurons produce type I interferon during viral encephalitis</article-title>. <source/>Proc. Natl. Acad. Sci., <volume>103</volume>, <fpage>7835</fpage>–<lpage>7840</lpage>.<pub-id pub-id-type="pmid">16682623</pub-id></mixed-citation>
</ref>
<ref id="bty237-B13">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Gupta</surname><given-names>S.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Transcriptome analysis reveals dysregulation of innate immune response genes and neuronal activity-dependent genes in autism</article-title>. <source/>Nat. Commun., <volume>5</volume>, <fpage>5748.</fpage><pub-id pub-id-type="pmid">25494366</pub-id></mixed-citation>
</ref>
<ref id="bty237-B14">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Hadley</surname><given-names>D.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>The impact of the metabotropic glutamate receptor and other gene family interaction networks on autism</article-title>. <source/>Nat. Commun., <volume>5</volume>, <fpage>4074.</fpage><pub-id pub-id-type="pmid">24927284</pub-id></mixed-citation>
</ref>
<ref id="bty237-B15">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Heuer</surname><given-names>L.</given-names></name></person-group>
<etal>et al</etal> (<year>2008</year>) 
<article-title>Reduced levels of immunoglobulin in children with autism correlates with behavioral symptoms</article-title>. <source/>Autism Res., <volume>1</volume>, <fpage>275</fpage>–<lpage>283</lpage>.<pub-id pub-id-type="pmid">19343198</pub-id></mixed-citation>
</ref>
<ref id="bty237-B16">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Horvath</surname><given-names>S.</given-names></name>, <name name-style="western"><surname>Dong</surname><given-names>J.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Geometric interpretation of gene coexpression network analysis</article-title>. <source/>PLoS Comput. Biol., <volume>4</volume>, <fpage>e1000117.</fpage><pub-id pub-id-type="pmid">18704157</pub-id></mixed-citation>
</ref>
<ref id="bty237-B17">
<mixed-citation publication-type="book">
<person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>N.L.</given-names></name></person-group>
<etal>et al</etal> (<year>2005</year>) <source/>Univariate Discrete Distributions, Vol. 444. 
<publisher-name>Wiley</publisher-name>, New Jersey, USA.</mixed-citation>
</ref>
<ref id="bty237-B18">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Langfelder</surname><given-names>P.</given-names></name>, <name name-style="western"><surname>Horvath</surname><given-names>S.</given-names></name></person-group> (<year>2008</year>) 
<article-title>WGCNA: an R package for weighted correlation network analysis</article-title>. <source/>BMC Bioinformatics, <volume>9</volume>, <fpage>559.</fpage><pub-id pub-id-type="pmid">19114008</pub-id></mixed-citation>
</ref>
<ref id="bty237-B19">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Law</surname><given-names>C.W.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source/>Genome Biol., <volume>15</volume>, <fpage>R29.</fpage><pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
</ref>
<ref id="bty237-B20">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Lei</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2017</year>) 
<article-title>Network module-based model in the differential expression analysis for RNA-seq</article-title>. <source/>Bioinformatics, <volume>33</volume>, <fpage>2699</fpage>–<lpage>2705</lpage>.<pub-id pub-id-type="pmid">28407034</pub-id></mixed-citation>
</ref>
<ref id="bty237-B21">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Love</surname><given-names>M.I.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source/>Genome Biol., <volume>15</volume>, <fpage>550.</fpage><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
</ref>
<ref id="bty237-B22">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Nam</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>S.-Y.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Gene-set approach for expression pattern analysis</article-title>. <source/>Brief. Bioinformatics, <volume>9</volume>, <fpage>189</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">18202032</pub-id></mixed-citation>
</ref>
<ref id="bty237-B23">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Patterson</surname><given-names>P.H.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Maternal infection and immune involvement in autism</article-title>. <source/>Trends Mol. Med., <volume>17</volume>, <fpage>389</fpage>–<lpage>394</lpage>.<pub-id pub-id-type="pmid">21482187</pub-id></mixed-citation>
</ref>
<ref id="bty237-B24">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Polson</surname><given-names>N.G.</given-names></name></person-group>
<etal>et al</etal> (<year>2013</year>) 
<article-title>Bayesian inference for logistic models using Pólya–Gamma latent variables</article-title>. <source/>J. Am. Statist. Assoc., <volume>108</volume>, <fpage>1339</fpage>–<lpage>1349</lpage>.</mixed-citation>
</ref>
<ref id="bty237-B25">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Ravasz</surname><given-names>E.</given-names></name></person-group>
<etal>et al</etal> (<year>2002</year>) 
<article-title>Hierarchical organization of modularity in metabolic networks</article-title>. <source/>Science, <volume>297</volume>, <fpage>1551</fpage>–<lpage>1555</lpage>.<pub-id pub-id-type="pmid">12202830</pub-id></mixed-citation>
</ref>
<ref id="bty237-B26">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Robinson</surname><given-names>M.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2010</year>) 
<article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source/>Bioinformatics, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
</ref>
<ref id="bty237-B27">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Tesson</surname><given-names>B.M.</given-names></name></person-group>
<etal>et al</etal> (<year>2010</year>) 
<article-title>DiffCoEx: a simple and sensitive method to find differentially coexpressed gene modules</article-title>. <source/>BMC Bioinformatics, <volume>11</volume>, <fpage>497.</fpage><pub-id pub-id-type="pmid">20925918</pub-id></mixed-citation>
</ref>
<ref id="bty237-B28">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Torres</surname><given-names>A.R.</given-names></name></person-group>
<etal>et al</etal> (<year>2002</year>) 
<article-title>The transmission disequilibrium test suggests that HLA-DR4 and DR13 are linked to autism spectrum disorder</article-title>. <source/>Human Immunol., <volume>63</volume>, <fpage>311</fpage>–<lpage>316</lpage>.<pub-id pub-id-type="pmid">12039413</pub-id></mixed-citation>
</ref>
<ref id="bty237-B29">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Torres</surname><given-names>A.R.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) 
<article-title>HLA immune function genes in autism</article-title>. <source/>Autism Res. Treatment, <volume>2012</volume>, <fpage>1.</fpage></mixed-citation>
</ref>
<ref id="bty237-B30">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Walsh</surname><given-names>C.A.</given-names></name></person-group>
<etal>et al</etal> (<year>2008</year>) 
<article-title>Autism and brain development</article-title>. <source/>Cell, <volume>135</volume>, <fpage>396</fpage>–<lpage>400</lpage>.<pub-id pub-id-type="pmid">18984148</pub-id></mixed-citation>
</ref>
<ref id="bty237-B31">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wan</surname><given-names>Y.-W.</given-names></name></person-group>
<etal>et al</etal> (<year>2015</year>) 
<article-title>TCGA2STAT: simple TCGA data access for integrated statistical analysis in R</article-title>. <source/>Bioinformatics, <volume>32</volume>, <fpage>952</fpage>–<lpage>954</lpage>.<pub-id pub-id-type="pmid">26568634</pub-id></mixed-citation>
</ref>
<ref id="bty237-B32">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>Z.</given-names></name></person-group>
<etal>et al</etal> (<year>2009</year>) 
<article-title>RNA-Seq: a revolutionary tool for transcriptomics</article-title>. <source/>Nat. Rev. Genet., <volume>10</volume>, <fpage>57</fpage>–<lpage>63</lpage>.<pub-id pub-id-type="pmid">19015660</pub-id></mixed-citation>
</ref>
<ref id="bty237-B33">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Warren</surname><given-names>R.P.</given-names></name></person-group>
<etal>et al</etal> (<year>1996</year>) 
<article-title>Strong association of the third hypervariable region of HLA-DR<italic>β</italic>1 with autism</article-title>. <source/>J. Neuroimmunol., <volume>67</volume>, <fpage>97</fpage>–<lpage>102</lpage>.<pub-id pub-id-type="pmid">8765331</pub-id></mixed-citation>
</ref>
<ref id="bty237-B34">
<mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>M.</given-names></name></person-group> (<year>2017</year>) Nonparametric Bayesian negative binomial factor analysis. International Society for Bayesian Analysis, Durham, North Carolina, USA. doi: 10.1214/17-BA1070.</mixed-citation>
</ref>
<ref id="bty237-B35">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Carin</surname><given-names>L.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Negative binomial process count and mixture modeling</article-title>. <source/>IEEE Trans. Pattern Anal. Machine Intel., <volume>37</volume>, <fpage>307</fpage>–<lpage>320</lpage>.</mixed-citation>
</ref>
<ref id="bty237-B36">
<mixed-citation publication-type="other">
<person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>M.</given-names></name></person-group>
<etal>et al</etal> (<year>2012</year>) Lognormal and gamma mixed negative binomial regression. In: <italic>ICML</italic>, NIH Public Access, Edinburgh, Scotland. pp. 1343–1350. </mixed-citation>
</ref>
<ref id="bty237-B37">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Zikopoulos</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Barbas</surname><given-names>H.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Changes in prefrontal axons may disrupt the network in autism</article-title>. <source/>J. Neurosci., <volume>30</volume>, <fpage>14595</fpage>–<lpage>14609</lpage>.<pub-id pub-id-type="pmid">21048117</pub-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>
</pmc-articleset>