<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">

<pmc-articleset><article article-type="research-article" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<?properties open_access?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Genet</journal-id>
<journal-id journal-id-type="iso-abbrev">PLoS Genet</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">plosgen</journal-id>
<journal-title-group>
<journal-title>PLoS Genetics</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-7390</issn>
<issn pub-type="epub">1553-7404</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="pmid">30951530</article-id>
<article-id pub-id-type="pmc">6469799</article-id>
<article-id pub-id-type="publisher-id">PGENETICS-D-18-01962</article-id>
<article-id pub-id-type="doi">10.1371/journal.pgen.1008009</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Computational Biology</subject>
<subj-group>
<subject>Genome Analysis</subject>
<subj-group>
<subject>Genome-Wide Association Studies</subject>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Genetics</subject>
<subj-group>
<subject>Genomics</subject>
<subj-group>
<subject>Genome Analysis</subject>
<subj-group>
<subject>Genome-Wide Association Studies</subject>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Genetics</subject>
<subj-group>
<subject>Human Genetics</subject>
<subj-group>
<subject>Genome-Wide Association Studies</subject>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Genetics</subject>
<subj-group>
<subject>Heredity</subject>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Medicine and Health Sciences</subject>
<subj-group>
<subject>Pharmacology</subject>
<subj-group>
<subject>Drugs</subject>
<subj-group>
<subject>Statins</subject>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Genetics</subject>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Biochemistry</subject>
<subj-group>
<subject>Metabolism</subject>
<subj-group>
<subject>Carbohydrate Metabolism</subject>
<subj-group>
<subject>Glucose Metabolism</subject>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Genetics</subject>
<subj-group>
<subject>Phenotypes</subject>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Genetics</subject>
<subj-group>
<subject>Heredity</subject>
<subj-group>
<subject>Quantitative Traits</subject>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Biology and Life Sciences</subject>
<subj-group>
<subject>Genetics</subject>
<subj-group>
<subject>Phenotypes</subject>
<subj-group>
<subject>Quantitative Traits</subject>
</subj-group>
</subj-group>
</subj-group>
</subj-group>
<subj-group subj-group-type="Discipline-v3">
<subject>Research and Analysis Methods</subject>
<subj-group>
<subject>Simulation and Modeling</subject>
</subj-group>
</subj-group>
</article-categories>
<title-group>
<article-title>Reverse GWAS: Using genetics to identify and model phenotypic subtypes</article-title>
<alt-title alt-title-type="running-head">Reverse GWAS: Using genetics to identify and model phenotypic subtypes</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6520-4766</contrib-id>
<name>
<surname>Dahl</surname>
<given-names>Andy</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001">
<sup>1</sup>
</xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7496-2075</contrib-id>
<name>
<surname>Cai</surname>
<given-names>Na</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002">
<sup>2</sup>
</xref>
<xref ref-type="aff" rid="aff003">
<sup>3</sup>
</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1523-7225</contrib-id>
<name>
<surname>Ko</surname>
<given-names>Arthur</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004">
<sup>4</sup>
</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Laakso</surname>
<given-names>Markku</given-names>
</name>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff005">
<sup>5</sup>
</xref>
<xref ref-type="aff" rid="aff006">
<sup>6</sup>
</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Pajukanta</surname>
<given-names>Päivi</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004">
<sup>4</sup>
</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Flint</surname>
<given-names>Jonathan</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff007">
<sup>7</sup>
</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zaitlen</surname>
<given-names>Noah</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001">
<sup>1</sup>
</xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Medicine, UCSF, San Francisco, California, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Wellcome Sanger Institute, Cambridge, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>European Bioinformatics Institute (EMBL-EBI), Cambridge, United Kingdom</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Human Genetics, David Geffen School of Medicine, UCLA, Los Angeles, California, United States of America</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Institute of Clinical Medicine, Internal Medicine, University of Eastern Finland, Kuopio, Finland</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>Kuopio University Hospital, Kuopio, Finland</addr-line>
</aff>
<aff id="aff007">
<label>7</label>
<addr-line>Center for Neurobehavioral Genetics, Semel Institute for Neuroscience and Human Behavior, UCLA, Los Angeles, California, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor">
<name>
<surname>Barsh</surname>
<given-names>Gregory S.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"></xref>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Stanford University School of Medicine, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="COI-statement" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email>andywdahl@gmail.com</email> (AD); <email>noah.zaitlen@ucsf.edu</email> (NZ)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>5</day>
<month>4</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>4</issue>
<elocation-id>e1008009</elocation-id>
<history>
<date date-type="received">
<day>5</day>
<month>10</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>7</day>
<month>2</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-statement>© 2019 Dahl et al</copyright-statement>
<copyright-year>2019</copyright-year>
<copyright-holder>Dahl et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="pgen.1008009.pdf"></self-uri>
<abstract>
<p>Recent and classical work has revealed biologically and medically significant subtypes in complex diseases and traits. However, relevant subtypes are often unknown, unmeasured, or actively debated, making automated statistical approaches to subtype definition valuable. We propose reverse GWAS (RGWAS) to identify and validate subtypes using genetics and multiple traits: while GWAS seeks the genetic basis of a given trait, RGWAS seeks to define trait subtypes with distinct genetic bases. Unlike existing approaches relying on off-the-shelf clustering methods, RGWAS uses a novel decomposition, MFMR, to model covariates, binary traits, and population structure. We use extensive simulations to show that modelling these features can be crucial for power and calibration. We validate RGWAS in practice by recovering a recently discovered stress subtype in major depression. We then show the utility of RGWAS by identifying three novel subtypes of metabolic traits. We biologically validate these metabolic subtypes with SNP-level tests and a novel polygenic test: the former recover known metabolic GxE SNPs; the latter suggests subtypes may explain substantial missing heritability. Crucially, statins, which are widely prescribed and theorized to increase diabetes risk, have opposing effects on blood glucose across metabolic subtypes, suggesting the subtypes have potential translational value.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Complex diseases depend on interactions between many known and unknown genetic and environmental factors. However, most studies aggregate these strata and test for associations on average across samples, though biological factors and medical interventions can have dramatically different effects on different people. Further, more-sophisticated models are often infeasible because relevant sources of heterogeneity are not generally known <italic>a priori</italic>. We introduce Reverse GWAS to simultaneously split samples into homogeneous subtypes and to learn differences in genetic or treatment effects between subtypes. Unlike existing approaches to computational subtype identification from high-dimensional trait data, RGWAS accounts for covariates, binary disease traits and, especially, population structure–important features of real genetic datasets. We validate RGWAS by recovering known genetic subtypes of major depression. We demonstrate RGWAS can uncover useful novel subtypes in a metabolic dataset, finding three novel subtypes with both SNP- and polygenic-level heterogeneity. Importantly, we show that RGWAS can uncover subtypes with differential treatment response: we show that statin, a common drug and potential type 2 diabetes risk factor, may have opposing subtype-specific effects on blood glucose.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by 377 National Institutes of Health (NIH) grants 1U01HG009080-01, 5K25HL121295-03, 378 1R03DE025665-01A1, HL-095056, HL-28481, and U01 DK105561. N. Cai was supported 379 by the EBI-Sanger Postdoctoral Fellowship. A. Ko was supported by the NIH grant 380 F31HL127921. 381 The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"></fig-count>
<table-count count="1"></table-count>
<page-count count="22"></page-count>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-04-17</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Genotype data from the CONVERGE cohort are available through the European Variation Archive (EVA) as previously described [<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/28195579">https://www.ncbi.nlm.nih.gov/pubmed/28195579</ext-link>], and phenotype data are available through the CONVERGE data access committee (<ext-link ext-link-type="uri" xlink:href="http://www.well.ox.ac.uk/converge">http://www.well.ox.ac.uk/converge</ext-link>). Genotype and phenotype data from the METISM cohort are available through METSIM data access committee (<ext-link ext-link-type="uri" xlink:href="http://www.nationalbiobanks.fi/index.php/studies2/10-metsim">http://www.nationalbiobanks.fi/index.php/studies2/10-metsim</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<title>Data Availability</title>
<p>Genotype data from the CONVERGE cohort are available through the European Variation Archive (EVA) as previously described [<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/28195579">https://www.ncbi.nlm.nih.gov/pubmed/28195579</ext-link>], and phenotype data are available through the CONVERGE data access committee (<ext-link ext-link-type="uri" xlink:href="http://www.well.ox.ac.uk/converge">http://www.well.ox.ac.uk/converge</ext-link>). Genotype and phenotype data from the METISM cohort are available through METSIM data access committee (<ext-link ext-link-type="uri" xlink:href="http://www.nationalbiobanks.fi/index.php/studies2/10-metsim">http://www.nationalbiobanks.fi/index.php/studies2/10-metsim</ext-link>).</p>
</notes>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Distinguishing subtypes can be essential for treatment, prognosis, and learning basic disease biology. For example, breast cancer has subtypes distinguished by tumor hormone receptor status that have different genetic risk variants, population structure, comorbidities, treatment responses, and prognoses [<xref ref-type="bibr" rid="pgen.1008009.ref001">1</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref002">2</xref>]. Many other common diseases have known, biologically distinct subtypes [<xref ref-type="bibr" rid="pgen.1008009.ref003">3</xref>–<xref ref-type="bibr" rid="pgen.1008009.ref007">7</xref>], often involving distinct tissues or biological pathways, including two diseases we study: major depression (MD) [<xref ref-type="bibr" rid="pgen.1008009.ref008">8</xref>] and type 2 diabetes (T2D) [<xref ref-type="bibr" rid="pgen.1008009.ref009">9</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref010">10</xref>]. Genetically distinct subtypes can arise from gene-environment interactions [<xref ref-type="bibr" rid="pgen.1008009.ref011">11</xref>–<xref ref-type="bibr" rid="pgen.1008009.ref013">13</xref>]; gene-gene interactions [<xref ref-type="bibr" rid="pgen.1008009.ref014">14</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref015">15</xref>]; or disease misclassification, which is well documented but usually ignored [<xref ref-type="bibr" rid="pgen.1008009.ref016">16</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref017">17</xref>].</p>
<p>In this work we describe a novel method to learn and validate genetic subtypes in a two-step approach that we call reverse GWAS (RGWAS). In the first step, RGWAS infers subtypes by clustering multiple traits with a finite mixture of regressions method we designed specifically for large, multi-trait GWAS datasets (MFMR). The core assumption of MFMR is that the subtypes differ in distribution for many traits, which creates a subtype structure that can be detected with computational algorithms. In the second step, RGWAS assesses the causal <italic>biological</italic> distinction between the inferred subtypes by testing for genetic effect heterogeneity across subtypes, both at the SNP- and polygenic-levels. We also test effect heterogeneity for non-genetic covariates, like medical interventions, to assess <italic>pragmatic</italic> distinctions between subtypes [<xref ref-type="bibr" rid="pgen.1008009.ref018">18</xref>–<xref ref-type="bibr" rid="pgen.1008009.ref021">21</xref>].</p>
<p>RGWAS offers several important advances in both the identification and testing steps over other recent computational approaches to uncover subtypes [<xref ref-type="bibr" rid="pgen.1008009.ref022">22</xref>–<xref ref-type="bibr" rid="pgen.1008009.ref031">31</xref>]. First, unlike previous methods, the RGWAS identification step corrects for population structure, handles binary traits, and scales to tens of thousands of samples. Second, previous approaches to the testing step were badly confounded and/or under-powered to detect genetic heterogeneity in complex traits, while RGWAS offers calibrated <italic>p</italic>-values, polygenic subtype validation tests, and covariate adjustment. These advances substantially reduce both type I and type II errors in computational subtyping.</p>
<p>We first evaluate RGWAS through extensive simulations over a wide range of parameter settings and generative models, including several scenarios that violate our assumed model. In comparison to previous methods, as well as several novel methods and obvious extensions, we find that RGWAS is substantially more powerful, more robust, and better calibrated. We then validate RGWAS in real data by recovering a recently discovered stress subtype in MD, as well as known subtype-specific SNP effects.</p>
<p>Finally, we apply RGWAS to a metabolic cohort where subtypes are unknown <italic>a priori</italic> and find strong statistical support for genetic effect heterogeneity across dozens of complex phenotypes: first, a subtype-aware mixed model substantially increases heritability, from 20.7% to 30.2% on average across traits; second, we identify dozens of subtype-specific SNP effects that could not be discovered in standard analyses, including three SNPs with previously identified metabolic interactions; third, subtype-aware GWAS increases the number of hits, from 60 to 70 across traits. Crucially, we find that statin, a widely prescribed drug that may increase diabetes risk [<xref ref-type="bibr" rid="pgen.1008009.ref032">32</xref>–<xref ref-type="bibr" rid="pgen.1008009.ref034">34</xref>], has opposing effects on blood glucose across metabolic subtypes, which suggests that learned subtypes may have significant translational value.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Reverse GWAS is calibrated and powerful in simulations</title>
<p>We examine the relative behaviors of RGWAS and other recent methods for computational subtype identification through application to simulated datasets. We simulated from a range of generative models and parameter settings meant to reflect many of the complexities of real data (<xref ref-type="sec" rid="sec011">Methods</xref>, Supplementary Section 3). Our baseline includes noise that is correlated across traits; large main subtype effects; 27 quantitative and 3 binary traits; and 12 SNPs containing null, homogeneous, and heterogeneous SNPs. We simulate datasets both under a <italic>K</italic> = 2 model and a <italic>K</italic> = 1 model where no subtypes of any sort are present. For each parameter setting we aggregate results from roughly 300 simulated datasets. We explore several variations to this baseline later.</p>
<p>For each simulated dataset we first cluster individuals (RGWAS step 1) into a subtype vector <italic>z</italic>. We focus on our Multi-trait Finite Mixture of Regressions (MFMR) approach (<xref ref-type="sec" rid="sec011">Methods</xref>) and three other, conceptually distinct approaches to cluster individuals into subtypes (<xref ref-type="sec" rid="sec011">Methods</xref>). First, we use Gaussian Mixture Models (GMM) to represent covariate-unaware methods, e.g. <italic>k</italic>-means [<xref ref-type="bibr" rid="pgen.1008009.ref028">28</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref031">31</xref>] and TDA [<xref ref-type="bibr" rid="pgen.1008009.ref022">22</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref026">26</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref027">27</xref>]. Second, we consider a novel approach based on Canonical Correlation Analysis (CCA) that defines the subtype vector <italic>z</italic> as the top phenotypic CC. Third, we use the true <italic>z</italic> to show the best-case scenario with perfect subtyping (Oracle).</p>
<p>First, we observed that MFMR outperformed non-oracle methods in recovering true cluster identities across a range of simulations settings (<xref ref-type="supplementary-material" rid="pgen.1008009.s002">S1 Fig</xref>). While this does increase confidence in MFMR, clustering accuracy is not a directly useful metric because true clusters are not known in practice. Moreover, we are primarily concerned with the significance and interpretation of our inferred subtypes, rather than merely their existence, which requires calibrated tests for effect heterogeneity between identified clusters. Hence our primary evaluation focuses on the false- and true-positive rates (FPR and TPR) for the standard SNP-subtype (<italic>z</italic>) interaction test in (<xref ref-type="disp-formula" rid="pgen.1008009.e011">3</xref>), conditioning on main subtype effects (RGWAS step 2). A polygenic alternative for RGWAS step 2 is presented below (<xref ref-type="sec" rid="sec011">Methods</xref>, [<xref ref-type="bibr" rid="pgen.1008009.ref035">35</xref>]). We report a true positive if the SNP was simulated with heterogeneous effects across subtypes, and a false positive if the SNP was simulated with null or homogeneous effects.</p>
<p>The results in <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref> show that interaction tests applied to MFMR subtypes are calibrated and almost perfectly obtain oracle power. Crucially, MFMR remains calibrated even when <italic>K</italic> = 1 (<xref ref-type="fig" rid="pgen.1008009.g001">Fig 1b</xref>), so RGWAS discoveries reliably validate the existence of subtypes. Further, when <italic>K</italic> &gt; 2 subtypes were simulated, MFMR with fixed <italic>K</italic> = 2 lost power but remained calibrated (<xref ref-type="supplementary-material" rid="pgen.1008009.s003">S2a Fig</xref>). Together, this shows that MFMR is robust to misspecified <italic>K</italic>, though power increases when <italic>K</italic> is more accurate.</p>
<fig id="pgen.1008009.g001" orientation="portrait" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008009.g001</object-id>
<label>Fig 1</label>
<caption>
<title>SNP heterogeneity tests at nominal <italic>p</italic> = .01.</title>
<p>SNPs are either null (a); homogeneous (Hom, c); or truly heterogeneous (Het, d); we also test Hom SNPs in simulations with no subtypes (b). FPR is shown on the log scale. Hom SNPs explain 4% of variance and Het SNPs explain .4% (triangles) or vice versa (circles).</p>
</caption>
<graphic xlink:href="pgen.1008009.g001"></graphic>
</fig>
<p>On the other hand, GMM is miscalibrated by an order of magnitude when <italic>K</italic> = 1, making it unreliable for interaction testing and, more broadly, validating the existence of subtypes (<xref ref-type="fig" rid="pgen.1008009.g001">Fig 1b</xref>). One fundamental difference between MFMR and GMM is that only MFMR models covariates. Intuitively, ignored covariate effects confound true subtypes, hence GMM performs poorly when homogeneous effects are large or heterogeneous effects are small (<xref ref-type="fig" rid="pgen.1008009.g001">Fig 1c</xref>, <xref ref-type="supplementary-material" rid="pgen.1008009.s003">S2c–S2e Fig</xref>). Another difference between MFMR and GMM is that the former explicitly models binary traits, while the latter discards them and, concomitantly, loses power (<xref ref-type="supplementary-material" rid="pgen.1008009.s003">S2b Fig</xref>, <xref ref-type="sec" rid="sec011">Methods</xref>).</p>
<p>Our novel application of CCA has low power but seems calibrated and, sometimes, seems to outperform even the oracle (e.g. <xref ref-type="supplementary-material" rid="pgen.1008009.s003">S2c</xref> and <xref ref-type="supplementary-material" rid="pgen.1008009.s003">S3</xref> Figs). Unsurprisingly, this is a Pyrrhic victory: by smoothing over traits, CCA creates a bias that simultaneously increases FPR and TPR, which we show with theory (Supplementary Section 4) and simulation (<xref ref-type="supplementary-material" rid="pgen.1008009.s004">S3 Fig</xref>). Moreover, the CCA subtypes poorly capture the true, discrete subtypes (<xref ref-type="supplementary-material" rid="pgen.1008009.s002">S1 Fig</xref>). Broadly, CCA is often calibrated for testing the existence of heterogeneity, but it cannot determine which specific traits are truly heterogeneous and, moreover, has lower power than MFMR. We also tried using the top phenotypic PC for <italic>z</italic>, which performed like CCA except with lower power, and the top genetic PC [<xref ref-type="bibr" rid="pgen.1008009.ref025">25</xref>], which had very low power (<xref ref-type="supplementary-material" rid="pgen.1008009.s005">S4 Fig</xref>).</p>
<sec id="sec004">
<title>Simulations violating model assumptions</title>
<p>Having analyzed simulations from our assumed model, we turn to other generative models and parameter settings to assess the limitations of RGWAS. We first considered several direct variations to our baseline simulation. We drew <italic>t</italic><sub>5</sub>-distributed noise, which has higher kurtosis than the Gaussian noise assumed by our model. We found that MFMR and CCA performed similarly as in the Gaussian case, but GMM became even more inflated (<xref ref-type="supplementary-material" rid="pgen.1008009.s006">S5 Fig</xref>); nonetheless, we caution that MFMR, like linear regression, will not generally be calibrated under arbitrary noise distributions. Next, we assessed non-linear SNP effects and found that MFMR again remained roughly calibrated, but GMM and CCA were inflated for strong homogeneous effects; this held for two types of non-linear covariate transformations (<xref ref-type="supplementary-material" rid="pgen.1008009.s007">S6 Fig</xref>), but we again caution that MFMR is not generally calibrated when covariates have non-linear effects. We also tried replacing the discrete subtypes <italic>z</italic> with a continuous <italic>z</italic> drawn from a Gaussian distribution. This exacerbated GMM inflation, but MFMR remained powerful and calibrated; however, when we doubled all heterogeneous effect sizes, MFMR became ≈ 4-fold inflated for large homogeneous covariates and <italic>N</italic> ≥ 30, 000 (<xref ref-type="supplementary-material" rid="pgen.1008009.s008">S7 Fig</xref>), suggesting caution for MFMR in large datasets when large-effect, continuous subtypes may exist. Overall, modest amounts of these types of model misspecification cause relatively modest RGWAS bias, but stronger model violations will inevitably cause FPR inflation.</p>
<p>Second, we examined case ascertainment, which causes bias in many genetic testing settings [<xref ref-type="bibr" rid="pgen.1008009.ref036">36</xref>–<xref ref-type="bibr" rid="pgen.1008009.ref040">40</xref>]. We simulated “Case/Control” studies of a relatively rare disease, with population prevalence 20%, by ascertaining a 50/50 case/control dataset (<xref ref-type="supplementary-material" rid="pgen.1008009.s009">S8 Fig</xref>). Little changed qualitatively, though all methods, even the oracle, had slight FPR inflation for large <italic>N</italic>. This modest level of inflation is expected because the ascertainment process violates the interaction regression model [<xref ref-type="bibr" rid="pgen.1008009.ref041">41</xref>].</p>
<p>Third, we examined the robustness of MFMR to covariate/phenotype misclassification. Running MFMR requires specifying whether each available variable is a trait or a covariate (though SNPs are always covariates because of Mendelian randomization, and all the covariates in our simulation are SNPs). Intuitively, subtypes are clusters of covariate-adjusted traits. Variables that confound subtype structure, then, should included as covariates, while variables that may have different distributions between subtypes should be included as traits. Nonetheless, this distinction can be murky in practice, and so we perform simulations where we treat a covariate like a trait or vice versa. MFMR remained calibrated when swapping traits and covariates, unlike GMM, suggesting exact covariate/trait specification is not essential for valid inference with MFMR. However, MFMR did lose power, emphasizing the statistical utility derived from properly modelling the distinction between covariates and traits (<xref ref-type="supplementary-material" rid="pgen.1008009.s010">S9 Fig</xref>).</p>
<p>Fourth, we studied the impact of SNP-subtype correlation (Supplementary Section 3.2), which is a known source of bias in genetic interaction tests [<xref ref-type="bibr" rid="pgen.1008009.ref042">42</xref>]. We found that power held roughly constant for all methods as the G-E correlation increased from 0 to 1, but FPR did increase for all methods, including the oracle (<xref ref-type="supplementary-material" rid="pgen.1008009.s003">S2f Fig</xref>). Nonetheless, the MFMR inflation is modest–always less than 3-fold–and MFMR was no more inflated than the oracle. Altogether, this simulation does recapitulate known biases from G-E correlation, but it does not suggest that RGWAS is more susceptible to these biases than standard tests for genetic interaction.</p>
<p>Finally, and most importantly, we examined the robustness of the clustering methods to population structure, which is routinely the primary confounder in genetic studies. We simulated a 50/50 mixture of two populations and 10,000 SNPs from a Balding-Nichols model with <italic>F</italic><sub><italic>ST</italic></sub> = .1 (Supplementary Section 3.3). We repeated our simulations using 12 randomly selected SNPs (out of the 10,000) and adding population main effects of varying strength. For MFMR and the oracle, we condition on three genetic PCs and their interactions with <italic>z</italic> in the step 2 tests. MFMR remains calibrated and powerful while CCA and GMM suffer substantial FPR inflation, even for completely null SNPs (<xref ref-type="supplementary-material" rid="pgen.1008009.s009">S8 Fig</xref>). Using PCs in step 2 largely addresses the inflation from using GMM in step 1, but only when subtype structure is stronger than population structure; otherwise, the inferred GMM subtypes are non-trivially confounded by population structure. This is important because population structure is often stronger than subtype structure in reality, especially in multi-ethnic datasets, and because GMM produces false positives when subtypes are completely absent. Altogether, successful genetic subtype inference requires population structure adjustment both when inferring subtypes in step 1 and when testing their genetic significance in step 2.</p>
</sec>
</sec>
<sec id="sec005">
<title>Positive control: A known major depression subtype</title>
<p>The results over the simulated datasets showed that RGWAS was powerful and calibrated across a wide range of parameter settings. To see if RGWAS could perform well in a real setting, we used CONVERGE [<xref ref-type="bibr" rid="pgen.1008009.ref043">43</xref>], a major depression (MD) cohort with a recently discovered, genetically heterogeneous “Stress” subtype [<xref ref-type="bibr" rid="pgen.1008009.ref044">44</xref>]. This serves as a positive control for genetic subtype discovery. In addition to having a known subtype, CONVERGE is ideally suited to RGWAS analysis because it recruited a large number (<italic>N</italic> = 9, 303) of deeply phenotyped (31 binary and 10 quantitative traits) Han Chinese women with recurrent MD and matched controls. Cases were carefully ascertained to minimize environmental heterogeneity, comparatively amplifying signals for biological heterogeneity. RGWAS analysis is also compelling because only a small number of genetic associations with MD have been found to date–consistent with the existence of genetically distinct disease subtypes–and there are few known genetic interactions in complex human traits.</p>
<p>The inferred MFMR subtypes (RGWAS step 1) with <italic>K</italic> = 2 are summarized in <xref ref-type="fig" rid="pgen.1008009.g002">Fig 2</xref>. We conditioned on age and ten genetic PCs as covariates, and we jointly imputed the covariates and traits (<xref ref-type="sec" rid="sec011">Methods</xref>). The MFMR method split the individuals into subtypes that distinguish the aggregate lifetime adversity measure “Stress”, which recovers the subtype chosen by domain experts [<xref ref-type="bibr" rid="pgen.1008009.ref044">44</xref>]. While “Stress” is an obvious contributor to MD risk, there is no reason to expect MFMR would identify this as the key factor given we are studying a large number explicitly MD-relevant traits. Indeed, GMM did not split along this trait (squared correlation with “Stress” is .01), demonstrating “Stress” is not a trivially obvious subtype. The GMM clusters were not examined further as they have high FPR in simulations.</p>
<fig id="pgen.1008009.g002" orientation="portrait" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008009.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Genetic heterogeneity in the CONVERGE major depression dataset.</title>
<p>Quantitative trait 90% inter-quantile ranges (a) and binary trait prevalences (b) are shown for each subtype. (c) Per-subtype odds ratios (±2 s.e.) for two SNPs discovered by (homogeneous) GWAS [<xref ref-type="bibr" rid="pgen.1008009.ref043">43</xref>] (left) and three SNPs discovered using known subtypes [<xref ref-type="bibr" rid="pgen.1008009.ref044">44</xref>] (right).</p>
</caption>
<graphic xlink:href="pgen.1008009.g002"></graphic>
</fig>
<p>We tested five SNPs for effect heterogeneity (RGWAS step 2) across subtypes (<xref ref-type="fig" rid="pgen.1008009.g002">Fig 2c</xref>) with our standard SNP-subtype interaction test. The first two SNPs (rs35936514 and rs12415800) were discovered in the initial GWAS [<xref ref-type="bibr" rid="pgen.1008009.ref043">43</xref>] and we use as negative controls for heterogeneity. For positive controls, we use three SNPs (rs7526682, rs11577545, and rs950893) that we recently found to interact with “Stress” [<xref ref-type="bibr" rid="pgen.1008009.ref044">44</xref>]. As expected, the homogeneous SNPs are nearly genome-wide significant, and RGWAS successfully determines which of the five SNPs are heterogeneous. Note that the heterogeneous SNPs show only modest homogeneous signal because they essentially have no effect in the “Stress” subtype. In previous work, we established that these subtypes have differential polygenic architecture using linear mixed models (<italic>p</italic> = .038); we also found suggestive polygenic score interaction and suggestive differences in the respective heritability estimates per subtype [<xref ref-type="bibr" rid="pgen.1008009.ref044">44</xref>], further supporting the genetic distinction between “Stress” subtypes of MD.</p>
<p>We chose <italic>K</italic> = 2 using prior knowledge that MD can be split by (binary) “Stress”. We assessed this empirically by evaluating the MFMR likelihood on held-out data, which supported <italic>K</italic> &gt; 1 subtypes (<xref ref-type="supplementary-material" rid="pgen.1008009.s011">S10 Fig</xref>). <italic>K</italic> = 3 creates an MD-only subtype, so we do not pursue <italic>K</italic> ≥ 3.</p>
</sec>
<sec id="sec006">
<title>New metabolic subtypes with genetic and pragmatic significance</title>
<p>We next applied MFMR (RGWAS step 1) to metabolic traits measured in METSIM [<xref ref-type="bibr" rid="pgen.1008009.ref045">45</xref>]. By combining genetic, environmental, metabolomic, and disease measurements, METSIM enables tracing the pathway from risk factors to metabolic consequences to altered disease risk. We studied 6,248 unrelated Finnish men. We used three binary traits: 854 samples had T2D, 3,526 had pre-diabetes (preT2D), and 541 had coronary heart disease (CHD); we excluded 15 samples with T1D. We used 13 broad quantitative traits and 228 nuclear magnetic resonance (NMR) metabolite measurements. We projected the NMR traits onto their top 6 PCs (capturing 77% of variance), which is a standard way to ease computation while retaining most of the information in the raw NMR traits. As covariates, we used three genetic PCs, age, age<sup>2</sup>, and smoking, alcohol, statin, diuretic, and beta-blocker use.</p>
<p>We study <italic>K</italic> = 3 to compromise between parsimony and the cross-validated log-likelihood, which broadly supports 1 &lt; <italic>K</italic> ≤ 7 (<xref ref-type="supplementary-material" rid="pgen.1008009.s011">S10 Fig</xref>). To test robustness to perturbations of the data, we used five-fold cross-validation. We found that 99.6% of originally co-clustered pairs (i.e. same likeliest subtype) remained together, showing that people from the same training population can be accurately assigned to existing subtypes.</p>
<p>The three inferred metabolic subtypes are summarized in <xref ref-type="fig" rid="pgen.1008009.g003">Fig 3</xref>. They primarily distinguish the metabolomic PCs, which are aggregates of 228 NMR traits. To elucidate the subtypes, we fit logistic regressions on the raw NMR traits, conditional on statin, and studied those with nominal <italic>p</italic> &lt; .01 (despite [<xref ref-type="bibr" rid="pgen.1008009.ref028">28</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref030">30</xref>], these <italic>p</italic>-values are not calibrated). We first compared the large blue group to the combined orange and green groups, which suggested the blue group had less-esterified cholesterol in small HDL and higher histidine and relative amounts of omega-3 fatty acid. Next, comparing orange to green indicated orange had more free but less esterified overall cholesterol, especially in large LDL, and that orange has higher polyunsaturated fats and phenylalanine.</p>
<fig id="pgen.1008009.g003" orientation="portrait" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008009.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Three inferred metabolic subtypes in METSIM.</title>
<p>(a) Quantitative and (b) binary distributions for covariates (grey labels, left) and traits (black labels, right). (c) Subtype sizes.</p>
</caption>
<graphic xlink:href="pgen.1008009.g003"></graphic>
</fig>
<sec id="sec007">
<title>SNP level metabolic heterogeneity</title>
<p>We next sought to evaluate the subtypes for evidence of SNP effect heterogeneity on metabolic phenotypes (RGWAS step 2). However, with ∼6,000 samples, we do not have power for genome-wide heterogeneity tests. Instead, we test known metabolic GWAS SNPs–68 from T2D and 13 from CHD (<xref ref-type="sec" rid="sec011">Methods</xref>). We found four heterogeneous SNP-trait associations at <italic>p</italic> = .05/81 (<xref ref-type="fig" rid="pgen.1008009.g004">Fig 4</xref>). The orange and green effect estimates had opposite sign for 2/4, and all blue estimates were near zero. This suggests that the blue group is a type of baseline and that partially overlapping biological pathways are specifically activated in the smaller groups.</p>
<fig id="pgen.1008009.g004" orientation="portrait" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008009.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Metabolic subtype-specific SNP effects across the 16 traits used for subtyping.</title>
<p>Subtype-specific effect estimates are shown ± 2 s.e. for significantly heterogeneous SNPs out of 81 known metabolic SNPs (<italic>p</italic> = .05/81).</p>
</caption>
<graphic xlink:href="pgen.1008009.g004"></graphic>
</fig>
<p>These SNPs have several known metabolic interactions, providing additional evidence that the subtypes are meaningful. rs10401969 is a splice variant for <italic>SUGP1</italic> that affects downstream splicing in the gene targeted by statins, <italic>HMGCR</italic> [<xref ref-type="bibr" rid="pgen.1008009.ref046">46</xref>]; it also interacts with an APOE SNP on fenofibrate response [<xref ref-type="bibr" rid="pgen.1008009.ref047">47</xref>]. rs7138803 interacts with exercise for obesity [<xref ref-type="bibr" rid="pgen.1008009.ref048">48</xref>] and features in an obesity score interacting with diet [<xref ref-type="bibr" rid="pgen.1008009.ref049">49</xref>]. rs780094 interacts with another SNP for fasting glucose [<xref ref-type="bibr" rid="pgen.1008009.ref050">50</xref>], suggestively interacts with diet [<xref ref-type="bibr" rid="pgen.1008009.ref051">51</xref>], and is one of three SNPs in a risk score interacting with postprandial and post-fenofibrate cholesterol [<xref ref-type="bibr" rid="pgen.1008009.ref052">52</xref>].</p>
<p>We additionally performed heterogeneity tests of these 81 SNPs directly over the 228 raw NMR phenotypes we used to construct the NMR PCs. We found 33 further SNP-trait interactions at <italic>p</italic> = .05/81 (<xref ref-type="supplementary-material" rid="pgen.1008009.s012">S11 Fig</xref>). This included interactions between rs7138803 and 8 VLDL traits and insulin; rs7528419 and 16 VLDL traits and HDL; and rs780094 and triglyceride proportion in large VLDL. These results add confidence and interpretability to the interactions we discovered for NMR PCs 3 and 6. Further, we discovered 5 additional SNPs, not significantly heterogeneously associated with our 16 primary traits, including rs10885122 (interacting with medium HDL phospholipid percentage and HDL-3), rs1387153 (phospholid percentage in large and extra large VLDL), and rs6903956 (HDL).</p>
<p>To show an example of the utility of identifying subtypes, we performed a genome-wide interaction scan with the global, <italic>K</italic> df test [<xref ref-type="bibr" rid="pgen.1008009.ref053">53</xref>]. This “GxE GWAS” test does not establish SNP heterogeneity, but it can increase power over ordinary GWAS when heterogeneity exists. GxE GWAS and GWAS give largely consistent results (<xref ref-type="table" rid="pgen.1008009.t001">Table 1</xref>, <xref ref-type="supplementary-material" rid="pgen.1008009.s013">S12 Fig</xref>), as expected because the homogeneous and global tests are not independent. Nonetheless, GxE GWAS is a valuable complement to GWAS as it discovers 10 additional loci (though GxE GWAS misses 19/60 GWAS loci).</p>
<table-wrap id="pgen.1008009.t001" orientation="portrait" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008009.t001</object-id>
<label>Table 1</label>
<caption>
<title>Number of genome-wide significant loci for GWAS and GxE GWAS.</title>
<p>Shared describes the number of loci that are significant in both the GWAS and GxE GWAS for the same trait (<italic>r</italic><sup>2</sup> &lt; .2), while GWAS and GxE GWAS describe the loci unique to that association scan. No loci were found for CHD, insulin, or WHR. Both approaches found a single preT2D locus. We excluded NMR PC 5 because of GxE GWAS inflation.</p>
</caption>
<alternatives>
<graphic id="pgen.1008009.t001g" xlink:href="pgen.1008009.t001"></graphic>
<table border="0" frame="box" rules="all">
<colgroup span="1">
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
<col align="left" span="1" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" colspan="1" rowspan="1"></th>
<th align="center" colspan="1" rowspan="1">Gluc</th>
<th align="center" colspan="1" rowspan="1">BMI</th>
<th align="center" colspan="1" rowspan="1">LDL</th>
<th align="center" colspan="1" rowspan="1">HDL</th>
<th align="center" colspan="1" rowspan="1">TG</th>
<th align="center" colspan="1" rowspan="1">PC 1</th>
<th align="center" colspan="1" rowspan="1">PC 2</th>
<th align="center" colspan="1" rowspan="1">PC 3</th>
<th align="center" colspan="1" rowspan="1">PC 4</th>
<th align="center" colspan="1" rowspan="1">PC 6</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" colspan="1" rowspan="1">GWAS</td>
<td align="center" colspan="1" rowspan="1">1</td>
<td align="center" colspan="1" rowspan="1">0</td>
<td align="center" colspan="1" rowspan="1">3</td>
<td align="center" colspan="1" rowspan="1">2</td>
<td align="center" colspan="1" rowspan="1">6</td>
<td align="center" colspan="1" rowspan="1">5</td>
<td align="center" colspan="1" rowspan="1">2</td>
<td align="center" colspan="1" rowspan="1">0</td>
<td align="center" colspan="1" rowspan="1">3</td>
<td align="center" colspan="1" rowspan="1">4</td>
</tr>
<tr>
<td align="center" colspan="1" rowspan="1">GxE GWAS</td>
<td align="center" colspan="1" rowspan="1">2</td>
<td align="center" colspan="1" rowspan="1">1</td>
<td align="center" colspan="1" rowspan="1">2</td>
<td align="center" colspan="1" rowspan="1">1</td>
<td align="center" colspan="1" rowspan="1">2</td>
<td align="center" colspan="1" rowspan="1">1</td>
<td align="center" colspan="1" rowspan="1">3</td>
<td align="center" colspan="1" rowspan="1">1</td>
<td align="center" colspan="1" rowspan="1">1</td>
<td align="center" colspan="1" rowspan="1">1</td>
</tr>
<tr>
<td align="center" colspan="1" rowspan="1">Shared</td>
<td align="center" colspan="1" rowspan="1">2</td>
<td align="center" colspan="1" rowspan="1">0</td>
<td align="center" colspan="1" rowspan="1">5</td>
<td align="center" colspan="1" rowspan="1">5</td>
<td align="center" colspan="1" rowspan="1">3</td>
<td align="center" colspan="1" rowspan="1">1</td>
<td align="center" colspan="1" rowspan="1">2</td>
<td align="center" colspan="1" rowspan="1">0</td>
<td align="center" colspan="1" rowspan="1">3</td>
<td align="center" colspan="1" rowspan="1">19</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>To mimic prior approaches, we performed a covariate-unaware GxE GWAS by using GMM subtypes (in step 1) and by excluding covariates from the heterogeneity tests (in step 2). Genome-wide tests were highly inflated for <italic>K</italic> ∈ {2, 3, 4}, usually obtaining effectively infinite λ<sub><italic>GC</italic></sub> (<xref ref-type="supplementary-material" rid="pgen.1008009.s015">S1 Table</xref>). Notably, λ<sub><italic>GC</italic></sub> was even inflated for the binary traits, which were excluded from the clustering in step 1 in order for GMM to converge, emphasizing the subtlety and breadth of overfitting concerns in two-step testing. This inflation can easily be mistaken for strong, ubiquitous signal when evaluating only candidate SNPs, which is common in computational subtyping papers. The RGWAS λ<sub><italic>GC</italic></sub> (using MFMR in step 1 and covariate-aware tests in step 2) were comparatively modest, with a maximum of 1.33 (after excluding NMR PC 5, with λ<sub><italic>GC</italic></sub> = 1.83). Despite this modest inflation for some traits–which can be readily detected, and avoided, by evaluating λ<sub><italic>GC</italic></sub>–RGWAS results are usable, unlike the covariate-unaware results that mimic existing approaches. Similar conclusions hold for the global, <italic>K</italic> df test.</p>
</sec>
<sec id="sec008">
<title>Polygenic metabolic heterogeneity</title>
<p>Identification of heterogeneous effects at individual SNPs provides both evidence of differential causal effects between subtypes and the specific loci that distinguish them. To complement these results, we additionally employed a polygenic linear mixed model (LMM) test for genetic subtype heterogeneity (RGWAS step 2). Such polygenic approaches have greater power to detect genetic signal than SNP-level tests, but they do not identify individual causal loci.</p>
<p>Briefly, the polygenic model estimates both the ordinary heritability and the subtype-specific heritability, the latter aggregating all subtype-specific SNP effects. For example, when subtypes are two sexes, the subtype-specific heritability aggregates all SNP effects that are active only in one sex (and, more generally, SNP effects that differ between sexes). For non-sex linked traits, the resulting sex-specific heritability is zero, hence nonzero subtype-specific heritability demonstrates the existence of subtype-specific genetic effects.</p>
<p>We fit the subtype specific LMM with IID GxEMM [<xref ref-type="bibr" rid="pgen.1008009.ref035">35</xref>], which is a simple extension of a previous LMM for GxE [<xref ref-type="bibr" rid="pgen.1008009.ref054">54</xref>] that accommodates probabilistic subtype membership. This is important because hard-assignment of individuals to subtypes discards information and fails to propagate step 1 subtyping uncertainty to step 2 subtype testing. We use the covariates used in our MFMR decomposition as fixed effects, as well as their interactions with subtype status [<xref ref-type="bibr" rid="pgen.1008009.ref055">55</xref>]. We calculate variance explained after residualizing fixed effects [<xref ref-type="bibr" rid="pgen.1008009.ref056">56</xref>]. We test for <inline-formula id="pgen.1008009.e001"><alternatives><graphic id="pgen.1008009.e001g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e001.jpg"></graphic><mml:math id="M1"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> with a Wald test, and we test for <inline-formula id="pgen.1008009.e002"><alternatives><graphic id="pgen.1008009.e002g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e002.jpg"></graphic><mml:math id="M2"><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> with an LRT. For T2D, we exclude people with preT2D; for preT2D, we exclude people with T2D.</p>
<p>We report estimates for binary traits on the observed scale as there is no commonly accepted approach for rescaling heterogeneous heritability estimates to a liability scale. Similarly, we do not report p-values for these binary traits, to be maximally conservative. Nonetheless, we do observe that IID GxEMM increases the estimated heritability for preT2D and CHD, which is consistent with the existence of subtype-specific heritability.</p>
<p>We found significant subtype-specific heritability for 4 of the 13 quantitative traits used in the MFMR decomposition (<italic>p</italic> &lt; .01/13, <xref ref-type="fig" rid="pgen.1008009.g005">Fig 5</xref>, left), giving strong evidence that our inferred subtypes tag meaningfully distinct biology. On average, these subtype-aware heritability estimates are 30.2%, compared to 20.7% for ordinary heritability estimates (<xref ref-type="supplementary-material" rid="pgen.1008009.s014">S13 Fig</xref>). This shows that subtypes can mask substantial heritability across an array of traits. Intuitively, this increase in heritability derives from allowing subtype-specific effects that are ignored by homogeneous heritability: in the sex example, a SNP with exactly opposite effects in males and females has zero net contribution to homogeneous heritability, but it clearly contributes to the broader notion of subtype-specific heritability.</p>
<fig id="pgen.1008009.g005" orientation="portrait" position="float">
<object-id pub-id-type="doi">10.1371/journal.pgen.1008009.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Polygenic heterogeneity in the inferred metabolic subtypes.</title>
<p>Left: Point estimates ± 2 s.e. for traits used in MFMR clustering. Right: Across-trait estimate distribution for all 228 raw NMR traits. <inline-formula id="pgen.1008009.e003"><alternatives><graphic id="pgen.1008009.e003g" xlink:href="pgen.1008009.e003"></graphic><mml:math id="M3"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is the standard heritability estimate from GREML [<xref ref-type="bibr" rid="pgen.1008009.ref054">54</xref>]. <inline-formula id="pgen.1008009.e004"><alternatives><graphic id="pgen.1008009.e004g" xlink:href="pgen.1008009.e004"></graphic><mml:math id="M4"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1008009.e005"><alternatives><graphic id="pgen.1008009.e005g" xlink:href="pgen.1008009.e005"></graphic><mml:math id="M5"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> are the homogeneoues and subtype-specific heritability estimates from IID GxEMM, and <inline-formula id="pgen.1008009.e006"><alternatives><graphic id="pgen.1008009.e006g" xlink:href="pgen.1008009.e006"></graphic><mml:math id="M6"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> is the sum of <inline-formula id="pgen.1008009.e007"><alternatives><graphic id="pgen.1008009.e007g" xlink:href="pgen.1008009.e007"></graphic><mml:math id="M7"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1008009.e008"><alternatives><graphic id="pgen.1008009.e008g" xlink:href="pgen.1008009.e008"></graphic><mml:math id="M8"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
</caption>
<graphic xlink:href="pgen.1008009.g005"></graphic>
</fig>
<p>To expand to a larger set of traits and bolster confidence in widespread subtype-specific heritability, we repeated our IID GxEMM analysis on the 228 NMR traits (<xref ref-type="fig" rid="pgen.1008009.g005">Fig 5</xref>, right). We found significant subtype-specific heritability for 104 of the 228 NMR traits (<italic>p</italic> &lt; .01/228), dramatically increasing the number of significantly polygenically heterogeneous traits. On average, the subtype-aware heritability is 31.8% and the standard heritability is 17.5% (<xref ref-type="fig" rid="pgen.1008009.g005">Fig 5</xref>), which are qualitatively comparable to the average heritabilities from the 13 quantitative MFMR traits.</p>
</sec>
<sec id="sec009">
<title>Pragmatic metabolic heterogeneity</title>
<p>While identifying genetic heterogeneity is important for showing that subtypes have differential causal biology, identifying nongenetic sources of subtype heterogeneity can be pragmatically important. We tested for statin effect heterogeneity to assess the ability of the metabolic subtypes to differentiate medical intervention effects. Using our standard interaction test with <italic>K</italic> = 3 (<xref ref-type="sec" rid="sec011">Methods</xref>), only glucose had significant statin heterogeneity at <italic>p</italic> = 0.05/16 (<italic>p</italic> = 1.19 × 10<sup>−4</sup>). There is no obvious FPR inflation as statin has no other significantly heterogeneous effects across other traits (<xref ref-type="supplementary-material" rid="pgen.1008009.s016">S2 Table</xref>). These results held after conditioning on T2D as a heterogeneous covariate in our step 2 test (statin-glucose interaction <italic>p</italic> = 2.95 × 10<sup>−6</sup>). Statin effect heterogeneity is further supported by tests with <italic>K</italic> = 4 (T2D-adjusted heterogeneity <italic>p</italic> = 9.67 × 10<sup>−7</sup>); for <italic>K</italic> = 2, however, the test is insignificant (<italic>p</italic> = .39), providing further evidence that <italic>K</italic> = 2 gives insufficient subtype resolution.</p>
<p>We next estimated the subtype-specific statin effects with our primary metabolic subtypes (derived treating statin as heterogeneous inside MFMR). We performed a heterogeneous linear regression on glucose conditional on our standard covariates and T2D, which indicated that statin increases blood sugar in most people–consistent with [<xref ref-type="bibr" rid="pgen.1008009.ref032">32</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref033">33</xref>]–but also that it may decrease glucose in the smaller, higher-risk orange and green groups.</p>
<p>Since METSIM measured two time points, we next tested the pragmatic ability of our baseline subtypes to predict conversion from preT2D to T2D. We fit logistic regression on time 2 T2D status for the 1,924 baseline prediabetics with time 2 data. Subtypes significantly predicted T2D conversion (<italic>p</italic> = 0.0036), with orange and green converting less often than blue, which remained after conditioning on our standard covariates (<italic>p</italic> = .031). This also demonstrates the subtypes persist at least partially over time, in contrast to prior, directly age-dependent T2D subtypes [<xref ref-type="bibr" rid="pgen.1008009.ref057">57</xref>].</p>
</sec>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>In a purely <italic>descriptive</italic> sense, inferring subtypes is easy: applying any clustering algorithm to any data produces subgroups. But existing methods cannot go beyond such descriptions because they are liable to downstream FPR inflation. By contrast, RGWAS is calibrated in simulation, recovers known MD subtypes, and produces <italic>biologically</italic> and <italic>pragmatically</italic> validated metabolic subtypes. RGWAS handles covariates, mixed binary and quantitative traits, and residual trait correlations.</p>
<p>There are several limitations to RGWAS. First, like other two step methods, RGWAS fails to propagate first-step uncertainty. Similarly, although we do not imagine there is a “true” <italic>K</italic>, more can always be done to better choose <italic>K</italic>. Also, while we have tested a variety of simple decompositions to learn subtypes, others may perform better, especially where domain-specific tools exist. In particular, MFMR is conceptually similar to a matrix factorization/depth-two linear network, suggesting inner layers of appropriate neural networks may define useful subtypes.</p>
<p>There are also specific limitations to our inferred stress subtypes in CONVERGE. First, our stress measurements were retrospective and self-reported, hence they may be biased by MD status. Second, our analysis was not entirely without domain supervision because we included the aggregate trait “Stress” that was previously manually constructed [<xref ref-type="bibr" rid="pgen.1008009.ref044">44</xref>]. Nonetheless, RGWAS identified the key trait amongst dozens, unlike GMM, and our METSIM analysis demonstrates that RGWAS can be useful without any domain guidance.</p>
<p>The statin effect heterogeneity on glucose we found is consistent with previously reported interactions between statin and age [<xref ref-type="bibr" rid="pgen.1008009.ref032">32</xref>] and genetically predicted LDL [<xref ref-type="bibr" rid="pgen.1008009.ref034">34</xref>] on T2D, and also fenofibrate’s interaction with lipid levels on cardiovascular risk [<xref ref-type="bibr" rid="pgen.1008009.ref058">58</xref>]. By contrast, large meta-analyses did not find inter-study statin heterogeneity [<xref ref-type="bibr" rid="pgen.1008009.ref032">32</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref033">33</xref>]. This suggests that statin heterogeneity largely exists within, rather than between, datasets. In the future it will be important to more precisely characterize the causal mechanism underlying statin heterogeneity. Although we expect such a mechanism to broadly replicate, the same is not necessarily true for our specific subtypes, especially as they rely on phenotypic PCs which are dataset-specific.</p>
<p>MFMR is only a first step toward genetic subtyping, and there are many possible extensions. Sparsifying penalties can be incorporated by replacing CM steps with calls to third-party software and could extend MFMR to higher-dimensional traits and covariates. A random-effect version of MFMR could improve power to detect polygenic subtypes, though computational issues are non-trivial. MFMR could also be adapted to count data, zero-inflation, higher-order arrays, or missing data. Theoretically, it would be interesting to let subtypes vary between traits, which MFMR can capture only non-parsimoniously by choosing large <italic>K</italic>. Instead of an i.i.d. prior on <italic>z</italic>, MFMR could model <italic>z</italic> with a multinomial logistic regression to estimate, test, and correct for effects on <italic>z</italic>, which can be directly interesting [<xref ref-type="bibr" rid="pgen.1008009.ref059">59</xref>]; this can also be important for correcting bias from G-E correlation [<xref ref-type="bibr" rid="pgen.1008009.ref042">42</xref>]. Or, instead, we could use a continuous prior on <italic>z</italic> with a factor analysis model [<xref ref-type="bibr" rid="pgen.1008009.ref023">23</xref>]. (We note, however, that RGWAS copes reasonably well with modest G-E correlation and continuous <italic>z</italic> in our simulations.) Finally, MFMR could be applied only within diseased individuals to directly define subtypes of disease, though this requires fundamentally different step 2 tests (c.f. [<xref ref-type="bibr" rid="pgen.1008009.ref060">60</xref>]).</p>
<p>Our polygenic approach to subtype validation with GxEMM provides a much needed power advantage over SNP-level heterogeneity tests at the cost of resolution; conceptually, polygenic risk score tests lie between [<xref ref-type="bibr" rid="pgen.1008009.ref061">61</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref062">62</xref>]. But SNP-level precision is not needed to meet our criterion for biologically meaningful subtypes, making GxEMM invaluable for subtype validation. Nonetheless, there are many limitations to our approach that we will address in future work. First, GxEMM can confuse non-linear effects for heterogeneity. Similar issues arise in generalized linear models, where the existence of effect heterogeneity depends on the choice of link function. Some forms of non-linearity can be accommodated [<xref ref-type="bibr" rid="pgen.1008009.ref063">63</xref>], including ascertained case/control data where cases are over-sampled from the population [<xref ref-type="bibr" rid="pgen.1008009.ref036">36</xref>–<xref ref-type="bibr" rid="pgen.1008009.ref040">40</xref>]; we are working to extend these approaches to leverage subtype heterogeneity. Second, IID GxEMM assumes that each subtype has equal heritability and equal noise levels, which may not hold in practice for many meaningful subtypes. Several approaches exist to relax these assumptions to varying degrees [<xref ref-type="bibr" rid="pgen.1008009.ref035">35</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref064">64</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref065">65</xref>], which reduce bias, provide richer characterizations of subtypes, and will be important to pursue in future work. However, this increased generality comes with higher estimation error for individual parameters, and we consider the results presented in our paper conservative alternatives to these richer models.</p>
<p>Although we focused on fixed- and random-effect interaction tests to establish heterogeneity between subtypes in RGWAS step 2, it may also be useful to apply recent, complementary heterogeneity tests. For example, Subtest could be used to assess differences between <italic>K</italic> = 2 disease-only subtypes [<xref ref-type="bibr" rid="pgen.1008009.ref060">60</xref>]. For large <italic>K</italic>, on the other hand, StructLMM is a natural complement to GxEMM: the latter is more powerful because it uses genome-wide information and a richer GxE model, but the former has SNP-level resolution and scales to dramatically larger <italic>N</italic> and <italic>K</italic>. Similarly, large-<italic>K</italic> subtypes could be post-processed with hierarchical clustering and tested with TreeWAS [<xref ref-type="bibr" rid="pgen.1008009.ref062">62</xref>]. Broadly, any heterogeneity test can be used in the second step.</p>
<p>In the future, we will actively encourage MFMR to prioritize tissue-specific subtypes by incorporating tissue-specific genetic risk scores as heterogeneous covariates. This is particularly interesting for traits, including metabolic diseases [<xref ref-type="bibr" rid="pgen.1008009.ref015">15</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref066">66</xref>], that have disparate genetic risk factors acting through distinct cell types, tissues, or biological processes. Subtypes that differentiate biological modes of action at this systems-level would be more easily interpretable and useful for basic research and precision treatment. In larger datasets, it may also be interesting to evaluate subtype-specific enrichments in heritability explained per tissue or cell type [<xref ref-type="bibr" rid="pgen.1008009.ref067">67</xref>].</p>
<p>Finally, as MFMR seeks clusters that are unaffected by confounders like population structure, age, or sex, it may be useful for clustering in settings where protecting certain information is important for privacy or fairness [<xref ref-type="bibr" rid="pgen.1008009.ref068">68</xref>]. In this sense, MFMR is to GMM roughly as AC-PCA [<xref ref-type="bibr" rid="pgen.1008009.ref069">69</xref>] or contrastive PCA [<xref ref-type="bibr" rid="pgen.1008009.ref070">70</xref>] are to ordinary PCA.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec012">
<title>Ethics statement</title>
<p>CONVERGE: The study protocol was approved centrally by the Ethical Review Board of Oxford University (Oxford Tropical Research Ethics Committee) and the ethics committees of all participating hospitals in China. All participants provided written informed consent.</p>
<p>METSIM: The Ethics Committee of the University of Eastern Finland and Kuopio University Hospital approved the METSIM study, and this study was conducted in accordance with the Helsinki Declaration. All participants provided written informed consent.</p>
</sec>
<sec id="sec013">
<title>RGWAS step 1: Clustering with MFMR to find subtypes</title>
<p>Reverse GWAS first clusters samples into subtypes (step 1) and then tests for covariate effect heterogeneity between subtypes (step 2). RGWAS always uses MFMR in step 1. Step 2 always features interaction tests between subtype membership and focal covariates, which may be non-genetic, a SNP, or all SNPs in the genome.</p>
<p>We derive a novel clustering algorithm, multitrait finite mixture of regressions (MFMR), beginning from the standard regression model for interaction. Assuming a single quantitative trait <italic>y</italic>, covariates <italic>X</italic>, discrete subtypes <italic>z</italic>, and a focal covariate <italic>g</italic> putatively interacting with <italic>z</italic>, our model is:
<disp-formula id="pgen.1008009.e009"><alternatives><graphic id="pgen.1008009.e009g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e009.jpg"></graphic><mml:math id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>β</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula>
<italic>X</italic><sub><italic>i</italic></sub>, is a vector of <italic>Q</italic> control covariates, like genetic PCs or sex, with homogeneous effect sizes <italic>α</italic>. <italic>z</italic><sub><italic>i</italic></sub> ∈ {1, …, <italic>K</italic>} is a <italic>K</italic>-level factor specifying the subtype for individual <italic>i</italic>, and <italic>γ</italic><sub><italic>k</italic></sub> are the subtype main effects. <italic>β</italic> is the vector of subtype-specific <italic>g</italic> effect sizes. We say <italic>g</italic> is homogeneous if <italic>β</italic><sub>1</sub> = … = <italic>β</italic><sub><italic>K</italic></sub>; otherwise, <italic>g</italic> is heterogeneous. We assume <italic>ϵ</italic> is i.i.d. Gaussian with mean zero.</p>
<p>Our full MFMR model generalizes (<xref ref-type="disp-formula" rid="pgen.1008009.e009">1</xref>) in several complementary directions. First, we learn the subtypes (<italic>z</italic>) rather than assume they are known (giving a Finite Mixture of Regressions, FMR) by assuming <italic>z</italic><sub><italic>i</italic></sub> are i.i.d. Categorical:
<disp-formula id="pgen.1008009.e010"><alternatives><graphic id="pgen.1008009.e010g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e010.jpg"></graphic><mml:math id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>|</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mspace width="4pt"></mml:mspace><mml:mspace width="4.pt"></mml:mspace><mml:mtext>for</mml:mtext><mml:mspace width="4.pt"></mml:mspace><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula></p>
<p>Second, we generalize the single trait <italic>y</italic> to a matrix <italic>Y</italic> of Multiple traits (MFMR), which adds power for subtypes that affect the distribution of many traits. This power is important in practice because genetic interactions are often weak but phenotypic relationships are often strong. We also generalize the single heterogeneous covariate <italic>g</italic> to a matrix <italic>G</italic> of multiple covariates, which adds power when there are many heterogeneous effects.</p>
<p>Finally, we model binary traits with probit link functions to mitigate the spurious local modes that plague methods like <italic>k</italic>-means. For example, this issue led others to discard roughly half their data <italic>post hoc</italic> [<xref ref-type="bibr" rid="pgen.1008009.ref031">31</xref>]. The full multi-trait probit model is computationally prohibitive even for modest <italic>B</italic>, which we address with a novel conditional independence assumption. This induces constraints in our optimization which we solve analytically with block matrix identities (Supplementary Section 2.3).</p>
<p>Computationally, we fit MFMR with an Expectation Conditional-Maximization (ECM) algorithm. Our ECM generalizes standard EM for Gaussian Mixture Models. Both iterate between <italic>z</italic> updates in E-steps and parameter updates (e.g. <italic>α</italic> and <italic>β</italic>) in (C)M steps.</p>
<p>When fitting MFMR in step 1, a covariate that will be tested for heterogeneity in step 2 can either be ignored (MFMRX), included in <italic>X</italic> (MFMR, our default), or included in <italic>G</italic> (MFMR+). In Gaussian mixture models, covariates can only be ignored (GMM) or added as traits (GMM+) [<xref ref-type="bibr" rid="pgen.1008009.ref031">31</xref>]. MFMR+ and GMM+ overfit in simulations, inflating the FPR; conversely, MFMRX and GMM underfit homogeneous covariates, which also inflates FPR (<xref ref-type="supplementary-material" rid="pgen.1008009.s005">S4 Fig</xref>). MFMR strikes a balance: the homogeneous effect is adjusted but subtypes are not tuned to the heterogeneous effect. This resembles a score test as the alternate is tested by evaluating only the null. Nonetheless, small-effect covariates, like SNPs, can be safely ignored within MFMR, enabling genome-wide testing with MFMRX [<xref ref-type="bibr" rid="pgen.1008009.ref071">71</xref>]. For simplicity, we refer only to MFMR throughout our paper, but we use the MFMRX test for real human SNPs (in CONVERGE and METSIM, but not the simulations) as they likely have negligible effects; however, we use the MFMR test for statin in the main text because it has large metabolic effects.</p>
<p>We note that MFMR generalizes several well-known models. If binary traits and <italic>X</italic> are excluded and the covariates <italic>G</italic> are reduced to an intercept, MFMR becomes GMM. When <italic>P</italic> = 1 and <italic>z</italic> is known, MFMR becomes a standard gene-environment interaction (GxE) model with discrete environments/subtypes. Finally, if <italic>P</italic> = 1 and <italic>β</italic><sub><italic>k</italic></sub> = <italic>β</italic><sub>0</sub> for all <italic>k</italic>, MFMR reduces to linear/probit regression.</p>
</sec>
<sec id="sec014">
<title>RGWAS step 2: Calibrated tests to validate subtypes</title>
<p>For simplicity, we assume there are <italic>K</italic> = 2 subtypes and just one interacting covariate, <italic>g</italic>. These assumptions mean the output from step 1 is just a vector <italic>z</italic>, where <italic>z</italic><sub><italic>i</italic></sub> is the subtype 1 probability for sample <italic>i</italic>, and that the interaction model takes a simple form:
<disp-formula id="pgen.1008009.e011"><alternatives><graphic id="pgen.1008009.e011g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e011.jpg"></graphic><mml:math id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi><mml:mo>∼</mml:mo><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>z</mml:mi><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>g</mml:mi><mml:mo>*</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
<inline-formula id="pgen.1008009.e012"><alternatives><graphic id="pgen.1008009.e012g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e012.jpg"></graphic><mml:math id="M12"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> collects all background covariates, like genetic PCs, unlike existing subtype validation tests that largely ignore population structure [<xref ref-type="bibr" rid="pgen.1008009.ref024">24</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref026">26</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref029">29</xref>, <xref ref-type="bibr" rid="pgen.1008009.ref031">31</xref>]. * is element-wise multiplication, but it can easily be generalized to allow <italic>K</italic> &gt; 2 and a matrix <italic>G</italic> instead of a single covariate <italic>g</italic>.</p>
<p>We consider three tests for <italic>g</italic>: the homogeneity test for <italic>δ</italic> ≠ 0 given <italic>β</italic> = 0; the heterogeneity test for <italic>β</italic> ≠ 0 with free <italic>δ</italic>; and the global test for <italic>δ</italic>, <italic>β</italic> ≠ 0 [<xref ref-type="bibr" rid="pgen.1008009.ref053">53</xref>]. The homogeneity test has 1 degree of freedom (df), the heterogeneity test has <italic>K</italic> − 1 df, and the global test has <italic>K</italic> df. We focus on the heterogeneity test, which establishes that <italic>g</italic> has differential effects across subtypes and thus that the subtypes differ in causal biology (if <italic>g</italic> is genetic) or pragmatically (e.g. if <italic>g</italic> is a treatment). We also investigate the global test’s ability to increase power over the typical homogeneous test in the GxE GWAS analysis in <xref ref-type="table" rid="pgen.1008009.t001">Table 1</xref>. We assume <italic>ϵ</italic> is i.i.d and test with linear or logistic regression.</p>
<sec id="sec015">
<title>Polygenic step 2 tests</title>
<p>We also developed a polygenic version of the interaction test in (<xref ref-type="disp-formula" rid="pgen.1008009.e011">3</xref>) to jointly model and test <italic>δ</italic> and <italic>β</italic> across all SNPs with random effects. When there are no interaction effects, i.e. <italic>β</italic> = 0, this gives exactly the standard GREML approach to estimate heritability from genome-wide similarity across unrelated samples [<xref ref-type="bibr" rid="pgen.1008009.ref056">56</xref>]. GREML accomplishes this by modelling each SNP’s homogeneous effect, <italic>δ</italic>, as a small Gaussian variable, and then aggregating the size of each SNP’s <italic>δ</italic> across the genome to estimate the total genetic contribution to phenotypic variability, i.e. heritability.</p>
<p>Polygenic interaction models go further by also giving the interaction effect, <italic>β</italic>, a random effect distribution. As the homogeneous mixed model used in GREML aggregates the <italic>δ</italic> estimates across the genome to estimate homogeneoues heritability, the interaction mixed model aggregates the <italic>β</italic> estimates along the genome to estimate the heterogeneous heritability explained by subtype-/environment-specific genetic effects. The latter provides an estimate of subtype-specific heritability, which can be combined with the homogeneous heritability estimates to partition broad-sense heritability into shared- and subtype-specific components. This approach was pioneered for unrelated humans in [<xref ref-type="bibr" rid="pgen.1008009.ref054">54</xref>], but this model assumes that each sample is deterministically assigned to a single environment/subtype. Because our subtype assignments are probabilistic, we use GxEMM to fit subtype-specific heritabilities [<xref ref-type="bibr" rid="pgen.1008009.ref035">35</xref>], which accommodates arbitrary environmental covariates.</p>
<p>Polygenic interaction tests are essential for genetic subtyping at modest sample sizes because the test for nonzero subtype-specific heritability is much more powerful than testing individual SNPs in complex traits. Polygenic interactions can demonstrate that subtypes have partially distinct genetic bases even when power is too low to discover individual subtype-specific SNP effects.</p>
</sec>
</sec>
<sec id="sec016">
<title>Other approaches to infer subtypes</title>
<p>We develop a novel subtyping approach by applying CCA to <italic>G</italic> and the joint binary and quantitative phenotype matrix (<italic>Y</italic><sup><italic>b</italic></sup>: <italic>Y</italic>), each column-wise centered and scaled, and taking <italic>z</italic> to be the top phenotypic CC. CCA (and phenotypic PCA) defines <italic>z</italic> as a linear trait combination. We prove that this causes the interaction tests to have inflated FPR when a mixture of heterogeneous and homogeneous traits are studied (Supplementary Section 4), which is likely in practice. Nonetheless, sparse estimators can resolve this problem in some theoretical settings, and CCA is computationally efficient (<xref ref-type="supplementary-material" rid="pgen.1008009.s002">S1 Fig</xref>).</p>
<p>We also tested GMM, which models samples as draws from one of <italic>K</italic> multivariate Gaussians. We fit GMM to the quantitative traits with a standard EM algorithm [<xref ref-type="bibr" rid="pgen.1008009.ref072">72</xref>]; in early tests where binary traits were included, GMM often failed to converge, or converged to exactly coincide with one of the binary traits, even with multiple random restarts. We consider GMM similar, in the sense of covariate-unawareness, to <italic>k</italic>-means, which struggles even more with binary traits, and TDA, a proprietary package.</p>
<p>Most similar to MFMR, LIMMI aims to identify GxE with unknown E in gene expression [<xref ref-type="bibr" rid="pgen.1008009.ref023">23</xref>]. Beyond many technical differences, LIMMI and MFMR are built for disjoint scenarios: MFMR only fits tens of traits, but LIMMI only fits hundreds of samples, preventing its use in our setting.</p>
</sec>
<sec id="sec017">
<title>METSIM dataset</title>
<p>We selected metabolically relevant SNPs by taking published GWAS SNPs for T2D or CHD. We used the 153 T2D SNPs in <xref ref-type="table" rid="pgen.1008009.t001">Table 1</xref> of [<xref ref-type="bibr" rid="pgen.1008009.ref073">73</xref>] as known T2D SNPs. We had genotyped 86 of these SNPs, which we reduced further to 68 roughly independent SNPs (<italic>r</italic><sup>2</sup> &lt; .1). We used the 65 CHD SNPs in <xref ref-type="supplementary-material" rid="pgen.1008009.s016">S2 Table</xref> of [<xref ref-type="bibr" rid="pgen.1008009.ref074">74</xref>] as known CHD SNPs, 13 of which we genotyped (all <italic>r</italic><sup>2</sup> &lt; .1). We filtered the original 10,070 person dataset so all pairwise kinships were below 0.05, as in [<xref ref-type="bibr" rid="pgen.1008009.ref056">56</xref>].</p>
</sec>
<sec id="sec018">
<title>Phenotype imputation</title>
<p>We imputed missing data before running MFMR in CONVERGE. We jointly imputed covariates and traits with a sample-wise i.i.d. Gaussian model (MVN-impute from [<xref ref-type="bibr" rid="pgen.1008009.ref075">75</xref>]). We thresholded imputed entries in <italic>Y</italic><sup><italic>b</italic></sup> to {0, 1} in order to retain the downstream logistic regression framework. By contrast, discarding samples with any missing data reduces sample size by roughly half and the known positive SNP interactions were no longer recovered.</p>
<p>We imputed METSIM similarly, including all 228 NMR traits at the imputation step. We used softImpute to accommodate the wide matrix [<xref ref-type="bibr" rid="pgen.1008009.ref076">76</xref>].</p>
<p>We note that complete-data analyses performed in similar contexts substantially reduce sample size, e.g. [<xref ref-type="bibr" rid="pgen.1008009.ref031">31</xref>] discard 39% of their samples.</p>
</sec>
<sec id="sec019">
<title>Code availability</title>
<p>RGWAS is implemented in the simple, free <monospace>rgwas</monospace> R package, available with a vignette at <ext-link ext-link-type="uri" xlink:href="https://github.com/andywdahl/rgwas">https://github.com/andywdahl/rgwas</ext-link>.</p>
<p>All summary data and code necessary to reproduce the main and supplementary figures and tables are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/andywdahl/rgwas-scripts">https://github.com/andywdahl/rgwas-scripts</ext-link>.</p>
</sec>
</sec>
<sec id="sec020" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material content-type="local-data" id="pgen.1008009.s001">
<label>S1 Text</label>
<caption>
<title>Supplementary note.</title>
<p>Full description of MFMR model and EM algorithm. Also includes full descriptions of simulations and proofs about PCA/CCA subtype estimators.</p>
<p>(PDF)</p>
</caption>
<media xlink:href="pgen.1008009.s001.pdf">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s002">
<label>S1 Fig</label>
<caption>
<title>Running time and subtype estimation accuracy in simulations.</title>
<p>Left: Average running times in main <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref> (excluding failed GMM runs). Right: Clustering accuracy for simulations without (‘Quantitative’, as in main <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref>) and with ascertainment (‘Case/Control’, as in <xref ref-type="supplementary-material" rid="pgen.1008009.s003">S2 Fig</xref>). We measure accuracy with adjusted Rand index, which varies from 0 (random guessing) to 1 (exact match). We compute the index only across pairs from a random 300 subsamples, reducing computation roughly ≈ 10<sup>5</sup>-fold when <italic>N</italic> = 100, 000. Accuracies are estimated for roughly 300 simulations per point in the plot. MFMR+ is shown for simplicity because MFMR gives different clusters per tested SNP.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s002.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s003">
<label>S2 Fig</label>
<caption>
<title>Simulations varying several further parameters.</title>
<p>Tests for truly heterogeneous SNPs are shown in the top 6 panels (a-f), and the corresponding tests for SNPs with only homogeneoues effects are shown in the below 6 panels (g-l). <italic>K</italic> is the number of true, simulated subtypes and <italic>B</italic> is the number of binary traits. <italic>ρ</italic><sub><italic>GE</italic></sub> is the gene-subtype correlation term, with <italic>ρ</italic><sub><italic>GE</italic></sub> = 0 giving non-heritable subtype statuses and <italic>ρ</italic><sub><italic>GE</italic></sub> = 1 giving perfectly heritable subtypes. <inline-formula id="pgen.1008009.e013"><alternatives><graphic id="pgen.1008009.e013g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e013.jpg"></graphic><mml:math id="M13"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pgen.1008009.e014"><alternatives><graphic id="pgen.1008009.e014g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e014.jpg"></graphic><mml:math id="M14"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pgen.1008009.e015"><alternatives><graphic id="pgen.1008009.e015g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e015.jpg"></graphic><mml:math id="M15"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> are the variances explained by homogeneous SNPs, heterogeneous SNPs, and main subtype effects, respectively. As in main <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref>, solid lines have <inline-formula id="pgen.1008009.e016"><alternatives><graphic id="pgen.1008009.e016g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e016.jpg"></graphic><mml:math id="M16"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>4</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mn>4</mml:mn><mml:mo>%</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and dashed lines are reversed; in (d,e), line types define only the <italic>h</italic><sup>2</sup> term not governed by the x-axis. In (a), all methods fit <italic>K</italic> = 2 subtypes; there is no true heterogeneity for <italic>K</italic> = 1, where the oracle is not defined, and for <italic>K</italic> &gt; 1 and the oracle picks a true cluster at random. Generally, increasing the heterogeneous factors (<inline-formula id="pgen.1008009.e017"><alternatives><graphic id="pgen.1008009.e017g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e017.jpg"></graphic><mml:math id="M17"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pgen.1008009.e018"><alternatives><graphic id="pgen.1008009.e018g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e018.jpg"></graphic><mml:math id="M18"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>) makes subtyping easier, while increasing <inline-formula id="pgen.1008009.e019"><alternatives><graphic id="pgen.1008009.e019g" mimetype="image" orientation="portrait" position="anchor" xlink:href="pgen.1008009.e019.jpg"></graphic><mml:math id="M19"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> makes subtyping harder.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s003.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s004">
<label>S3 Fig</label>
<caption>
<title>Simulations where SNP heterogeneity only exists for some traits, for which they are only homogeneous.</title>
<p>Left: the tested trait has no genetic heterogeneity or main subtype effect. Center: the tested trait has only a main subtype effect but no heterogeneity. Right: the full heterogeneity simulation. Linear subtype estimators (CCA and <italic>Y</italic> PC) are not trait-specific.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s004.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s005">
<label>S4 Fig</label>
<caption>
<title>Main <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref> with further subtyping methods.</title>
<p>MFMR+ varies MFMR by treating the tested SNP as heterogeneous. GMM+ varies GMM by including the SNPs as traits when clustering. As expected, MFMR+ and GMM+ are miscalibrated. GMM+ often fails to converge, especially for <italic>N</italic> ≥ 10, 000 (we evaluate only the converged runs). The other methods, with low power, define subtypes as the top PC of <italic>Y</italic> or <italic>G</italic>, optionally thresholded to be binary (“G PC+disc”).</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s005.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s006">
<label>S5 Fig</label>
<caption>
<title>Simulations with non-Gaussian noise.</title>
<p>Purely homogeneoues simulations, without subtypes, where the noise, <italic>ϵ</italic>, has marginal <italic>t</italic><sub>5</sub> distributions. <italic>ϵ</italic> is simulated by drawing i.i.d. <italic>t</italic><sub>5</sub>-distributed random variables, arranging into an <italic>N</italic> × <italic>P</italic> matrix, and then right-multiplying with Σ<sup>1/2</sup>, where Σ is the noise covariance matrix and is drawn as in the main simulations in main <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref>.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s006.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s007">
<label>S6 Fig</label>
<caption>
<title>Simulations with non-linear homogeneous effects.</title>
<p>Purely homogeneoues simulations, without subtypes, where SNPs truly have a non-linear effect. In (a-d), the SNPs are squared before use in MFMR, so that the true SNP and the utilized covariate (i.e. SNP<sup>2</sup>) have zero correlation. In (e-h), the true SNPs are exponentiated before inclusion in MFMR, so the true SNP effect is log-linear. Results are partitioned by whether the tested traits are quantitative or binary, as well as by whether the true SNP effect is null or homogeneous.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s007.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s008">
<label>S7 Fig</label>
<caption>
<title>Simulations with continuously-varying subtypes.</title>
<p><italic>z</italic> is chosen to be Gaussian. Top: Effect sizes are chosen so that power roughly matches main <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref>; it is not trivial to directly convert effect sizes from the discrete <italic>z</italic> simulations. Bottom: All heterogeneoues effect sizes are doubled relative to top panels.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s008.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s009">
<label>S8 Fig</label>
<caption>
<title>Alternate versions of <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref>.</title>
<p>Top: SNP effect heterogeneity tests are applied to binary traits, not quantitative traits as in main <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref>. Even though GMM only clusters the quantitative traits, tests for the (correlated) binary traits are miscalibrated. Middle: a 20% population prevalence binary trait is ascertained to have 50% in-sample prevalence and then tested. Bottom: population structure is added and MFMR, Oracle and GMM-PC test conditional on three genetic PCs; GMM and GMM-PC use the same subtype estimator.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s009.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s010">
<label>S9 Fig</label>
<caption>
<title>Simulations where some covariates and traits are swapped.</title>
<p>Simulation modification where decompositions falsely treat a trait as a SNP/covariate (a,b,e,f,i) or vice versa (c,d,g,h,j). (a-d) No genetic or main subtype heterogeneity is simulated, so that the positive heterogeneity associations are unambiguously false. We test both the variable that we misplace (a,c) and the correctly place SNP/covariates and traits (b,d). (e-j) Simulations are drawn as in main text <xref ref-type="fig" rid="pgen.1008009.g001">Fig 1</xref>, with <italic>K</italic> = 2. (e-h) Tests are shown for the misplaced trait/covariate in (e,g); for the truly homogeneous SNPs in (f,h); and for the truly heterogeneous SNPs in (i,j).</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s010.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s011">
<label>S10 Fig</label>
<caption>
<title>Out-of-sample likelihood varying <italic>K</italic> in CONVERGE (left) and METSIM (right).</title>
<p>Samples are split into 5 folds; parameters are fit holding one fold out; the parameters’s likelihood is evaluated on the held out fold; and the process is repeated for each fold. The log-likelihoods are shown relative to the baseline likelihood of each fold at <italic>K</italic> = 1; this is analogous to using likelihood ratio statistics to compare a general <italic>K</italic> to the null with <italic>K</italic> = 1. The average across folds are shown in red, and the maximizer of <italic>K</italic> is highlighted in green.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s011.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s012">
<label>S11 Fig</label>
<caption>
<title>Metabolic subtype-specific SNP effects across all 228 NMR traits.</title>
<p>SNP-phenotype pairs where the test for effect heterogeneity across subtypes is significant at <italic>p</italic> = .05/81. We test all 228 NMR-based metabolomic traits here rather than using their top PCs as in main <xref ref-type="fig" rid="pgen.1008009.g004">Fig 4</xref> and the MFMR decomposition used to learn subtypes. Per-subtype estimates and standard errors are provided in colors as in main <xref ref-type="fig" rid="pgen.1008009.g004">Fig 4</xref>.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s012.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s013">
<label>S12 Fig</label>
<caption>
<title>Comparison of the −log<sub>10</sub>(<italic>p</italic>)-values for ordinary GWAS (x-axis) and our novel GxE GWAS (y-axis).</title>
<p>Guide lines are drawn at <italic>p</italic> = 5 × 10<sup>−8</sup>, the conventional GWAS threshold. Each point is a SNP, and colors indicate which analyses were significant for the SNP. T2D, CHD, WHR and insulin are omitted because they have no genome-wide significant hits in either analysis; preT2D is omitted because the only hit is shared between both analyses. NMR PC 5 is omitted because it is badly inflated in GxE GWAS (λ<sub><italic>GC</italic></sub> = 1.83); this trait has one hit in GWAS.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s013.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s014">
<label>S13 Fig</label>
<caption>
<title>Comparison of GREML and IID metabolic heritability estimates.</title>
<p>Left: total IID GxEMM heritability (which adds the homogeneous and heterogeneous estimates) compared to the ordinary heritability estimated with GREML. Right: histogram of per-trait heritability increases from replacing GREML with IID GxEMM.</p>
<p>(TIF)</p>
</caption>
<media xlink:href="pgen.1008009.s014.tif">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s015">
<label>S1 Table</label>
<caption>
<title>λ<sub><italic>GC</italic></sub> for GWAS, MFMR GxE GWAS, and GMM GxE GWAS.</title>
<p>GWAS means the standard regression approach conditioning on known covariates and genetic PCs. RGWAS is our approach, which uses covariate-aware clusters (MFMR) and tests for genetic variant effect heterogeneity (Het) or globally for any genetic effect (Global). “Previous Subtyping” is like RGWAS, except using covariate-unaware clustering (GMM) and heterogeneity tests. “Inf” means our calculations suffered numerical problems, meaning that λ<sub><italic>GC</italic></sub> is very large. We do not perform SNP tests on NMR PC 5.</p>
<p>(CSV)</p>
</caption>
<media xlink:href="pgen.1008009.s015.csv">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
<supplementary-material content-type="local-data" id="pgen.1008009.s016">
<label>S2 Table</label>
<caption>
<title>Statin effect heterogeneity test for <italic>K</italic> ∈ {2, 3, 4} and the 16 traits used to define clusters with MFMR.</title>
<p>The “MFMR <monospace>droptest</monospace>” columns test using the large-effect covariate test implemented in the <monospace>rgwas</monospace> R package and described in the Methods in the main text. The “+Condition on T2D” columns run the same linear model as in <monospace>droptest</monospace>, except that T2D status is additionally included as a covariate; this analysis is performed to add confidence that the heterogeneous statin effect on glucose is not merely driven by simple confounding from T2D status.</p>
<p>(CSV)</p>
</caption>
<media xlink:href="pgen.1008009.s016.csv">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank members of Zaitlen lab for helpful discussions and the individuals who participated in the CONVERGE and METSIM studies.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pgen.1008009.ref001">
<label>1</label>
<mixed-citation publication-type="journal">
<name><surname>Iqbal</surname><given-names>J</given-names></name>, <name><surname>Ginsburg</surname><given-names>O</given-names></name>, <name><surname>Rochon</surname><given-names>PA</given-names></name>, <name><surname>Sun</surname><given-names>P</given-names></name>, <name><surname>Narod</surname><given-names>SA</given-names></name>. <article-title>Differences in breast cancer stage at diagnosis and cancer-specific survival by race and ethnicity in the United States</article-title>. <source/>JAMA. <year>2015</year>;<volume>313</volume>(<issue>2</issue>):<fpage>165</fpage>–<lpage>173</lpage>. <pub-id pub-id-type="doi">10.1001/jama.2014.17322</pub-id>
<pub-id pub-id-type="pmid">25585328</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref002">
<label>2</label>
<mixed-citation publication-type="journal">
<name><surname>Milne</surname><given-names>RL</given-names></name>, <name><surname>Kuchenbaecker</surname><given-names>KB</given-names></name>, <name><surname>Michailidou</surname><given-names>K</given-names></name>, <name><surname>Beesley</surname><given-names>J</given-names></name>, <name><surname>Kar</surname><given-names>S</given-names></name>, <name><surname>Lindström</surname><given-names>S</given-names></name>, <etal>et al</etal>
<article-title>Identification of ten variants associated with risk of estrogen-receptor-negative breast cancer</article-title>. <source/>Nature Genetics. <year>2017</year>;<volume>49</volume>(<issue>12</issue>):<fpage>1767</fpage>–<lpage>1778</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3785</pub-id>
<pub-id pub-id-type="pmid">29058716</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref003">
<label>3</label>
<mixed-citation publication-type="journal">
<collab>Dominantly Inherited Alzheimer Network</collab>, <name><surname>Ringman</surname><given-names>JM</given-names></name>, <name><surname>Goate</surname><given-names>A</given-names></name>, <name><surname>Masters</surname><given-names>CL</given-names></name>, <name><surname>Cairns</surname><given-names>NJ</given-names></name>, <name><surname>Danek</surname><given-names>A</given-names></name>, <etal>et al</etal>
<article-title>Genetic Heterogeneity in Alzheimer Disease and Implications for Treatment Strategies</article-title>. <source/>Current Neurology and Neuroscience Reports. <year>2014</year>;<volume>14</volume>(<issue>11</issue>):<fpage>429</fpage>
<pub-id pub-id-type="doi">10.1007/s11910-014-0499-8</pub-id><pub-id pub-id-type="pmid">24435591</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref004">
<label>4</label>
<mixed-citation publication-type="journal">
<name><surname>Jeste</surname><given-names>SS</given-names></name>, <name><surname>Geschwind</surname><given-names>DH</given-names></name>. <article-title>Disentangling the heterogeneity of autism spectrum disorder through genetic findings</article-title>. <source/>Nature reviews Neurology. <year>2014</year>;<volume>10</volume>(<issue>2</issue>):<fpage>74</fpage>–<lpage>81</lpage>. <pub-id pub-id-type="doi">10.1038/nrneurol.2013.278</pub-id>
<pub-id pub-id-type="pmid">24468882</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref005">
<label>5</label>
<mixed-citation publication-type="journal">
<name><surname>Gibson</surname><given-names>P</given-names></name>, <name><surname>Tong</surname><given-names>Y</given-names></name>, <name><surname>Robinson</surname><given-names>G</given-names></name>, <name><surname>Thompson</surname><given-names>MC</given-names></name>, <name><surname>Currle</surname><given-names>DS</given-names></name>, <name><surname>Eden</surname><given-names>C</given-names></name>, <etal>et al</etal>
<article-title>Subtypes of medulloblastoma have distinct developmental origins</article-title>. <source/>Nature. <year>2010</year>;<volume>468</volume>(<issue>7327</issue>):<fpage>1095</fpage>–<lpage>1099</lpage>. <pub-id pub-id-type="doi">10.1038/nature09587</pub-id>
<pub-id pub-id-type="pmid">21150899</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref006">
<label>6</label>
<mixed-citation publication-type="journal">
<name><surname>Cho</surname><given-names>JH</given-names></name>, <name><surname>Feldman</surname><given-names>M</given-names></name>. <article-title>Heterogeneity of autoimmune diseases: pathophysiologic insights from genetics and implications for new therapies</article-title>. <source/>Nature medicine. <year>2015</year>;<volume>21</volume>(<issue>7</issue>):<fpage>730</fpage>–<lpage>738</lpage>. <pub-id pub-id-type="doi">10.1038/nm.3897</pub-id>
<pub-id pub-id-type="pmid">26121193</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref007">
<label>7</label>
<mixed-citation publication-type="journal">
<name><surname>Mueller</surname><given-names>S</given-names></name>, <name><surname>Engleitner</surname><given-names>T</given-names></name>, <name><surname>Maresch</surname><given-names>R</given-names></name>, <name><surname>Zukowska</surname><given-names>M</given-names></name>, <name><surname>Lange</surname><given-names>S</given-names></name>, <name><surname>Kaltenbacher</surname><given-names>T</given-names></name>, <etal>et al</etal>
<article-title>Evolutionary routes and KRAS dosage define pancreatic cancer phenotypes</article-title>. <source/>Nature. <year>2018</year>;<volume>554</volume>(<issue>7690</issue>):<fpage>62</fpage>–<lpage>68</lpage>. <pub-id pub-id-type="doi">10.1038/nature25459</pub-id>
<pub-id pub-id-type="pmid">29364867</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref008">
<label>8</label>
<mixed-citation publication-type="journal">
<name><surname>Flint</surname><given-names>J</given-names></name>, <name><surname>Kendler</surname><given-names>KS</given-names></name>. <article-title>The genetics of major depression</article-title>. <source/>Neuron. <year>2014</year>;<volume>81</volume>(<issue>3</issue>):<fpage>484</fpage>–<lpage>503</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2014.01.027</pub-id>
<pub-id pub-id-type="pmid">24507187</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref009">
<label>9</label>
<mixed-citation publication-type="journal">
<name><surname>Patel</surname><given-names>CJ</given-names></name>, <name><surname>Chen</surname><given-names>R</given-names></name>, <name><surname>Kodama</surname><given-names>K</given-names></name>, <name><surname>Ioannidis</surname><given-names>JPA</given-names></name>, <name><surname>Butte</surname><given-names>AJ</given-names></name>. <article-title>Systematic identification of interaction effects between genome- and environment-wide associations in type 2 diabetes mellitus</article-title>. <source/>Human Genetics. <year>2013</year>;<volume>132</volume>(<issue>5</issue>):<fpage>495</fpage>–<lpage>508</lpage>. <pub-id pub-id-type="doi">10.1007/s00439-012-1258-z</pub-id>
<pub-id pub-id-type="pmid">23334806</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref010">
<label>10</label>
<mixed-citation publication-type="journal">
<name><surname>Udler</surname><given-names>MS</given-names></name>, <name><surname>Kim</surname><given-names>J</given-names></name>, <name><surname>von Grotthuss</surname><given-names>M</given-names></name>, <name><surname>Bonàs-Guarch</surname><given-names>S</given-names></name>, <name><surname>Cole</surname><given-names>JB</given-names></name>, <name><surname>Chiou</surname><given-names>J</given-names></name>, <etal>et al</etal>
<article-title>Type 2 diabetes genetic loci informed by multi-trait associations point to disease mechanisms and subtypes: A soft clustering analysis</article-title>. <source/>PLoS medicine. <year>2018</year>;<volume>15</volume>(<issue>9</issue>):<fpage>e1002654</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pmed.1002654</pub-id>
<pub-id pub-id-type="pmid">30240442</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref011">
<label>11</label>
<mixed-citation publication-type="journal">
<name><surname>Lee</surname><given-names>MN</given-names></name>, <name><surname>Ye</surname><given-names>C</given-names></name>, <name><surname>Villani</surname><given-names>AC</given-names></name>, <name><surname>Raj</surname><given-names>T</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Eisenhaure</surname><given-names>TM</given-names></name>, <etal>et al</etal>
<article-title>Common Genetic Variants Modulate Pathogen-Sensing Responses in Human Dendritic Cells</article-title>. <source/>Science. <year>2014</year>;<volume>343</volume>(<issue>6175</issue>):<fpage>1246980</fpage>–<lpage>1246980</lpage>. <pub-id pub-id-type="doi">10.1126/science.1246980</pub-id>
<pub-id pub-id-type="pmid">24604203</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref012">
<label>12</label>
<mixed-citation publication-type="journal">
<name><surname>Fairfax</surname><given-names>BP</given-names></name>, <name><surname>Humburg</surname><given-names>P</given-names></name>, <name><surname>Makino</surname><given-names>S</given-names></name>, <name><surname>Naranbhai</surname><given-names>V</given-names></name>, <name><surname>Wong</surname><given-names>D</given-names></name>, <name><surname>Lau</surname><given-names>E</given-names></name>, <etal>et al</etal>
<article-title>Innate Immune Activity Conditions the Effect of Regulatory Variants upon Monocyte Gene Expression</article-title>. <source/>Nature. <year>2014</year>;<volume>343</volume>(<issue>6175</issue>):<fpage>1246949</fpage>–<lpage>1246949</lpage>.</mixed-citation>
</ref>
<ref id="pgen.1008009.ref013">
<label>13</label>
<mixed-citation publication-type="journal">
<name><surname>Knowles</surname><given-names>DA</given-names></name>, <name><surname>Davis</surname><given-names>JR</given-names></name>, <name><surname>Edgington</surname><given-names>H</given-names></name>, <name><surname>Raj</surname><given-names>A</given-names></name>, <name><surname>Favé</surname><given-names>MJ</given-names></name>, <name><surname>Zhu</surname><given-names>X</given-names></name>, <etal>et al</etal>
<article-title>Allele-specific expression reveals interactions between genetic variation and environment</article-title>. <source/>Nature Methods. <year>2017</year>;<volume>14</volume>(<issue>7</issue>):<fpage>699</fpage>–<lpage>702</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4298</pub-id>
<pub-id pub-id-type="pmid">28530654</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref014">
<label>14</label>
<mixed-citation publication-type="journal">
<name><surname>Brown</surname><given-names>AA</given-names></name>, <name><surname>Buil</surname><given-names>A</given-names></name>, <name><surname>Vinuela</surname><given-names>A</given-names></name>, <name><surname>Lappalainen</surname><given-names>T</given-names></name>, <name><surname>Zheng</surname><given-names>HF</given-names></name>, <name><surname>Richards</surname><given-names>JB</given-names></name>, <etal>et al</etal>
<article-title>Genetic interactions affecting human gene expression identified by variance association mapping</article-title>. <source/>eLife. <year>2014</year>;<volume>3</volume>:<fpage>e01381</fpage>
<pub-id pub-id-type="doi">10.7554/eLife.01381</pub-id>
<pub-id pub-id-type="pmid">24771767</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref015">
<label>15</label>
<mixed-citation publication-type="journal">
<name><surname>Small</surname><given-names>KS</given-names></name>, <name><surname>Todorčević</surname><given-names>M</given-names></name>, <name><surname>Civelek</surname><given-names>M</given-names></name>, <name><surname>Moustafa</surname><given-names>JSES</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Simon</surname><given-names>MM</given-names></name>, <etal>et al</etal>
<article-title>Regulatory variants at KLF14 influence type 2 diabetes risk via a female-specific effect on adipocyte size and body composition</article-title>. <source/>Nature Genetics. <year>2018</year>;<volume>50</volume>(<issue>4</issue>):<fpage>572</fpage>–<lpage>580</lpage>. <pub-id pub-id-type="doi">10.1038/s41588-018-0088-x</pub-id>
<pub-id pub-id-type="pmid">29632379</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref016">
<label>16</label>
<mixed-citation publication-type="journal">
<collab>Cross-Disorder Group of the Psychiatric Genomics Consortium</collab>, <name><surname>Lee</surname><given-names>SH</given-names></name>, <name><surname>Ripke</surname><given-names>S</given-names></name>, <name><surname>Neale</surname><given-names>BM</given-names></name>, <name><surname>Faraone</surname><given-names>SV</given-names></name>, <name><surname>Purcell</surname><given-names>SM</given-names></name>, <etal>et al</etal>
<article-title>Genetic relationship between five psychiatric disorders estimated from genome-wide SNPs</article-title>. <source/>Nature Genetics. <year>2013</year>;<volume>45</volume>(<issue>9</issue>):<fpage>984</fpage>–<lpage>994</lpage>. <pub-id pub-id-type="doi">10.1038/ng.2711</pub-id>
<pub-id pub-id-type="pmid">23933821</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref017">
<label>17</label>
<mixed-citation publication-type="journal">
<name><surname>Anttila</surname><given-names>V</given-names></name>, <name><surname>Bulik-Sullivan</surname><given-names>B</given-names></name>, <name><surname>Finucane</surname><given-names>HK</given-names></name>, <name><surname>Bras</surname><given-names>J</given-names></name>, <name><surname>Duncan</surname><given-names>L</given-names></name>, <name><surname>Escott-Price</surname><given-names>V</given-names></name>, <etal>et al</etal>
<article-title>Analysis of shared heritability in common disorders of the brain</article-title>. <source/>BioRxiv. <year>2016</year>; p. <fpage>048991</fpage>.</mixed-citation>
</ref>
<ref id="pgen.1008009.ref018">
<label>18</label>
<mixed-citation publication-type="journal">
<name><surname>Exner</surname><given-names>DV</given-names></name>, <name><surname>Dries</surname><given-names>DL</given-names></name>, <name><surname>Domanski</surname><given-names>MJ</given-names></name>, <name><surname>Cohn</surname><given-names>JN</given-names></name>. <article-title>Lesser response to angiotensin-converting-enzyme inhibitor therapy in black as compared with white patients with left ventricular dysfunction</article-title>. <source/>New England Journal of Medicine. <year>2001</year>;<volume>344</volume>(<issue>18</issue>):<fpage>1351</fpage>–<lpage>1357</lpage>. <pub-id pub-id-type="doi">10.1056/NEJM200105033441802</pub-id>
<pub-id pub-id-type="pmid">11333991</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref019">
<label>19</label>
<mixed-citation publication-type="journal">
<collab>International Warfarin Pharmacogenetics Consortium</collab>, <name><surname>Klein</surname><given-names>TE</given-names></name>, <name><surname>Altman</surname><given-names>RB</given-names></name>, <name><surname>Eriksson</surname><given-names>N</given-names></name>, <name><surname>Gage</surname><given-names>BF</given-names></name>, <name><surname>Kimmel</surname><given-names>SE</given-names></name>, <etal>et al</etal>
<article-title>Estimation of the warfarin dose with clinical and pharmacogenetic data</article-title>. <source/>New England Journal of Medicine. <year>2009</year>;<volume>360</volume>(<issue>8</issue>):<fpage>753</fpage>–<lpage>764</lpage>. <pub-id pub-id-type="doi">10.1056/NEJMoa0809329</pub-id>
<pub-id pub-id-type="pmid">19228618</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref020">
<label>20</label>
<mixed-citation publication-type="journal">
<name><surname>Mega</surname><given-names>JL</given-names></name>, <name><surname>Simon</surname><given-names>T</given-names></name>, <name><surname>Collet</surname><given-names>JP</given-names></name>, <name><surname>Anderson</surname><given-names>JL</given-names></name>, <name><surname>Antman</surname><given-names>EM</given-names></name>, <name><surname>Bliden</surname><given-names>K</given-names></name>, <etal>et al</etal>
<article-title>Reduced-Function CYP2C19 Genotype and Risk of Adverse Clinical Outcomes Among Patients Treated With Clopidogrel Predominantly for PCI: A Meta-analysis</article-title>. <source/>JAMA. <year>2010</year>;<volume>304</volume>(<issue>16</issue>):<fpage>1821</fpage>–<lpage>1830</lpage>. <pub-id pub-id-type="doi">10.1001/jama.2010.1543</pub-id>
<pub-id pub-id-type="pmid">20978260</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref021">
<label>21</label>
<mixed-citation publication-type="journal">
<name><surname>Rothwell</surname><given-names>PM</given-names></name>, <name><surname>Cook</surname><given-names>NR</given-names></name>, <name><surname>Gaziano</surname><given-names>JM</given-names></name>, <name><surname>Price</surname><given-names>JF</given-names></name>, <name><surname>Belch</surname><given-names>JFF</given-names></name>, <name><surname>Roncaglioni</surname><given-names>MC</given-names></name>, <etal>et al</etal>
<article-title>Effects of aspirin on risks of vascular events and cancer according to bodyweight and dose: analysis of individual patient data from randomised trials</article-title>. <source/>Lancet (London, England). <year>2018</year>;<volume>392</volume>(<issue>10145</issue>):<fpage>387</fpage>–<lpage>399</lpage>. <pub-id pub-id-type="doi">10.1016/S0140-6736(18)31133-4</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref022">
<label>22</label>
<mixed-citation publication-type="journal">
<name><surname>Nicolau</surname><given-names>M</given-names></name>, <name><surname>Levine</surname><given-names>AJ</given-names></name>, <name><surname>Carlsson</surname><given-names>G</given-names></name>. <article-title>Topology based data analysis identifies a subgroup of breast cancers with a unique mutational profile and excellent survival</article-title>. <source/>Proceedings of the National Academy of Sciences of the United States of America. <year>2011</year>;<volume>108</volume>(<issue>17</issue>):<fpage>7265</fpage>–<lpage>7270</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1102826108</pub-id>
<pub-id pub-id-type="pmid">21482760</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref023">
<label>23</label>
<mixed-citation publication-type="journal">
<name><surname>Fusi</surname><given-names>N</given-names></name>, <name><surname>Lippert</surname><given-names>C</given-names></name>, <name><surname>Borgwardt</surname><given-names>K</given-names></name>, <name><surname>Lawrence</surname><given-names>ND</given-names></name>, <name><surname>Stegle</surname><given-names>O</given-names></name>. <article-title>Detecting regulatory gene–environment interactions with unmeasured environmental factors</article-title>. <source/>Bioinformatics. <year>2013</year>;<volume>29</volume>(<issue>11</issue>):<fpage>1382</fpage>–<lpage>1389</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btt148</pub-id>
<pub-id pub-id-type="pmid">23559640</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref024">
<label>24</label>
<mixed-citation publication-type="journal">
<name><surname>Arnedo</surname><given-names>J</given-names></name>, <name><surname>Svrakic</surname><given-names>DM</given-names></name>, <name><surname>del Val</surname><given-names>C</given-names></name>, <name><surname>Romero-Zaliz</surname><given-names>R</given-names></name>, <name><surname>Hernández-Cuervo</surname><given-names>H</given-names></name>, <collab>Consortium MGoS</collab>, <etal>et al</etal>
<article-title>Uncovering the Hidden Risk Architecture of the Schizophrenias: Confirmation in Three Independent Genome-Wide Association Studies</article-title>. <source/>American Journal of Psychiatry. <year>2015</year>;<volume>172</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>153</lpage>. <pub-id pub-id-type="doi">10.1176/appi.ajp.2014.14040435</pub-id>
<pub-id pub-id-type="pmid">25219520</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref025">
<label>25</label>
<mixed-citation publication-type="journal">
<name><surname>Maier</surname><given-names>R</given-names></name>, <name><surname>Moser</surname><given-names>G</given-names></name>, <name><surname>Chen</surname><given-names>GB</given-names></name>, <name><surname>Ripke</surname><given-names>S</given-names></name>, <name><surname>Coryell</surname><given-names>W</given-names></name>, <name><surname>Potash</surname><given-names>JB</given-names></name>, <etal>et al</etal>
<article-title>Joint Analysis of Psychiatric Disorders Increases Accuracy of Risk Prediction for Schizophrenia, Bipolar Disorder, and Major Depressive Disorder</article-title>. <source/>The American Journal of Human Genetics. <year>2015</year>;<volume>96</volume>(<issue>2</issue>):<fpage>283</fpage>–<lpage>294</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2014.12.006</pub-id>
<pub-id pub-id-type="pmid">25640677</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref026">
<label>26</label>
<mixed-citation publication-type="journal">
<name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Cheng</surname><given-names>WY</given-names></name>, <name><surname>Glicksberg</surname><given-names>BS</given-names></name>, <name><surname>Gottesman</surname><given-names>O</given-names></name>, <name><surname>Tamler</surname><given-names>R</given-names></name>, <name><surname>Chen</surname><given-names>R</given-names></name>, <etal>et al</etal>
<article-title>Identification of type 2 diabetes subgroups through topological analysis of patient similarity</article-title>. <source/>Science Translational Medicine. <year>2015</year>;<volume>7</volume>(<issue>311</issue>):<fpage>311ra174</fpage>–<lpage>311ra174</lpage>. <pub-id pub-id-type="doi">10.1126/scitranslmed.aaa9364</pub-id>
<pub-id pub-id-type="pmid">26511511</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref027">
<label>27</label>
<mixed-citation publication-type="journal">
<name><surname>Hinks</surname><given-names>TSC</given-names></name>, <name><surname>Brown</surname><given-names>T</given-names></name>, <name><surname>Lau</surname><given-names>LCK</given-names></name>, <name><surname>Rupani</surname><given-names>H</given-names></name>, <name><surname>Barber</surname><given-names>C</given-names></name>, <name><surname>Elliott</surname><given-names>S</given-names></name>, <etal>et al</etal>
<article-title>Multidimensional endotyping in patients with severe asthma reveals inflammatory heterogeneity in matrix metalloproteinases and chitinase 3–like protein 1</article-title>. <source/>Journal of Allergy and Clinical Immunology. <year>2016</year>;<volume>138</volume>(<issue>1</issue>):<fpage>61</fpage>–<lpage>75</lpage>. <pub-id pub-id-type="doi">10.1016/j.jaci.2015.11.020</pub-id>
<pub-id pub-id-type="pmid">26851968</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref028">
<label>28</label>
<mixed-citation publication-type="journal">
<name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Liang</surname><given-names>R</given-names></name>, <name><surname>Zhou</surname><given-names>T</given-names></name>, <name><surname>Zheng</surname><given-names>J</given-names></name>, <name><surname>Liang</surname><given-names>BM</given-names></name>, <name><surname>Zhang</surname><given-names>HP</given-names></name>, <etal>et al</etal>
<article-title>Identification and validation of asthma phenotypes in Chinese population using cluster analysis</article-title>. <source/>Annals of Allergy, Asthma &amp; Immunology. <year>2017</year>;<volume>119</volume>(<issue>4</issue>):<fpage>324</fpage>–<lpage>332</lpage>. <pub-id pub-id-type="doi">10.1016/j.anai.2017.07.016</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref029">
<label>29</label>
<mixed-citation publication-type="journal">
<name><surname>Krishnan</surname><given-names>ML</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Aljabar</surname><given-names>P</given-names></name>, <name><surname>Ball</surname><given-names>G</given-names></name>, <name><surname>Mirza</surname><given-names>G</given-names></name>, <name><surname>Saxena</surname><given-names>A</given-names></name>, <etal>et al</etal>
<article-title>Machine learning shows association between genetic variability in PPARGand cerebral connectivity in preterm infants</article-title>. <source/>Proceedings of the National Academy of Sciences. <year>2017</year>;<volume>114</volume>(<issue>52</issue>):<fpage>13744</fpage>–<lpage>13749</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1704907114</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref030">
<label>30</label>
<mixed-citation publication-type="journal">
<name><surname>Nguyen</surname><given-names>QH</given-names></name>, <name><surname>Lukowski</surname><given-names>SW</given-names></name>, <name><surname>Chiu</surname><given-names>HS</given-names></name>, <name><surname>Senabouth</surname><given-names>A</given-names></name>, <name><surname>Bruxner</surname><given-names>TJC</given-names></name>, <name><surname>Christ</surname><given-names>AN</given-names></name>, <etal>et al</etal>
<article-title>Single-cell RNA-seq of human induced pluripotent stem cells reveals cellular heterogeneity and cell state transitions between subpopulations</article-title>. <source/>Genome Research. <year>2018</year>;<volume>28</volume>(<issue>7</issue>):<fpage>1053</fpage>–<lpage>1066</lpage>. <pub-id pub-id-type="doi">10.1101/gr.223925.117</pub-id>
<pub-id pub-id-type="pmid">29752298</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref031">
<label>31</label>
<mixed-citation publication-type="journal">
<name><surname>Ahlqvist</surname><given-names>E</given-names></name>, <name><surname>Storm</surname><given-names>P</given-names></name>, <name><surname>Käräjämäki</surname><given-names>A</given-names></name>, <name><surname>Martinell</surname><given-names>M</given-names></name>, <name><surname>Dorkhan</surname><given-names>M</given-names></name>, <name><surname>Carlsson</surname><given-names>A</given-names></name>, <etal>et al</etal>
<article-title>Novel subgroups of adult-onset diabetes and their association with outcomes: a data-driven cluster analysis of six variables</article-title>. <source/>The Lancet Diabetes &amp; Endocrinology. <year>2018</year>
<pub-id pub-id-type="doi">10.1016/S2213-8587(18)30051-2</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref032">
<label>32</label>
<mixed-citation publication-type="journal">
<name><surname>Sattar</surname><given-names>N</given-names></name>, <name><surname>Preiss</surname><given-names>D</given-names></name>, <name><surname>Murray</surname><given-names>HM</given-names></name>, <name><surname>Welsh</surname><given-names>P</given-names></name>, <name><surname>Buckley</surname><given-names>BM</given-names></name>, <name><surname>de Craen</surname><given-names>AJ</given-names></name>, <etal>et al</etal>
<article-title>Statins and risk of incident diabetes: a collaborative meta-analysis of randomised statin trials</article-title>. <source/>The Lancet. <year>2010</year>;<volume>375</volume>(<issue>9716</issue>):<fpage>735</fpage>–<lpage>742</lpage>. <pub-id pub-id-type="doi">10.1016/S0140-6736(09)61965-6</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref033">
<label>33</label>
<mixed-citation publication-type="journal">
<name><surname>Preiss</surname><given-names>D</given-names></name>, <name><surname>Seshasai</surname><given-names>SRK</given-names></name>, <name><surname>Welsh</surname><given-names>P</given-names></name>, <name><surname>Murphy</surname><given-names>SA</given-names></name>, <name><surname>Ho</surname><given-names>JE</given-names></name>, <name><surname>Waters</surname><given-names>DD</given-names></name>, <etal>et al</etal>
<article-title>Risk of incident diabetes with intensive-dose compared with moderate-dose statin therapy: a meta-analysis</article-title>. <source/>JAMA. <year>2011</year>;<volume>305</volume>(<issue>24</issue>):<fpage>2556</fpage>–<lpage>2564</lpage>. <pub-id pub-id-type="doi">10.1001/jama.2011.860</pub-id>
<pub-id pub-id-type="pmid">21693744</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref034">
<label>34</label>
<mixed-citation publication-type="journal">
<name><surname>Lotta</surname><given-names>LA</given-names></name>, <name><surname>Sharp</surname><given-names>SJ</given-names></name>, <name><surname>Burgess</surname><given-names>S</given-names></name>, <name><surname>Perry</surname><given-names>JRB</given-names></name>, <name><surname>Stewart</surname><given-names>ID</given-names></name>, <name><surname>Willems</surname><given-names>SM</given-names></name>, <etal>et al</etal>
<article-title>Association Between Low-Density Lipoprotein Cholesterol–Lowering Genetic Variants and Risk of Type 2 Diabetes</article-title>. <source/>JAMA. <year>2016</year>;<volume>316</volume>(<issue>13</issue>):<fpage>1383</fpage>–<lpage>1391</lpage>. <pub-id pub-id-type="doi">10.1001/jama.2016.14568</pub-id>
<pub-id pub-id-type="pmid">27701660</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref035">
<label>35</label>
<mixed-citation publication-type="other">Dahl A, Cai N, Flint J, Zaitlen N. GxEMM: Extending linear mixed models to general gene-environment interactions. BioRxiv. 2018.</mixed-citation>
</ref>
<ref id="pgen.1008009.ref036">
<label>36</label>
<mixed-citation publication-type="journal">
<name><surname>Zaitlen</surname><given-names>N</given-names></name>, <name><surname>Zaitlen</surname><given-names>N</given-names></name>, <name><surname>Pasaniuc</surname><given-names>B</given-names></name>, <name><surname>Pasaniuc</surname><given-names>B</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <name><surname>Patterson</surname><given-names>N</given-names></name>, <etal>et al</etal>
<article-title>Analysis of case-control association studies with known risk variants</article-title>. <source/>Bioinformatics. <year>2012</year>;<volume>28</volume>(<issue>13</issue>):<fpage>1729</fpage>–<lpage>1737</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bts259</pub-id>
<pub-id pub-id-type="pmid">22556366</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref037">
<label>37</label>
<mixed-citation publication-type="journal">
<name><surname>Zaitlen</surname><given-names>N</given-names></name>, <name><surname>Lindström</surname><given-names>S</given-names></name>, <name><surname>Pasaniuc</surname><given-names>B</given-names></name>, <name><surname>Cornelis</surname><given-names>M</given-names></name>, <name><surname>Genovese</surname><given-names>G</given-names></name>, <name><surname>Pollack</surname><given-names>S</given-names></name>, <etal>et al</etal>
<article-title>Informed Conditioning on Clinical Covariates Increases Power in Case-Control Association Studies</article-title>. <source/>PLoS Genetics. <year>2012</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e1003032</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1371/journal.pgen.1003032</pub-id>
<pub-id pub-id-type="pmid">23144628</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref038">
<label>38</label>
<mixed-citation publication-type="journal">
<name><surname>Golan</surname><given-names>D</given-names></name>, <name><surname>Rosset</surname><given-names>S</given-names></name>. <article-title>Effective Genetic-Risk Prediction Using Mixed Models</article-title>. <source/>The American Journal of Human Genetics. <year>2014</year>;<volume>95</volume>(<issue>4</issue>):<fpage>383</fpage>–<lpage>393</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2014.09.007</pub-id>
<pub-id pub-id-type="pmid">25279982</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref039">
<label>39</label>
<mixed-citation publication-type="journal">
<name><surname>Golan</surname><given-names>D</given-names></name>, <name><surname>Lander</surname><given-names>ES</given-names></name>, <name><surname>Rosset</surname><given-names>S</given-names></name>. <article-title>Measuring missing heritability: inferring the contribution of common variants</article-title>. <source/>Proceedings of the National Academy of Sciences of the United States of America. <year>2014</year>;<volume>111</volume>(<issue>49</issue>):<fpage>E5272</fpage>–<lpage>81</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1419064111</pub-id>
<pub-id pub-id-type="pmid">25422463</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref040">
<label>40</label>
<mixed-citation publication-type="journal">
<name><surname>Weissbrod</surname><given-names>O</given-names></name>, <name><surname>Flint</surname><given-names>J</given-names></name>, <name><surname>Rosset</surname><given-names>S</given-names></name>. <article-title>Estimating SNP-Based Heritability and Genetic Correlation in Case-Control Studies Directly and with Summary Statistics</article-title>. <source/>The American Journal of Human Genetics. <year>2018</year>;<volume>103</volume>(<issue>1</issue>):<fpage>89</fpage>–<lpage>99</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2018.06.002</pub-id>
<pub-id pub-id-type="pmid">29979983</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref041">
<label>41</label>
<mixed-citation publication-type="journal">
<name><surname>Lindsay</surname><given-names>B</given-names></name>, <name><surname>Liu</surname><given-names>J</given-names></name>. <article-title>Model Assessment Tools for a Model False World</article-title>. <source/>Statistical Science. <year>2009</year>;<volume>24</volume>(<issue>3</issue>):<fpage>303</fpage>–<lpage>318</lpage>. <pub-id pub-id-type="doi">10.1214/09-STS302</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref042">
<label>42</label>
<mixed-citation publication-type="journal">
<name><surname>Dudbridge</surname><given-names>F</given-names></name>, <name><surname>Fletcher</surname><given-names>O</given-names></name>. <article-title>Gene-Environment Dependence Creates Spurious Gene-Environment Interaction</article-title>. <source/>The American Journal of Human Genetics. <year>2014</year>;<volume>95</volume>(<issue>3</issue>):<fpage>301</fpage>–<lpage>307</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2014.07.014</pub-id>
<pub-id pub-id-type="pmid">25152454</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref043">
<label>43</label>
<mixed-citation publication-type="journal">
<name><surname>Consortium</surname><given-names>C</given-names></name>. <article-title>Sparse whole genome sequencing identifies two loci for major depressive disorder</article-title>. <source/>Nature. <year>2015</year>;<volume>523</volume>(<issue>7562</issue>):<fpage>588</fpage>–<lpage>591</lpage>. <pub-id pub-id-type="doi">10.1038/nature14659</pub-id><pub-id pub-id-type="pmid">26176920</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref044">
<label>44</label>
<mixed-citation publication-type="journal">
<name><surname>Peterson</surname><given-names>RE</given-names></name>, <name><surname>Cai</surname><given-names>N</given-names></name>, <name><surname>Dahl</surname><given-names>AW</given-names></name>, <name><surname>Bigdeli</surname><given-names>TB</given-names></name>, <name><surname>Edwards</surname><given-names>AC</given-names></name>, <name><surname>Webb</surname><given-names>BT</given-names></name>, <etal>et al</etal>
<article-title>Molecular Genetic Analysis Subdivided by Adversity Exposure Suggests Etiologic Heterogeneity in Major Depression</article-title>. <source/>The American journal of psychiatry. <year>2018</year>;<volume>175</volume>(<issue>6</issue>):<fpage>545</fpage>–<lpage>554</lpage>. <pub-id pub-id-type="doi">10.1176/appi.ajp.2017.17060621</pub-id>
<pub-id pub-id-type="pmid">29495898</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref045">
<label>45</label>
<mixed-citation publication-type="journal">
<name><surname>Laakso</surname><given-names>M</given-names></name>, <name><surname>Kuusisto</surname><given-names>J</given-names></name>, <name><surname>Stančáková</surname><given-names>A</given-names></name>, <name><surname>Kuulasmaa</surname><given-names>T</given-names></name>, <name><surname>Pajukanta</surname><given-names>P</given-names></name>, <name><surname>Lusis</surname><given-names>AJ</given-names></name>, <etal>et al</etal>
<article-title>The Metabolic Syndrome in Men study: a resource for studies of metabolic and cardiovascular diseases</article-title>. <source/>Journal of Lipid Research. <year>2017</year>;<volume>58</volume>(<issue>3</issue>):<fpage>481</fpage>–<lpage>493</lpage>. <pub-id pub-id-type="doi">10.1194/jlr.O072629</pub-id>
<pub-id pub-id-type="pmid">28119442</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref046">
<label>46</label>
<mixed-citation publication-type="journal">
<name><surname>Kim</surname><given-names>MJ</given-names></name>, <name><surname>Yu</surname><given-names>CY</given-names></name>, <name><surname>Theusch</surname><given-names>E</given-names></name>, <name><surname>Naidoo</surname><given-names>D</given-names></name>, <name><surname>Stevens</surname><given-names>K</given-names></name>, <name><surname>Kuang</surname><given-names>YL</given-names></name>, <etal>et al</etal>
<article-title>SUGP1 is a novel regulator of cholesterol metabolism</article-title>. <source/>Human Molecular Genetics. <year>2016</year>;<volume>13</volume>:<fpage>ddw151</fpage>
<pub-id pub-id-type="doi">10.1093/hmg/ddw151</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref047">
<label>47</label>
<mixed-citation publication-type="journal">
<name><surname>Aslibekyan</surname><given-names>S</given-names></name>, <name><surname>Goodarzi</surname><given-names>MO</given-names></name>, <name><surname>Frazier-Wood</surname><given-names>AC</given-names></name>, <name><surname>Yan</surname><given-names>X</given-names></name>, <name><surname>Irvin</surname><given-names>MR</given-names></name>, <name><surname>Kim</surname><given-names>E</given-names></name>, <etal>et al</etal>
<article-title>Variants Identified in a GWAS Meta-Analysis for Blood Lipids Are Associated with the Lipid Response to Fenofibrate</article-title>. <source/>PLoS ONE. <year>2012</year>;<volume>7</volume>(<issue>10</issue>):<fpage>e48663</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0048663</pub-id>
<pub-id pub-id-type="pmid">23119086</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref048">
<label>48</label>
<mixed-citation publication-type="journal">
<name><surname>Xi</surname><given-names>B</given-names></name>, <name><surname>Wang</surname><given-names>C</given-names></name>, <name><surname>Wu</surname><given-names>L</given-names></name>, <name><surname>Zhang</surname><given-names>M</given-names></name>, <name><surname>Shen</surname><given-names>Y</given-names></name>, <name><surname>Zhao</surname><given-names>X</given-names></name>, <etal>et al</etal>
<article-title>Influence of Physical Inactivity on Associations Between Single Nucleotide Polymorphisms and Genetic Predisposition to Childhood Obesity</article-title>. <source/>American Journal of Epidemiology. <year>2011</year>;<volume>173</volume>(<issue>11</issue>):<fpage>1256</fpage>–<lpage>1262</lpage>. <pub-id pub-id-type="doi">10.1093/aje/kwr008</pub-id>
<pub-id pub-id-type="pmid">21527513</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref049">
<label>49</label>
<mixed-citation publication-type="journal">
<name><surname>Qi</surname><given-names>Q</given-names></name>, <name><surname>Chu</surname><given-names>AY</given-names></name>, <name><surname>Kang</surname><given-names>JH</given-names></name>, <name><surname>Jensen</surname><given-names>MK</given-names></name>, <name><surname>Curhan</surname><given-names>GC</given-names></name>, <name><surname>Pasquale</surname><given-names>LR</given-names></name>, <etal>et al</etal>
<article-title>Sugar-Sweetened Beverages and Genetic Risk of Obesity</article-title>. <source/>New England Journal of Medicine. <year>2012</year>;<volume>367</volume>(<issue>15</issue>):<fpage>1387</fpage>–<lpage>1396</lpage>. <pub-id pub-id-type="doi">10.1056/NEJMoa1203039</pub-id>
<pub-id pub-id-type="pmid">22998338</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref050">
<label>50</label>
<mixed-citation publication-type="journal">
<name><surname>Tam</surname><given-names>CHT</given-names></name>, <name><surname>Ma</surname><given-names>RCW</given-names></name>, <name><surname>So</surname><given-names>WY</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Lam</surname><given-names>VKL</given-names></name>, <name><surname>Germer</surname><given-names>S</given-names></name>, <etal>et al</etal>
<article-title>Interaction Effect of Genetic Polymorphisms in Glucokinase (GCK) and Glucokinase Regulatory Protein (GCKR) on Metabolic Traits in Healthy Chinese Adults and Adolescents</article-title>. <source/>Diabetes. <year>2009</year>;<volume>58</volume>(<issue>3</issue>):<fpage>765</fpage>–<lpage>769</lpage>. <pub-id pub-id-type="doi">10.2337/db08-1277</pub-id>
<pub-id pub-id-type="pmid">19073768</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref051">
<label>51</label>
<mixed-citation publication-type="journal">
<name><surname>Nettleton</surname><given-names>JA</given-names></name>, <name><surname>McKeown</surname><given-names>NM</given-names></name>, <name><surname>Kanoni</surname><given-names>S</given-names></name>, <name><surname>Lemaitre</surname><given-names>RN</given-names></name>, <name><surname>Hivert</surname><given-names>MF</given-names></name>, <name><surname>Ngwa</surname><given-names>J</given-names></name>, <etal>et al</etal>
<article-title>Interactions of Dietary Whole-Grain Intake With Fasting Glucose- and Insulin-Related Genetic Loci in Individuals of European Descent: A meta-analysis of 14 cohort studies</article-title>. <source/>Diabetes Care. <year>2010</year>;<volume>33</volume>(<issue>12</issue>):<fpage>2684</fpage>–<lpage>2691</lpage>. <pub-id pub-id-type="doi">10.2337/dc10-1150</pub-id>
<pub-id pub-id-type="pmid">20693352</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref052">
<label>52</label>
<mixed-citation publication-type="journal">
<name><surname>Perez-Martinez</surname><given-names>P</given-names></name>, <name><surname>Corella</surname><given-names>D</given-names></name>, <name><surname>Shen</surname><given-names>J</given-names></name>, <name><surname>Arnett</surname><given-names>DK</given-names></name>, <name><surname>Yiannakouris</surname><given-names>N</given-names></name>, <name><surname>Tai</surname><given-names>ES</given-names></name>, <etal>et al</etal>
<article-title>Association between glucokinase regulatory protein (GCKR) and apolipoprotein A5 (APOA5) gene polymorphisms and triacylglycerol concentrations in fasting, postprandial, and fenofibrate-treated states</article-title>. <source/>The American Journal of Clinical Nutrition. <year>2008</year>;<volume>89</volume>(<issue>1</issue>):<fpage>391</fpage>–<lpage>399</lpage>. <pub-id pub-id-type="doi">10.3945/ajcn.2008.26363</pub-id>
<pub-id pub-id-type="pmid">19056598</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref053">
<label>53</label>
<mixed-citation publication-type="journal">
<name><surname>Kraft</surname><given-names>P</given-names></name>, <name><surname>Yen</surname><given-names>YC</given-names></name>, <name><surname>Stram</surname><given-names>DO</given-names></name>, <name><surname>Morrison</surname><given-names>J</given-names></name>, <name><surname>Gauderman</surname><given-names>WJ</given-names></name>. <article-title>Exploiting Gene-Environment Interaction to Detect Genetic Associations</article-title>. <source/>Human heredity. <year>2007</year>;<volume>63</volume>(<issue>2</issue>):<fpage>111</fpage>–<lpage>119</lpage>. <pub-id pub-id-type="doi">10.1159/000099183</pub-id>
<pub-id pub-id-type="pmid">17283440</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref054">
<label>54</label>
<mixed-citation publication-type="journal">
<name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Lee</surname><given-names>SH</given-names></name>, <name><surname>Goddard</surname><given-names>ME</given-names></name>, <name><surname>Visscher</surname><given-names>PM</given-names></name>. <article-title>GCTA: a tool for genome-wide complex trait analysis</article-title>. <source/>The American Journal of Human Genetics. <year>2011</year>
<pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref055">
<label>55</label>
<mixed-citation publication-type="journal">
<name><surname>Sul</surname><given-names>JH</given-names></name>, <name><surname>Bilow</surname><given-names>M</given-names></name>, <name><surname>Yang</surname><given-names>WY</given-names></name>, <name><surname>Kostem</surname><given-names>E</given-names></name>, <name><surname>Furlotte</surname><given-names>N</given-names></name>, <name><surname>He</surname><given-names>D</given-names></name>, <etal>et al</etal>
<article-title>Accounting for Population Structure in Gene-by-Environment Interactions in Genome-Wide Association Studies Using Mixed Models</article-title>. <source/>PLoS Genetics. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):<fpage>e1005849</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pgen.1005849</pub-id>
<pub-id pub-id-type="pmid">26943367</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref056">
<label>56</label>
<mixed-citation publication-type="journal">
<name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Benyamin</surname><given-names>B</given-names></name>, <name><surname>McEvoy</surname><given-names>BP</given-names></name>, <name><surname>Gordon</surname><given-names>S</given-names></name>, <name><surname>Henders</surname><given-names>AK</given-names></name>, <name><surname>Nyholt</surname><given-names>DR</given-names></name>, <etal>et al</etal>
<article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>. <source/>Nature Genetics. <year>2010</year>;<volume>42</volume>(<issue>7</issue>):<fpage>565</fpage>–<lpage>569</lpage>. <pub-id pub-id-type="doi">10.1038/ng.608</pub-id>
<pub-id pub-id-type="pmid">20562875</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref057">
<label>57</label>
<mixed-citation publication-type="journal">
<name><surname>Sladek</surname><given-names>R</given-names></name>. <article-title>The many faces of diabetes: addressing heterogeneity of a complex disease</article-title>. <source/>The Lancet Diabetes &amp; Endocrinology. <year>2018</year>
<pub-id pub-id-type="doi">10.1016/S2213-8587(18)30070-6</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref058">
<label>58</label>
<mixed-citation publication-type="journal">
<name><surname>Elam</surname><given-names>MB</given-names></name>, <name><surname>Ginsberg</surname><given-names>HN</given-names></name>, <name><surname>Lovato</surname><given-names>LC</given-names></name>, <name><surname>Corson</surname><given-names>M</given-names></name>, <name><surname>Largay</surname><given-names>J</given-names></name>, <name><surname>Leiter</surname><given-names>LA</given-names></name>, <etal>et al</etal>
<article-title>Association of Fenofibrate Therapy With Long-term Cardiovascular Risk in Statin-Treated Patients With Type 2 Diabetes</article-title>. <source/>JAMA Cardiology. <year>2017</year>;<volume>2</volume>(<issue>4</issue>):<fpage>370</fpage>–<lpage>380</lpage>. <pub-id pub-id-type="doi">10.1001/jamacardio.2016.4828</pub-id>
<pub-id pub-id-type="pmid">28030716</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref059">
<label>59</label>
<mixed-citation publication-type="journal">
<name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Kim</surname><given-names>Y</given-names></name>, <name><surname>Tsang</surname><given-names>EK</given-names></name>, <name><surname>Davis</surname><given-names>JR</given-names></name>, <name><surname>Damani</surname><given-names>FN</given-names></name>, <name><surname>Chiang</surname><given-names>C</given-names></name>, <etal>et al</etal>
<article-title>The impact of rare variation on gene expression across tissues</article-title>. <source/>Nature. <year>2017</year>;<volume>550</volume>(<issue>7675</issue>):<fpage>239</fpage>–<lpage>243</lpage>. <pub-id pub-id-type="doi">10.1038/nature24267</pub-id>
<pub-id pub-id-type="pmid">29022581</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref060">
<label>60</label>
<mixed-citation publication-type="journal">
<name><surname>Liley</surname><given-names>J</given-names></name>, <name><surname>Todd</surname><given-names>JA</given-names></name>, <name><surname>Wallace</surname><given-names>C</given-names></name>. <article-title>A method for identifying genetic heterogeneity within phenotypically defined disease subgroups</article-title>. <source/>Nature Genetics. <year>2016</year>;<volume>49</volume>(<issue>2</issue>):<fpage>310</fpage>–<lpage>316</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3751</pub-id>
<pub-id pub-id-type="pmid">28024155</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref061">
<label>61</label>
<mixed-citation publication-type="journal">
<collab>International Schizophrenia Consortium</collab>, <name><surname>Purcell</surname><given-names>SM</given-names></name>, <name><surname>Wray</surname><given-names>NR</given-names></name>, <name><surname>Stone</surname><given-names>JL</given-names></name>, <name><surname>Visscher</surname><given-names>PM</given-names></name>, <name><surname>O’Donovan</surname><given-names>MC</given-names></name>, <etal>et al</etal>
<article-title>Common polygenic variation contributes to risk of schizophrenia and bipolar disorder</article-title>. <source/>Nature. <year>2009</year>;<volume>460</volume>(<issue>7256</issue>):<fpage>748</fpage>–<lpage>752</lpage>. <pub-id pub-id-type="doi">10.1038/nature08185</pub-id>
<pub-id pub-id-type="pmid">19571811</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref062">
<label>62</label>
<mixed-citation publication-type="journal">
<name><surname>Cortes</surname><given-names>A</given-names></name>, <name><surname>Dendrou</surname><given-names>C</given-names></name>, <name><surname>Motyer</surname><given-names>A</given-names></name>, <name><surname>Jostins</surname><given-names>L</given-names></name>, <name><surname>Vukcevic</surname><given-names>D</given-names></name>, <name><surname>Dilthey</surname><given-names>A</given-names></name>, <etal>et al</etal>
<article-title>Bayesian analysis of genetic association across tree-structured routine healthcare data in the UK Biobank</article-title>. <source/>BioRxiv. <year>2017</year>; p. <fpage>105122</fpage>.</mixed-citation>
</ref>
<ref id="pgen.1008009.ref063">
<label>63</label>
<mixed-citation publication-type="journal">
<name><surname>Fusi</surname><given-names>N</given-names></name>, <name><surname>Lippert</surname><given-names>C</given-names></name>, <name><surname>Lawrence</surname><given-names>ND</given-names></name>, <name><surname>Stegle</surname><given-names>O</given-names></name>. <article-title>Warped linear mixed models for the genetic analysis of transformed phenotypes</article-title>. <source/>Nature communications. <year>2014</year>;<volume>5</volume>:<fpage>4890</fpage>
<pub-id pub-id-type="doi">10.1038/ncomms5890</pub-id>
<pub-id pub-id-type="pmid">25234577</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref064">
<label>64</label>
<mixed-citation publication-type="journal">
<name><surname>Robinson</surname><given-names>MR</given-names></name>, <name><surname>English</surname><given-names>G</given-names></name>, <name><surname>Moser</surname><given-names>G</given-names></name>, <name><surname>Lloyd-Jones</surname><given-names>LR</given-names></name>, <name><surname>Triplett</surname><given-names>MA</given-names></name>, <name><surname>Zhu</surname><given-names>Z</given-names></name>, <etal>et al</etal>
<article-title>Genotype-covariate interaction effects and the heritability of adult body mass index</article-title>. <source/>Nature Genetics. <year>2017</year>;<volume>49</volume>(<issue>8</issue>):<fpage>1174</fpage>–<lpage>1181</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3912</pub-id>
<pub-id pub-id-type="pmid">28692066</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref065">
<label>65</label>
<mixed-citation publication-type="journal">
<name><surname>Ni</surname><given-names>G</given-names></name>, <name><surname>van der Werf</surname><given-names>J</given-names></name>, <name><surname>Zhou</surname><given-names>X</given-names></name>, <name><surname>Hyppönen</surname><given-names>E</given-names></name>, <name><surname>Wray</surname><given-names>NR</given-names></name>, <name><surname>Lee</surname><given-names>SH</given-names></name>. <article-title>Genotype-covariate correlation and interaction disentangled by a whole-genome multivariate reaction norm model</article-title>. <source/>BioRxiv. <year>2018</year>; p. <fpage>377796</fpage>.</mixed-citation>
</ref>
<ref id="pgen.1008009.ref066">
<label>66</label>
<mixed-citation publication-type="journal">
<name><surname>Smemo</surname><given-names>S</given-names></name>, <name><surname>Tena</surname><given-names>JJ</given-names></name>, <name><surname>Kim</surname><given-names>KH</given-names></name>, <name><surname>Gamazon</surname><given-names>ER</given-names></name>, <name><surname>Sakabe</surname><given-names>NJ</given-names></name>, <name><surname>Gómez-Marín</surname><given-names>C</given-names></name>, <etal>et al</etal>
<article-title>Obesity-associated variants within FTO form long-range functional connections with IRX3</article-title>. <source/>Nature. <year>2014</year>;<volume>507</volume>(<issue>7492</issue>):<fpage>371</fpage>–<lpage>375</lpage>. <pub-id pub-id-type="doi">10.1038/nature13138</pub-id>
<pub-id pub-id-type="pmid">24646999</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref067">
<label>67</label>
<mixed-citation publication-type="journal">
<name><surname>Finucane</surname><given-names>H</given-names></name>, <name><surname>Reshef</surname><given-names>Y</given-names></name>, <name><surname>Anttila</surname><given-names>V</given-names></name>, <name><surname>Slowikowski</surname><given-names>K</given-names></name>, <name><surname>Gusev</surname><given-names>A</given-names></name>, <name><surname>Byrnes</surname><given-names>A</given-names></name>, <etal>et al</etal>
<article-title>Heritability enrichment of specifically expressed genes identifies disease-relevant tissues and cell types</article-title>. <source/>BioRxiv. <year>2017</year>; p. <fpage>103069</fpage>.</mixed-citation>
</ref>
<ref id="pgen.1008009.ref068">
<label>68</label>
<mixed-citation publication-type="journal">
<name><surname>Zou</surname><given-names>J</given-names></name>, <name><surname>Schiebinger</surname><given-names>L</given-names></name>. <article-title>AI can be sexist and racist—it’s time to make it fair</article-title>. <source/>Nature. <year>2018</year>;<volume>559</volume>(<issue>7714</issue>):<fpage>324</fpage>–<lpage>326</lpage>. <pub-id pub-id-type="doi">10.1038/d41586-018-05707-8</pub-id>
<pub-id pub-id-type="pmid">30018439</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref069">
<label>69</label>
<mixed-citation publication-type="journal">
<name><surname>Lin</surname><given-names>Z</given-names></name>, <name><surname>Yang</surname><given-names>C</given-names></name>, <name><surname>Zhu</surname><given-names>Y</given-names></name>, <name><surname>Duchi</surname><given-names>J</given-names></name>, <name><surname>Fu</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <etal>et al</etal>
<article-title>Simultaneous dimension reduction and adjustment for confounding variation</article-title>. <source/>Proceedings of the National Academy of Sciences. <year>2016</year>;<volume>113</volume>(<issue>51</issue>):<fpage>14662</fpage>–<lpage>14667</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1617317113</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref070">
<label>70</label>
<mixed-citation publication-type="journal">
<name><surname>Abid</surname><given-names>A</given-names></name>, <name><surname>Zhang</surname><given-names>MJ</given-names></name>, <name><surname>Bagaria</surname><given-names>VK</given-names></name>, <name><surname>Zou</surname><given-names>J</given-names></name>. <article-title>Exploring patterns enriched in a dataset with contrastive principal component analysis</article-title>. <source/>Nature communications. <year>2018</year>;<volume>9</volume>(<issue>1</issue>):<fpage>2134</fpage>
<pub-id pub-id-type="doi">10.1038/s41467-018-04608-8</pub-id>
<pub-id pub-id-type="pmid">29849030</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref071">
<label>71</label>
<mixed-citation publication-type="journal">
<name><surname>Kang</surname><given-names>HM</given-names></name>, <name><surname>Sul</surname><given-names>JH</given-names></name>, <name><surname>Service</surname><given-names>SK</given-names></name>, <name><surname>Zaitlen</surname><given-names>NA</given-names></name>, <name><surname>Kong</surname><given-names>Sy</given-names></name>, <name><surname>Freimer</surname><given-names>NB</given-names></name>, <etal>et al</etal>
<article-title>Variance component model to account for sample structure in genome-wide association studies</article-title>. <source/>Nature Genetics. <year>2010</year>;<volume>42</volume>(<issue>4</issue>):<fpage>348</fpage>–<lpage>354</lpage>. <pub-id pub-id-type="doi">10.1038/ng.548</pub-id>
<pub-id pub-id-type="pmid">20208533</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref072">
<label>72</label>
<mixed-citation publication-type="journal">
<name><surname>Leisch</surname><given-names>F</given-names></name>. <article-title>FlexMix: A General Framework for Finite Mixture Models and Latent Class Regression in R</article-title>. <source/>Journal of Statistical Software. <year>2004</year>;<volume>11</volume>(<issue>8</issue>):<fpage>1</fpage>–<lpage>18</lpage>. <pub-id pub-id-type="doi">10.18637/jss.v011.i08</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref073">
<label>73</label>
<mixed-citation publication-type="journal">
<name><surname>Prasad</surname><given-names>R</given-names></name>, <name><surname>Groop</surname><given-names>L</given-names></name>. <article-title>Genetics of Type 2 Diabetes—Pitfalls and Possibilities</article-title>. <source/>Genes. <year>2015</year>;<volume>6</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>123</lpage>. <pub-id pub-id-type="doi">10.3390/genes6010087</pub-id>
<pub-id pub-id-type="pmid">25774817</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref074">
<label>74</label>
<mixed-citation publication-type="journal">
<collab>The CARDIoGRAMplusC4D Consortium</collab>, <name><surname>Nikpay</surname><given-names>M</given-names></name>, <name><surname>Goel</surname><given-names>A</given-names></name>, <name><surname>Won</surname><given-names>HH</given-names></name>, <name><surname>Hall</surname><given-names>LM</given-names></name>, <name><surname>Willenborg</surname><given-names>C</given-names></name>, <etal>et al</etal>
<article-title>A comprehensive 1000 Genomes–based genome-wide association meta-analysis of coronary artery disease</article-title>. <source/>Nature Genetics. <year>2015</year>;<volume>47</volume>(<issue>10</issue>):<fpage>1121</fpage>–<lpage>1130</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3396</pub-id>
<pub-id pub-id-type="pmid">26343387</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref075">
<label>75</label>
<mixed-citation publication-type="journal">
<name><surname>Dahl</surname><given-names>A</given-names></name>, <name><surname>Iotchkova</surname><given-names>V</given-names></name>, <name><surname>Baud</surname><given-names>A</given-names></name>, <name><surname>Johansson</surname><given-names>Å</given-names></name>, <name><surname>Gyllensten</surname><given-names>U</given-names></name>, <name><surname>Soranzo</surname><given-names>N</given-names></name>, <etal>et al</etal>
<article-title>A multiple-phenotype imputation method for genetic studies</article-title>. <source/>Nature Genetics. <year>2016</year>;<volume>48</volume>(<issue>4</issue>):<fpage>466</fpage>–<lpage>472</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3513</pub-id>
<pub-id pub-id-type="pmid">26901065</pub-id></mixed-citation>
</ref>
<ref id="pgen.1008009.ref076">
<label>76</label>
<mixed-citation publication-type="journal">
<name><surname>Mazumder</surname><given-names>R</given-names></name>, <name><surname>Hastie</surname><given-names>T</given-names></name>, <name><surname>Tibshirani</surname><given-names>R</given-names></name>. <article-title>Spectral Regularization Algorithms for Learning Large Incomplete Matrices</article-title>. <source/>Journal of Machine Learning Research. <year>2010</year>;<volume>11</volume>(<issue>Aug</issue>):<fpage>2287</fpage>–<lpage>2322</lpage>. <pub-id pub-id-type="pmid">21552465</pub-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>
</pmc-articleset>