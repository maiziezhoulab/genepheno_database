<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">

<pmc-articleset><article article-type="research-article" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<?properties open_access?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
<journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
<journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
<journal-title-group>
<journal-title>Bioinformatics</journal-title>
</journal-title-group>
<issn pub-type="ppub">1367-4803</issn>
<issn pub-type="epub">1367-4811</issn>
<publisher>
<publisher-name>Oxford University Press</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="pmid">29267850</article-id>
<article-id pub-id-type="pmc">5905576</article-id>
<article-id pub-id-type="doi">10.1093/bioinformatics/btx788</article-id>
<article-id pub-id-type="publisher-id">btx788</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Applications Notes</subject>
<subj-group subj-group-type="category-toc-heading">
<subject>Data and Text Mining</subject>
</subj-group>
</subj-group>
</article-categories>
<title-group>
<article-title>Rcupcake: an R package for querying and analyzing biomedical data through the BD2K PIC-SURE RESTful API</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Gutiérrez-Sacristán</surname>
<given-names>Alba</given-names>
</name>
<xref ref-type="aff" rid="btx788-aff1">1</xref>
<xref ref-type="aff" rid="btx788-aff2">2</xref>
<xref ref-type="aff" rid="btx788-aff3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Guedj</surname>
<given-names>Romain</given-names>
</name>
<xref ref-type="aff" rid="btx788-aff1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Korodi</surname>
<given-names>Gabor</given-names>
</name>
<xref ref-type="aff" rid="btx788-aff1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Stedman</surname>
<given-names>Jason</given-names>
</name>
<xref ref-type="aff" rid="btx788-aff1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id authenticated="false" contrib-id-type="orcid">http://orcid.org/0000-0002-9383-528X</contrib-id>
<name>
<surname>Furlong</surname>
<given-names>Laura I</given-names>
</name>
<xref ref-type="aff" rid="btx788-aff2">2</xref>
<xref ref-type="aff" rid="btx788-aff3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Patel</surname>
<given-names>Chirag J</given-names>
</name>
<xref ref-type="aff" rid="btx788-aff1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kohane</surname>
<given-names>Isaac S</given-names>
</name>
<xref ref-type="aff" rid="btx788-aff1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Avillach</surname>
<given-names>Paul</given-names>
</name>
<xref ref-type="aff" rid="btx788-aff1">1</xref>
<xref ref-type="corresp" rid="btx788-cor1"></xref>
<!--<email>paul_avillach@hms.harvard.edu</email>-->
</contrib>
</contrib-group>
<contrib-group>
<contrib contrib-type="editor">
<name>
<surname>Valencia</surname>
<given-names>Alfonso</given-names>
</name>
<role>Associate Editor</role>
</contrib>
</contrib-group>
<aff id="btx788-aff1"><label>1</label>Department of Biomedical Informatics, Harvard Medical School, Boston, MA, USA</aff>
<aff id="btx788-aff2"><label>2</label>Research Programme on Biomedical Informatics (GRIB), Hospital del Mar Medical Research Institute (IMIM), Barcelona, Spain</aff>
<aff id="btx788-aff3"><label>3</label>Department of Experimental and Health Sciences (DCEXS), Universitat Pompeu Fabra (UPF), Barcelona, Spain</aff>
<author-notes>
<corresp id="btx788-cor1">To whom correspondence should be addressed. Email: <email>paul_avillach@hms.harvard.edu</email></corresp>
</author-notes>
<pub-date pub-type="ppub">
<day>15</day>
<month>4</month>
<year>2018</year>
</pub-date>
<pub-date iso-8601-date="2017-12-18" pub-type="epub">
<day>18</day>
<month>12</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="pmc-release">
<day>18</day>
<month>12</month>
<year>2017</year>
</pub-date>
<!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
<volume>34</volume>
<issue>8</issue>
<fpage>1431</fpage>
<lpage>1432</lpage>
<history>
<date date-type="received">
<day>16</day>
<month>8</month>
<year>2017</year>
</date>
<date date-type="rev-recd">
<day>20</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>16</day>
<month>12</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
<copyright-year>2017</copyright-year>
<license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
<license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
</license>
</permissions>
<self-uri xlink:href="btx788.pdf"></self-uri>
<abstract>
<title>Abstract</title>
<sec id="s1">
<title>Motivation</title>
<p>In the era of big data and precision medicine, the number of databases containing clinical, environmental, self-reported and biochemical variables is increasing exponentially. Enabling the experts to focus on their research questions rather than on computational data management, access and analysis is one of the most significant challenges nowadays.</p>
</sec>
<sec id="s2">
<title>Results</title>
<p>We present Rcupcake, an R package that contains a variety of functions for leveraging different databases through the BD2K PIC-SURE RESTful API and facilitating its query, analysis and interpretation. The package offers a variety of analysis and visualization tools, including the study of the phenotype co-occurrence and prevalence, according to multiple layers of data, such as phenome, exposome or genome.</p>
</sec>
<sec id="s3">
<title>Availability and implementation</title>
<p>The package is implemented in R and is available under Mozilla v2 license from GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/hms-dbmi/Rcupcake">https://github.com/hms-dbmi/Rcupcake</ext-link>). Two reproducible case studies are also available (<ext-link ext-link-type="uri" xlink:href="https://github.com/hms-dbmi/Rcupcake-case-studies/blob/master/SSCcaseStudy_v01.ipynb">https://github.com/hms-dbmi/Rcupcake-case-studies/blob/master/SSCcaseStudy_v01.ipynb</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/hms-dbmi/Rcupcake-case-studies/blob/master/NHANEScaseStudy_v01.ipynb">https://github.com/hms-dbmi/Rcupcake-case-studies/blob/master/NHANEScaseStudy_v01.ipynb</ext-link>).</p>
</sec>
<sec id="s5">
<title>Supplementary information</title>
<p>
<xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
</sec>
</abstract>
<funding-group>
<award-group award-type="grant">
<funding-source>
<named-content content-type="funder-name">NIH</named-content>
<named-content content-type="funder-identifier">10.13039/100000002</named-content>
</funding-source>
<award-id>U54HG007963</award-id>
</award-group>
<award-group award-type="grant">
<funding-source>
<named-content content-type="funder-name">NIH</named-content>
<named-content content-type="funder-identifier">10.13039/100000002</named-content>
</funding-source>
<award-id>OT3 OD025466-01; NHLBI OT3 HL142480-01</award-id>
</award-group>
</funding-group>
<counts>
<page-count count="2"></page-count>
</counts>
</article-meta>
</front>
<body>
<sec>
<title>1 Introduction</title>
<p>The national precision medicine initiative represents a large bet on the hypothesis that multimodal or multidimensional perspectives will be able to identify subpopulations that are more predictable and share common disorders and potentially effective treatments. Testing this hypothesis requires: building an infrastructure capable of such multidimensional representation of patients in all their clinical complexity and genomic variability (<xref ref-type="bibr" rid="btx788-B3">National Research Council <italic>et al.</italic>, 2011</xref>) and making the access and analysis of the data included in this infrastructure easy and reproducible. That is the reason why the BD2K PIC-SURE RESTful API (<ext-link ext-link-type="uri" xlink:href="http://bd2k-picsure.hms.harvard.edu/">http://bd2k-picsure.hms.harvard.edu/</ext-link>) was created (<xref ref-type="bibr" rid="btx788-B2">Margolis, 2014</xref>). Actually, it provides a unique programmatic interface to access multiple large and complex data sets, containing data from different levels, like phenome, exposome or genome, in a reproducible way to follow the FAIR principles: findability, accessibility, interoperability and reusability (<xref ref-type="bibr" rid="btx788-B5">Wilkinson <italic>et al.</italic>, 2016</xref>). By providing some tools that make the access and analysis of these multiple layers of data through this API easier, the use of the API will be leveraged.</p>
<p>We created an R package named ‘Rcupcake’ that provides to the user an easy way to query data through the BD2K PIC-SURE RESTful API and a set of functions to perform descriptive analyses, univariate analyses and comorbidities studies.</p>
</sec>
<sec>
<title>2 Materials and methods</title>
<p>The R package ‘Rcupcake’ includes a set of 18 functions (<xref ref-type="supplementary-material" rid="sup1">Supplementary Section 9</xref>) for retrieving and analyzing any patient-level data—linked with a patient identifier (genomics, clinical, environmental, etc.). Bringing together the data from different studies on an individual takes considerable effort and a significant investment of time to understand how all the data relates to individual study participants. Rcupcake allows data scientists to generate data analysis for their own database easily.</p>
<sec>
<title>2.1 Retrieving the data from the BD2K PIC-SURE RESTful API</title>
<p>Data retrieval using the BD2K PIC-SURE RESTful API requires several steps (<ext-link ext-link-type="uri" xlink:href="http://bd2k-picsure.hms.harvard.edu/example-01.html">http://bd2k-picsure.hms.harvard.edu/example-01.html</ext-link>): (i) to get the API key, (ii) to start a secure session, (iii) to create and run a JSON query and (iv) to download the data in one of the available formats.</p>
<p>The Rcupcake package only requires the URL, the access keys to the databases of interest and the location paths of the variables of interest from the end-user to retrieve the data. With this input, the Rcupcake package handles the connection to the servers, the JSON query building and the data downloading. Once done, the data can be exported for further analyses.</p>
</sec>
<sec>
<title>2.2 Data analyses and visualization</title>
<p>Rcupcake provides support for the study and visualization of some attributes contained in the datasets, enabling researchers to explore and characterize the retrieved data in three different ways: (i) descriptive analysis, (ii) univariate analysis and (iii) co-occurrence analysis.</p>
<p>The descriptive analysis can be performed using three different functions:
<list list-type="bullet"><list-item><p><bold><italic>demographic.summary</italic></bold> performs the description of two main demographic characteristics— age and gender—of the population under study (examples and detailed information in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section 5</xref>).</p></list-item><list-item><p><bold><italic>phenotype.summary</italic></bold> performs a descriptive analysis of all the variables of interest for the whole population and/or according to one variable (exposure, mutation, etc.) (examples and detailed information in <xref ref-type="supplementary-material" rid="sup1">Supplementary Section 6</xref>).</p></list-item><list-item><p><bold><italic>phenotype.prevalence</italic></bold> provides the proportion of all the variables of interest with their confidence intervals (examples and detailed information in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Section 7.1</xref>).</p></list-item></list>The univariate analysis can be performed using the function:
<list list-type="bullet"><list-item><p><bold><italic>comparison2b2</italic></bold> performs the univariate analysis between two variables. The function determines whether the variables are binary or continuous and computes a Fisher’s test, a <italic>t</italic>-test or a Pearson correlation test.</p></list-item></list>The co-occurrence analyses and visualization can be performed using three functions:
<list list-type="bullet"><list-item><p><bold><italic>co.occurrence</italic></bold> assesses the co-occurrence between two variables (usually diseases). Different co-occurrence tests and cut-off values can be chosen (examples and detailed information in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Section 7</xref>). The co-occurrences analyses can also be performed according to a variable (Exposure) such as an exposome variable or a gene mutation in order to compare the results.</p></list-item><list-item><p><bold><italic>cooc.network</italic></bold><italic>and</italic><bold><italic>cooc.heatmap</italic></bold> create, respectively, a network plot or a heatmaps plot to visualize the results of the co-occurrence analyses.</p></list-item></list></p>
</sec>
</sec>
<sec>
<title>3 Example applications of the Rcupcake package</title>
<p>To show the functionality and features of Rcupcake, two different datasets accessible with the BD2K PIC-SURE RESTful API are used as demonstration case studies, NHANES (<xref ref-type="bibr" rid="btx788-B4">Patel <italic>et al.</italic>, 2016</xref>) and Simon Simplex Collection (SSC) (<xref ref-type="bibr" rid="btx788-B1">Fischbach and Lord, 2010</xref>). NHANES is a public available database that contains phenome and exposome data for more than 41 474 patients while SSC encloses phenome and genome information from 2600 simplex families where there is one proband suffering from autism and needs a signed data-use agreement. The Rcupcake package enables the user to exploit the data from both of them, following the same easy structure (<xref ref-type="supplementary-material" rid="sup1">Supplementary Jupyter Notebooks</xref>). We have specifically illustrated this using the open source Jupyter notebook, which has been widely adopted across multiple data science disciplines both for its usefulness in keeping a record of data analyses and also for allowing reproducibility of the studies by any party, given access to these notebooks.</p>
<p>The two case studies show a step by step retrieval and analysis process for each of these databases. The steps described are (i) how to query the database through the BD2K PIC-SURE API RESTful API using R, (ii) how to perform a descriptive analysis of the population and the variables retrieved, (iii) how to perform a univariate analysis with the retrieved data and (iv) how to perform a co-occurrence analyses and visualize the results.</p>
</sec>
<sec>
<title>4 Conclusion</title>
<p>The Rcupcakge package combined with the BD2K PIC-SURE RESTful API facilitates the data access and analysis to any patient-level data linked with a patient identifier available through the API with R and provides a solid base for scalable and reproducible analysis. Rcupcake package is especially suited for researchers to analyze multiple layers of data, enabling the combination of thousands of different variables—clinical, environmental, self-reported, biochemical—all in one set of data structures that are queryable. Moreover, it can be integrated with other R packages available for follow-up analyses. It represents a step further to improve data-driven discovery, understanding and interpretation.</p>
</sec>
<sec>
<title>Funding</title>
<p>This work has been supported by the NIH BD2K grant U54HG007963; NIH Data Commons OT3 OD025466-01; NHLBI OT3 HL142480-01.</p>
<p>
<italic>Conflict of Interest</italic>: none declared.</p>
</sec>
<sec sec-type="supplementary-material">
<title>Supplementary Material</title>
<supplementary-material content-type="local-data" id="sup1">
<label>Supplementary Data</label>
<media xlink:href="btx788_suppl_data.zip">
<caption>
<p>Click here for additional data file.</p>
</caption>
</media>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="btx788-B1">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Fischbach</surname><given-names>G.D.</given-names></name>, <name name-style="western"><surname>Lord</surname><given-names>C.</given-names></name></person-group> (<year>2010</year>) 
<article-title>The Simons Simplex Collection: a resource for identification of autism genetic risk factors</article-title>. <source/>Neuron, <volume>68</volume>, <fpage>192</fpage>–<lpage>195</lpage>.<pub-id pub-id-type="pmid">20955926</pub-id></mixed-citation>
</ref>
<ref id="btx788-B2">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Margolis</surname><given-names>R.</given-names></name></person-group>
<etal>et al</etal> (<year>2014</year>) 
<article-title>The National Institutes of Health’s Big Data to Knowledge (BD2K) initiative: capitalizing on biomedical big data</article-title>. <source/>J. Am. Med. Inform. Assoc., <volume>21</volume>, <fpage>957</fpage>–<lpage>958</lpage>.<pub-id pub-id-type="pmid">25008006</pub-id></mixed-citation>
</ref>
<ref id="btx788-B3">
<mixed-citation publication-type="book">
<collab>National Research Council</collab>. <etal>et al</etal> (<year>2011</year>) <source/>Toward Precision Medicine: Building a Knowledge Network for Biomedical Research and a New Taxonomy of Disease. 
<publisher-name>National Academies Press</publisher-name>, 
<publisher-loc>Washington, D.C</publisher-loc>.</mixed-citation>
</ref>
<ref id="btx788-B4">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Patel</surname><given-names>C.J.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>A database of human exposomes and phenomes from the US National Health and Nutrition Examination Survey</article-title>. <source/>Sci. Data, <volume>3</volume>, <fpage>160096.</fpage><pub-id pub-id-type="pmid">27779619</pub-id></mixed-citation>
</ref>
<ref id="btx788-B5">
<mixed-citation publication-type="journal">
<person-group person-group-type="author"><name name-style="western"><surname>Wilkinson</surname><given-names>M.D.</given-names></name></person-group>
<etal>et al</etal> (<year>2016</year>) 
<article-title>The FAIR guiding principles for scientific data management and stewardship</article-title>. <source/>Sci.Data, <volume>3</volume>, <fpage>160018.</fpage><pub-id pub-id-type="pmid">26978244</pub-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>
</pmc-articleset>