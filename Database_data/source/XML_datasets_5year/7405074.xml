<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">

<pmc-articleset><article article-type="research-article" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<?properties open_access?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">eNeuro</journal-id>
<journal-id journal-id-type="iso-abbrev">eNeuro</journal-id>
<journal-id journal-id-type="hwp">eneuro</journal-id>
<journal-id journal-id-type="pmc">eneuro</journal-id>
<journal-id journal-id-type="publisher-id">eNeuro</journal-id>
<journal-title-group>
<journal-title>eNeuro</journal-title>
</journal-title-group>
<issn pub-type="epub">2373-2822</issn>
<publisher>
<publisher-name>Society for Neuroscience</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="pmid">32241874</article-id>
<article-id pub-id-type="pmc">7405074</article-id>
<article-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020</article-id>
<article-id pub-id-type="publisher-id">eN-NWR-0408-19</article-id>
<article-categories>
<subj-group subj-group-type="hwp-journal-coll">
<subject>1</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Research Article: New Research</subject>
<subj-group>
<subject>Cognition and Behavior</subject>
</subj-group>
</subj-group>
</article-categories>
<title-group>
<article-title>Hierarchical Compression Reveals Sub-Second to Day-Long Structure in Larval Zebrafish Behavior</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ghosh</surname>
<given-names>Marcus</given-names>
</name>
<xref ref-type="aff" rid="aff1"></xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Rihel</surname>
<given-names>Jason</given-names>
</name>
<xref ref-type="aff" rid="aff1"></xref>
</contrib>
<aff id="aff1">Department of Cell and Developmental Biology, <institution>University College London</institution>, London WC1E 6BT, <country>United Kingdom</country>
</aff>
</contrib-group>
<author-notes>
<fn fn-type="other">
<p>The authors declare no competing financial interests.</p>
</fn>
<fn fn-type="con">
<p>Author contributions: M.G. and J.R. designed research; M.G. performed research; J.R. contributed unpublished reagents/analytic tools; M.G. and J.R. analyzed data; M.G. and J.R. wrote the paper.</p>
</fn>
<fn fn-type="supported-by">
<p>This work was supported by a Medical Research Council Doctoral Training grant (M.G.), a UCL Excellence fellowship (J.R.), a Wellcome Trust Investigator Award (J.R.), and a European Research Council starting grant (J.R.).</p>
</fn>
<corresp id="cor1">Correspondence should be addressed to Jason Rihel at <email>j.rihel@ucl.ac.uk</email>.</corresp>
</author-notes>
<pub-date pub-type="epreprint">
<day>2</day>
<month>4</month>
<year>2020</year>
</pub-date>
<pub-date pub-type="epub">
<day>13</day>
<month>7</month>
<year>2020</year>
</pub-date>
<pub-date pub-type="collection">
<season>Jul-Aug</season>
<year>2020</year>
</pub-date>
<volume>7</volume>
<issue>4</issue>
<elocation-id>ENEURO.0408-19.2020</elocation-id>
<history>
<date date-type="received">
<day>4</day>
<month>10</month>
<year>2019</year>
</date>
<date date-type="rev-recd">
<day>22</day>
<month>1</month>
<year>2020</year>
</date>
<date date-type="accepted">
<day>26</day>
<month>2</month>
<year>2020</year>
</date>
</history>
<permissions>
<copyright-statement>Copyright © 2020 Ghosh and Rihel</copyright-statement>
<copyright-year>2020</copyright-year>
<copyright-holder>Ghosh and Rihel</copyright-holder>
<license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/">
<license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>, which permits unrestricted use, distribution and reproduction in any medium provided that the original work is properly attributed.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="ENEURO.0408-19.2020.pdf"></self-uri>
<self-uri xlink:href="ENEURO.0408-19.2020g1.jpg" xlink:role="icon"></self-uri>
<abstract>
<title>Abstract</title>
<p>Animal behavior is dynamic, evolving over multiple timescales from milliseconds to days and even across a lifetime. To understand the mechanisms governing these dynamics, it is necessary to capture multi-timescale structure from behavioral data. Here, we develop computational tools and study the behavior of hundreds of larval zebrafish tracked continuously across multiple 24-h day/night cycles. We extracted millions of movements and pauses, termed bouts, and used unsupervised learning to reduce each larva’s behavior to an alternating sequence of active and inactive bout types, termed modules. Through hierarchical compression, we identified recurrent behavioral patterns, termed motifs. Module and motif usage varied across the day/night cycle, revealing structure at sub-second to day-long timescales. We further demonstrate that module and motif analysis can uncover novel pharmacological and genetic mutant phenotypes. Overall, our work reveals the organization of larval zebrafish behavior at multiple timescales and provides tools to identify structure from large-scale behavioral datasets.</p>
</abstract>
<kwd-group>
<kwd>behavioral dynamics</kwd>
<kwd>sleep</kwd>
<kwd>zebrafish</kwd>
</kwd-group>
<funding-group>
<award-group>
<funding-source><named-content content-type="funder-id">http://doi.org/10.13039/501100000781</named-content>EC | European Research Council (ERC)</funding-source>
<award-id>282027</award-id>
</award-group>
<award-group>
<funding-source>UCL Excellence Fellowship</funding-source>
</award-group>
<award-group>
<funding-source>Medical Research Council Doctoral Training Grant</funding-source>
</award-group>
</funding-group>
<counts>
<fig-count count="5"></fig-count>
<table-count count="12"></table-count>
<equation-count count="13"></equation-count>
<ref-count count="53"></ref-count>
<page-count count="21"></page-count>
<word-count count="00"></word-count>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>cover-date</meta-name>
<meta-value>July/August 2020</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="s1" sec-type="intro">
<title>Significance Statement</title>
<p>Behavior is dynamic and not only can change from one second to the next but also can unfold over many hours or even days. Understanding how behavior is organized on these different timescales is a critical task in neuroscience, because the constraints on and patterns of behavior offer important clues about the underlying computations being performed in the brain. The analysis tools we develop in this manuscript and apply from sub-second to day-long larval zebrafish behavior expands our understanding of how behavioral patterns change at multiple timescales. The computational metrics we describe can now be used to understand the behavioral consequences of psychotropic drugs or genetic lesions associated with neurodevelopmental and neuropsychiatric disorders.</p>
</sec>
<sec id="s2" sec-type="intro">
<title>Introduction</title>
<p>To survive, animals must coordinate patterns of action and inaction in response to their environment. These actions and inactions, which together we will define as behavior, result from some function incorporating internal (e.g., transcriptional, hormonal, or neuronal activity) and external (e.g., time of day or temperature) state. Thus, behavioral descriptions provide insight into the underlying mechanisms that control behavior and are a necessary step in understanding these systems (<xref ref-type="bibr" rid="B27">Krakauer et al., 2017</xref>).</p>
<p>Animal behavior, however, typically has many degrees of freedom and evolves over multiple timescales from milliseconds (<xref ref-type="bibr" rid="B51">Wiltschko et al., 2015</xref>) to days (<xref ref-type="bibr" rid="B37">Proekt et al., 2012</xref>; <xref ref-type="bibr" rid="B17">Fulcher and Jones, 2017</xref>) and even across an animal’s entire lifespan (<xref ref-type="bibr" rid="B24">Jordan et al., 2013</xref>; <xref ref-type="bibr" rid="B44">Stern et al., 2017</xref>). As such, quantitatively describing behavior remains both conceptually and technically challenging (<xref ref-type="bibr" rid="B5">Berman, 2018</xref>; <xref ref-type="bibr" rid="B8">Brown and de Bivort, 2018</xref>). Inspired by early ideas from ethology (<xref ref-type="bibr" rid="B29">Lashley, 1951</xref>; <xref ref-type="bibr" rid="B46">Tinbergen, 2010</xref>), one approach is to describe behavior in terms of simple modules that are arranged into more complex motifs. Behavioral modules are often defined from postural data as stereotyped movements, such as walking in <italic>Drosophila</italic> (<xref ref-type="bibr" rid="B7">Berman et al., 2014</xref>; <xref ref-type="bibr" rid="B50">Vogelstein et al., 2014</xref>; <xref ref-type="bibr" rid="B42">Robie et al., 2017</xref>) and mice (<xref ref-type="bibr" rid="B51">Wiltschko et al., 2015</xref>), while behavioral motifs are defined as sequences of modules, which capture the patterns inherent to animal behavior, such as grooming in <italic>Drosophila</italic> (<xref ref-type="bibr" rid="B7">Berman et al., 2014</xref>, <xref ref-type="bibr" rid="B6">2016</xref>).</p>
<p>Zebrafish larvae have emerged as a powerful model organism in neuroscience, owing to their genetic tractability (<xref ref-type="bibr" rid="B22">Howe et al., 2013</xref>), translucency (<xref ref-type="bibr" rid="B49">Vanwalleghem et al., 2018</xref>), and amenability to pharmacological screening (<xref ref-type="bibr" rid="B39">Rihel and Ghosh, 2015</xref>). In terms of behavior, larvae exhibit an alternating sequence of movements and pauses, termed bouts. This structure is particularly suited to modular description as individual bouts can be easily segmented and it is relatively easy to acquire many examples from even a single animal due to the high frequency of their movement (<xref ref-type="bibr" rid="B25">Kim et al., 2017</xref>). Leveraging these advantages, recent work used unsupervised learning to uncover a locomotor repertoire of 13 swim types in larval zebrafish, including slow forward swims and faster escape swims (<xref ref-type="bibr" rid="B31">Marques et al., 2018</xref>). However, the inactive periods between swim bouts were not considered, despite reflecting behavioral states such as passivity in the face of adversity (<xref ref-type="bibr" rid="B33">Mu et al., 2019</xref>) or even sleep (<xref ref-type="bibr" rid="B36">Prober et al., 2006</xref>).</p>
<p>To explore an animal’s full behavioral repertoire, from fast movements to sleep, it is necessary to study behavior over long timescales. To date, however, module and motif descriptions of behavior have been developed from videos 15 min (<xref ref-type="bibr" rid="B50">Vogelstein et al., 2014</xref>; <xref ref-type="bibr" rid="B51">Wiltschko et al., 2015</xref>; <xref ref-type="bibr" rid="B42">Robie et al., 2017</xref>) to 2 h (<xref ref-type="bibr" rid="B31">Marques et al., 2018</xref>) in length. Consequently, most identified behavioral structure has been on the order of milliseconds, and the existence of longer-timescale structure, on the order of minutes to hours has remained largely unexplored. The development of methods to extract multi-timescale structure from long-timescale recordings would open avenues to explore questions about how behavior varies across the day/night cycle and develops across an animal’s lifespan. Furthermore, as pharmacologically or genetically induced behavioral phenotypes can differ at different times of the day/night cycle in zebrafish larvae (<xref ref-type="bibr" rid="B40">Rihel et al., 2010a</xref>; <xref ref-type="bibr" rid="B21">Hoffman et al., 2016</xref>), a long-timescale approach would provide valuable phenotyping information.</p>
<p>Currently, the limiting factor in scaling these methods is the volume of data, owing to the high framerates and dimensionality required to estimate animal posture. Here, we present an alternative approach in which we trade dimensionality for scale by building a module and motif description of larval zebrafish behavior from a one-dimensional behavioral parameter recorded over time. Specifically, we used a high-throughput behavioral set-up (<xref ref-type="bibr" rid="B41">Rihel et al., 2010b</xref>) to continuously monitor the activity of hundreds of zebrafish larvae across multiple days and nights. To identify multi-timescale behavioral structure, we developed a three-step computational approach. First, we used unsupervised learning to identify a set of 10 behavioral modules that describe both active and inactive bout structure. Second, we applied a compression algorithm (<xref ref-type="bibr" rid="B34">Nevill-Manning and Witten, 2000</xref>) to our module data to compile a library of almost 50,000 motifs, revealing behavioral patterns organized across sub-second to minute timescales. Finally, we used a supervised learning algorithm (<xref ref-type="bibr" rid="B20">Peng et al., 2005</xref>) to identify motifs from the library used at particular times of the day/night cycle. To test the ability of our approach to detect biologically relevant phenotypes, we also studied the behavior of larvae exposed to the seizure-inducing drug, pentylenetetrazol (PTZ; <xref ref-type="bibr" rid="B3">Baraban et al., 2005</xref>), the sedating drug, melatonin (<xref ref-type="bibr" rid="B53">Zhdanova et al., 2001</xref>), and mutants of the hypocretin receptor (<italic>hcrtr</italic>; <xref ref-type="bibr" rid="B52">Yokogawa et al., 2007</xref>), the loss of which is associated with narcolepsy in humans (<xref ref-type="bibr" rid="B30">Lin et al., 1999</xref>) and altered bout structure in zebrafish (<xref ref-type="bibr" rid="B52">Yokogawa et al., 2007</xref>; <xref ref-type="bibr" rid="B13">Elbaz et al., 2012</xref>). We found that our computational approach could readily detect both compound dose and mutant specific differences in module and motif usage, demonstrating the biological relevance of our behavioral description.</p>
<p>Ultimately, our work reveals the organization of larval zebrafish behavior at sub-second to day-long timescales and provides new computational tools to identify structure from large-scale behavioral datasets.</p>
</sec>
<sec id="s3" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s3A">
<title>Animal husbandry</title>
<p>Adult zebrafish were reared by University College London (UCL) Fish Facility on a 14/10 h light/dark cycle (lights on: 9 A.M. to 11 P.M.). To obtain embryos, pairs of adult males and females were isolated overnight with a divider that was removed at 9 A.M. the following morning. After a few hours, fertile embryos were collected and sorted under a bright-field microscope into groups of 50 embryos per 10-cm Petri dish filled with fresh fish water (0.3 g/l Instant Ocean). Plates were kept in an incubator at 28.5°C on a 14/10 h light/dark cycle. Using a Pasteur pipet under a bright-field microscope, debris was removed from the plates and the fish water replaced each day. All work was in accordance with the United Kingdom Animal Experimental Procedures Act (1986) under Home Office Project License 70/7612 awarded to J.R.</p>
</sec>
<sec id="s3B">
<title>Behavioral setup</title>
<p>For all behavioral experiments a Pasteur pipet was used to transfer single zebrafish larvae [aged 4–5 d post fertilization (dpf)] into the individual wells of a clear 96-square well plate (7701-1651; Whatman); then each well was filled with 650 μl of fish water. For experiments longer than 24 h, larvae were plated at 4 dpf and tracking was started the same day. For the duration of these experiments, evaporated fish water was replaced each morning between 9 and 9:30 A.M. For the wild-type experiments, each plate was covered with a plastic lid (4311971; Applied Biosystems) to prevent evaporation and to negate the need to replenish the fish water. For the 24-h small molecule experiments (melatonin and PTZ), larvae were plated at 5dpf and the plates were left overnight in a 28.5°C 14 h/10 h light/dark incubator. The following morning each plate was transferred to a behavior setup where larvae were dosed, between 9 and 10 A.M., immediately after which behavioral recordings were started and run for 24 h. Following two control rows, each row was dosed with a successively higher concentration of test compound. Larvae were not fed either before or during experiments.</p>
<p>To record each animal’s behavior, each plate was placed into a Zebrabox (ViewPoint Life Sciences) running quantization mode with the following settings: detection sensitivity, 15; burst, 50; and freezing, 4. All experiments were conducted on a 14/10 h light/dark cycle (lights on at 9 A.M. to 11 P.M.) with constant infrared illumination. All experiments were recorded at 25 Hz. Larvae were tracked continuously for 24–73 h, after which all larvae unresponsive to touch with a 10-μl pipette tip were presumed sick or dead and excluded from subsequent analysis. In the wild-type experiments we additionally excluded wells in which a bubble had formed under the plastic lid. The number of larvae excluded/used for each set of experiments is as follows: wild type, 164/288 (all exclusions were due to bubble artefacts); hypocretin, 0/180; melatonin, 0/96; PTZ, 44/96 (doses of 10, 15, and 30 m<sc>M</sc> were lethal to all tested larvae over 24 h). Following each experiment, larvae were euthanized with an overdose of 2-phenoxyethanol (Acros Organics).</p>
</sec>
<sec id="s3C">
<title>Fish lines</title>
<p>The term wild type refers to the AB x TUP LF zebrafish strain. This line was used for the wild-type experiments, as well as the melatonin and PTZ dose-response curves. <italic>hcrtr</italic> (ZFIN ID: hu2098; <xref ref-type="bibr" rid="B52">Yokogawa et al., 2007</xref>) experiments were conducted on embryos collected from heterozygous in-crosses, with larvae genotyped using KASP primers (LGC Genomics) post-tracking. KASP results were validated by comparison to PCR-based genotyping of samples from each KASP classified genotype.</p>
</sec>
<sec id="s3D">
<title><italic>hcrtr</italic> genotyping</title>
<sec id="s3D1">
<title>DNA extraction</title>
<p>Following each <italic>hcrtr</italic> experiment, each larva was euthanized in its well (as above) and DNA was extracted using HotSHOT DNA preparation (<xref ref-type="bibr" rid="B48">Truett et al., 2000</xref>). Larval samples were transferred to the individual wells of a 96-well PCR plate. Excess liquid was pipetted from each well before applying 50 μl of 1× base solution (1.25 M KOH and 10 m<sc>M</sc> EDTA in water). Plates were heat sealed and incubated at 95°C for 30 min, then cooled to room temperature before the addition of 50 μl of 1× neutralization solution (2 M Tris-HCl in water).</p>
</sec>
<sec id="s3D2">
<title>PCR</title>
<p>The following reaction mixture per sample was prepared on ice in a 96-well PCR plate: 18.3 μl PCR mix (2 mM MgCl<sub>2</sub>, 14 mM, pH 8.4, Tris-HCl, 68 mM KCl, 0.14% gelatin in water, autoclaved for 20 min, cooled to room temperature, chilled on ice, then we added: 1.8% 100 mg/ml BSA and 0.14% 100 mM d [A, C, G, T] TP), 0.5 μl of forward and reverse primers (20 μ<sc>M</sc>), 5.5 μl water, 0.2 μl of Taq polymerase, and 3.0 μl of DNA. Next, each plate was heat sealed and placed into a thermocycler, set with the following program: 95°C, 5 min; 44 cycles: 95°C, 30 s; 57°C, 30 s; and 72°C, 45 s; then 72°C, 10 min and 10°C until collection. Finally, samples were mixed with 6× loading buffer [colorless buffer: Ficoll-400, 12.5 g, Tris-HCl (1 M, pH 7.4) – 5 ml, EDTA (0.5 M) – 10 ml, to 50 ml in pure water; heated to 65°C to dissolve, per 10 ml of colorless buffer 25 mg of both xylene cyanol and orange G were added, then diluted to 6×] and run on agarose gels (1% – 2%) with 4% GelRed (Biotium).</p>
<p><italic>hcrtr</italic> forward primer: 5′-<named-content content-type="gene">CCACCCGCTAAAATTCAAAAGCACTGCTAAC</named-content>-3′; <italic>hcrtr</italic> reverse primer: 5′-<named-content content-type="gene">CATCACAGACGGTGAACAGG</named-content>-3′.</p>
</sec>
<sec id="s3D3">
<title>PCR information</title>
<p>PCR products were digested with Ddel at 37°C to produce a 170-bp band in the wild-type animals and 140- and 30-bp bands in <italic>hcrtr</italic> mutants.</p>
</sec>
<sec id="s3E">
<title>KASP</title>
<p>KASP genotyping was conducted in white, low profile PCR plates on ice with six wells allocated 50:50 for positive and negative controls. The following reaction mixture was prepared per sample: 3.89 μl of 2× KASP reaction mix, 0.11 μl KASP primers, 1.0 μl water, and 3.0 μl DNA. Plates were then heat sealed and placed into a thermocycler with the following thermal cycling program: 94°C, 15 min; 10 cycles: 94°C, 20 s; 61–53°C (dropping 0.8°C per cycle), 60 s; 26 cycles: 94°C, 20 s; 53°C, 60 s, then 10°C until collection.</p>
<p>Following thermal cycling we used a fluorescence reader (Bio-Rad CFX96 Real-Time System) and Bio-Rad CFX Manager software (version 3.1) to automatically determine each sample’s genotype from a 2D scatter plot of fluorescence in each channel. From this scatter plot, outlying samples of unclear genotype were manually excluded from subsequent analysis.</p>
</sec>
<sec id="s3E4">
<title>KASP assay ID: 554-0090.1</title>
<p>KASP Flanking Sequence (alternative allele shown in square brackets, with a forward slash indicating a deletion in the alternative allele): 5′-<named-content content-type="gene">ACCGCTGGTATGCGATCTGCCACCCGCTAAAATTCAAAAGCACTGCTAAA</named-content>[A/T]<named-content content-type="gene">GAGCCCGCAAGAGCATC</named-content>
<named-content content-type="gene">GTGCTGATCTGGCTGGTGTCCTGCATCATGATG</named-content>-3′.</p>
</sec>
</sec>
<sec id="s3F">
<title>Pharmacology</title>
<p>0.15 M melatonin and 1 M PTZ (M5250 and P6500; Sigma) stock solutions were made in DMSO and sterile water, respectively. Behavioral testing concentrations for each compound were selected based on <xref ref-type="bibr" rid="B40">Rihel et al. (2010a)</xref>. For behavior experiments, each animal in a well with 650 μl of fish water was dosed with 1.3 μl of either vehicle control or compound at 500× concentration, resulting in a 1 in 500 dilution and thus the desired testing concentration.</p>
</sec>
<sec id="s3G">
<title>Computing</title>
<sec id="s3G5">
<title>Hardware</title>
<p>A desktop computer with 16 GB of RAM was used for most data analysis, figure production, and writing. For two-time intensive steps, hierarchical compression of full module sequences (Batch_Compress.m) and normalizing the behavioral motif counts (Batch_Grammar_Freq.m), data were run in parallel, with a worker for every animal, on the UCL Legion Cluster (Research Computing Services, UCL).</p>
</sec>
<sec id="s3G6">
<title>Software</title>
<p>All software used for data handling, analysis, and the production of figures is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ghoshm/Structure_Paper">https://github.com/ghoshm/Structure_Paper</ext-link>. The codes are also available as <xref ref-type="supplementary-material" rid="ext1">Extended Data 1</xref> and Extended Data <xref ref-type="supplementary-material" rid="ext2">2</xref>.</p>
<supplementary-material content-type="local-data" id="ext1">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.ed1</object-id>
<label>Extended Data 1</label>
<caption>
<p>Supplementary Paper Code_Extended Data. Download <inline-supplementary-material content-type="local-data" id="ed1" mime-subtype="zip" mimetype="application" xlink:href="enu-eN-NWR-0408-19-s10.zip">Extended Data 1, ZIP file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
<supplementary-material content-type="local-data" id="ext2">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.ed2</object-id>
<label>Extended Data 2</label>
<caption>
<p>Supplementary Legion Code_Extended Data. Download <inline-supplementary-material content-type="local-data" id="ed2" mime-subtype="zip" mimetype="application" xlink:href="enu-eN-NWR-0408-19-s11.zip">Extended Data 2, ZIP file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
</sec>
<sec id="s3G7">
<title>Processing behavioral data</title>
<p>See Extended Data <xref ref-type="supplementary-material" rid="fig1-3">Figure 1-3</xref> for a flow diagram describing behavioral data acquisition and analysis. All custom behavioral analysis software was written and run in MATLAB 2016b-2018a (MathWorks). The suffixes .m and .mat denote MATLAB code and MATLAB data files, respectively.</p>
<p>Behavioral data were recorded by subtracting subsequent pairs of frames from each other and determining the number of pixels that changed intensity within each well between each pair of frames, termed Δ pixels. To acquire behavior data, each Zebrabox was setup using ViewPoint’s ZEBRALAB software (version 3.22), which outputs a .xls and a .raw file (ViewPoint specific format) per experiment. Each behavior .xls file was reorganized into a .txt file using the function perl_batch_192.m (Jason Rihel). For each experiment a .txt metadata file assigning each animal to an experimental group, for example genotype, was manually produced. To replicate the previous analysis methodology, as in Extended Data <xref ref-type="supplementary-material" rid="fig1-1">Figure 1-1<italic>D</italic></xref>, behavior and metadata .txt files were input to the function sleep_analysis2.m (Jason Rihel).</p>
<supplementary-material content-type="local-data" id="fig1-1">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.f1-1</object-id>
<label>Extended Data Figure 1-1</label>
<caption>
<p>Behavioral set-up and analysis. <bold><italic>A</italic></bold>, Schematic of our behavioral set-up. Note that aside from the computer, the set-up is fully enclosed. Not shown to scale. IR, infrared; LED, light emitting diode. <bold><italic>B</italic></bold>, Normalized temporal correlation of active bout starts between 24 wild-type larva (6 dpf) across 24 h. Pairwise correlations were computed and then grouped into three groups: autocorrelation (orange); neighbor fish, defined as larva in adjacent wells, diagonals excluded (light blue); and distant, non-neighbor fish (dark blue). Data from each group are plotted as a mean (bold line) and SD (shaded surround). Note that the <italic>y</italic>-axis is cropped from 1, where autocorrelation peaks, to 0.1. <bold><italic>C</italic></bold>, A fictive illustration of zebrafish behavior (blue line). Two minutes of data are shown divided by a black dashed vertical line. A 1-min binning approach would score both minutes as 20 s of activity and miss the 60-s period of inactivity in between. This latter loss leads to a discrepancy in the number of periods ≥60 s between the 1-min bin and 25-Hz methods (see <bold><italic>D</italic></bold>). <bold><italic>D</italic></bold>, The number of inactive periods ≥60 s for each of 124 wild-type animals is shown, as determined by both a 1-min bin and 25-Hz approach. Data are from each animal’s entire recording period (4–7 dpf). Data for each animal is shown as a pale blue line overlaid with a bold line showing the population mean and SD. Inset, The percentage of the 25-Hz counts detected by the 1-min bin method per animal. Each animal’s data are shown by a circle. An orange cross marks the population mean. <bold><italic>E</italic></bold>, Average activity across one day (white background) and night (dark background) for larvae exposed to either H<sub>2</sub>O (control) or a range of PTZ doses immediately prior to tracking at 6 dpf. Data for each larva was summed into seconds and then smoothed with a 15-min running average. Shown is a mean summed and smoothed trace (bold line) and SEM (shaded surround); <italic>n</italic> denotes the number of animals per condition. Download <inline-supplementary-material content-type="local-data" id="f1-1" mime-subtype="tiff" mimetype="image" xlink:href="enu-eN-NWR-0408-19-s01.tif">Figure 1-1, TIF file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
<p>To assess data on a frame by frame basis, each experiment's .raw file, which was output from Viewpoint’s Zebrabox, was exported within the ZEBRALAB software to thousands of .xls files. Each .xls file contained 50,000 rows and 21 columns, with data from any given well listed approximately every 192 rows, as the setup always assumes recordings are from two 96-well plates. This formatting is, however, only approximate as infrequently the well order is erroneously non-sequential; these rows were termed ordering errors. Each .xls file is formatted with 21 columns, of which three contain useful data: type, notes when ViewPoint defined data acquisition errors occurred; location, denotes which well the data came from; and data1, records the Δ pixel value from that well for that time point.</p>
<p>The function Vp_Extract.m was used to reformat the .xls files from each experiment to single frame by fish matrices, from which each animal’s behavior was quantified. Vp_Extract.m requires three inputs to be selected: a folder containing the .xls files; a .txt behavior file output from perl_batch_192.m; and a .txt metadata file. To ensure that each animal has the same number of frames, frames with ViewPoint defined errors or ordering errors (which are automatically detected by Vp_Extract.m) are discarded. A maximum Δ pixels value can be set and active bouts containing even a single frame with a higher Δ pixels value than this are set to zero for the entire duration of the bout. Here a maximum Δ pixels threshold of 200 was set. This value was determined from manual inspection of the dataset as well as by comparisons of these data to data recorded from plates with no animals in. Following this step, the maximum Δ pixels value observed was 165. Most Δ pixels values were between 3 (minimum observed value) and 30 (Extended Data <xref ref-type="supplementary-material" rid="fig1-2">Fig. 1-2<italic>A</italic></xref>). Time periods during which water is being replenished are automatically detected and set to a Δ pixels value of zero. These time periods are noted and excluded from later analysis. The function outputs .mat files for subsequent analysis. Either single or multiple .mat files output from Vp_Extract.m were input to Vp_Analyse.m and Bout_Clustering.m.</p>
<supplementary-material content-type="local-data" id="fig1-2">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.f1-2</object-id>
<label>Extended Data Figure 1-2</label>
<caption>
<p>Bout Features. <bold><italic>A</italic></bold>, Bout feature distributions during the day (light blue) and the night (dark blue). For the probability curves, each animal’s data were fit with a pdf. Shown is a mean pdf (bold line) and SD (shaded surround) with a log scale on the <italic>x</italic>-axis. For the scatter plots, each larva’s mean value across the days or nights (5–6 dpf) is shown as a light blue (day) or dark blue circle (night). An orange cross marks each population’s mean. Of the pdfs, only the mean day and night active bout total and inactive bout length pdfs were consistently significantly different across three independent experiments (<italic>p</italic> &lt; 0.01; two-sample Kolmogorov–Smirnov test); <italic>n</italic> = 124 wild-type larvae. <bold><italic>B</italic></bold>, Melatonin bout feature means. A mean was taken per animal per feature, and day or night (6 dpf). Shown is a population mean and SEM during the day (white background) and the night (grey background). Control, DMSO; <italic>n</italic> = 24 controls then <italic>n</italic> = 12 per dose. <bold><italic>C</italic></bold>, PTZ bout feature means, as in <bold><italic>B</italic></bold>. Control, H<sub>2</sub>O; <italic>n</italic> = 24 controls then <italic>n</italic> = 10 (2.5 mM), <italic>n</italic> = 9 (5 mM), and <italic>n</italic> = 9 (7.5 mM). <bold><italic>D</italic></bold>, <italic>hcrtr</italic> bout feature means as in <bold><italic>B</italic></bold>, for days (white background) and nights (grey background) 5–6 post fertilization. <italic>hcrtr</italic><sup>-/-</sup> mutants had significantly lower mean values compared to both <italic>hcrtr</italic><sup>+/+</sup> and <italic>hcrtr</italic><sup>-/+</sup> for the following active bout features: length, SD and total (<italic>p</italic> &lt; 0.05 for all comparisons, Dunn–Sidak corrected four-way ANOVA, adjusted for the following factors: day/night, development, and experimental repeat). No features differed significantly between <italic>hcrtr</italic><sup>-/+</sup> and <italic>hcrtr</italic><sup>+/+</sup>; <italic>n</italic> = 39, 102, and 39; for WT, <italic>hcrtr</italic><sup>+/+</sup>; Het, <italic>hcrtr</italic><sup>-/+</sup>; and Hom, <italic>hcrtr</italic><sup>-/-</sup>, respectively. Download <inline-supplementary-material content-type="local-data" id="f1-2" mime-subtype="tiff" mimetype="image" xlink:href="enu-eN-NWR-0408-19-s02.tif">Figure 1-2, TIF file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
<supplementary-material content-type="local-data" id="fig1-3">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.f1-3</object-id>
<label>Extended Data Figure 1-3</label>
<caption>
<p>Analysis framework. Flow diagram depicting the steps of our analysis framework. Data are output from our behavioral set-up (ViewPoint) in the form of a .xls file. perl_batch_192.m organizes these data to a .txt format. Experiment metadata (e.g., animal genotypes) are supplied in the form of a .txt file. The 1-min bin method uses sleep_analysis2.m to produce figures and statistics from these two .txt files. The 25-Hz method exports .raw data from ViewPoint to produce .xls files. Vp_Extract.m reorganizes these, using .txt data, to a .mat file which can be input to either Vp_Analyse.m or Bout_Clustering.m. Vp_Analyse.m produces figures and statistics. Bout_Clustering.m uses the clustering function gmm_sample_ea.m to assign data to modules, produce figures, and calculate statistics, Bout_Clustering.m’s output can be input to Bout_Transitions.m, which compresses full modular sequences by calling Batch_Compress.m and Batch_Grammar_Freq.m. The motifs identified from this approach can be input to Batch_Transitions_Hours.m which compresses 500 module chunks and uses Batch_Grammar_Freq.m to count motif occurrences per hour. With the exception of the 1-min bin method (sleep_analysis2.m), two example figures are shown for each figure producing step. All code can be run locally, although for speed several steps (indicated in green) are best run on a cluster computer. Download <inline-supplementary-material content-type="local-data" id="f1-3" mime-subtype="tiff" mimetype="image" xlink:href="enu-eN-NWR-0408-19-s03.tif">Figure 1-3, TIF file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
<p>Vp_Analyse.m was used to compare general activity levels and bout features across time and between groups. The function has two options. The first allows for specific days and nights of interest to be cropped from the data. The second determines how experimental repeats are handled, treating the data as either a single merged dataset or as separate datasets. In the latter case, each experimental repeat is plotted with the same color scheme as the first experiment, with progressive shading for each repeat. Additionally, the <italic>N</italic>-way ANOVA comparisons include a repeat factor, which can be used to determine whether results are consistent across experimental repeats. Vp_Analyse.m outputs two statistics results structures: twa, <italic>N</italic>-way ANOVA comparison results; and kw, two-sample Kolmogorov–Smirnov test results. Vp_Analyse.m outputs figures showing each group’s activity (<xref ref-type="fig" rid="F1">Fig. 1<italic>D</italic>,<italic>E</italic></xref>) and bout features (Extended Data <xref ref-type="supplementary-material" rid="fig1-2">Fig. 1-2</xref>) over time.</p>
<fig fig-type="figure" id="F1" orientation="portrait" position="float">
<label>Figure 1.</label>
<caption>
<p> Behavior at scale. <bold><italic>A</italic></bold>, top panel, Five consecutive frames from an individual well of a 96-well plate as a 6 dpf zebrafish larva performs a swim bout. Blue highlights pixels that change intensity between frames (Δ pixels). Lower panel. A Δ pixels time series from the larva above. Highlighted are the features that describe each active and inactive bout. <bold><italic>B</italic></bold>, Mean bout frequency (Hz) recorded from individual larvae at 5 and 6 dpf during the day (light blue) and the night (dark blue). Each dot is 1 of 124 wild-type larvae. The orange crosses mark the population means. <bold><italic>C</italic></bold>, The probability of observing different lengths of inactivity during the day (light blue) or the night (dark blue) at 5 and 6 dpf. Each larva’s data were fit by a pdf. Shown is a mean pdf (bold line) and SD (shaded surround) with a log scale on the <italic>x</italic>-axis cropped to 10 s. Inset, The total probability of inactive bout lengths longer than 10 s, per animal. <bold><italic>D</italic></bold>, The mean activity of 124 wild-type larvae from 4 to 7 dpf, on a 14/10 h light/dark cycle. Data for each larva was summed into seconds and then smoothed with a 15-min running average. Shown is a summed and smoothed mean Δ pixels trace (bold line) and SEM (shaded surround). <bold><italic>E</italic></bold>, Average activity across one day (white background) and night (dark background) for larvae dosed with either DMSO (control) or a range of melatonin doses immediately before tracking at 6 dpf. Data were summed and smoothed as in <bold><italic>D</italic></bold>. The number of animals per condition is denoted as <italic>n</italic>. Extended Data <xref ref-type="supplementary-material" rid="fig1-1">Figures 1-1</xref>, <xref ref-type="supplementary-material" rid="fig1-2">1-2</xref>, <xref ref-type="supplementary-material" rid="fig1-3">1-3</xref> support <xref ref-type="fig" rid="F1">Figure 1</xref>.</p>
</caption>
<graphic xlink:href="SN-ENUJ200083F001"></graphic>
</fig>
<p>The script Bout_Clustering.m was used to cluster all active and inactive bouts into behavioral modules, as well as to compare the resultant modules. To cluster the data an evidence accumulation approach is used (<xref ref-type="bibr" rid="B15">Fred and Jain, 2002</xref>, <xref ref-type="bibr" rid="B16">2005</xref>) implemented by the custom MATLAB function gmm_sample_ea.m. Bout_Clustering.m produces figures (Extended Data <xref ref-type="supplementary-material" rid="fig2-1">Fig. 2-1</xref>) and statistically compares the modules. The MATLAB workspace output from Bout_Clustering.m can be input to either Bout_Transitions.m or Bout_Transitions_Hours.m.</p>
<supplementary-material content-type="local-data" id="fig2-1">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.f2-1</object-id>
<label>Extended Data Figure 2-1</label>
<caption>
<p>Evidence accumulation-based clustering. <bold><italic>A</italic></bold>, left, Scree plot showing the percentage of variance explained by each principal component from the active bout data. The first three principal components, the knee point of the curve, were kept for subsequent analysis. The colors of these points refer to the right panel. Right, Each of the three retained component’s coefficients for the different active bout parameters is shown. <bold><italic>B</italic></bold>, The active bouts within each module were fit by Gaussian distributions. Each active bout is shown in a 3D space of PC1, PC2, and probability. Each bout is numbered and colored by its module assignment. <bold><italic>C</italic></bold>, Evidence accumulation (E.A.) matrix for the 40,000 active probe points (matrix dimensions are thus 40,000 by 40,000). A higher E.A. index indicates a higher frequency of pairwise occurrences in the same cluster across 200 Gaussian mixture models. This matrix was clustered hierarchically, and a maximum lifetime cut was made to determine the final number of modules. The dendrogram above shows all 40,000 leaves and is colored by mean module length from shortest (lightest) to longest (darkest) as in other figures. 500. Evidence accumulation matrix for the inactive bouts. Download <inline-supplementary-material content-type="local-data" id="f2-1" mime-subtype="tiff" mimetype="image" xlink:href="enu-eN-NWR-0408-19-s04.tif">Figure 2-1, TIF file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
<p>The function gmm_sample_ea.m clusters data using an evidence accumulation approach (<xref ref-type="bibr" rid="B15">Fred and Jain, 2002</xref>, <xref ref-type="bibr" rid="B16">2005</xref>) through which the results of multiple Gaussian mixture models are combined to generate an aggregate solution. This process is executed through the following six steps. First, a sample of “probe points” are randomly sampled from the data. The number of probe points to sample is user defined. Second, values of K and sample sizes are uniformly sampled from user set ranges. The values of K are used to set the number of mixture components for each mixture model. The sample sizes determine the number of points, randomly sampled from the data that each mixture model is fit to. Third, a Gaussian mixture model is iteratively fit to the sampled data with K components. Each probe point is assigned to the component with the highest corresponding posterior probability and evidence is accumulated on the probe points; evidence is defined as pairwise co-occurrences in the same component. Fourthly, the evidence accumulation matrix is hierarchically clustered, and the final number of clusters is determined by using the maximum differentiated linkage distance to cut the resultant dendrogram. The linkage metric used is a user-defined option. Fifthly, the clusters are normalized for size by randomly sampling the number of points in the smallest cluster, from each cluster. Finally, all data points are assigned to these final size normalized clusters using the mode cluster assignment of the k-nearest neighbors, with k being user defined.</p>
<p>The script Bout_Transitions.m takes the MATLAB workspace output from Bout_Clustering.m as an input and compresses each animal’s full module sequence to generate a library of behavioral motifs. The number of occurrences of each motif are counted and normalized by comparison to paired shuffled data. Finally, a supervised learning algorithm is applied to identify context specific behavioral motifs. For two-time intensive steps, hierarchical compression of full module sequences (Batch_Compress.m) and normalizing the behavioral motif counts (Batch_Grammar_Freq.m), data were manually copied (via MobaXterm, Personal Edition v10.5) to UCL Legion Cluster (Research Computing Services, UCL) and processed in parallel with a worker for every fish. MATLAB code for hierarchical compression is described in <xref ref-type="bibr" rid="B19">Gomez-Marin et al. (2016)</xref>. MATLAB code for submitting these jobs to Legion, analyzing data and retrieving results is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/ghoshm/Legion_Code">https://github.com/ghoshm/Legion_Code</ext-link>. Ultimately, Bout_Transitions.m outputs a library of behavioral motifs and motif-related figures (<xref ref-type="fig" rid="F3">Fig. 3</xref>).</p>
<p>The script Bout_Transitions_Hours.m compresses blocks of 500 modules for statistical comparisons, uses the motif library from Bout_Transitions.m to count the occurrence of each motif every hour, normalizes these counts to paired shuffled data and finally uses supervised learning to identify hour specific behavioral motifs. As with Bout_Transitions.m behavioral motifs are normalized, via Batch_Grammar_Freq.m, using UCL Legion Cluster. Bout_Transitions_Hours.m outputs figures (<xref ref-type="fig" rid="F4">Fig. 4<italic>D</italic></xref>) and statistics.</p>
<table-wrap id="T1" orientation="portrait" position="float">
<label>Table 1</label>
<caption>
<p>Wild-type motif classifier performance Download <xref ref-type="supplementary-material" rid="fig4-1">Figure 4-1</xref>, TIF file.</p>
</caption>
<table frame="hsides" rules="none">
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<thead>
<tr>
<th align="center" colspan="1" rowspan="1">Comparison</th>
<th align="center" colspan="1" rowspan="1">Motifs (number)</th>
<th align="center" colspan="1" rowspan="1">Cv error (%)</th>
<th align="center" colspan="1" rowspan="1">Cv error Std</th>
<th align="center" colspan="1" rowspan="1">Mc error (%)</th>
<th align="center" colspan="1" rowspan="1">Mc EP</th>
<th align="center" colspan="1" rowspan="1">RM error (%)</th>
<th align="center" colspan="1" rowspan="1">RM error Std</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td colspan="1" rowspan="1">
<monospace>Wild type</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Day/night</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>15</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.20</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.63</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.25</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.25</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.50</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Day 5/day 6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>93</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>20.2</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3.18</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>45.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.09</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Night 5/night 6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>85</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>19.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.09</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3.18</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>48.3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.00</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Day hours</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>09-10</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>102</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.23</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.67</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.26</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>10-11</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.37</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.31</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.18</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.10</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>11-12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.20</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.23</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.15</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.03</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>12-13</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.06</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.34</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.19</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.08</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>13-14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>14-15</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>15-16</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.11</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>16-17</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.09</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.15</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>17-18</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>18-19</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>19-20</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>20-21</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.11</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.27</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.15</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.01</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>21-22</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>22-23</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.14</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.44</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.15</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.03</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Night hours</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>23-24</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>23</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.69</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.47</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.57</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.23</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>24–01</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>177</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.84</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.83</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>11.6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.78</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>01–02</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.92</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.51</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.05</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>02-03</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>88</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.72</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.18</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.4</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.31</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>03-04</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.17</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.04</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>04-05</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>22</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.92</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.47</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.07</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>05-06</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.17</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>06-07</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.17</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.02</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>07-08</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.84</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.34</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.01</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>08-09</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.17</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.01</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Morning/evening</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>229</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>33.2</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.32</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.85</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>44.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.96</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Early/late night</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>26</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>36.4</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.18</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.00</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>43.4</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.55</monospace>
</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="TF1">
<p>A table showing the performance of each wild-type motif classifier. Each classifier sought to separate the data shown in the comparison column, e.g., day/night. For the hourly comparisons, each hour was compared with data from all other hours grouped together. For each comparison, 250 motifs were chosen by mRMR, then a smaller number were retained (see motifs column) based on classification error curves (Extended Data <xref ref-type="supplementary-material" rid="fig4-1">Fig. 4-1<italic>A</italic></xref>). Cv, 10-fold cross validated; Std, SD across the 10 folds; Mc, majority class classifier; EP, SE of proportion; RM, classifiers built from random motif subsets.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<table-wrap id="T2" orientation="portrait" position="float">
<label>Table 2</label>
<caption>
<p><italic>hcrtr</italic> and pharmacological classifier performance Download <xref ref-type="supplementary-material" rid="fig4-1">Figure 4-1</xref>, TIF file.</p>
</caption>
<table frame="hsides" rules="none">
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<thead>
<tr>
<th align="center" colspan="1" rowspan="1">Comparison</th>
<th align="center" colspan="1" rowspan="1">Motifs (number)</th>
<th align="center" colspan="1" rowspan="1">Cv error (%)</th>
<th align="center" colspan="1" rowspan="1">Cv error Std</th>
<th align="center" colspan="1" rowspan="1">Mc error (%)</th>
<th align="center" colspan="1" rowspan="1">Mc EP</th>
<th align="center" colspan="1" rowspan="1">RM error (%)</th>
<th align="center" colspan="1" rowspan="1">RM error Std</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td colspan="1" rowspan="1">
<italic>
<monospace>hcrtr</monospace>
</italic>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Day and night</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Het</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>173</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>25.5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.77</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.88</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>39.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.93</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>83</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>24.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.07</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.83</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>47.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3.66</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Het/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>235</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>24.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3.76</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.88</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>38.6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.83</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Day</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Het</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>80</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>19.5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.60</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.66</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>37.9</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.08</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>195</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.50</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.00</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>48.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.22</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Het/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>55</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>22.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.02</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.66</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>33.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.01</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Night</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Het</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>79</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.38</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.66</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>37.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.17</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>53</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>12.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.58</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.00</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>52.3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.16</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Het/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>76</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.27</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.66</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>36.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>5.05</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Melatonin (day)</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Control</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>40</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>25.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.42</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.4</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3.67</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>0.01</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>89</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.52</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>30.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>15.2</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>0.1</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>192</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.52</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>20.5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>18.0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>1</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>132</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.78</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.02</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>29.5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.67</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>3</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>97</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>48.6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>11.2</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>10</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>250</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.78</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.02</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>20.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.40</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>30</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>133</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>32.2</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.89</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>PTZ (day)</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Control</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>26</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>46.2</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.91</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>15.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.43</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>2.5 mM</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>55</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>35.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.06</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>42.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>11.4</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>5 mM</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>162</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>32.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.83</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>34.3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>18.0</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>7.5 mM</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>104</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>32.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.83</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>49.9</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>14.7</monospace>
</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="TF2">
<p>A table showing the performance of each classifier. Each classifier sought to separate the data shown in the comparison column, e.g., <italic>hcrtr</italic><sup>+/+</sup> (WT) and <italic>hcrtr</italic><sup>−/+</sup> (Het). For the pharmacological comparisons, each condition was compared with the rest of the conditions grouped together, aside from the control data which was excluded. For each comparison, 250 motifs were chosen by mRMR, then a smaller number were retained (see motifs column) based on classification error curves (see Extended Data <xref ref-type="supplementary-material" rid="fig4-1">Fig. 4-1<italic>A</italic></xref>). Cv, 10-fold cross validated; Std, SD across the 10 folds; Mc, majority class classifier; EP, SE of proportion; RM, classifiers built from random motif subsets; WT, <italic>hcrtr</italic><sup>+/+</sup>; Het, <italic>hcrtr</italic><sup>−/+</sup>; Hom, <italic>hcrtr</italic><sup>−/−</sup>.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<table-wrap id="T3" orientation="portrait" position="float">
<label>Table 3</label>
<caption>
<p>Module classifier performance Download <xref ref-type="supplementary-material" rid="fig4-1">Figure 4-1</xref>, TIF file.</p>
</caption>
<table frame="hsides" rules="none">
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<col align="left" span="1" valign="top"/>
<thead>
<tr>
<th align="center" colspan="1" rowspan="1">Comparison</th>
<th align="center" colspan="1" rowspan="1">Modules (number)</th>
<th align="center" colspan="1" rowspan="1">Cv error (%)</th>
<th align="center" colspan="1" rowspan="1">Cv error Std</th>
<th align="center" colspan="1" rowspan="1">Mc error (%)</th>
<th align="center" colspan="1" rowspan="1">Mc EP</th>
</tr>
</thead>
<tbody valign="top">
<tr>
<td colspan="1" rowspan="1">
<monospace>Wild type</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Day/Night</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.61</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.29</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.25</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Day 5/Day 6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>21.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.53</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3.18</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Night 5/Night 6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>35.5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.71</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3.18</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<italic>
<monospace>hcrtr</monospace>
</italic>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Day and night</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Het</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>0.77</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.88</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>45.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.9</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.83</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Het/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.12</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.88</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Day</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Het</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.46</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.66</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>40.4</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>12.5</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.00</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Het/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.35</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.66</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Night</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Het</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.46</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.66</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>WT/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>47.4</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10.9</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>50.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.00</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Het/Hom</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.72</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>27.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.66</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>Melatonin (day)</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Control</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.33</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.69</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>25.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.42</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>0.01</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2.78</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.02</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>0.1</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>2</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.52</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>1</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>18.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>7.74</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>3</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.67</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>10</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.52</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>30</monospace>μ<monospace>M</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.8</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.52</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>16.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>4.39</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">
<monospace>PTZ (day)</monospace>
</td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
<td colspan="1" rowspan="1"></td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>Control</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1.92</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>5.27</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>46.2</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>6.91</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>2.5 mM</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>17.9</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>17.6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>35.7</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>9.06</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>5 mM</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>28.6</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>22.3</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>32.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.83</monospace>
</td>
</tr>
<tr>
<td colspan="1" rowspan="1">•<monospace>7.5 mM</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>10</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>20.0</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>26.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>32.1</monospace>
</td>
<td colspan="1" rowspan="1">
<monospace>8.83</monospace>
</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<fn id="TF3">
<p>A table showing the performance of each module classifier. Each classifier sought to separate the data shown in the comparison column, e.g., wild type, day/night. For each comparison, all 10 modules were sequentially chosen by the mRMR algorithm, then a smaller subset was retained (see module column) based on classification error curves. Cv, 10-fold cross validated; Std, SD across the 10 folds; Mc, majority class classifier; EP, SE of proportion.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>Processed behavioral data are available at: <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/record/3344770#.XYYwYyhKiUk">https://zenodo.org/record/3344770#.XYYwYyhKiUk</ext-link>. Raw data are available upon request.</p>
</sec>
</sec>
<sec id="s3H">
<title>Behavioral data analysis</title>
<sec id="s3H8">
<title>Δ Pixels</title>
<p>At the acquisition stage, Δ pixels data were filtered by the software (ViewPoint) such that each frame for a given well was scored as either zero or higher. In the absence of movement within a well, and hence no pixels changing intensity, Δ pixels values of zero were recorded. These periods were termed inactive bouts and were defined as any single or consecutive frames with Δ pixels values equal to zero. The length of each inactive bout was used as a descriptive feature. When there were movements within a well, Δ pixels values greater than zero were recorded. These periods were termed active bouts and were defined as any single or consecutive frames with Δ pixels values greater than zero. Six features were used to describe each active bout: length, mean, SD, total, minimum, and maximum. These features, as well as the number of active bouts, percentage of time spent active and total Δ pixels activity, were compared between conditions, e.g., day and night and dose of drug, in two ways using the function Vp_Analyse.m.</p>
<p>To compare the distribution of values for each feature between conditions, a probability density function (pdf) was fit to each animal’s data and the mean shape of each condition’s pdf was compared using a two-sample Kolmogorov–Smirnov test (Extended Data <xref ref-type="supplementary-material" rid="fig1-2">Fig. 1-2<italic>A</italic></xref>). To compare each feature’s average values between conditions, mean values were taken from each animal, and <italic>N</italic>-way ANOVA was computed. The following factors, when relevant, were included and full interaction terms were calculated: condition, e.g., mutant and wild type; time, e.g., day and night; development, defined as a consecutive day and night; and experimental repeat, i.e., which experimental repeat a datapoint came from. For experiments with multiple repeats, the lack of an interaction effect between the comparison of interest and experimental repeat factor was considered as evidence of a consistent result.</p>
<p>Note that our analysis relies on periods of inactivity registering Δ pixels values of zero. Consequently, to be compatible with our analysis code, other data may require post-recording filtering.</p>
</sec>
<sec id="s3H9">
<title>Clustering</title>
<p>To cluster the bouts, the script Bout_Clustering.m was used. First, matrices of bouts by features were constructed (active matrix, 30,900,018 × 6; inactive matrix, 30,900,418 × 1). To prepare the active data for clustering, each animal’s data were individually normalized by calculating <italic>z</italic> scores using <xref ref-type="disp-formula" rid="FD1">Equation 1</xref>, which illustrates how every bout (i) from each animal (f) was normalized by first subtracting the mean of this animal’s bout features (<inline-formula id="IE1"><mml:math id="i1"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) from the bout and then dividing by the SD of each bout feature for this animal σ<sub>f</sub>:
<disp-formula id="FD1"><label>(1)</label><mml:math id="m1"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>σ</mml:mo><mml:mtext>f</mml:mtext></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
<p>Active bout features across all animals were then centered by subtracting each feature’s mean value from every bout, and principal component analysis (PCA) was used to reduce the data to three dimensions, the knee point of the scree plot, which together explain 97.5% of the variance (Extended Data <xref ref-type="supplementary-material" rid="fig2-1">Fig. 2-1<italic>A</italic></xref>).</p>
<p>Next, the active and inactive bouts were separately clustered using an evidence accumulation-based approach (<xref ref-type="bibr" rid="B15">Fred and Jain, 2002</xref>, <xref ref-type="bibr" rid="B16">2005</xref>) implemented by the function gmm_sample_ea.m. First, 40,000 probe points were randomly sampled from the data. Next, for 200 iterations, another group of points were randomly sampled and fit with a Gaussian mixture model with a random number of clusters. For each iteration, these two parameters varied uniformly in the following ranges: the number of points sampled, 40,000–100,000; the number of clusters fit, 2–20. Each mixture model was fit using MATLAB’s fitgmdist function (MATLAB, Statistics and Machine Learning Toolbox) with full, regularized, independent covariance matrices and initialized using the k-means++ algorithm (<xref ref-type="bibr" rid="B2">Arthur and Vassilvitskii, 2007</xref>). Each mixture model was fit five times and the one with the largest log-likelihood was retained. Once each model had been fit, each probe point was assigned to the component with the largest posterior probability, and evidence in the form of pairwise occurrence in the same cluster was accumulated on the probe points. Once the 200 mixture models had been fit, average link clustering was applied to the evidence accumulation matrix and the final number of clusters determined based on maximum cluster lifetime. Next, the resultant clusters were normalized for size by randomly selecting the number of points in the smallest cluster from each cluster (5983 active, 614 inactive bouts). Finally, all points were assigned to the size normalized clusters using the mode cluster assignment of the 50 nearest neighbors for every point.</p>
</sec>
<sec id="s3H10">
<title>Hierarchical compression</title>
<p>Clustering reduced each animal’s behavior to a non-repetitive sequence of active and inactive bouts, termed modules. On average this reduced each wild-type sequence length by 96%, from 6,308,514 frames to 236,636 modules, easing the computational demands of compressing these sequences.</p>
<p>To compress modular sequences, an offline compressive heuristic (<xref ref-type="bibr" rid="B34">Nevill-Manning and Witten, 2000</xref>) was used (<xref ref-type="disp-formula" rid="FD2">Eq. 2</xref>). At each iteration (i) of the algorithm, the most compressive motif was defined as the motif which made the most savings, a balance between the length of the motif (<italic>W</italic>) and the number of times it occurred in the sequence (<italic>N</italic>), which also considered the combined cost of adding a new motif to the dictionary (<italic>W</italic> + 1) and of introducing a new symbol into the sequence (+N) at every occurrence of this motif in the sequence:
<disp-formula id="FD2"><label>(2)</label><mml:math id="m2"><mml:mrow><mml:mi>S</mml:mi><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>g</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>W</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
<p>The overall compressibility of a given input sequence was calculated by summing these savings across all iterations and dividing this total by the length of the original input sequence (in modules). This process resulted in a compressibility metric that ranged from 0 to 1 (low-high compressibility). To reduce computational time, motifs of a maximum of 10 modules long were sought, although the hierarchical nature of the algorithm enabled the identification of longer motifs through nesting. To generate the common motif library, the motifs obtained from compression of every animal’s full module sequence (Batch_Compress.m) were merged, and then all unique motifs were kept (Bout_Transitions.m). To generate sets of paired control sequences for every animal, each animal’s module sequence was divided into sequential day and night or hourly segments and the modules within each of these windows was shuffled 10 times, maintaining the active/inactive transition structure (Bout_Transitions.m). As compressibility varies non-linearly with uncompressed sequence length (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>B</italic></xref>), to enable comparisons between samples with different numbers of modules, non-overlapping blocks 500 modules long were compressed (Bout_Transitions_Hours.m).</p>
</sec>
<sec id="s3H11">
<title>Supervised motif selection</title>
<p>To identify both which and how many motifs were required to distinguish between behavioral contexts (e.g., day and night), the following approach was executed by the function Batch_Grammar_Freq.m. First, the number of occurrences of every motif from the common motif library was counted in every real and shuffled modular sequence. Next, to calculate enrichment/constraint scores for every motif, the deviation of the real from shuffled counts, as well as the deviation of each shuffle from the other shuffles, was calculated (<xref ref-type="disp-formula" rid="FD3">Eq. 3</xref>). For a given animal and time window, e.g., day or night, the mean number of times motif (i) was counted in the shuffled data (<inline-formula id="IE2"><mml:math id="i2"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) was subtracted from the real number of counts (<inline-formula id="IE3"><mml:math id="i3"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) and divided by the SD of the shuffled counts (<inline-formula id="IE4"><mml:math id="i4"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>):
<disp-formula id="FD3"><label>(3)</label><mml:math id="m3"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math></disp-formula>
</p>
<p>For example, for a given animal and time window, if a motif was used 10 times in the real data and a mean of 4.5 times in the 10 sets of paired shuffled data (SD 1.58), enrichment/constraint would equal 3.48:
<disp-formula id="UFD1"><mml:math id="m4"><mml:mrow><mml:mn>3.48</mml:mn><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>10</mml:mn><mml:mo>−</mml:mo><mml:mn>4.5</mml:mn></mml:mrow><mml:mrow><mml:mn>1.58</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
<p>When comparing the shuffled data to itself, each shuffle (now <inline-formula id="IE5"><mml:math id="i5"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) was excluded from <inline-formula id="IE6"><mml:math id="i6"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE7"><mml:math id="i7"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Infinite values occurred when there was no SD in the <inline-formula id="IE8"><mml:math id="i8"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> counts and thus <inline-formula id="IE9"><mml:math id="i9"><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> equaled zero. To facilitate subsequent working, infinite values were replaced with a constant value of √(1 + number of shuffled counts) = √(11) = ±3.32. Note that in the real data, infinite values constituted only 2.2% of all enrichment/constraint scores.</p>
<p>For any given comparison, motif library enrichment/constraint scores for the relevant animals were formatted into a matrix of samples by motifs (<xref ref-type="fig" rid="F4">Fig. 4<italic>B</italic></xref>). Scores for each motif (column) were normalized by subtracting each column’s mean score and dividing by each column’s SD. A supervised feature selection algorithm (<xref ref-type="bibr" rid="B20">Peng et al., 2005</xref>) was applied to these matrices to select the top 250 maximally relevant and minimally redundant (mRMR) motifs. For each comparison we defined the first motif chosen by mRMR as the best motif. To determine the best motifs among test conditions, we excluded control data. For example, to determine the best 0.01 μM melatonin motif, we compared this group’s data to all larvae dosed with melatonin at other doses (<xref ref-type="fig" rid="F5">Fig. 5<italic>A</italic></xref>). For completeness, we still plot the control enrichment/constraint scores for these motifs.</p>
<fig fig-type="figure" id="F5" orientation="portrait" position="float">
<label>Figure 5.</label>
<caption>
<p>Pharmacological behavioral motifs. <bold><italic>A</italic></bold>, left, Module sequences for the single best motif for each melatonin comparison. Modules are colored as elsewhere. Middle: for each dose’s single best motif, see left panel <italic>y</italic>-axis for dose, enrichment/constraint scores are shown for every dose on a log <italic>x</italic>-axis. Each animal is shown as a dot, with a mean ± std overlaid per dose. Right, A two-dimensional tSNE embedding from a space of 912 unique motifs. Each animal is shown as a single dot underlaid by a shaded boundary encompassing all animals in each condition. <bold><italic>B</italic></bold>, left, Module sequences for the single best motif for each PTZ comparison. To highlight a seizure specific motif, the control motif and corresponding enrichment/constraint score shown is mRMR motif 2, not 1, for this comparison. Modules are colored as elsewhere. Middle, For each dose’s single best motif, enrichment/constraint scores are shown for every dose on a linear <italic>x</italic>-axis. Each animal is shown as a dot, with a mean and SD overlaid per dose. Right, A two-dimensional tSNE embedding from a space of 338 unique motifs. Each animal is shown as a single dot underlaid by a shaded boundary encompassing all animals in each condition. <bold><italic>C</italic></bold>, Each classifier’s classification error (%) is shown in terms of modules (<italic>x</italic>-axis) and motifs (<italic>y</italic>-axis). Data are shown as mean and SD from 10-fold cross validation. Classifiers are colored by experimental dataset (see Legend). For reference, y = x is shown as a broken black line. Data below this line demonstrates superior performance of the motif classifiers.</p>
</caption>
<graphic xlink:href="SN-ENUJ200083F005"></graphic>
</fig>
<p>To determine how many of the 250 motifs chosen by mRMR were necessary for accurate classification, linear discriminant analysis classifiers were trained on data using 10-fold cross validation as sequential mRMR motifs were added, and classification error mean and SD were calculated. The MATLAB function fitcdiscr (Statistics and Machine Learning Toolbox) was used to implement these steps. Finally, to determine how many motifs were necessary for a given comparison, classification error curves were smoothed with a running average three motifs wide and the number of motifs at which the minimum classification error occurred was identified (Extended Data <xref ref-type="supplementary-material" rid="fig4-1">Fig. 4-1<italic>A</italic></xref>). To evaluate classifier performance, the results of each classifier were compared with a majority class classifier whose performance depended on the ratio of samples of each class. For example, in a dataset with two labels at a ratio of 0.1:0.9, the majority class classifier would consistently assign the latter label and achieve a classification error of 10% (±SE of proportion). Additionally, we compared each classifiers performance to a set of 10 classifiers built using the same number of motifs, although randomly selected. For example, for a classifier which achieved its minimal classification error using 15 motifs, we randomly selected 15 motifs and trained classifiers as above. We repeated this process 10 times per classifier and report the error and SD across these 10 repeats.</p>
</sec>
</sec>
</sec>
<sec id="s4" sec-type="results">
<title>Results</title>
<sec id="s4A">
<title>Behavior at scale</title>
<p>Larval zebrafish behavior consists of an alternating sequence of movements and pauses, termed bouts, that are organized at sub-second timescales. To capture this structure from high-throughput, long-timescale experiments, we used a 96-well plate set-up with a single larva housed in each well (Extended Data <xref ref-type="supplementary-material" rid="fig1-1">Fig. 1-1<italic>A</italic></xref>) and as a proxy for movement recorded the number of pixels that changed intensity within each well between successive pairs of frames, a metric we term Δ pixels. We built on previous work using this set-up (for review, see <xref ref-type="bibr" rid="B4">Barlow and Rihel, 2017</xref>; <xref ref-type="bibr" rid="B35">Oikonomou and Prober, 2017</xref>) by analyzing Δ pixels data at 25 Hz, rather than in 1-min bins. When recorded in this way, Δ pixels data are an alternating sequence of positive values representing movement magnitude and zeros representing periods of inactivity (<xref ref-type="fig" rid="F1">Fig. 1<italic>A</italic></xref>;<xref ref-type="supplementary-material" rid="vid1">Movie 1</xref>). We defined active bouts as any single or consecutive frames with non-zero Δ pixels values and described each bout using several features including the mean and SD of Δ pixels values across the bout (<xref ref-type="fig" rid="F1">Fig. 1<italic>A</italic></xref>). We defined inactive bouts as any single or consecutive frames with zero Δ pixels values and described each inactive bout using its length (<xref ref-type="fig" rid="F1">Fig. 1<italic>A</italic></xref>). We found no correlation of active bout initiation between larvae in adjacent wells of the 96-well plate (Extended Data <xref ref-type="supplementary-material" rid="fig1-1">Fig. 1-1<italic>B</italic></xref>), suggesting no interactions among larvae.</p>
<supplementary-material content-type="local-data" id="vid1">
<label>Movie 1.</label>
<caption>
<p>High-throughput behavioral tracking. A video of 96, 6 dpf zebrafish larvae swimming in our rig. The last 1 s of each larva’s Δ pixels data is plotted over each well. This video was filmed at 25 Hz and is played back in real time.</p>
</caption>
<media content-type="play-in-place" id="sv1" mimetype="video" orientation="portrait" position="anchor" xlink:href="enu-eN-NWR-0408-19-s08.mp4" xlink:role="external-host-filename">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.video.1</object-id>
</media>
</supplementary-material>
<p>Using this approach, we first assessed the behavior of wild-type larvae across a 14/10 h day/night cycle (Extended Data <xref ref-type="supplementary-material" rid="fig1-2">Fig. 1-2<italic>A</italic></xref>). During the day, wild-type larvae initiated bouts at a mean frequency of 0.89 Hz (<xref ref-type="fig" rid="F1">Fig. 1<italic>B</italic></xref>), a rate consistent with other assays (<xref ref-type="bibr" rid="B25">Kim et al., 2017</xref>), and tended to use short, sub-second long inactive bouts (<xref ref-type="fig" rid="F1">Fig. 1<italic>C</italic></xref>). During the night, larvae displayed a mean bout frequency of only 0.07 Hz (<xref ref-type="fig" rid="F1">Fig. 1<italic>B</italic></xref>) and used longer inactive bouts, on the order of seconds to minutes (<xref ref-type="fig" rid="F1">Fig. 1<italic>C</italic></xref>). Together, these differences resulted in a diurnal pattern of activity (<xref ref-type="fig" rid="F1">Fig. 1<italic>D</italic></xref>). These results are broadly consistent with those from analysis of binned Δ pixels data (<xref ref-type="bibr" rid="B4">Barlow and Rihel, 2017</xref>; <xref ref-type="bibr" rid="B35">Oikonomou and Prober, 2017</xref>), with the addition of sub-second resolution and an increase in accuracy, as determined by intra-fish comparisons between the methods (Extended Data <xref ref-type="supplementary-material" rid="fig1-1">Fig. 1-1<italic>C</italic>,<italic>D</italic></xref>).</p>
<p>Next, we extended our approach to examine the behavioral effects of pharmacological and genetic manipulations. Melatonin, which is strongly hypnotic in zebrafish (<xref ref-type="bibr" rid="B40">Rihel et al., 2010a</xref>), dose dependently decreased larval activity (<xref ref-type="fig" rid="F1">Fig. 1<italic>E</italic></xref>) by decreasing the number, magnitude, and length of active bouts and by inducing longer inactive bouts (Extended Data <xref ref-type="supplementary-material" rid="fig1-2">Fig. 1-2<italic>B</italic></xref>). The epileptogenic drug PTZ (Extended Data <xref ref-type="supplementary-material" rid="fig1-1">Fig. 1-1<italic>E</italic></xref>) altered both active and inactive bout parameters (Extended Data <xref ref-type="supplementary-material" rid="fig1-2">Fig. 1-2<italic>C</italic></xref>), eliciting on average longer, lower amplitude active bouts and longer inactive bouts during the day. Finally, homozygous <italic>hcrtr</italic><sup>−/−</sup> mutants had only subtle differences in active bout structure, with shorter mean active bout length and lower active bout total and SD, compared with both wild-type <italic>hcrtr</italic><sup>+/+</sup> and heterozygous <italic>hcrtr</italic><sup>-/+</sup> siblings, which did not differ from one another by any metrics (Extended Data <xref ref-type="supplementary-material" rid="fig1-2">Fig. 1-2<italic>D</italic></xref>).</p>
<p>Collectively, these results quantitatively demonstrate the advantages of assessing Δ pixels data on a frame by frame basis and provide insight into the behavior of wild-type zebrafish larvae across the day/night cycle as well as those subject to pharmacological or genetic manipulations.</p>
</sec>
<sec id="s4B">
<title>Module usage varies with behavioral context</title>
<p>Recent work has demonstrated that larval activity can be classified using unsupervised learning into 13 distinct bout types that represent different swimming movements (<xref ref-type="bibr" rid="B31">Marques et al., 2018</xref>). A full description of larval behavior, however, requires quantification of both the movements and pauses that they execute. Thus, we sought to determine whether distinct active or inactive bout types, which we termed modules, were identifiable from our data, and if module usage depended on behavioral context.</p>
<p>To address these questions, we separately clustered the active and inactive bouts (combined across experiments a total of 30,900,018 active and 30,900,418 inactive bouts) using an evidence accumulation-based clustering algorithm (see Materials and Methods). In brief, 200 Gaussian mixture models were built from each data set, then the results of these models were combined to generate aggregate solutions. This clustering method identified five active and five inactive modules (<xref ref-type="fig" rid="F2">Fig. 2<italic>A</italic>,<italic>B</italic></xref>; Extended Data <xref ref-type="supplementary-material" rid="fig2-1">Fig. 2-1</xref>), which we separately labeled from 1 to 5 from the shortest to longest mean bout length. The active modules, which formed discrete peaks in bout feature space (Extended Data <xref ref-type="supplementary-material" rid="fig2-1">Fig. 2-1<italic>B</italic></xref>), corresponded to different shapes of Δ pixel changes in terms of amplitude and length (<xref ref-type="fig" rid="F2">Fig. 2<italic>A</italic></xref>; Extended Data <xref ref-type="supplementary-material" rid="fig2-2">Fig. 2-2<italic>A</italic></xref>), while the inactive modules consisted of different lengths of inactivity (<xref ref-type="fig" rid="F2">Fig. 2<italic>B</italic></xref>; Extended Data <xref ref-type="supplementary-material" rid="fig2-2">Fig. 2-2<italic>A</italic></xref>). The shortest inactive module (module 1) had a mean length of 0.06 s and ranged from a minimum of 0.04 s (our sampling limit) to a maximum of 0.12 s. In contrast, the longest inactive module (module 5) had a mean length of 96 s and covered a huge range of values from a minimum of 20 s to a maximum of 8.8 h.</p>
<fig fig-type="figure" id="F2" orientation="portrait" position="float">
<label>Figure 2.</label>
<caption>
<p>Unsupervised learning identifies contextual behavioral modules. <bold><italic>A</italic></bold>, Average Δ pixels changes for each active module. Shown is the mean (bold line) and SEM (shaded surround) of 100 bouts randomly sampled from each module from one representative larva. Modules are numbered and colored by average module length across all animals, from shortest (1) to longest (5). <bold><italic>B</italic></bold>, A probability density curve showing the distribution of inactive bout lengths in seconds, on a log <italic>x</italic>-axis cropped to 60 s. Modules are numbered and colored from shortest (1) to longest (5) mean length (see legend for each module’s minimum and maximum bout length). <bold><italic>C</italic></bold>, Matrices showing the active (left) or inactive (right) module assignment of every frame (<italic>x</italic>-axis) for each of 124 wild-type larvae (<italic>y</italic>-axis) across the 14-h days (light blue underlines) and 10-h nights (dark blue underlines) from 5 to 6 dpf. Larvae were sorted by total number of active modules from highest (top) to lowest (bottom). Modules are colored according to the adjacent colormaps. <bold><italic>D</italic></bold>, Average active (upper) and inactive (lower) module probability during day (light blue) and night (dark blue) 5 and 6 of development. Each of 124 wild-type animals is shown as a dot and orange crosses mark the population means. Active modules are sorted by mean day probability from highest to lowest (left to right). Inactive modules are sorted by mean length from shortest to longest (left to right). The blobs correspond to the color used for each module in other figures. <bold><italic>E</italic></bold>, The mean frequency of each active (left) and inactive (right) module across days 5 and 6 of development. Shown is a mean smoothed with a 15-min running average, rescaled to 0–1. Days are shown with a white background, nights with a dark background. Modules are sorted from shortest to longest (lower to upper panels). Extended Data <xref ref-type="supplementary-material" rid="fig2-1">Figures 2-1</xref>, <xref ref-type="supplementary-material" rid="fig2-2">2-2</xref> support <xref ref-type="fig" rid="F2">Figure 2</xref>.</p>
</caption>
<graphic xlink:href="SN-ENUJ200083F002"></graphic>
</fig>
<fig fig-type="figure" id="F3" orientation="portrait" position="float">
<label>Figure 3.</label>
<caption>
<p>Hierarchical compression reveals structure in zebrafish behavior. <bold><italic>A</italic></bold>, Compression explained using fictive data. Top to bottom, From Δ pixels data (black trace), we classified both active and inactive behaviors into modules (colored circles). From modular behavioral sequences, we identified motifs (sequences of modules) using a compression algorithm. Compression iteratively identifies motifs (shown as boxes) by replacing them with new symbols until no more motifs can be identified and the sequence is maximally compressed. <bold><italic>B</italic></bold>, Each panel shows how compressibility, calculated from 500 module blocks, varies in different behavioral contexts. Each pale line shows an individual fish’s mean compressibility during the day and the night. The darker overlay shows a population day and night mean ± SD. In the wild-type data, compressibility is higher during the day than the night (<italic>p</italic> &lt; 10<sup>−158</sup>) and increases from day/night 5–6 (<italic>p</italic> &lt; 10<sup>−4</sup>), findings consistent across triplicate experiments. Melatonin decreases (<italic>p</italic> &lt; 10<sup>−10</sup>), while PTZ increases compressibility (<italic>p</italic> &lt; 10<sup>−8</sup>). There is no effect of <italic>hcrtr</italic> genotype on compressibility. Statistics are two-way or four-way ANOVA. <bold><italic>C</italic></bold>, All 46,554 unique motifs (<italic>y</italic>-axis) identified by compressing data from all animals. Each motif’s module sequence is shown, with the modules colored according to the colormap on the right. Motifs are sorted by length and then sequentially by module. Motifs range in length from 2 to 20 modules long. Inset, For each motif length, the probability of observing each inactive or active module. <bold><italic>D</italic></bold>, Each motif in the library consists of an alternating sequence of Δ pixels changes and pauses (active and inactive modules). A representative motif of each module length is shown with each module colored according to the colormap in <bold><italic>C</italic></bold>. Representative motifs were chosen by determining every motif’s distribution of modules and then for each observed module length, selecting the motif closest to the average module distribution (see <bold><italic>C</italic></bold>, inset). Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Figure 3-1</xref> supports <xref ref-type="fig" rid="F3">Figure 3</xref>.</p>
</caption>
<graphic xlink:href="SN-ENUJ200083F003"></graphic>
</fig>
<fig fig-type="figure" id="F4" orientation="portrait" position="float">
<label>Figure 4.</label>
<caption>
<p>Supervised learning identifies contextual behavioral motifs. <bold><italic>A</italic></bold>, pdfs showing the probability of observing motifs at different enrichment/constraint scores rounded to whole numbers and summed at values above or below ±4 for ease of visualization. Each wild-type animal is depicted by a single pale blue (real data) and 10 black (shuffled data) lines; overlaid in bold are mean pdfs. The inset shows that the kurtosis of the real data are higher than the shuffled data (<italic>p</italic> &lt; 10<sup>−271</sup>; two-way ANOVA, real vs shuffled data, no significant interaction with experimental repeat factor). Each larva is shown as a pale line; overlaid is a population mean and SD. <bold><italic>B</italic></bold>, Enrichment/constraint scores for all 46,554 motifs (<italic>x</italic>-axis) for each fish during day/night 5 and 6 of development (<italic>y</italic>-axis). To emphasize structure, motifs are sorted in both axes, first by their average day/night difference (from day to night enriched left to right), then separately day and night by larva. Finally, each motif’s enrichment/constraint score is Z-scored to aid visualization. <bold><italic>C</italic></bold>, left, The 15 day/night mRMR motifs module sequences are shown numbered by the order in which they were selected by the algorithm. Motifs are sorted by day minus night enrichment/constraint score (middle). The long pauses at the end of motifs 5 and 14 are cropped at 10 s (arrows). Middle, For each selected motif (<italic>y</italic>-axis), ordered as in the left panel, each wild-type animal’s (124 in total) day minus night enrichment/constraint score (<italic>x</italic>-axis) is shown as a dot. Values above zero are colored light blue; below zero are dark blue. Overlaid is a population mean and SD per motif. Right, A tSNE embedding of the 15-dimensional motif data (middle) into a two-dimensional space. Each circle represents a single day (light blue) or night (dark blue) sample. <bold><italic>D</italic></bold>, Representative motif temporal dynamics; shown are motifs 1 (day) and 2 (night) from <bold><italic>C</italic></bold>, as well as a startle-like motif. Left, Each motif’s module sequence. Right, Each motif’s mean enrichment/constraint score each hour, rescaled to 0–1. Extended Data <xref ref-type="supplementary-material" rid="fig4-1">Figure 4-1</xref> supports <xref ref-type="fig" rid="F4">Figure 4</xref>.</p>
</caption>
<graphic xlink:href="SN-ENUJ200083F004"></graphic>
</fig>
<supplementary-material content-type="local-data" id="fig2-2">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.f2-2</object-id>
<label>Extended Data Figure 2-2</label>
<caption>
<p>Behavioral modules. <bold><italic>A</italic></bold>, pdfs for each bout feature by module. All features are shown on a log <italic>x</italic>-axis. The legend panel indicates each module’s color. <bold><italic>B</italic></bold>, Melatonin module probabilities during 6 dpf day (upper panels) and night (lower panels) for both the active (left) and inactive (right) modules. Shown is a mean and SEM for each group, colored according to the legend. Active modules are sorted from highest to lowest by average wild-type day probability, based upon wild-type data in <xref ref-type="fig" rid="F2">Figure 2<italic>D</italic></xref>. Inactive modules are sorted by increasing mean length. Control, DMSO; <italic>n</italic> = 24 controls then <italic>n</italic> = 12 per dose. <bold><italic>C</italic></bold>, PTZ data as in <bold><italic>B</italic></bold>, with H<sub>2</sub>O (control); <italic>n</italic> = 24 controls then <italic>n</italic> = 10 (2.5 mM), <italic>n</italic> = 9 (5 mM), and <italic>n</italic> = 9 (7.5 mM). <bold><italic>D</italic></bold>, <italic>hcrtr</italic> data as in <bold><italic>B</italic></bold>, with mean values across 5 and 6 dpf. No module probabilities differed significantly among genotypes (full four-way ANOVA, with the following factors: genotype, day/night, development, and experimental repeat); <italic>n</italic> = 39, 102, and 39; for WT, <italic>hcrtr</italic><sup>+/+</sup>; Het, <italic>hcrtr</italic><sup>-/+</sup>; and Hom, <italic>hcrtr</italic><sup>-/-</sup>, respectively. Download <inline-supplementary-material content-type="local-data" id="f2-2" mime-subtype="tiff" mimetype="image" xlink:href="enu-eN-NWR-0408-19-s05.tif">Figure 2-2, TIF file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
<supplementary-material content-type="local-data" id="fig3-1">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.f3-1</object-id>
<label>Extended Data Figure 3-1</label>
<caption>
<p>Hierarchical compression metrics. <bold><italic>A</italic></bold>, The compressibility (<italic>y</italic>-axis) of the real wild-type data is higher than the paired shuffled data (<italic>p</italic> &lt; 10<sup>−15</sup>, two-way ANOVA, real vs shuffled data, no significant interaction with experimental repeat factor). Each animal’s data are shown as a pale blue line. Overlaid is a mean and SD. Inset, The mean difference in compressibility between each larva’s real and shuffled data. Each larva is shown by a circle, and the orange cross marks the mean. <bold><italic>B</italic></bold>, The compressibility (<italic>y</italic>-axis) of the real wild-type data varies non-linearly with uncompressed sequence length. Each larva (of 124) is shown as a dot. <bold><italic>C</italic></bold>, The number of motifs (<italic>y</italic>-axis) identified from compressing each wild-type animal’s real and paired shuffled data. Each animal’s data are shown as a pale blue line. Overlaid is a mean and SD. Inset, The mean intra-fish difference in the number of identified motifs. Each larva is shown by a circle, and the orange cross marks the mean. <bold><italic>D</italic></bold>, Motif length (<italic>x</italic>-axis) and usage probability (<italic>y</italic>-axis) across the entire real (blue) and 10 shuffled datasets (black). Note that each shuffled dataset is plotted independently. For each motif length a grey line joins the real and mean shuffled value. <bold><italic>E</italic></bold>, Each panel shows how Δ compressibility varies in different behavioral contexts. Each pale line shows an individual larva’s average Δ compressibility during the day and the night. The darker overlay shows a population day and night mean and SD. <bold><italic>F</italic></bold>, Δ Compressibility of 500 module blocks for each wild-type larva, averaged into 1-h time points. Each pale blue line shows 1 of 124 larvae. Line breaks occur when a larva had &lt;500 modules within a given hour. The darker blue overlay shows the mean and SD of these data every hour. Shown are days (white background) and nights (dark background) 5 and 6 of development. Download <inline-supplementary-material content-type="local-data" id="f3-1" mime-subtype="tiff" mimetype="image" xlink:href="enu-eN-NWR-0408-19-s06.tif">Figure 3-1, TIF file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
<supplementary-material content-type="local-data" id="fig4-1">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.f4-1</object-id>
<label>Extended Data Figure 4-1</label>
<caption>
<p>Motif classifier performance. <bold><italic>A</italic></bold>, Classification error (%) from linear classifiers separating wild-type day and night behavior using motif enrichment/constraint scores as sequential mRMR motifs from 1 to 250 are added (<italic>x</italic>-axis). The average error is shown in light blue. Overlaid in darker blue is a running average three motifs wide. The broken black lines show the minimum of the smoothed data to be at 15 motifs, where the classification error is 0.2%. <bold><italic>B</italic></bold>, Wild-type temporal classifier performance. Real classifiers (color) are shown as a mean and SD from 10-fold cross validation. Majority class classifiers (grey) are shown as value and SE of proportion. Each classifier’s data are listed on the <italic>x</italic>-axis. D, day; N, night; M/E, morning/evening; E/LN, early/late night. The number of motifs chosen for each classification and exact values for each classifier are detailed in <xref ref-type="table" rid="T1">Table 1</xref>. <bold><italic>C</italic></bold>, <italic>hcrtr</italic>, Melatonin and PTZ classifier performance. Real classifiers (color) are shown as a mean and SD from 10-fold cross validation. Majority class classifiers (grey) are shown as value and SE of proportion. Each classifier’s data are listed on the <italic>x</italic>-axis. For <italic>hcrtr</italic> comparisons, grouped classifiers as well as separate day (light blue underline) and night (dark blue underline) classifiers are shown. For melatonin and PTZ, only day data were compared. Classifier details can be found in <xref ref-type="table" rid="T2">Table 2</xref>. Download <inline-supplementary-material content-type="local-data" id="f4-1" mime-subtype="tiff" mimetype="image" xlink:href="enu-eN-NWR-0408-19-s07.tif">Figure 4-1, TIF file</inline-supplementary-material>.</p>
</caption>
</supplementary-material>
<p>To examine how module usage varied across time, we represented each larva’s behavior as an alternating sequence of active and inactive modules (<xref ref-type="fig" rid="F2">Fig. 2<italic>C</italic></xref>; <xref ref-type="supplementary-material" rid="vid2">Movie 2</xref>). In the wild-type data, module usage varied with time of day (<xref ref-type="fig" rid="F2">Fig. 2<italic>D</italic></xref>). For example, the probability of observing inactive module 2, which consists of typical day pause lengths (0.16–1.16 s), was on average 0.6 during the day and only 0.24 during the night, when inactive modules 1, 4, and 5 became more likely (<xref ref-type="fig" rid="F2">Fig. 2<italic>D</italic></xref>). To reveal finer-grain temporal dynamics, we also examined each module’s mean frequency over time (<xref ref-type="fig" rid="F2">Fig. 2<italic>E</italic></xref>). In general, both the active and the short inactive modules had high frequencies during the day, peaking at the light/dark transition as the larvae responded to the sudden change in illumination. In contrast, the only module with a peak in frequency at the dark-to-light transition was inactive module 4 (3.72–20 s), which also had an increased frequency approaching the light-to-dark transition. Together, these results reveal that zebrafish employ different bout types in a time of day/night dependent manner.</p>
<supplementary-material content-type="local-data" id="vid2">
<label>Movie 2.</label>
<caption>
<p>Behavioral modules. A video of 96, 6 dpf zebrafish larvae swimming in our rig. The last 1 s of each larva’s Δ pixels data is plotted over each well, with each active and inactive bout colored according to its module assignment. This video was filmed at 25 Hz and is played back in real time.</p>
</caption>
<media content-type="play-in-place" id="sv2" mimetype="video" orientation="portrait" position="anchor" xlink:href="enu-eN-NWR-0408-19-s09.mp4" xlink:role="external-host-filename">
<object-id pub-id-type="doi">10.1523/ENEURO.0408-19.2020.video.2</object-id>
</media>
</supplementary-material>
<p>Next, we examined the impact of pharmacological and genetic manipulations on bout type usage. Larvae dosed with melatonin showed a shift toward using shorter active modules and longer inactive modules (Extended Data <xref ref-type="supplementary-material" rid="fig2-2">Fig. 2-2<italic>B</italic></xref>). In PTZ-dosed larvae, there were also shifts in active module probability. Particularly notable was the complete exclusion of active module 1 in 27 of the 28 (96.4%) PTZ-dosed larvae, while control larvae used this module with 0.12 probability during the day and 0.22 during the night (Extended Data <xref ref-type="supplementary-material" rid="fig2-2">Fig. 2-2<italic>C</italic></xref>). These shifts likely reflect the chaotic, seizure-like swimming observed in PTZ-treated larvae (<xref ref-type="bibr" rid="B3">Baraban et al., 2005</xref>), although no single active module clearly captured these behavioral seizures. PTZ also increased the probability of the shortest inactive (module 1) as well as the two longest inactive modules (modules 4 and 5), the latter of which are likely to correspond to the interictal bouts of inactivity associated with seizures (Extended Data <xref ref-type="supplementary-material" rid="fig2-2">Fig. 2-2<italic>C</italic></xref>). Conversely, <italic>hcrtr</italic> mutants exhibited no differences in either active or inactive module probabilities compared with their wild-type siblings (Extended Data <xref ref-type="supplementary-material" rid="fig2-2">Fig. 2-2<italic>D</italic></xref>), demonstrating that bout type usage is similar between these mutants and wild-type animals across the day/night cycle.</p>
<p>Collectively, these results reveal that zebrafish behavior in this assay can be described by five types of active and five types of inactive modules, the usage of which varies with behavioral context. Interestingly, in many contexts, both active and inactive module probabilities were shifted, suggesting that these module types may co-vary, perhaps by being arranged into recurrent sequences.</p>
</sec>
<sec id="s4C">
<title>Hierarchical compression reveals structure in zebrafish behavior</title>
<p>From a set of behavioral modules, an animal could structure their behavior in a range of ways. At one end of this spectrum, successive modules could be organized completely randomly, such that prior modules exert no influence on future module selection. At the other end, module selection could be fully deterministic with a particular module always following another. Rather than being fixed, however, it is likely that animals adapt their behavioral structure in response to changing internal or external states. We sought to map the structure of zebrafish behavior in different contexts by examining the presence and organization of module sequences, which could provide insight into the mechanisms governing behavior. To do this, we used a compression algorithm (<xref ref-type="bibr" rid="B34">Nevill-Manning and Witten, 2000</xref>) as <xref ref-type="bibr" rid="B19">Gomez-Marin et al. (2016)</xref> used to discover structure in <italic>Caenorhabditis elegans</italic> postural data. When applied to our dataset (<xref ref-type="fig" rid="F3">Fig. 3<italic>A</italic></xref>), this algorithm iteratively identified motifs from each larva’s modular sequence and returned two outputs, compressibility, a measure of each larva’s behavioral structure, and a library of identified recurrent module sequences, termed motifs.</p>
<p>To quantify the structure of zebrafish behavior, we first compressed every animal’s full modular sequence, which in wild-type animals were on average 236,636 modules long across 70 h. To determine whether the resultant compression values indicated more structure than would be expected based on either the distribution or the transition structure of the active-to-inactive modules, we compared each larva’s compressibility to that of 10 sets of paired shuffled data. All wild-type larvae were more compressive than their paired shuffled data, demonstrating that their behavior is more structured than expected from modular probabilities alone (Extended Data <xref ref-type="supplementary-material" rid="fig1-3">Fig. 3-1<italic>A</italic></xref>). Compressibility, however, varies non-linearly with input sequence length, as longer sequences will be more likely to contain motifs (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>B</italic></xref>). Thus, to enable comparisons between samples with different numbers of modules, we compressed non-overlapping 500 module blocks of sequence per larva. This approach revealed that compressibility was higher during the day than the night (<xref ref-type="fig" rid="F3">Fig. 3<italic>B</italic></xref>). To determine whether these differences were primarily due to the presence of behavioral motifs or instead were a consequence of differences in module distribution, we also compared the difference in compressibility (Δ compressibility) between each animal’s real and shuffled data. This approach revealed that the compressibility difference between the day and the night is predominantly due to differences in module distribution (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>E</italic></xref>). To reveal finer-grain temporal changes in compressibility, we plotted Δ compressibility across time (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>F</italic></xref>). This approach revealed peaks at the light-to-dark transitions in the evenings, consistent with this stimulus eliciting stereotyped behavioral sequences (<xref ref-type="bibr" rid="B9">Burgess and Granato, 2007</xref>; <xref ref-type="bibr" rid="B14">Emran et al., 2010</xref>).</p>
<p>Next, we used compressibility to assess how our pharmacological and genetic manipulations altered the structure of larval behavior. We found that melatonin decreased day compressibility to night-time levels (<xref ref-type="fig" rid="F3">Fig. 3<italic>B</italic></xref>), a difference primarily due to shifts in module distribution (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>E</italic></xref>). PTZ increased compressibility to a constant day/night value (<xref ref-type="fig" rid="F3">Fig. 3<italic>B</italic></xref>). PTZ, however, reduced Δ compressibility (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>E</italic></xref>), indicating that changes in module distribution, rather than motif usage, are the dominant driver of PTZ-induced behavioral changes. Importantly, these drug-induced changes in compressibility do not simply reflect overall activity levels. For example, PTZ-exposed larvae are less active than controls during the day and more active during the night (Extended Data <xref ref-type="supplementary-material" rid="fig1-1">Fig. 1-1<italic>E</italic></xref>) but have consistently higher compressibility (<xref ref-type="fig" rid="F3">Fig. 3<italic>B</italic></xref>). Finally, in <italic>hcrtr</italic> mutants, we found no differences in either compressibility or Δ compressibility, suggesting that <italic>hcrtr</italic> mutant behavior is structured similarly to wild-type animals (<xref ref-type="fig" rid="F3">Fig. 3<italic>B</italic></xref>).</p>
<p>Overall, our compressibility results demonstrate that larval zebrafish behavior is structured and that the amount of structure varies with behavioral context. Our Δ compressibility results suggest that such variation predominantly arises from altered module, rather than motif, usage.</p>
<p>To gain insight into the behavioral sequences larvae deploy, we then studied the motifs identified by the compression algorithm. Compression of the real modular sequences identified a mean of 1901 motifs per animal (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>C</italic></xref>). Interestingly, compression of the real data almost always identified slightly fewer motifs than the shuffled data (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>C</italic></xref>). This suggests that the motifs identified from the real data were used more frequently than those in the shuffled data and therefore likely reflect enriched behavioral sequences. Merging the motifs identified across all animals generated a library of 46,554 unique behavioral motifs (<xref ref-type="fig" rid="F3">Fig. 3<italic>C</italic></xref>). In terms of raw Δ pixels data, each motif represented an approximately repeated pattern of movements and pauses of varying length (<xref ref-type="fig" rid="F3">Fig. 3<italic>D</italic></xref>). Motifs in the library ranged from two to 20 modules long with a median length of eight modules and spanned timescales from approximately 0.1 s to 11.3 min with a median length of 3.84 s. In the real data, longer motifs tended to be used more frequently than in the shuffled data (Extended Data <xref ref-type="supplementary-material" rid="fig3-1">Fig. 3-1<italic>D</italic></xref>), demonstrating the likely behavioral relevance of these sequences. Motifs of different module lengths used distinct sub-sets of modules (<xref ref-type="fig" rid="F3">Fig. 3<italic>C</italic></xref>). For example, motifs comprised of longer module sequences had a lower probability of using long inactive modules. Together, these results reveal the varied timescales at which zebrafish larvae organize their behavior and suggest the presence of structure governing the arrangement of modules into motifs.</p>
</sec>
<sec id="s4D">
<title>Behavioral motif usage is time dependent</title>
<p>The large number of motifs in our library led us to hypothesize that each may be used in specific behavioral contexts. To test this hypothesis, we counted the number of times each larva or set of paired shuffled data used each motif within each time frame (e.g., day or night) and then normalized these counts by calculating the deviation of the real from shuffled counts as well as the deviation of each shuffle from the other shuffles, a metric we termed enrichment/constraint. Overall, we found that enrichment/constraint scores from our real data were more prone to extreme positive (enriched) and negative (constrained) values than the shuffled data (<xref ref-type="fig" rid="F4">Fig. 4<italic>A</italic></xref>), suggesting that a minority of behavioral motifs were used more or less frequently than would be expected by chance.</p>
<p>To test whether these extremes occurred in particular contexts, we first compared motif usage between the day and the night in wild-type larvae by generating a matrix of enrichment/constraint scores (<xref ref-type="fig" rid="F4">Fig. 4<italic>B</italic></xref>). To distil the most salient motifs from this and other contextual matrices, we used a three-step approach. First, we used the mRMR algorithm (<xref ref-type="bibr" rid="B20">Peng et al., 2005</xref>) to rank the motifs from most to least salient. Second, we trained linear discriminant analysis classifiers using 10-fold cross validation as we iteratively increased the number of input motifs from most to least salient (e.g., motif 1, motif 1 and 2, motif 1 – <italic>n</italic>). Finally, we selected the subset of motifs which achieved the lowest classification error between groups in each context. To determine how accurately these motif subsets could distinguish between behavioral contexts, we compared each classifier’s performance to that of a majority class classifier, which performed as well as the ratio of samples between the two contexts. For example, in the day versus night classification, a majority class classifier would have an error rate of 50% (±SE of proportion), as each larva contributes an equal number of days and nights to the enrichment/constraint matrix. Additionally, to demonstrate the salience of the motifs selected by the mRMR algorithm, we compared each classifier’s performance to a set of 10 classifiers built using the same number of motifs, although randomly selected. For example, for a classifier that achieved its minimal classification error using 50 motifs, we randomly selected 50 motifs from the library and built a classifier. For each comparison we repeated this process 10 times.</p>
<p>Applying this algorithm to wild-type data revealed changes in motif usage across multiple timescales (Extended Data <xref ref-type="supplementary-material" rid="fig4-1">Fig. 4-1<italic>B</italic></xref>). We found that only 15 motifs were required to classify day-specific and night-specific behavior with only a 0.2% (±0.63% SD) classification error, compared with a majority class classifier with 50% error and random 15-motif subsets with a mean error of 9.25% (<xref ref-type="fig" rid="F4">Fig. 4<italic>C</italic></xref>; <xref ref-type="table" rid="T1">Table 1</xref>). The day-enriched motifs consisted of high amplitude movements interspersed with short pauses, while the night enriched motifs contained low amplitude movements and long pauses (<xref ref-type="fig" rid="F4">Fig. 4<italic>C</italic></xref>). Next, we examined how motif usage changed over time by comparing consecutive days and nights (5–6 dpf). In both day 5 versus day 6 and night 5 versus night 6 comparisons, the classifiers achieved roughly 20% error using 93 and 85 motifs, respectively (<xref ref-type="table" rid="T1">Table 1</xref>). Thus, motif usage shifted over just 24 h, although these changes were far less prominent than those between the day and night. To study whether motif usage varied at finer timescales, we first divided the day into morning/evening and the night into early/late periods. In each case, the mRMR algorithm performed better than the control classifiers (morning/evening: 33%, early/late night: 36%) although the relatively high classification errors suggest that motif selection did not vary strongly across each day or night (<xref ref-type="table" rid="T1">Table 1</xref>). Consistent with this conclusion, classifiers attempting to delineate each hour from every other mostly failed to outperform their control classifiers (<xref ref-type="table" rid="T1">Table 1</xref>). The two notable exceptions were the hour following each lighting transition, where this approach achieved good classification performance (<xref ref-type="table" rid="T1">Table 1</xref>) and identified startle-like motifs. We interpret these motifs as startle-like as they consist of long pauses interrupted by high-amplitude movements and primarily occur at the lighting transitions (<xref ref-type="fig" rid="F4">Fig. 4<italic>D</italic></xref>), stimuli known to elicit startle behaviors in larval zebrafish (<xref ref-type="bibr" rid="B9">Burgess and Granato, 2007</xref>; <xref ref-type="bibr" rid="B14">Emran et al., 2010</xref>).</p>
<p>Together, these results demonstrate that motif usage varied between the day and the night, but aside from the lighting transitions, was relatively consistent within these periods.</p>
</sec>
<sec id="s4E">
<title>Dose-dependent and dose-specific behavioral motifs</title>
<p>Finally, we hypothesized that behavioral motif usage would vary dose dependently across concentrations of melatonin and PTZ, providing insight into the mechanisms by which these compounds exert their behavioral effects. Motif dose dependency would suggest a continuously modulated underlying process, which might arise for example if the fraction of bound receptors relates to neuronal activity modulation. Alternatively, motifs enriched at only specific doses would suggest discrete effects on neuronal circuitry.</p>
<p>Applying the mRMR algorithm to our pharmacological data revealed both dose-dependent and dose-specific modulation of motif usage. We found that each melatonin dose could be separated from the others using 40–250 motifs with only 0–2.78% classification error (<xref ref-type="fig" rid="F5">Fig. 5<italic>A</italic></xref>; <xref ref-type="table" rid="T2">Table 2</xref>). Focusing on just the best motif for each comparison, we observed both dose dependency as well as dose specificity. For example, comparing controls to all melatonin-dosed larvae identified a dose-dependent motif that consisted of large magnitude movements and short pauses, whose enrichment/constraint score decreased with increasing melatonin concentration (<xref ref-type="fig" rid="F5">Fig. 5<italic>A</italic></xref>). Conversely, the best 10 μM motif, two long pauses broken by a small active bout sequence, showed dose specificity being enriched at only 3 and 10 μ<sc>M</sc> doses (<xref ref-type="fig" rid="F5">Fig. 5<italic>A</italic></xref>). When applied to the PTZ data, our approach performed even more accurately, achieving perfect classification (0% error) between all conditions (<xref ref-type="fig" rid="F5">Fig. 5<italic>B</italic></xref>; <xref ref-type="table" rid="T2">Table 2</xref>). Furthermore, in PTZ-dosed larvae we observed enrichment for motifs highly constrained in wild-type larvae, highlighting the usage of motifs beyond the normal wild-type repertoire, such as those corresponding to behavioral seizures (<xref ref-type="fig" rid="F5">Fig. 5<italic>B</italic></xref>).</p>
<p>Next, we tested whether our motif subset approach could detect <italic>hcrtr</italic> mutant phenotypes that were not easily captured by other methods. For example, based on human and rodent literature, where loss of hypocretin is associated with narcolepsy (<xref ref-type="bibr" rid="B30">Lin et al., 1999</xref>) and prior zebrafish literature (<xref ref-type="bibr" rid="B13">Elbaz et al., 2012</xref>), we expected abnormal transitions between active and inactive bouts. We found reasonable performance when discriminating between <italic>hcrtr</italic><sup>+/+</sup> and <italic>hcrtr</italic><sup>−/−</sup> during both the day (16.7 ± 7.5% error with 195 motifs) and night (12.8 ± 9.6% error with 53 motifs) but weaker performance when distinguishing between <italic>hcrtr</italic><sup>+/+</sup> and <italic>hcrtr</italic><sup>−/+</sup>, as expected for a haplosufficient gene (Extended Data <xref ref-type="supplementary-material" rid="fig4-1">Fig. 4-1<italic>C</italic></xref>; <xref ref-type="table" rid="T2">Table 2</xref>). Thus, homozygous loss of <italic>hcrtr</italic> impacts motif usage enough to allow for successful classification of <italic>hcrtr</italic><sup>−/−</sup> mutants, although no single <italic>hcrtr</italic><sup>−/−</sup> motifs with large differences in enrichment/constraint scores compared with wild-type siblings were particularly evident.</p>
<p>Collectively, these results demonstrate that behavioral motifs are used context dependently and reveal how motif subsets can parse subtle differences in motif usage between behavioral contexts. However, does motif analysis provide additional discriminatory power over module selection, which also varies between behavioral contexts? To assess this, we compared the performance of each motif classifier to paired module classifiers built from matrices of module probabilities. All of the motif classifiers achieved better performance than their module pairs (<xref ref-type="fig" rid="F5">Fig. 5<italic>C</italic></xref>; <xref ref-type="table" rid="T3">Table 3</xref>), demonstrating both the phenotyping value of the motifs and their importance in the structure of larval behavior.</p>
</sec>
</sec>
<sec id="s5" sec-type="discussion">
<title>Discussion</title>
<p>Here, we developed and applied computational tools to describe high-throughput, long-timescale behavioral data in terms of behavioral units (modules) and sequences of modules (motifs) organized across sub-second to day-long timescales.</p>
<sec id="s5A">
<title>Low-dimensional representations of behavior</title>
<p>Low-dimensional representations of behavior, such as the Δ pixels metric employed here, result in a loss of information, for example, direction of movement or posture. However, such metrics do facilitate screening approaches and/or long-timescale tracking and in these contexts have provided biological insight into the molecular targets of small molecules (<xref ref-type="bibr" rid="B40">Rihel et al., 2010a</xref>) and genetics of aging (<xref ref-type="bibr" rid="B10">Churgin et al., 2017</xref>). Our work builds on previous long-timescale studies of behavior by assessing sub-second resolution Δ pixels data across multiple days and nights. This improved resolution enabled the segmentation and parameterization of individual active and inactive bouts from our data, revealing how larvae adapt their behavior across the day/night cycle and how behavior is impacted by small molecules.</p>
<p>Future work should aim to extend our assay by recording more detailed behavioral measures. Indeed, a recent study using centroid tracking in 96-well plates revealed that larvae show a day/night location preference within the well and furthermore uncovered a mutant with a difference in this metric (<xref ref-type="bibr" rid="B45">Thyme et al., 2019</xref>), demonstrating that even within the confined space of a 96-well plate, location is an informative metric to record. It is likely that even more detailed behavioral measures, like eye and tail angles, will yield additional insights, for example enabling the exploration of rapid-eye-movement sleep in zebrafish larvae, as done in reptiles (<xref ref-type="bibr" rid="B43">Shein-Idelson et al., 2016</xref>). Such metrics could be extracted by skeletonization or even through the use of an autoencoder applied to the raw video frames from each well (<xref ref-type="bibr" rid="B23">Johnson et al., 2016</xref>). Once such high dimensional data had been assigned to modules, our compression and motif enrichment/constraint approach could be applied in the same manner as here.</p>
</sec>
<sec id="s5B">
<title>Modular descriptions of behavior</title>
<p>A key idea in ethology is that behavior consists of stereotyped modules arranged into motifs (<xref ref-type="bibr" rid="B29">Lashley, 1951</xref>; <xref ref-type="bibr" rid="B46">Tinbergen, 2010</xref>). While early studies described behavior in this manner through manual observations (<xref ref-type="bibr" rid="B11">Dawkins and Dawkins, 1976</xref>), recent advances in machine vision and learning have automated these processes (<xref ref-type="bibr" rid="B47">Todd et al., 2017</xref>). For example, in zebrafish larvae, recent work used unsupervised learning to uncover a locomotor repertoire of 13 swim types including slow forward swims and faster escape swims (<xref ref-type="bibr" rid="B31">Marques et al., 2018</xref>), although inactive bouts were not considered. From our dataset, we identified five active and five inactive modules, which, respectively, describe swim bouts of different amplitudes (<xref ref-type="fig" rid="F2">Fig. 2<italic>A</italic></xref>) and periods of inactivity of varied length (<xref ref-type="fig" rid="F2">Fig. 2<italic>B</italic></xref>). Interestingly, all modules were used with reasonably high and similar probability by all wild-type animals (<xref ref-type="fig" rid="F2">Fig. 2<italic>D</italic></xref>), demonstrating that these modules represent a set of common larval behaviors. Furthermore, the temporal (<xref ref-type="fig" rid="F2">Fig. 2<italic>E</italic></xref>) and pharmacological (Extended Data <xref ref-type="supplementary-material" rid="fig2-2">Fig. 2-2<italic>B</italic>,<italic>C</italic></xref>) shifts in these probabilities illustrates that module usage can be flexibly reorganized depending on behavioral context (<xref ref-type="bibr" rid="B51">Wiltschko et al., 2015</xref>).</p>
<p>To discretize our bouts into modules, we first extracted hand-engineered features from each bout (<xref ref-type="fig" rid="F1">Fig. 1<italic>A</italic></xref>) and then applied an evidence accumulation-based clustering algorithm (<xref ref-type="bibr" rid="B15">Fred and Jain, 2002</xref>, <xref ref-type="bibr" rid="B16">2005</xref>). While our results demonstrate the relevance and utility of these modules in describing larval behavior, it is possible that our approach missed rare bout types. Consequently, future work should build on our bout classification by exploring the benefits of including additional features, the use of alternative clustering algorithms and our assumption of stereotypy, i.e., that all bouts can be fit into a module (<xref ref-type="bibr" rid="B5">Berman, 2018</xref>). An alternative direction would be to produce a mapping between our active modules and those identified from analysis of larval posture (<xref ref-type="bibr" rid="B31">Marques et al., 2018</xref>). Bridging this gap could facilitate behavioral screening approaches, for example, by using data from our set-up to prioritize pharmacological compounds or mutants for postural analysis.</p>
</sec>
<sec id="s5C">
<title>Quantifying structure in behavior</title>
<p>In some contexts, it is beneficial for animals to execute coordinated patterns of behavior. For example, to efficiently search an environment zebrafish larvae will execute organized sequences of left and right turns (<xref ref-type="bibr" rid="B12">Dunn et al., 2016</xref>). In other contexts, more random behavior will be advantageous, such as when escaping from a predator (<xref ref-type="bibr" rid="B32">Maye et al., 2007</xref>). Quantifying structure in behavior thus provides insight into the overarching strategy being employed in particular contexts. Alterations in behavioral structure can also manifest clinically, for example in Autism Spectrum Disorder, a defining feature of which is increased behavioral stereotypy (<xref ref-type="bibr" rid="B1">American Psychiatric Association, 2013</xref>). Consequently, compression would be a relevant and likely informative metric to record in animal models or even human cases for such conditions.</p>
<p>To quantify structure in larval zebrafish behavior in different contexts, we inputted each larva’s modular sequence to a compression algorithm. We found that wild-type behavior was more compressive during the day than the night (<xref ref-type="fig" rid="F3">Fig. 3<italic>B</italic></xref>). This echoes recent work in <italic>Drosophila</italic> that revealed higher temporal predictability during the day than the night as well as in females (<xref ref-type="bibr" rid="B17">Fulcher and Jones, 2017</xref>). A likely explanation for these findings comes from work in <italic>C. elegans</italic> (<xref ref-type="bibr" rid="B19">Gomez-Marin et al., 2016</xref>) that demonstrated that animals who transition slowly between modules, as both zebrafish (<xref ref-type="fig" rid="F1">Fig. 1<italic>B</italic></xref>) and <italic>Drosophila</italic> do at night (<xref ref-type="bibr" rid="B18">Geissmann et al., 2019</xref>), tend to be less compressive. This may suggest that the underlying mechanisms controlling longer-timescale behaviors are less precise than those controlling fast behavioral sequences.</p>
<p>For future efforts applying compression to behavioral data, there are two avenues left to explore, what compression heuristic to use and how to compress data from multiple animals. Following the work of <xref ref-type="bibr" rid="B19">Gomez-Marin et al. (2016)</xref>, we defined the best motif at any iteration as the most compressive, which represents a balance between the motif’s length and frequency. While this metric generally leads to the best compression (<xref ref-type="bibr" rid="B34">Nevill-Manning and Witten, 2000</xref>), alternative measures, such as frequency or length may capture other aspects of behavior. The second avenue relates to comparisons between animals. Here, each animal was compressed individually, identifying motifs that were later grouped into a common library. While computationally tractable, this approach prevents certain comparisons across animals, for example identifying the most compressive motif across all larvae. This issue could be solved by compressing a single sequence containing all of the animals’ modular sequences joined end to end, with spacers to prevent interanimal motifs. Compressing this long sequence would, however, be computationally demanding.</p>
<p>Compressing and merging the identified motifs across all animals generated a library of 46,554 unique motifs (<xref ref-type="fig" rid="F3">Fig. 3<italic>C</italic></xref>), each of which described an alternating sequence of movements and pauses (<xref ref-type="fig" rid="F3">Fig. 3<italic>D</italic></xref>). Motifs ranged from 0.1 s to 11.3 min in length, revealing the range of timescales at which larval behavior is organized. We cannot, however, rule out the existence of longer timescale motifs in larval behavior as computational demands limited our search to motifs 10 modules long (although the algorithm’s hierarchical approach enabled the identification of motifs up to 20 modules long). Thus, future work should aim to extend our approach to explore the full range of timescales at which larval behavior is organized by systematically varying this parameter.</p>
</sec>
<sec id="s5D">
<title>Contextual behavioral motifs</title>
<p>Finally, by distilling salient subsets of motifs from our library, we demonstrated that motif usage was context dependent and highlighted the discriminatory power of motif subsets, which were capable of distinguishing between day/night behavior and even between small changes in compound dose. Comparing motif usage across the day/night cycle identified a set of highly night specific motifs (<xref ref-type="fig" rid="F4">Fig. 4<italic>C</italic></xref>), which may represent sleep behaviors. One way in which future studies could address this possibility would be to deprive larvae of these motifs throughout the night, for example, by using a closed-loop paradigm (<xref ref-type="bibr" rid="B18">Geissmann et al., 2019</xref>), and observing the impact on larval behavior the following day. In relation to the PTZ data, comparing seizure motifs across epileptogenic compounds and mutants with spontaneous seizures could suggest clues as to their underlying mechanism (<xref ref-type="bibr" rid="B26">Kokel et al., 2010</xref>; <xref ref-type="bibr" rid="B40">Rihel et al., 2010a</xref>). For example, seizures with similar motif usage patterns may originate in the same brain area or impact awareness in the same manner. This hypothesis could be tested by generating whole-brain activity maps (<xref ref-type="bibr" rid="B38">Randlett et al., 2015</xref>) across conditions, with the aim of identifying common and unique neuronal correlates.</p>
<p>Given the amenability of larval zebrafish to high-throughput behavioral screening (<xref ref-type="bibr" rid="B39">Rihel and Ghosh, 2015</xref>) future work should leverage our approach to large-scale genetic (<xref ref-type="bibr" rid="B45">Thyme et al., 2019</xref>) or pharmacological datasets (<xref ref-type="bibr" rid="B40">Rihel et al., 2010a</xref>). Individually, these datasets would provide information on the genetic and molecular basis of behavior across multiple timescales, encompassing processes from sleep to aging. In combination, by identifying mutant and drug-induced phenotypes that cancel each other out (<xref ref-type="bibr" rid="B28">Lamb et al., 2006</xref>; <xref ref-type="bibr" rid="B21">Hoffman et al., 2016</xref>), these datasets could be used to identify phenotypic suppressors in genetic disease models, an outcome with potential clinical relevance.</p>
</sec>
</sec>
</body>
<back>
<ack>
<p>Acknowledgements: We thank members of the University College London (UCL) fish floor for insightful discussions, Ida Barlow and François Kroll for comments on this manuscript, and the UCL Fish Facility and staff for support.</p>
</ack>
<ref-list content-type="nameDate">
<title>References</title>
<ref id="B1">
<mixed-citation publication-type="book">
<collab>American Psychiatric Association</collab> (<year>2013</year>) <source/>Diagnostic and statistical manual of mental disorders, <edition>Ed 5</edition>
<publisher-loc>Arlington, VA</publisher-loc>: <publisher-name>American Psychiatric Association</publisher-name>.</mixed-citation>
</ref>
<ref id="B2">
<mixed-citation publication-type="conf-proc">
<string-name><surname>Arthur</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Vassilvitskii</surname>
<given-names>S</given-names></string-name> (<year>2007</year>) <article-title>k-means++: the advantages of careful seeding</article-title>. Proceedings of the 18th Annual ACM-SIAM Symposium on Discrete Algorithms, pp <fpage>1027</fpage>–<lpage>1035</lpage>. <comment>Philadelphia, PA, USA, Society for Industrial and Applied Mathematics</comment>.</mixed-citation>
</ref>
<ref id="B3">
<mixed-citation publication-type="journal">
<string-name><surname>Baraban</surname>
<given-names>SC</given-names></string-name>, <string-name><surname>Taylor</surname>
<given-names>MR</given-names></string-name>, <string-name><surname>Castro</surname>
<given-names>PA</given-names></string-name>, <string-name><surname>Baier</surname>
<given-names>H</given-names></string-name> (<year>2005</year>) <article-title>Pentylenetetrazole induced changes in zebrafish behavior, neural activity and c-fos expression</article-title>. <source/>Neuroscience
<volume>131</volume>:<fpage>759</fpage>–<lpage>768</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroscience.2004.11.031</pub-id>
<pub-id pub-id-type="pmid">15730879</pub-id></mixed-citation>
</ref>
<ref id="B4">
<mixed-citation publication-type="journal">
<string-name><surname>Barlow</surname>
<given-names>IL</given-names></string-name>, <string-name><surname>Rihel</surname>
<given-names>J</given-names></string-name> (<year>2017</year>) <article-title>Zebrafish sleep: from geneZZZ to neuronZZZ</article-title>. <source/>Curr Opin Neurobiol
<volume>44</volume>:<fpage>65</fpage>–<lpage>71</lpage>. <pub-id pub-id-type="doi">10.1016/j.conb.2017.02.009</pub-id>
<pub-id pub-id-type="pmid">28391130</pub-id></mixed-citation>
</ref>
<ref id="B5">
<mixed-citation publication-type="journal">
<string-name><surname>Berman</surname>
<given-names>GJ</given-names></string-name> (<year>2018</year>) <article-title>Measuring behavior across scales</article-title>. <source/>BMC Biol
<volume>16</volume>:<fpage>23</fpage>
<pub-id pub-id-type="doi">10.1186/s12915-018-0494-7</pub-id>
<pub-id pub-id-type="pmid">29475451</pub-id></mixed-citation>
</ref>
<ref id="B6">
<mixed-citation publication-type="journal">
<string-name><surname>Berman</surname>
<given-names>GJ</given-names></string-name>, <string-name><surname>Bialek</surname>
<given-names>W</given-names></string-name>, <string-name><surname>Shaevitz</surname>
<given-names>JW</given-names></string-name> (<year>2016</year>) <article-title>Predictability and hierarchy in <italic>Drosophila</italic> behavior</article-title>. <source/>Proc Natl Acad Sci USA
<volume>113</volume>:<fpage>11943</fpage>–<lpage>11948</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1607601113</pub-id>
<pub-id pub-id-type="pmid">27702892</pub-id></mixed-citation>
</ref>
<ref id="B7">
<mixed-citation publication-type="journal">
<string-name><surname>Berman</surname>
<given-names>GJ</given-names></string-name>, <string-name><surname>Choi</surname>
<given-names>DM</given-names></string-name>, <string-name><surname>Bialek</surname>
<given-names>W</given-names></string-name>, <string-name><surname>Shaevitz</surname>
<given-names>JW</given-names></string-name> (<year>2014</year>) <article-title>Mapping the stereotyped behaviour of freely moving fruit flies</article-title>. <source/>J R Soc Interface
<volume>11</volume>:<fpage>20140672</fpage>
<pub-id pub-id-type="doi">10.1098/rsif.2014.0672</pub-id>
<pub-id pub-id-type="pmid">25142523</pub-id></mixed-citation>
</ref>
<ref id="B8">
<mixed-citation publication-type="journal">
<string-name><surname>Brown</surname>
<given-names>AEX</given-names></string-name>, <string-name><surname>de Bivort</surname>
<given-names>B</given-names></string-name> (<year>2018</year>) <article-title>Ethology as a physical science</article-title>. <source/>Nat Phys
<volume>14</volume>:<fpage>653</fpage>–<lpage>657</lpage>. <pub-id pub-id-type="doi">10.1038/s41567-018-0093-0</pub-id>
</mixed-citation>
</ref>
<ref id="B9">
<mixed-citation publication-type="journal">
<string-name><surname>Burgess</surname>
<given-names>HA</given-names></string-name>, <string-name><surname>Granato</surname>
<given-names>M</given-names></string-name> (<year>2007</year>) <article-title>Modulation of locomotor activity in larval zebrafish during light adaptation</article-title>. <source/>J Exp Biol
<volume>210</volume>:<fpage>2526</fpage>–<lpage>2539</lpage>. <pub-id pub-id-type="doi">10.1242/jeb.003939</pub-id>
<pub-id pub-id-type="pmid">17601957</pub-id></mixed-citation>
</ref>
<ref id="B10">
<mixed-citation publication-type="journal">
<string-name><surname>Churgin</surname>
<given-names>MA</given-names></string-name>, <string-name><surname>Jung</surname>
<given-names>SK</given-names></string-name>, <string-name><surname>Yu</surname>
<given-names>CC</given-names></string-name>, <string-name><surname>Chen</surname>
<given-names>X</given-names></string-name>, <string-name><surname>Raizen</surname>
<given-names>DM</given-names></string-name>, <string-name><surname>Fang-Yen</surname>
<given-names>C</given-names></string-name> (<year>2017</year>) <article-title>Longitudinal imaging of <italic>Caenorhabditis elegans</italic> in a microfabricated device reveals variation in behavioral decline during aging</article-title>. <source/>Elife
<volume>6</volume>:<fpage>e26652</fpage>
<pub-id pub-id-type="doi">10.7554/eLife.26652</pub-id>
<pub-id pub-id-type="pmid">28537553</pub-id></mixed-citation>
</ref>
<ref id="B11">
<mixed-citation publication-type="journal">
<string-name><surname>Dawkins</surname>
<given-names>R</given-names></string-name>, <string-name><surname>Dawkins</surname>
<given-names>M</given-names></string-name> (<year>1976</year>) <article-title>Hierarchical organization and postural facilitation: rules for grooming in flies</article-title>. <source/>Anim Behav
<volume>24</volume>:<fpage>739</fpage>–<lpage>755</lpage>. <pub-id pub-id-type="doi">10.1016/S0003-3472(76)80003-6</pub-id>
</mixed-citation>
</ref>
<ref id="B12">
<mixed-citation publication-type="journal">
<string-name><surname>Dunn</surname>
<given-names>TW</given-names></string-name>, <string-name><surname>Mu</surname>
<given-names>Y</given-names></string-name>, <string-name><surname>Narayan</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Randlett</surname>
<given-names>O</given-names></string-name>, <string-name><surname>Naumann</surname>
<given-names>EA</given-names></string-name>, <string-name><surname>Yang</surname>
<given-names>C-T</given-names></string-name>, <string-name><surname>Schier</surname>
<given-names>AF</given-names></string-name>, <string-name><surname>Freeman</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Engert</surname>
<given-names>F</given-names></string-name>, <string-name><surname>Ahrens</surname>
<given-names>MB</given-names></string-name> (<year>2016</year>) <article-title>Brain-wide mapping of neural activity controlling zebrafish exploratory locomotion</article-title>. <source/>Elife
<volume>5</volume>:<fpage>e12741</fpage>
<pub-id pub-id-type="doi">10.7554/eLife.12741</pub-id>
<pub-id pub-id-type="pmid">27003593</pub-id></mixed-citation>
</ref>
<ref id="B13">
<mixed-citation publication-type="journal">
<string-name><surname>Elbaz</surname>
<given-names>I</given-names></string-name>, <string-name><surname>Yelin-Bekerman</surname>
<given-names>L</given-names></string-name>, <string-name><surname>Nicenboim</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Vatine</surname>
<given-names>G</given-names></string-name>, <string-name><surname>Appelbaum</surname>
<given-names>L</given-names></string-name> (<year>2012</year>) <article-title>Genetic ablation of hypocretin neurons alters behavioral state transitions in zebrafish.</article-title>
<source/>J Neurosci
<volume>32</volume>:<fpage>12961</fpage>–<lpage>12972</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.1284-12.2012</pub-id>
<pub-id pub-id-type="pmid">22973020</pub-id></mixed-citation>
</ref>
<ref id="B14">
<mixed-citation publication-type="journal">
<string-name><surname>Emran</surname>
<given-names>F</given-names></string-name>, <string-name><surname>Rihel</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Adolph</surname>
<given-names>AR</given-names></string-name>, <string-name><surname>Dowling</surname>
<given-names>JE</given-names></string-name> (<year>2010</year>) <article-title>Zebrafish larvae lose vision at night</article-title>. <source/>Proc Natl Acad Sci USA
<volume>107</volume>:<fpage>6034</fpage>–<lpage>6039</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0914718107</pub-id>
<pub-id pub-id-type="pmid">20224035</pub-id></mixed-citation>
</ref>
<ref id="B15">
<mixed-citation publication-type="conf-proc">
<string-name><surname>Fred</surname>
<given-names>ALN</given-names></string-name>, <string-name><surname>Jain</surname>
<given-names>AK</given-names></string-name> (<year>2002</year>) <article-title>Data clustering using evidence accumulation’, in Object recognition supported by user interaction for service robots</article-title>. IEEE Comput. Soc, pp <fpage>276</fpage>–<lpage>280</lpage>.</mixed-citation>
</ref>
<ref id="B16">
<mixed-citation publication-type="journal">
<string-name><surname>Fred</surname>
<given-names>ALN</given-names></string-name>, <string-name><surname>Jain</surname>
<given-names>AK</given-names></string-name> (<year>2005</year>) <article-title>Combining multiple clusterings using evidence accumulation</article-title>. <source/>IEEE Trans Pattern Anal Mach Intell
<volume>27</volume>:<fpage>835</fpage>–<lpage>850</lpage>. <pub-id pub-id-type="doi">10.1109/TPAMI.2005.113</pub-id>
<pub-id pub-id-type="pmid">15943417</pub-id></mixed-citation>
</ref>
<ref id="B17">
<mixed-citation publication-type="journal">
<string-name><surname>Fulcher</surname>
<given-names>BD</given-names></string-name>, <string-name><surname>Jones</surname>
<given-names>NS</given-names></string-name> (<year>2017</year>) <article-title>hctsa: a computational framework for automated time-series phenotyping using massive feature extraction</article-title>. <source/>Cell Syst
<volume>5</volume>:<fpage>527</fpage>–<lpage>531.e3</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2017.10.001</pub-id>
<pub-id pub-id-type="pmid">29102608</pub-id></mixed-citation>
</ref>
<ref id="B18">
<mixed-citation publication-type="journal">
<string-name><surname>Geissmann</surname>
<given-names>Q</given-names></string-name>, <string-name><surname>Beckwith</surname>
<given-names>EJ</given-names></string-name>, <string-name><surname>Gilestro</surname>
<given-names>GF</given-names></string-name> (<year>2019</year>) <article-title>Most sleep does not serve a vital function: evidence from <italic>Drosophila melanogaster</italic></article-title>. <source/>Sci Adv
<volume>5</volume>:<fpage>eaau9253</fpage>
<pub-id pub-id-type="doi">10.1126/sciadv.aau9253</pub-id>
<pub-id pub-id-type="pmid">30801012</pub-id></mixed-citation>
</ref>
<ref id="B19">
<mixed-citation publication-type="journal">
<string-name><surname>Gomez-Marin</surname>
<given-names>A</given-names></string-name>, <string-name><surname>Stephens</surname>
<given-names>GJ</given-names></string-name>, <string-name><surname>Brown</surname>
<given-names>AEX</given-names></string-name> (<year>2016</year>) <article-title>Hierarchical compression of <italic>Caenorhabditis elegans</italic> locomotion reveals phenotypic differences in the organization of behaviour</article-title>. <source/>J R Soc Interface
<volume>13</volume>:<fpage>20160466</fpage>
<pub-id pub-id-type="doi">10.1098/rsif.2016.0466</pub-id>
<pub-id pub-id-type="pmid">27581484</pub-id></mixed-citation>
</ref>
<ref id="B20">
<mixed-citation publication-type="journal">
<string-name><surname>Peng</surname>
<given-names>H</given-names></string-name>, <string-name><surname>Long</surname>
<given-names>F</given-names></string-name>, <string-name><surname>Ding</surname>
<given-names>C</given-names></string-name> (<year>2005</year>) <article-title>Feature selection based on mutual information criteria of max-dependency, max-relevance, and min-redundancy</article-title>. <source/>IEEE Trans Pattern Anal Mach Intell
<volume>27</volume>:<fpage>1226</fpage>–<lpage>1238</lpage>. <pub-id pub-id-type="doi">10.1109/TPAMI.2005.159</pub-id>
<pub-id pub-id-type="pmid">16119262</pub-id></mixed-citation>
</ref>
<ref id="B21">
<mixed-citation publication-type="journal">
<string-name><surname>Hoffman</surname>
<given-names>EJ</given-names></string-name>, <string-name><surname>Turner</surname>
<given-names>KJ</given-names></string-name>, <string-name><surname>Fernandez</surname>
<given-names>JM</given-names></string-name>, <string-name><surname>Cifuentes</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Ghosh</surname>
<given-names>M</given-names></string-name>, <string-name><surname>Ijaz</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Jain</surname>
<given-names>RA</given-names></string-name>, <string-name><surname>Kubo</surname>
<given-names>F</given-names></string-name>, <string-name><surname>Bill</surname>
<given-names>BR</given-names></string-name>, <string-name><surname>Baier</surname>
<given-names>H</given-names></string-name>, <string-name><surname>Granato</surname>
<given-names>M</given-names></string-name>, <string-name><surname>Barresi</surname>
<given-names>MJF</given-names></string-name>, <string-name><surname>Wilson</surname>
<given-names>SW</given-names></string-name>, <string-name><surname>Rihel</surname>
<given-names>J</given-names></string-name>, <string-name><surname>State</surname>
<given-names>MW</given-names></string-name>, <string-name><surname>Giraldez</surname>
<given-names>AJ</given-names></string-name> (<year>2016</year>) <article-title>Estrogens suppress a behavioral phenotype in zebrafish mutants of the autism risk gene, CNTNAP2</article-title>. <source/>Neuron
<volume>89</volume>:<fpage>725</fpage>–<lpage>733</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2015.12.039</pub-id>
<pub-id pub-id-type="pmid">26833134</pub-id></mixed-citation>
</ref>
<ref id="B22">
<mixed-citation publication-type="journal">
<string-name><surname>Howe</surname>
<given-names>K</given-names></string-name>, <string-name><surname>Clark</surname>
<given-names>MD</given-names></string-name>, <string-name><surname>Torroja</surname>
<given-names>CF</given-names></string-name>, <string-name><surname>Torrance</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Berthelot</surname>
<given-names>C</given-names></string-name>, <string-name><surname>Muffato</surname>
<given-names>M</given-names></string-name>, <string-name><surname>Collins</surname>
<given-names>JE</given-names></string-name>, <string-name><surname>Humphray</surname>
<given-names>S</given-names></string-name>, <string-name><surname>McLaren</surname>
<given-names>K</given-names></string-name>, <string-name><surname>Matthews</surname>
<given-names>L</given-names></string-name>, <string-name><surname>McLaren</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Sealy</surname>
<given-names>I</given-names></string-name>, <string-name><surname>Caccamo</surname>
<given-names>M</given-names></string-name>, <string-name><surname>Churcher</surname>
<given-names>C</given-names></string-name>, <string-name><surname>Scott</surname>
<given-names>C</given-names></string-name>, <string-name><surname>Barrett</surname>
<given-names>JC</given-names></string-name>, <string-name><surname>Koch</surname>
<given-names>R</given-names></string-name>, <string-name><surname>Rauch</surname>
<given-names>GJ</given-names></string-name>, <string-name><surname>White</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Chow</surname>
<given-names>W</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>) <article-title>The zebrafish reference genome sequence and its relationship to the human genome</article-title>. <source/>Nature
<volume>496</volume>:<fpage>498</fpage>–<lpage>503</lpage>. <pub-id pub-id-type="doi">10.1038/nature12111</pub-id>
<pub-id pub-id-type="pmid">23594743</pub-id></mixed-citation>
</ref>
<ref id="B23">
<mixed-citation publication-type="journal">
<string-name><surname>Johnson</surname>
<given-names>MJ</given-names></string-name>, <string-name><surname>Duvenaud</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Wiltschko</surname>
<given-names>AB</given-names></string-name>, <string-name><surname>Datta</surname>
<given-names>SR</given-names></string-name>, <string-name><surname>Adams</surname>
<given-names>RP</given-names></string-name> (<year>2016</year>) <article-title>Composing graphical models with neural networks for structured representations and fast inference</article-title>. <source/>arXiv
<volume>1603.06277</volume>.</mixed-citation>
</ref>
<ref id="B24">
<mixed-citation publication-type="journal">
<string-name><surname>Jordan</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Kuehn</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Katifori</surname>
<given-names>E</given-names></string-name>, <string-name><surname>Leibler</surname>
<given-names>S</given-names></string-name> (<year>2013</year>) <article-title>Behavioral diversity in microbes and low-dimensional phenotypic spaces</article-title>. <source/>Proc Natl Acad Sci USA
<volume>110</volume>:<fpage>14018</fpage>–<lpage>14023</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1308282110</pub-id>
<pub-id pub-id-type="pmid">23898201</pub-id></mixed-citation>
</ref>
<ref id="B25">
<mixed-citation publication-type="journal">
<string-name><surname>Kim</surname>
<given-names>DH</given-names></string-name>, <string-name><surname>Kim</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Marques</surname>
<given-names>JC</given-names></string-name>, <string-name><surname>Grama</surname>
<given-names>A</given-names></string-name>, <string-name><surname>Hildebrand</surname>
<given-names>DGC</given-names></string-name>, <string-name><surname>Gu</surname>
<given-names>W</given-names></string-name>, <string-name><surname>Li</surname>
<given-names>JM</given-names></string-name>, <string-name><surname>Robson</surname>
<given-names>DN</given-names></string-name> (<year>2017</year>) <article-title>Pan-neuronal calcium imaging with cellular resolution in freely swimming zebrafish</article-title>. <source/>Nat Methods
<volume>14</volume>:<fpage>1107</fpage>–<lpage>1114</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4429</pub-id>
<pub-id pub-id-type="pmid">28892088</pub-id></mixed-citation>
</ref>
<ref id="B26">
<mixed-citation publication-type="journal">
<string-name><surname>Kokel</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Bryan</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Laggner</surname>
<given-names>C</given-names></string-name>, <string-name><surname>White</surname>
<given-names>R</given-names></string-name>, <string-name><surname>Cheung</surname>
<given-names>CYJ</given-names></string-name>, <string-name><surname>Mateus</surname>
<given-names>R</given-names></string-name>, <string-name><surname>Healey</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Kim</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Werdich</surname>
<given-names>AA</given-names></string-name>, <string-name><surname>Haggarty</surname>
<given-names>SJ</given-names></string-name>, <string-name><surname>MacRae</surname>
<given-names>CA</given-names></string-name>, <string-name><surname>Shoichet</surname>
<given-names>B</given-names></string-name>, <string-name><surname>Peterson</surname>
<given-names>RT</given-names></string-name> (<year>2010</year>) <article-title>Rapid behavior-based identification of neuroactive small molecules in the zebrafish</article-title>. <source/>Nat Chem Biol
<volume>6</volume>:<fpage>231</fpage>–<lpage>237</lpage>. <pub-id pub-id-type="doi">10.1038/nchembio.307</pub-id>
<pub-id pub-id-type="pmid">20081854</pub-id></mixed-citation>
</ref>
<ref id="B27">
<mixed-citation publication-type="journal">
<string-name><surname>Krakauer</surname>
<given-names>JW</given-names></string-name>, <string-name><surname>Ghazanfar</surname>
<given-names>AA</given-names></string-name>, <string-name><surname>Gomez-Marin</surname>
<given-names>A</given-names></string-name>, <string-name><surname>MacIver</surname>
<given-names>MA</given-names></string-name>, <string-name><surname>Poeppel</surname>
<given-names>D</given-names></string-name> (<year>2017</year>) <article-title>Neuroscience needs behavior: correcting a reductionist bias</article-title>. <source/>Neuron
<volume>93</volume>:<fpage>480</fpage>–<lpage>490</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2016.12.041</pub-id>
<pub-id pub-id-type="pmid">28182904</pub-id></mixed-citation>
</ref>
<ref id="B28">
<mixed-citation publication-type="journal">
<string-name><surname>Lamb</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Crawford</surname>
<given-names>ED</given-names></string-name>, <string-name><surname>Peck</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Modell</surname>
<given-names>JW</given-names></string-name>, <string-name><surname>Blat</surname>
<given-names>IC</given-names></string-name>, <string-name><surname>Wrobel</surname>
<given-names>MJ</given-names></string-name>, <string-name><surname>Lerner</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Brunet</surname>
<given-names>JP</given-names></string-name>, <string-name><surname>Subramanian</surname>
<given-names>A</given-names></string-name>, <string-name><surname>Ross</surname>
<given-names>KN</given-names></string-name>, <string-name><surname>Reich</surname>
<given-names>M</given-names></string-name>, <string-name><surname>Hieronymus</surname>
<given-names>H</given-names></string-name>, <string-name><surname>Wei</surname>
<given-names>G</given-names></string-name>, <string-name><surname>Armstrong</surname>
<given-names>SA</given-names></string-name>, <string-name><surname>Haggarty</surname>
<given-names>SJ</given-names></string-name>, <string-name><surname>Clemons</surname>
<given-names>PA</given-names></string-name>, <string-name><surname>Wei</surname>
<given-names>R</given-names></string-name>, <string-name><surname>Carr</surname>
<given-names>SA</given-names></string-name>, <string-name><surname>Lander</surname>
<given-names>ES</given-names></string-name>, <etal>et al.</etal> (<year>2006</year>) <article-title>The connectivity map: using gene-expression signatures to connect small molecules, genes, and disease</article-title>. <source/>Science
<volume>313</volume>:<fpage>1929</fpage>–<lpage>1935</lpage>. <pub-id pub-id-type="doi">10.1126/science.1132939</pub-id>
<pub-id pub-id-type="pmid">17008526</pub-id></mixed-citation>
</ref>
<ref id="B29">
<mixed-citation publication-type="book">
<string-name><surname>Lashley</surname>
<given-names>KS</given-names></string-name> (<year>1951</year>) <source/>The problem of serial order in behavior. In: Cerebral mechanisms in behavior; the Hixon Symposium (Jeffress LA ed), pp <fpage>112</fpage>–<lpage>146</lpage>. <publisher-loc>New York</publisher-loc>: <publisher-name>Wiley</publisher-name>.</mixed-citation>
</ref>
<ref id="B30">
<mixed-citation publication-type="journal">
<string-name><surname>Lin</surname>
<given-names>L</given-names></string-name>, <string-name><surname>Faraco</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Li</surname>
<given-names>R</given-names></string-name>, <string-name><surname>Kadotani</surname>
<given-names>H</given-names></string-name>, <string-name><surname>Rogers</surname>
<given-names>W</given-names></string-name>, <string-name><surname>Lin</surname>
<given-names>X</given-names></string-name>, <string-name><surname>Qiu</surname>
<given-names>X</given-names></string-name>, <string-name><surname>de Jong</surname>
<given-names>PJ</given-names></string-name>, <string-name><surname>Nishino</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Mignot</surname>
<given-names>E</given-names></string-name> (<year>1999</year>) <article-title>The sleep disorder canine narcolepsy is caused by a mutation in the hypocretin (orexin) receptor 2 gene</article-title>. <source/>Cell
<volume>98</volume>:<fpage>365</fpage>–<lpage>376</lpage>. <pub-id pub-id-type="doi">10.1016/S0092-8674(00)81965-0</pub-id>
<pub-id pub-id-type="pmid">10458611</pub-id></mixed-citation>
</ref>
<ref id="B31">
<mixed-citation publication-type="journal">
<string-name><surname>Marques</surname>
<given-names>JC</given-names></string-name>, <string-name><surname>Lackner</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Felix</surname>
<given-names>R</given-names></string-name>, <string-name><surname>Orger</surname>
<given-names>MB</given-names></string-name> (<year>2018</year>) <article-title>Structure of the zebrafish locomotor repertoire revealed with unsupervised behavioral clustering</article-title>. <source/>Curr Biol
<volume>28</volume>:<fpage>181</fpage>–<lpage>195.e5</lpage>. <pub-id pub-id-type="doi">10.1016/j.cub.2017.12.002</pub-id>
<pub-id pub-id-type="pmid">29307558</pub-id></mixed-citation>
</ref>
<ref id="B32">
<mixed-citation publication-type="journal">
<string-name><surname>Maye</surname>
<given-names>A</given-names></string-name>, <string-name><surname>Hsieh</surname>
<given-names>C</given-names></string-name>, <string-name><surname>Sugihara</surname>
<given-names>G</given-names></string-name>, <string-name><surname>Brembs</surname>
<given-names>B</given-names></string-name> (<year>2007</year>) <article-title>Order in spontaneous behavior</article-title>. <source/>PLoS One
<volume>2</volume>:<fpage>e443</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0000443</pub-id>
<pub-id pub-id-type="pmid">17505542</pub-id></mixed-citation>
</ref>
<ref id="B33">
<mixed-citation publication-type="journal">
<string-name><surname>Mu</surname>
<given-names>Y</given-names></string-name>, <string-name><surname>Bennett</surname>
<given-names>DV</given-names></string-name>, <string-name><surname>Rubinov</surname>
<given-names>M</given-names></string-name>, <string-name><surname>Narayan</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Yang</surname>
<given-names>C-T</given-names></string-name>, <string-name><surname>Tanimoto</surname>
<given-names>M</given-names></string-name>, <string-name><surname>Mensh</surname>
<given-names>BD</given-names></string-name>, <string-name><surname>Looger</surname>
<given-names>LL</given-names></string-name>, <string-name><surname>Ahrens</surname>
<given-names>MB</given-names></string-name> (<year>2019</year>) <article-title>Glia accumulate evidence that actions are futile and suppress unsuccessful behavior</article-title>. <source/>Cell
<volume>178</volume>:<fpage>27</fpage>–<lpage>43.e19</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.050</pub-id>
<pub-id pub-id-type="pmid">31230713</pub-id></mixed-citation>
</ref>
<ref id="B34">
<mixed-citation publication-type="journal">
<string-name><surname>Nevill-Manning</surname>
<given-names>CG</given-names></string-name>, <string-name><surname>Witten</surname>
<given-names>IH</given-names></string-name> (<year>2000</year>) <article-title>On-line and off-line heuristics for inferring hierarchies of repetitions in sequences</article-title>. <source/>Proc IEEE
<volume>88</volume>:<fpage>1745</fpage>–<lpage>1755</lpage>. <pub-id pub-id-type="doi">10.1109/5.892710</pub-id>
</mixed-citation>
</ref>
<ref id="B35">
<mixed-citation publication-type="journal">
<string-name><surname>Oikonomou</surname>
<given-names>G</given-names></string-name>, <string-name><surname>Prober</surname>
<given-names>DA</given-names></string-name> (<year>2017</year>) <article-title>Attacking sleep from a new angle: contributions from zebrafish</article-title>. <source/>Curr Opin Neurobiol
<volume>44</volume>:<fpage>80</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1016/j.conb.2017.03.009</pub-id>
<pub-id pub-id-type="pmid">28391131</pub-id></mixed-citation>
</ref>
<ref id="B36">
<mixed-citation publication-type="journal">
<string-name><surname>Prober</surname>
<given-names>DA</given-names></string-name>, <string-name><surname>Rihel</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Onah</surname>
<given-names>AA</given-names></string-name>, <string-name><surname>Sung</surname>
<given-names>R-J</given-names></string-name>, <string-name><surname>Schier</surname>
<given-names>AF</given-names></string-name> (<year>2006</year>) <article-title>Hypocretin/orexin overexpression induces an insomnia-like phenotype in zebrafish.</article-title>
<source/>J Neurosci
<volume>26</volume>:<fpage>13400</fpage>–<lpage>13410</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.4332-06.2006</pub-id>
<pub-id pub-id-type="pmid">17182791</pub-id></mixed-citation>
</ref>
<ref id="B37">
<mixed-citation publication-type="journal">
<string-name><surname>Proekt</surname>
<given-names>A</given-names></string-name>, <string-name><surname>Banavar</surname>
<given-names>JR</given-names></string-name>, <string-name><surname>Maritan</surname>
<given-names>A</given-names></string-name>, <string-name><surname>Pfaff</surname>
<given-names>DW</given-names></string-name> (<year>2012</year>) <article-title>Scale invariance in the dynamics of spontaneous behavior</article-title>. <source/>Proc Natl Acad Sci USA
<volume>109</volume>:<fpage>10564</fpage>–<lpage>10569</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1206894109</pub-id>
<pub-id pub-id-type="pmid">22679281</pub-id></mixed-citation>
</ref>
<ref id="B38">
<mixed-citation publication-type="journal">
<string-name><surname>Randlett</surname>
<given-names>O</given-names></string-name>, <string-name><surname>Wee</surname>
<given-names>CL</given-names></string-name>, <string-name><surname>Naumann</surname>
<given-names>EA</given-names></string-name>, <string-name><surname>Nnaemeka</surname>
<given-names>O</given-names></string-name>, <string-name><surname>Schoppik</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Fitzgerald</surname>
<given-names>JE</given-names></string-name>, <string-name><surname>Portugues</surname>
<given-names>R</given-names></string-name>, <string-name><surname>Lacoste</surname>
<given-names>AMB</given-names></string-name>, <string-name><surname>Riegler</surname>
<given-names>C</given-names></string-name>, <string-name><surname>Engert</surname>
<given-names>F</given-names></string-name>, <string-name><surname>Schier</surname>
<given-names>AF</given-names></string-name> (<year>2015</year>) <article-title>Whole-brain activity mapping onto a zebrafish brain atlas</article-title>. <source/>Nat Methods
<volume>12</volume>:<fpage>1039</fpage>–<lpage>1046</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3581</pub-id>
<pub-id pub-id-type="pmid">26778924</pub-id></mixed-citation>
</ref>
<ref id="B39">
<mixed-citation publication-type="book">
<string-name><surname>Rihel</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Ghosh</surname>
<given-names>M</given-names></string-name> (<year>2015</year>) <chapter-title>Zebrafish</chapter-title> In: <source/>Drug discovery and evaluation: pharmacological assays (<person-group person-group-type="editor"><name name-style="western"><surname>Hock</surname><given-names>FJ</given-names></name></person-group>, ed), pp <fpage>1</fpage>–<lpage>102</lpage>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name>.</mixed-citation>
</ref>
<ref id="B40">
<mixed-citation publication-type="journal">
<string-name><surname>Rihel</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Prober</surname>
<given-names>DA</given-names></string-name>, <string-name><surname>Arvanites</surname>
<given-names>A</given-names></string-name>, <string-name><surname>Lam</surname>
<given-names>K</given-names></string-name>, <string-name><surname>Zimmerman</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Jang</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Haggarty</surname>
<given-names>SJ</given-names></string-name>, <string-name><surname>Kokel</surname>
<given-names>D</given-names></string-name>, <string-name><surname>Rubin</surname>
<given-names>LL</given-names></string-name>, <string-name><surname>Peterson</surname>
<given-names>RT</given-names></string-name>, <string-name><surname>Schier</surname>
<given-names>AF</given-names></string-name> (<year>2010a</year>) <article-title>Zebrafish behavioral profiling links drugs to biological targets and rest/wake regulation</article-title>. <source/>Science
<volume>327</volume>:<fpage>348</fpage>–<lpage>351</lpage>. <pub-id pub-id-type="doi">10.1126/science.1183090</pub-id>
<pub-id pub-id-type="pmid">20075256</pub-id></mixed-citation>
</ref>
<ref id="B41">
<mixed-citation publication-type="journal">
<string-name><surname>Rihel</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Prober</surname>
<given-names>DA</given-names></string-name>, <string-name><surname>Schier</surname>
<given-names>AF</given-names></string-name> (<year>2010b</year>) <article-title>Monitoring sleep and arousal in zebrafish</article-title>. <source/>Methods Cell Biol
<volume>100</volume>:<fpage>281</fpage>–<lpage>294</lpage>.<pub-id pub-id-type="pmid">21111222</pub-id></mixed-citation>
</ref>
<ref id="B42">
<mixed-citation publication-type="journal">
<string-name><surname>Robie</surname>
<given-names>AA</given-names></string-name>, <string-name><surname>Hirokawa</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Edwards</surname>
<given-names>AW</given-names></string-name>, <string-name><surname>Umayam</surname>
<given-names>LA</given-names></string-name>, <string-name><surname>Lee</surname>
<given-names>A</given-names></string-name>, <string-name><surname>Phillips</surname>
<given-names>ML</given-names></string-name>, <string-name><surname>Card</surname>
<given-names>GM</given-names></string-name>, <string-name><surname>Korff</surname>
<given-names>W</given-names></string-name>, <string-name><surname>Rubin</surname>
<given-names>GM</given-names></string-name>, <string-name><surname>Simpson</surname>
<given-names>JH</given-names></string-name>, <string-name><surname>Reiser</surname>
<given-names>MB</given-names></string-name>, <string-name><surname>Branson</surname>
<given-names>K</given-names></string-name> (<year>2017</year>) <article-title>Mapping the neural substrates of behavior</article-title>. <source/>Cell
<volume>170</volume>:<fpage>393</fpage>–<lpage>406.e28</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2017.06.032</pub-id>
<pub-id pub-id-type="pmid">28709004</pub-id></mixed-citation>
</ref>
<ref id="B43">
<mixed-citation publication-type="journal">
<string-name><surname>Shein-Idelson</surname>
<given-names>M</given-names></string-name>, <string-name><surname>Ondracek</surname>
<given-names>JM</given-names></string-name>, <string-name><surname>Liaw</surname>
<given-names>H-P</given-names></string-name>, <string-name><surname>Reiter</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Laurent</surname>
<given-names>G</given-names></string-name> (<year>2016</year>) <article-title>Slow waves, sharp waves, ripples, and REM in sleeping dragons</article-title>. <source/>Science
<volume>352</volume>:<fpage>590</fpage>–<lpage>595</lpage>. <pub-id pub-id-type="doi">10.1126/science.aaf3621</pub-id>
<pub-id pub-id-type="pmid">27126045</pub-id></mixed-citation>
</ref>
<ref id="B44">
<mixed-citation publication-type="journal">
<string-name><surname>Stern</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Kirst</surname>
<given-names>C</given-names></string-name>, <string-name><surname>Bargmann</surname>
<given-names>CI</given-names></string-name> (<year>2017</year>) <article-title>Neuromodulatory control of long-term behavioral patterns and individuality across development</article-title>. <source/>Cell
<volume>171</volume>:<fpage>1649</fpage>–<lpage>1662.e10</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2017.10.041</pub-id>
<pub-id pub-id-type="pmid">29198526</pub-id></mixed-citation>
</ref>
<ref id="B45">
<mixed-citation publication-type="journal">
<string-name><surname>Thyme</surname>
<given-names>SB</given-names></string-name>, <string-name><surname>Pieper</surname>
<given-names>LM</given-names></string-name>, <string-name><surname>Li</surname>
<given-names>EH</given-names></string-name>, <string-name><surname>Pandey</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Wang</surname>
<given-names>Y</given-names></string-name>, <string-name><surname>Morris</surname>
<given-names>NS</given-names></string-name>, <string-name><surname>Sha</surname>
<given-names>C</given-names></string-name>, <string-name><surname>Choi</surname>
<given-names>JW</given-names></string-name>, <string-name><surname>Herrera</surname>
<given-names>KJ</given-names></string-name>, <string-name><surname>Soucy</surname>
<given-names>ER</given-names></string-name>, <string-name><surname>Zimmerman</surname>
<given-names>S</given-names></string-name>, <string-name><surname>Randlett</surname>
<given-names>O</given-names></string-name>, <string-name><surname>Greenwood</surname>
<given-names>J</given-names></string-name>, <string-name><surname>McCarroll</surname>
<given-names>SA</given-names></string-name>, <string-name><surname>Schier</surname>
<given-names>AF</given-names></string-name> (<year>2019</year>) <article-title>Phenotypic landscape of schizophrenia-associated genes defines candidates and their shared functions</article-title>. <source/>Cell
<volume>177</volume>:<fpage>478</fpage>–<lpage>491.e20</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2019.01.048</pub-id>
<pub-id pub-id-type="pmid">30929901</pub-id></mixed-citation>
</ref>
<ref id="B46">
<mixed-citation publication-type="journal">
<string-name><surname>Tinbergen</surname>
<given-names>N</given-names></string-name> (<year>2010</year>) <article-title>On aims and methods of ethology</article-title>. <source/>Z Tierpsychol
<volume>20</volume>:<fpage>410</fpage>–<lpage>433</lpage>. <pub-id pub-id-type="doi">10.1111/j.1439-0310.1963.tb01161.x</pub-id>
</mixed-citation>
</ref>
<ref id="B47">
<mixed-citation publication-type="journal">
<string-name><surname>Todd</surname>
<given-names>JG</given-names></string-name>, <string-name><surname>Kain</surname>
<given-names>JS</given-names></string-name>, <string-name><surname>de Bivort</surname>
<given-names>BL</given-names></string-name> (<year>2017</year>) <article-title>Systematic exploration of unsupervised methods for mapping behavior</article-title>. <source/>Phys Biol
<volume>14</volume>:<fpage>015002</fpage>
<pub-id pub-id-type="doi">10.1088/1478-3975/14/1/015002</pub-id>
<pub-id pub-id-type="pmid">28166059</pub-id></mixed-citation>
</ref>
<ref id="B48">
<mixed-citation publication-type="journal">
<string-name><surname>Truett</surname>
<given-names>GE</given-names></string-name>, <string-name><surname>Heeger</surname>
<given-names>P</given-names></string-name>, <string-name><surname>Mynatt</surname>
<given-names>RL</given-names></string-name>, <string-name><surname>Truett</surname>
<given-names>AA</given-names></string-name>, <string-name><surname>Walker</surname>
<given-names>JA</given-names></string-name>, <string-name><surname>Warman</surname>
<given-names>ML</given-names></string-name> (<year>2000</year>) <article-title>Preparation of PCR-quality mouse genomic DNA with hot sodium hydroxide and tris (HotSHOT)</article-title>. <source/>Biotechniques
<volume>29</volume>:<fpage>52</fpage>–<lpage>54</lpage>. <pub-id pub-id-type="doi">10.2144/00291bm09</pub-id>
<pub-id pub-id-type="pmid">10907076</pub-id></mixed-citation>
</ref>
<ref id="B49">
<mixed-citation publication-type="journal">
<string-name><surname>Vanwalleghem</surname>
<given-names>GC</given-names></string-name>, <string-name><surname>Ahrens</surname>
<given-names>MB</given-names></string-name>, <string-name><surname>Scott</surname>
<given-names>EK</given-names></string-name> (<year>2018</year>) <article-title>Integrative whole-brain neuroscience in larval zebrafish</article-title>. <source/>Curr Opin Neurobiol
<volume>50</volume>:<fpage>136</fpage>–<lpage>145</lpage>. <pub-id pub-id-type="doi">10.1016/j.conb.2018.02.004</pub-id>
<pub-id pub-id-type="pmid">29486425</pub-id></mixed-citation>
</ref>
<ref id="B50">
<mixed-citation publication-type="journal">
<string-name><surname>Vogelstein</surname>
<given-names>JT</given-names></string-name>, <string-name><surname>Park</surname>
<given-names>Y</given-names></string-name>, <string-name><surname>Ohyama</surname>
<given-names>T</given-names></string-name>, <string-name><surname>Kerr</surname>
<given-names>RA</given-names></string-name>, <string-name><surname>Truman</surname>
<given-names>JW</given-names></string-name>, <string-name><surname>Priebe</surname>
<given-names>CE</given-names></string-name>, <string-name><surname>Zlatic</surname>
<given-names>M</given-names></string-name> (<year>2014</year>) <article-title>Discovery of brainwide neural-behavioral maps via multiscale unsupervised structure learning</article-title>. <source/>Science
<volume>344</volume>:<fpage>386</fpage>–<lpage>392</lpage>. <pub-id pub-id-type="doi">10.1126/science.1250298</pub-id>
<pub-id pub-id-type="pmid">24674869</pub-id></mixed-citation>
</ref>
<ref id="B51">
<mixed-citation publication-type="journal">
<string-name><surname>Wiltschko</surname>
<given-names>AB</given-names></string-name>, <string-name><surname>Johnson</surname>
<given-names>MJ</given-names></string-name>, <string-name><surname>Iurilli</surname>
<given-names>G</given-names></string-name>, <string-name><surname>Peterson</surname>
<given-names>RE</given-names></string-name>, <string-name><surname>Katon</surname>
<given-names>JM</given-names></string-name>, <string-name><surname>Pashkovski</surname>
<given-names>SL</given-names></string-name>, <string-name><surname>Abraira</surname>
<given-names>VE</given-names></string-name>, <string-name><surname>Adams</surname>
<given-names>RP</given-names></string-name>, <string-name><surname>Datta</surname>
<given-names>SR</given-names></string-name> (<year>2015</year>) <article-title>Mapping sub-second structure in mouse behavior</article-title>. <source/>Neuron
<volume>88</volume>:<fpage>1121</fpage>–<lpage>1135</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2015.11.031</pub-id>
<pub-id pub-id-type="pmid">26687221</pub-id></mixed-citation>
</ref>
<ref id="B52">
<mixed-citation publication-type="journal">
<string-name><surname>Yokogawa</surname>
<given-names>T</given-names></string-name>, <string-name><surname>Marin</surname>
<given-names>W</given-names></string-name>, <string-name><surname>Faraco</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Pézeron</surname>
<given-names>G</given-names></string-name>, <string-name><surname>Appelbaum</surname>
<given-names>L</given-names></string-name>, <string-name><surname>Zhang</surname>
<given-names>J</given-names></string-name>, <string-name><surname>Rosa</surname>
<given-names>F</given-names></string-name>, <string-name><surname>Mourrain</surname>
<given-names>P</given-names></string-name>, <string-name><surname>Mignot</surname>
<given-names>E</given-names></string-name> (<year>2007</year>) <article-title>Characterization of sleep in zebrafish and insomnia in hypocretin receptor mutants</article-title>. <source/>PLoS Biol
<volume>5</volume>:<fpage>e277</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pbio.0050277</pub-id>
<pub-id pub-id-type="pmid">17941721</pub-id></mixed-citation>
</ref>
<ref id="B53">
<mixed-citation publication-type="journal">
<string-name><surname>Zhdanova</surname>
<given-names>IV</given-names></string-name>, <string-name><surname>Wang</surname>
<given-names>SY</given-names></string-name>, <string-name><surname>Leclair</surname>
<given-names>OU</given-names></string-name>, <string-name><surname>Danilova</surname>
<given-names>NP</given-names></string-name> (<year>2001</year>) <article-title>Melatonin promotes sleep-like state in zebrafish</article-title>. <source/>Brain Res
<volume>903</volume>:<fpage>263</fpage>–<lpage>268</lpage>. <pub-id pub-id-type="doi">10.1016/S0006-8993(01)02444-1</pub-id>
<pub-id pub-id-type="pmid">11382414</pub-id></mixed-citation>
</ref>
</ref-list>
<sec id="s6" sec-type="synthesis-author-response">
<title>Synthesis</title>
<boxed-text orientation="portrait" position="float">
<p>Reviewing Editor: Tatyana Sharpee, The Salk Institute for Biological Studies</p>
<p>Decisions are customarily a result of the Reviewing Editor and the peer reviewers coming together and discussing their recommendations until a consensus is reached. When revisions are invited, a fact-based synthesis statement explaining their decision and outlining what is needed to prepare a revision will be listed below. The following reviewer(s) agreed to reveal their identity: David Ehrlich.</p>
</boxed-text>
<p>The study “Hierarchical Compression Reveals Sub-Second to Day-Long Structure in Larval Zebrafish Behavior” employed a novel approach in zebrafish to assess patterns in swimming behavior across sequences of bouts. The authors categorized swim bouts and pauses into “modules” using cluster analysis, then identified common sequences of modules called “motifs” using hierarchical compression. These modules and motifs varied in frequency across a number of domains (day vs. night, pharmacological agent and dose, genotype). Behavior was categorized based on movement timeseries from 96-well plates, with each fish described as a vector of pixel change counts. These minimalistic data permitted the classification of timeseries into categories of alternating bouts and pauses over millions of cycles. The extraordinary scale of behavior collected was critical for testing the strongest idea in the manuscript, that certain motifs are common across fish and specific to a particular state or dose of drug. The application of hierarchical compression to assess behavioral sequences in zebrafish is novel and of great interest, and the experiments demonstrate the applicability and value of this approach for comparing behavior across conditions. The manuscript was generally well written, the concepts made accessible, and the figures largely clear and informative. The manuscript needs to be improved to address concerns about clustering results and providing statistics on motif frequency.</p>
<p>Major concerns:</p>
<p>The clustering of pauses requires more exploration and support. The authors performed k-means clustering on this scalar data to categorize pauses according to duration - a defensible step for making hierarchical compression practical - resulting in 5 clusters. Regardless, the resulting cutoffs between clusters (0.16, 1.20, 3.72, 20.04 sec) appear arbitrary. The authors claim to “identify” 5 pause modules (L701), but I understand these modules to be imposed on the data. If the resulting cutoffs are effectively arbitrary, the authors should be more up-front about this critical simplification. Given this apparent arbitrariness and that the definition of motifs is sensitive to the categorization of pauses, it is essential to test whether conclusions about motifs are robust to the clustering of pauses. For example, inactive modules are defined collectively for day and night data. Consequentially, inactive modules are more evenly distributed in nighttime data than daytime data (Figure 2D). Daytime pauses are effectively chosen from 3 modules (1-3), while nighttime pauses are chosen from 5. I would think this simple fact makes daytime data more compressible, ignoring any differences in module sequencing. If pause cutoffs are set to give approximately equally populated inactive modules in daytime rather than nighttime, does compressibility flip to be larger at night than day (Fig 3B)? A key step will be to perform hierarchical compression again with 4 or 6 inactive modules to see whether the data on motif specificity in Figs. 5A and 5B obtain, with similar motifs observed under each drug dose.</p>
<p>The authors should more clearly explain the calculation of enrichment/constraint and calculate statistics to facilitate its interpretation. The authors counted motif observations and “Normalized these counts by calculating whether...” (L579), but “whether” implies a binary. How was the normalization performed? Why does Eq. 3 output +/-3.32 when sigma=0 (L388)?Normalization to counts in shuffled data involved in the computation of “enrichment/constraint” is useful to suggest an observed sequence occurs more often than chance in a block given a set of modules. However, many such blocks were analyzed and ∼50,000 motifs comprised the library. Given that so many blocks were analyzed, some motifs would naturally be repeated more than chance. Can the authors randomly generate a sequence of modules of the same length as the analyzed data across all blocks, in order to give a sense for the largest enrichment/constraint scores for motifs repeated by chance? This approach may provide a false positive rate, which would help assess whether observed motifs are observed significantly more than chance (applicable to Figs. 4C, 5A, 5B).</p>
<p>Minor concerns:</p>
<p>Was data independent across larvae if they could see each other swim? Did correlations of behavior across individuals, and specifically the timing of bouts, vary as a function of proximity of wells? Were fish of a given condition/dose distributed across wells for each experiment in a manner that could avoid this confound?</p>
<p>Abstract: “movements and pauses, termed bouts.” The term ‘bouts’ typically describes active swimming events, connoting the repetition of tail beats that comprises each swim event. Referring to pauses as “inactive bouts” throughout is confusing.</p>
<p>The authors should clarify whether larvae were fed prior to or during the experiment, or if they simply survived on yolk.</p>
<p>How many larvae were used for experiments? Approximately how many larvae died or were unresponsive (L99)?</p>
<p>Figure 1B- By my calculation, 100,000 bouts over 28 daytime hours corresponds to ∼1 Hz swim rate. These data are (importantly) consistent with literature and typically presented as rates. Comparing number of bouts across 28 daytime and 20 nighttime hours is misleading.</p>
<p>Figure 2C left - Are some active modules not plotted? This figure appears only red and is difficult to read.</p>
<p>A matter of taste, but readability is hindered by re-using the colormap for active modules (reds) to show melatonin dose, and reusing the colormap for inactive modules (blues) to show day/night and enrichment/constraint (e.g. Fig. 4B).</p>
<p>Figure 3B- An intriguing result! How did the motif dictionary compare for larvae at night and those treated with melatonin? Is the change in compressibility due to melatonin dose driven by module distribution or module sequence?</p>
<p>L558 apostrophe typo</p>
<p>L604- This claim is critical and it needs context. Is it surprising that only a few motifs were needed to classify day vs. night? Certain modules (e.g. inactive module 5) are almost exclusively observed during the night. A comparison to classification based solely on inactive duration would be useful. How many pauses must be observed to classify day/night with the same confidence?</p>
<p>L609 - To distinguish development from adaptation the authors must vary the day they introduce larvae to the plates.</p>
<p>Figure 4D - Can the authors justify the definition of a “startle” pattern with literature or further explain their logic?</p>
<p>L629 - Why would dose-specific motifs evidence low-affinity receptors? The attribution seems arbitrary. Perhaps this point would be better made in the Discussion when interpreting dose-specific data.</p>
<p>Figure 5A- Why is the best motif for a given dose of melatonin not always most prominent in that dose (e.g. 0.01uM motif is most enriched in control fish)?</p>
<p>L644- What is a “behavioral seizure” and which motif corresponds to it?</p>
<p>It is important to get a sense of how common these motifs are. Can the authors plot in Fig. 3C a marginal showing the probability distribution of motifs across all data?</p>
<p>L685- In this paragraph, can the authors speak to the steps to modify the existing protocol to account for higher-dimensional behavioral data?</p>
<p>Fish can translate a large proportion of body length per frame at 25Hz (ignoring interactions with walls of a well). How many pixels does a larva span? The maximal possible delta pixel is important for interpreting bout data. Do some bouts reach this ceiling? Would higher frame rates be prescribed for future applications?</p>
</sec>
<sec id="s7" sec-type="synthesis-author-response">
<title>Author Response</title>
<p>Synthesis of Reviews:</p>
<p>Computational Neuroscience Model Code Accessibility Comments for Author (Required): The code will be provided</p>
<p>Significance Statement Comments for Author (Required): The statement reads well.</p>
<p>Comments on the Visual Abstract for Author (Required):</p>
<p>n/a</p>
<p>Synthesis Statement for Author (Required):</p>
<p>The study “Hierarchical Compression Reveals Sub-Second to Day-Long Structure in Larval Zebrafish Behavior” employed a novel approach in zebrafish to assess patterns in swimming behavior across sequences of bouts. The authors categorized swim bouts and pauses into “modules” using cluster analysis, then identified common sequences of modules called “motifs” using hierarchical compression. These modules and motifs varied in frequency across a number of domains (day vs. night, pharmacological agent</p>
<p>and dose, genotype). Behavior was categorized based on movement timeseries from 96-</p>
<p>well plates, with each fish described as a vector of pixel change counts. These minimalistic data permitted the classification of timeseries into categories of alternating bouts and pauses over millions of cycles. The extraordinary scale of behavior collected was critical for testing the strongest idea in the manuscript, that certain motifs are common across fish and specific to a particular state or dose of drug. The application of hierarchical compression to assess behavioral sequences in zebrafish is novel and of great interest, and the experiments demonstrate the applicability and value of this approach for comparing behavior across conditions. The manuscript was generally well written, the concepts made accessible, and the figures largely clear and informative. The manuscript needs to be improved to address concerns about clustering results and providing statistics on motif frequency.</p>
<p>Dear Reviewers,</p>
<p>Thank you for your interest in our manuscript. We are grateful for the time you have put into the process, evident from your thoughtful comments. Below, we have divided your concerns into individual points and provided a reply to each. Where appropriate we have performed additional data analysis and made changes to the manuscript and figures. We believe these changes address all concerns and have strengthened our manuscript.</p>
<p>Major concerns:</p>
<p>The clustering of pauses requires more exploration and support. The authors performed k-means clustering on this scalar data to categorize pauses according to duration - a defensible step for making hierarchical compression practical - resulting in 5 clusters. Regardless, the resulting cutoffs between clusters (0.16, 1.20, 3.72, 20.04 sec) appear arbitrary. The authors claim to “identify” 5 pause modules (L701), but I understand these modules to be imposed on the data. If the resulting cutoffs are effectively arbitrary, the authors should be more up-front about this critical simplification.</p>
<p>We are glad that the reviewers recognise the importance of clustering the pauses into modules for subsequent analysis and interpretation. We would, however, like to emphasise that our clustering approach is fully unsupervised. Thus, our clusters are identified from, not imposed upon, our data.</p>
<p>As detailed in the methods (line 312) to identify our inactive (and active) modules, we designed an algorithm based upon Fred and Jain, 2002 and 2005, which executes the following steps:</p>
<p>1. Randomly sample a set of probe bouts</p>
<p>2. Over 200 iterations (with n and k varying uniformly):</p>
<p>a. Randomly sample n bouts (from the full set of bouts)</p>
<p>b. Fit a Gaussian mixture model with k components c. Assign probe points to components</p>
<p>d. Accumulate evidence - pairwise occurrence of probe points in the same cluster</p>
<p>3. Apply average link clustering to the evidence accumulation matrix (probe points x probe points)</p>
<p>4. Determine the final number of clusters by using the maximum differentiated linkage distance to cut the resultant dendrogram</p>
<p>This approach is appropriate for our large datasets (30,900,018 active and 30,900,418 inactive bouts), as it allows us to implicitly explore the effects of and interaction between the bouts sampled, the number of bouts sampled and the number of mixture</p>
<p>components, and ultimately combine this information across 200 models to an aggregate solution.</p>
<p>Ultimately, we do, however, recognise that clustering is an inherently challenging problem and hope that our discussion of alternative approaches (Line 770 onwards) and openness of data and code sharing through online repositories will stimulate further work in this area.</p>
<p>Given this apparent arbitrariness and that the definition of motifs is sensitive to the categorization of pauses, it is essential to test whether conclusions about motifs are robust to the clustering of pauses. For example, inactive modules are defined collectively for day and night data. Consequentially, inactive modules are more evenly distributed in nighttime data than daytime data (Figure 2D). Daytime pauses are effectively chosen from 3 modules (1-3), while nighttime pauses are chosen from 5. I would think this simple fact makes daytime data more compressible, ignoring any differences in module sequencing.</p>
<p>The reviewers are correct to recognize that a difference in compressibility could arise from differences in either module or motif usage.</p>
<p>Indeed, to determine the contribution of each we calculate “Δ compressibility” (the difference in compressibility between each animal’s real and shuffled data). From this metric we demonstrate that the difference between the day and the night is, as the reviewer suggests, predominantly due to differences in module usage (Lines 574).</p>
<p>To make this clearer in the manuscript we have changed the word “selection” in Line 576, to “distribution", and added a concise summary of our compressibility and Δ compressibility findings (Line 593).</p>
<p>If pause cutoffs are set to give approximately equally populated inactive modules in daytime rather than nighttime, does compressibility flip to be larger at night than day (Fig 3B)?</p>
<p>We understand the reviewers concern regarding how our bout classification impacts upon our compression results. Hopefully, as detailed above, we have now sufficiently emphasised the unsupervised nature of our bout classification and made clearer how Δ compressibility addresses differences in module distribution between contexts.</p>
<p>Here, we understand the reviewers to be asking “is day or night behaviour more compressible, module differences aside?”. This question is addressed by a comparison of Δ compressibility, which demonstrates that even once differences in module distribution are accounted for, the daytime data is more compressive and hence more sequence rich (Supplemental Figure 5e).</p>
<p>A key step will be to perform hierarchical compression again with 4 or 6 inactive modules to see whether the data on motif specificity in Figs. 5A and 5B obtain, with similar motifs observed under each drug dose.</p>
<p>Although we believe an unsupervised module classification approach to be appropriate for our aim, the reviewers raise an interesting point; how would the most salient motifs for a comparison compare when drawn from a motif library built from different modules?</p>
<p>Here, we are happy to provide data from a preliminary version of our analysis. This dataset included data from a second hypocretin mutant, which we later excluded due to poor quality of tracking. Aside from the additional data, we would like the reviewers to note that there are many differences between this and our final analysis including different thresholding parameters and the use of an alternative, less suitable, clustering method.</p>
<p>In this model, we identified 10 active and 6 inactive modules. To test how motif usage would differ between this and our final module set (5 active and 5 inactive), we compared the most salient control vs PTZ motif from each set.</p>
<p>The preliminary motif is 3 modules long: active module 7, inactive module 1, active module 7, and thus represents a pair of high amplitude movements broken by the shortest pause.</p>
<p>The usage of this motif (y-axis) is shown below (Reviewer Figure 1) across control and PTZ dosed axis). Each animal is represented by two dots (day and night) with a black cross denoting</p>
<p>each group’s mean.</p>
<p>This result is quite similar to our final analysis which also identifies a seizure motif 3 modules long: active module 2, inactive module 1, active module 4 - again a pair of active bouts broken by the shortest pause. Similarly, the usage of this motif is constrained in control fish and enriched in PTZ dosed fish (Figure 5B, middle panel - a cropped and rotated version of which is shown below to facilitate comparison to the preliminary model).</p>
<p>Overall, this demonstrates that motif libraries built from different module sets can still lead to similar salient motifs. We tentatively suggest that this example</p>
<p>demonstrates our analysis is likely robust to changes in our unsupervised module classification.</p>
<p>The authors should more clearly explain the calculation of enrichment/constraint and</p>
<p>calculate statistics to facilitate its interpretation. The authors counted motif observations and “Normalized these counts by calculating whether...” (L579), but “whether” implies a binary. How was the normalization performed?</p>
<p>We thank the reviewers for highlighting the need for a better explanation of our enrichment/constraint metric.</p>
<p>We have amended the main text to make its calculation clearer (lines 617) and removed</p>
<p>the word “whether” as suggested:</p>
<p>"To test this hypothesis, we counted the number of times each larva or set of paired shuffled data used each motif within each time frame (e.g. day or night) and then normalised these counts by calculating the deviation of the real from shuffled counts, as well as the deviation of each shuffle from the other shuffles, a metric we termed enrichment/constraint.”</p>
<p>In the methods we have also included a sample calculation to aid interpretation (line</p>
<p>389):</p>
<p>"For example, for a given animal and time window, if a motif was used 10 times in the real data and a mean of 4.5 times in the 10 sets of paired shuffled data (standard deviation 1.58), enrichment/constraint would equal 3.48.”</p>
<p>10 − 4.5</p>
<p>3.48 =</p>
<p>1.58</p>
<p>Why does Eq. 3 output +/-3.32 when sigma=0 (L388)?</p>
<p>When there is no standard deviation in the shuffled counts (sigma = 0), Eq.3 (the enrichment/constraint calculation) will output either positive or negative infinity. To facilitate subsequent working, infinite values were replaced with a constant value of √(1</p>
<p>+ number of shuffled counts) = √(11) = {plus minus} 3.32.</p>
<p>We acknowledge that this is a simple replacement scheme; however, in our real data infinite values constituted only 2.2% of all enrichment/ constraint scores.</p>
<p>We have adjusted line 396 to better explain this:</p>
<p>"When comparing the shuffled data to itself, each shuffle (now x_i) was excluded from s _i and σ_si. Infinite values occurred when there was no standard deviation in the σ_si counts and thus σ_si equalled zero. To facilitate subsequent working, infinite values were replaced with a constant value of √(1 + number of shuffled counts) = √(11) = {plus minus} 3.32. Note that in the real data, infinite values constituted only 2.2% of all enrichment/ constraint scores.”</p>
<p>Normalization to counts in shuffled data involved in the computation of “enrichment/constraint” is useful to suggest an observed sequence occurs more often than chance in a block given a set of modules. However, many such blocks were analyzed and ∼50,000 motifs comprised the library. Given that so many blocks were analyzed, some motifs would naturally be repeated more than chance. Can the authors randomly generate a sequence of modules of the same length as the analyzed data</p>
<p>across all blocks, in order to give a sense for the largest enrichment/constraint scores for motifs repeated by chance? This approach may provide a false positive rate, which would help assess whether observed motifs are observed significantly more than chance (applicable to Figs. 4C, 5A, 5B).</p>
<p>We are glad that the reviewers find our enrichment/constraint metric useful and agree that across such a large dataset it is likely that some motifs will be repeated more or less than chance and thus have non-zero enrichment/constraint scores.</p>
<p>To determine the distribution of chance enrichment/constraint scores, we shuffled every animals’ entire dataset 10 times, and then calculated enrichment/constraint as for the real data.</p>
<p>The results of this process are shown in Figure 4a where probability density functions show the probability of observing motifs at different enrichment/constraint scores.</p>
<p>As seen in the figure, the real and shuffled enrichment/constraint scores diverge before</p>
<p>{plus minus} 4. This demonstrates that in the shuffled data values above / below {plus minus} 4 are seen far less commonly than in the real data. To quantify this difference, we compared the kurtosis of each animal’s real and shuffled distribution (Figure 4a, insert), demonstrating that the kurtosis of the real data is significantly higher.</p>
<p>Minor concerns:</p>
<p>Was data independent across larvae if they could see each other swim? Did correlations of behavior across individuals, and specifically the timing of bouts, vary as a function of proximity of wells?</p>
<p>We thank the reviewer for raising this issue. To address the reviewer’s comment, we:</p>
<p>• Took a sample of 24 wild-type fish from our data</p>
<p>• Computed the pairwise correlation between their active bout starts across 24hrs</p>
<p>• Defined each pairwise comparison as either an “autocorrelation", a</p>
<p>"neighbour” (i.e. in an adjacent well of the 96 well plate, diagonals excluded) or</p>
<p>"distant” (i.e. in non-adjacent wells)</p>
<p>• Plotted the mean and standard deviation for each group</p>
<p>• Note that the y-axis is cropped from 1, where autocorrelation peaks, to 0.1.</p>
<p>As can be seen in the resultant figure (reproduced below) there is no significant effect of well proximity upon the timing of active bout starts. This result is broadly consistent with</p>
<p>results from Dreosti et al., 2015, who found that at this age larvae show no avoidance or</p>
<p>preference towards other larvae freely swimming behind a glass window.</p>
<p>We agree with the reviewer that this is an important consideration and thus have added the following text to the manuscript (line 463), as well as this figure to the supplement (Supplementary Figure 1b).</p>
<p>"We found no correlation of active bout initiation between larvae in adjacent wells of the</p>
<p>96-well plate (Supplementary Figure 1b), suggesting no interactions among larvae.”</p>
<p>Were fish of a given condition/dose distributed across wells for each experiment in a manner that could avoid this confound?</p>
<p>For the hypocretin experiments larvae were plated randomly as we were blind to genotype at this point. For the pharmacological experiments, we dosed each row of the plate with a successively higher dose. To make this clearer we have included the following line in the methods (line 93):</p>
<p>"Following two control rows, each row was dosed with a successively higher concentration</p>
<p>of test compound.”</p>
<p>As shown above, there is no significant effect of well proximity upon the timing of active bout starts.</p>
<p>Abstract: “movements and pauses, termed bouts.” The term ‘bouts’ typically describes active swimming events, connoting the repetition of tail beats that comprises each swim event. Referring to pauses as “inactive bouts” throughout is confusing.</p>
<p>Whilst we concede that in the zebrafish literature the term bout does typically describe a swimming movement, in the sleep field, which we hope will take interest in our paper, it is common to refer to bouts of inactivity (for example rest or sleep bouts). We therefore prefer to keep this terminology.</p>
<p>The authors should clarify whether larvae were fed prior to or during the experiment, or if they simply survived on yolk.</p>
<p>We thank the reviewers for noting our omission, larvae were not fed either prior to or during experiments. We have included this information in the text (line 95):</p>
<p>"Larvae were not fed either prior to or during experiments.”</p>
<p>How many larvae were used for experiments? Approximately how many larvae died or were unresponsive (L99)?</p>
<p>We thank the reviewers for suggesting we include this information. We have added the following to the methods section (line 102).</p>
<p>"In the wild-type experiments we additionally excluded wells in which a bubble had formed under the plastic lid. The number of larvae excluded / used for each set of experiments is as follows: wild-type -- 164/288 (all exclusions were due to bubble artefacts), hypocretin -</p>
<p>0/180, melatonin - 0/96, PTZ - 44/96 (doses of 10, 15 and 30mM were lethal to all tested</p>
<p>larvae).”</p>
<p>Figure 1B- By my calculation, 100,000 bouts over 28 daytime hours corresponds to ∼1 Hz swim rate. These data are (importantly) consistent with literature and typically presented as rates. Comparing number of bouts across 28 daytime and 20 nighttime hours is misleading.</p>
<p>We would like to thank the reviewers for noting that our data are consistent with the broader literature, especially as compared to larvae in larger arenas. We have altered Figure 1b to report Bout Frequency (Hz) as suggested and have highlighted the consistency of our result with the literature in the main text (line 468):</p>
<p>"During the day, wild-type larvae initiated bouts at a mean frequency of 0.89 Hz (Figure 1b) a rate consistent with other assays (Kim et al., 2017), and tended to use short, sub-second long inactive bouts (Figure 1c). During the night, larvae displayed a mean bout frequency of only 0.07 Hz (Figure 1b) and utilised longer inactive bouts, on the order of seconds to minutes (Figure 1c).”</p>
<p>Figure 2C left - Are some active modules not plotted? This figure appears only red and is difficult to read.</p>
<p>We are grateful to the reviewers for spotting this subtle error. We have corrected figure</p>
<p>2C to include all active modules.</p>
<p>The reviewer is right to point out that there is a lot of data displayed here (each matrix is</p>
<p>124 x 4,319,953). It is, however, our intention in this panel to show the data in as unprocessed a form as possible to illustrate our starting point for subsequent analysis. Furthermore, showing the data in this way allows readers to assess the consistency of later findings across individual animals. We hope that the two subsequent panels (Figure</p>
<p>2d and e), aid in the interpretation of this figure.</p>
<p>A matter of taste, but readability is hindered by re-using the colormap for active modules (reds) to show melatonin dose, and reusing the colormap for inactive modules (blues) to show day/night and enrichment/constraint (e.g. Fig. 4B).</p>
<p>Unfortunately, the use of a single colormap was decided upon early in the project.</p>
<p>As kindly noted in the synthesis statement, our figures are “largely clear and informative”. We hope that the reviewers appreciate our efforts towards this, including clear figure legends, consistency across panels and an effort to include only key findings in the main figures.</p>
<p>Figure 3B- An intriguing result! How did the motif dictionary compare for larvae at night and those treated with melatonin?</p>
<p>The reviewers raise an interesting question, specifically do melatonin treated larvae use similar behavioural motifs to larvae at night?</p>
<p>To address this question, we:</p>
<p>1. Calculated the mean enrichment/constraint for each motif across wild-type larvae during the night (a 1 x 46,554 vector)</p>
<p>2. Calculated the Euclidean distance between each wild-type sample (separately day and night) and this mean</p>
<p>3. Calculated the Euclidean distance between each melatonin sample (during the day) and this mean</p>
<p>The figure below shows these distances:</p>
<p>As expected, wild-type animals are further from the night mean during the day and closer during the night. Interestingly, with increasing melatonin dose motif usage shifts closer to the WT night mean, though remains distinguishable. This result suggests that melatonin induces night-like motif usage.</p>
<p>Note: we believe the difference between the wild-type day and melatonin control fish to be a result of the 0.2% DMSO applied to the melatonin control fish. As our melatonin is dissolved in DMSO, this is the most appropriate control for this experiment.</p>
<p>While we believe this finding to be of interest, we have decided not to include it in the manuscript, as we are not confident that this is the best way to compare motif usage similarity. In future, we hope to find a better approach which would allow us to compare motif similarity across larger datasets of drugs and mutants.</p>
<p>Is the change in compressibility due to melatonin dose driven by module distribution or module sequence?</p>
<p>We thank the reviewers for noting our omission of this result from the text. To rectify this, we have added the following line to the results section (line 582):</p>
<p>"We found that melatonin decreased day compressibility to night-time levels (Figure 3b), a difference primarily due to shifts in module distribution (Supplemental Figure 5e).”</p>
<p>As noted in response to a comment earlier we have also added a concise summary of our compressibility and Δ compressibility findings (line 593), which we hope clarifies our results.</p>
<p>L558 apostrophe typo</p>
<p>We thank the reviewers for noticing this error, which we have now corrected.</p>
<p>L604- This claim is critical and it needs context. Is it surprising that only a few motifs were needed to classify day vs. night? Certain modules (e.g. inactive module 5) are almost exclusively observed during the night. A comparison to classification based solely on inactive duration would be useful. How many pauses must be observed to classify day/night with the same confidence?</p>
<p>Though we were also impressed by this result, we believe that it is well contextualised in the paper.</p>
<p>To reiterate, we show that using motif enrichment/constraint we can distinguish day/night behaviour with only 0.2% error with 15 motifs. We contextualise this result by comparison to both a majority class classifier (50% error) and random 15-motif subsets (9.25% error).</p>
<p>Furthermore, we demonstrate that though a module-based classifier performs well (1.61% error), it is still inferior to a motif-based classifier; a generalisable finding across our datasets (Figure 5c).</p>
<p>Following the reviewers request for a “classification based solely on inactive duration” we additionally built a module classifier using only inactive module usage. This achieved a</p>
<p>2.42% classification error, poorer than either the overall (active and inactive) module-</p>
<p>based or motif classifiers.</p>
<p>As our original module-based classifier achieved its best performance using all 10 modules (5 active and 5 inactive) (Table 3), we have decided not to include the data from this purely inactive-module based model, which achieves worse classification and does therefore not add substantially to our manuscript.</p>
<p>L609 - To distinguish development from adaptation the authors must vary the day they introduce larvae to the plates.</p>
<p>The reviewers make a valid point. We have amended the text where appropriate. For example (line 650):</p>
<p>"Next, we examined how motif usage changed over time by comparing consecutive days and nights (5-6dpf).”</p>
<p>Figure 4D - Can the authors justify the definition of a “startle” pattern with literature or further explain their logic?</p>
<p>To address the reviewer’s comment we have added the following (line 662):</p>
<p>"We interpret these motifs as startle-like as they consist of long pauses interrupted by high- amplitude movements and primarily occur at the lighting transitions (Figure 4d), stimuli known to elicit startle behaviours in larval zebrafish (Burgess and Granato, 2007; Emran et al., 2010).”</p>
<p>L629 - Why would dose-specific motifs evidence low-affinity receptors? The attribution seems arbitrary. Perhaps this point would be better made in the Discussion when interpreting dose-specific data.</p>
<p>At the reviewer’s suggestion we have removed this from the text.</p>
<p>Figure 5A- Why is the best motif for a given dose of melatonin not always most prominent in that dose (e.g. 0.01uM motif is most enriched in control fish)?</p>
<p>While the reviewer is correct to note that motif usage (enrichment) is an important factor for distinguishing between doses, decreased motif usage (constraint) can be just as relevant. For example, the best 5mM PTZ motif (Figure 5b) is comparatively enriched at both 2.5 and 7.5 mM doses.</p>
<p>This specific case, however, is due to our approach for selecting the best motifs between test conditions which we have made clearer in the methods (line 404):</p>
<p>"For each comparison we defined the first motif chosen by mRMR as the best motif. To determine the best motifs among test conditions we excluded control data. For example, to determine the best 0.01μM melatonin motif, we compared this group’s data to all larvae dosed with melatonin at other doses (Figure 5a). For completeness, we still plot the control enrichment/constraint scores for these motifs.”</p>
<p>L644- What is a “behavioral seizure” and which motif corresponds to it?</p>
<p>We define the motifs shown in Figure 5b (control, 2.5 and 5mM best motifs) as behavioural seizures as they are constrained in control larvae (used less than in paired shuffled data) and enriched in PTZ dosed larvae.</p>
<p>Prior work in larval zebrafish has demonstrated that PTZ does induce “ictal and interictal- like electrographic discharges” as determined by extracellular recordings (Baraban et al.,</p>
<p>2005).</p>
<p>Here, however, we define these motifs as “behavioural seizures” as we don’t show any</p>
<p>evidence directly linking these motifs to epileptiform neuronal activity.</p>
<p>It is important to get a sense of how common these motifs are. Can the authors plot in</p>
<p>Fig. 3C a marginal showing the probability distribution of motifs across all data?</p>
<p>Following the reviewers request we have added a new supplementary panel (Supplementary Figure 5d), showing the probability distribution of motif usage as a function of motif length across all real data. For comparison, we have additionally plotted the results from our shuffled datasets.</p>
<p>Comparison of the real to shuffled data yielded an interesting finding, which we have now included in the manuscript (line 607):</p>
<p>"In the real data, longer motifs tended to be used more frequently than in the shuffled data (Supplementary Figure 5d), demonstrating the likely behavioural relevance of these sequences.”</p>
<p>L685- In this paragraph, can the authors speak to the steps to modify the existing protocol to account for higher-dimensional behavioral data?</p>
<p>As suggested, we have included a sentence to make this clearer (line 751):</p>
<p>"Once such high dimensional data had been assigned to modules, our compression and motif enrichment/constraint approach could be applied in the same manner as here.”</p>
<p>Fish can translate a large proportion of body length per frame at 25Hz (ignoring interactions with walls of a well). How many pixels does a larva span? The maximal possible delta pixel is important for interpreting bout data. Do some bouts reach this ceiling?</p>
<p>The largest delta pixel value we observe is 165. As shown by the distribution of active bout maximum values (Supplementary Figure 2a), values so high are extremely rare. Indeed only 1 value of 165 is recorded across our entire dataset of 30,900,018 active bouts.</p>
<p>As shown by the distribution of active bout mean values (Supplementary Figure 2a) most delta pixel changes are between 3 (minimum observed value) and 30.</p>
<p>To make this clearer we have included the following line in the methods (line 222):</p>
<p>"Following this step, the maximum Δ pixels value observed was 165. Most Δ pixels values</p>
<p>were between 3 (minimum observed value) and 30 (Supplementary Figure 2a).”</p>
<p>Would higher frame rates be prescribed for future applications?</p>
<p>As mentioned in the discussion, more detailed behavioural measures would likely yield additional insights (line 743).</p>
<p>However, an alternative approach (line 776), would be to generate a mapping between our high-throughput and other higher-resolution assays (for example Marques et al.,</p>
<p>2018). Thus, allowing users to use “data from our set-up to prioritise pharmacological</p>
<p>compounds or mutants for postural analysis”.</p>
</sec>
</back>
</article>
</pmc-articleset>