<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">

<pmc-articleset><article article-type="research-article" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<?properties open_access?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
<journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
<journal-title-group>
<journal-title>BMC Bioinformatics</journal-title>
</journal-title-group>
<issn pub-type="epub">1471-2105</issn>
<publisher>
<publisher-name>BioMed Central</publisher-name>
<publisher-loc>London</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="pmid">30885122</article-id>
<article-id pub-id-type="pmc">6423849</article-id>
<article-id pub-id-type="publisher-id">2707</article-id>
<article-id pub-id-type="doi">10.1186/s12859-019-2707-7</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Methodology Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Replicability analysis in genome-wide association studies via Cartesian hidden Markov models</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Pengfei</given-names>
</name>
<xref ref-type="aff" rid="Aff1"></xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Zhu</surname>
<given-names>Wensheng</given-names>
</name>
<address>
<email>wszhu@nenu.edu.cn</email>
</address>
<xref ref-type="aff" rid="Aff1"></xref>
</contrib>
<aff id="Aff1"><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1789 9163</institution-id><institution-id institution-id-type="GRID">grid.27446.33</institution-id><institution>Key Laboratory for Applied Statistics of MOE, School of Mathematics and Statistics, Northeast Normal University, </institution></institution-wrap>5268 Renmin Street, Changchun, 130024 China </aff>
</contrib-group>
<pub-date pub-type="epub">
<day>18</day>
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="pmc-release">
<day>18</day>
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<year>2019</year>
</pub-date>
<volume>20</volume>
<elocation-id>146</elocation-id>
<history>
<date date-type="received">
<day>2</day>
<month>2</month>
<year>2019</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>2</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-statement>© The Author(s) 2019</copyright-statement>
<license license-type="OpenAccess">
<license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
</license>
</permissions>
<abstract id="Abs1">
<sec>
<title>Background</title>
<p>Replicability analysis which aims to detect replicated signals attracts more and more attentions in modern scientific applications. For example, in genome-wide association studies (GWAS), it would be of convincing to detect an association which can be replicated in more than one study. Since the neighboring single nucleotide polymorphisms (SNPs) often exhibit high correlation, it is desirable to exploit the dependency information among adjacent SNPs properly in replicability analysis. In this paper, we propose a novel multiple testing procedure based on the Cartesian hidden Markov model (CHMM), called repLIS procedure, for replicability analysis across two studies, which can characterize the local dependence structure among adjacent SNPs via a four-state Markov chain.</p>
</sec>
<sec>
<title>Results</title>
<p>Theoretical results show that the repLIS procedure can control the false discovery rate (FDR) at the nominal level <italic>α</italic> and is shown to be optimal in the sense that it has the smallest false non-discovery rate (FNR) among all <italic>α</italic>-level multiple testing procedures. We carry out simulation studies to compare our repLIS procedure with the existing methods, including the Benjamini-Hochberg (BH) procedure and the empirical Bayes approach, called repfdr. Finally, we apply our repLIS procedure and repfdr procedure in the replicability analyses of psychiatric disorders data sets collected by Psychiatric Genomics Consortium (PGC) and Wellcome Trust Case Control Consortium (WTCCC). Both the simulation studies and real data analysis show that the repLIS procedure is valid and achieves a higher efficiency compared with its competitors.</p>
</sec>
<sec>
<title>Conclusions</title>
<p>In replicability analysis, our repLIS procedure controls the FDR at the pre-specified level <italic>α</italic> and can achieve more efficiency by exploiting the dependency information among adjacent SNPs.</p>
</sec>
<sec>
<title>Electronic supplementary material</title>
<p>The online version of this article (10.1186/s12859-019-2707-7) contains supplementary material, which is available to authorized users.</p>
</sec>
</abstract>
<kwd-group xml:lang="en">
<title>Keywords</title>
<kwd>GWAS</kwd>
<kwd>Cartesian hidden Markov model</kwd>
<kwd>Replicability analysis</kwd>
</kwd-group>
<funding-group>
<award-group>
<funding-source>
<institution>National Natural Science Foundation of China (CN)</institution>
</funding-source>
<award-id>11771072</award-id>
</award-group>
</funding-group>
<funding-group>
<award-group>
<funding-source>
<institution-wrap>
<institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
<institution>National Natural Science Foundation of China</institution>
</institution-wrap>
</funding-source>
<award-id>11371083</award-id>
</award-group>
</funding-group>
<custom-meta-group>
<custom-meta>
<meta-name>issue-copyright-statement</meta-name>
<meta-value>© The Author(s) 2019</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="Sec1">
<title>Background</title>
<p>Since the first publication of genome-wide association studies (GWAS) on age-related macular degeneration in 2005 [<xref ref-type="bibr" rid="CR1">1</xref>], great progress has been made in the genetic studies of the human complex diseases. As of September 1st, 2016, more than 24,000 SNPs have been identified to be associated with complex diseases or traits [<xref ref-type="bibr" rid="CR2">2</xref>]. It also has been shown that different diseases or traits usually share the similar genetic mechanisms and are even affected by some of the same genetic variants [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. This phenomenon is known as “pleiotropy". It is desirable to make an integrative analysis of several GWAS studies to improve the power by leveraging the pleiotropy information.</p>
<p>Meta-analysis is one of the approaches that combines of multiple scientific studies and has been widely used in biomedical research. In GWAS, however, the results obtained from meta-analysis are often in contradiction with those in single studies. For example, Voight et al. [<xref ref-type="bibr" rid="CR5">5</xref>] reported that some of the type 2 diabetes (T2D) related SNPs detected by meta-analysis were not discovered in single studies. It is more convincing if the result can be replicated in at least one study [<xref ref-type="bibr" rid="CR6">6</xref>]. To this end, replicability analysis was suggested to detect signals that are discovered in more than one study for GWAS [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. Instead of examining the association in each single study separately, replicability analysis combines results across different studies and can usually gain additional power in genetic association studies. Moreover, it has been reported that the population stratification may affect the GWAS identifications and lead to a subtle bias [<xref ref-type="bibr" rid="CR9">9</xref>]. We also hope that some of the identified SNPs in the study of one population can be replicated for the studies of other populations. Fortunately, replicability analysis of multiple GWAS from different populations can avoid this kind of bias in some extent.</p>
<p>So far, only a handful of methods have been proposed for replicability analysis. Benjamini et al. [<xref ref-type="bibr" rid="CR10">10</xref>] utilized the maximum <italic>p</italic>-value of two studies as the joint <italic>p</italic>-value for each test and then carried out the Benjamini-Hochberg procedure [<xref ref-type="bibr" rid="CR11">11</xref>] to detect replicated signals across two studies. Bogomolov and Heller [<xref ref-type="bibr" rid="CR12">12</xref>] focused on replicability analysis for two studies, and proposed an alternative FDR controlling procedure based on <italic>p</italic>-values. In 2014, a statistical approach, named GPA, was proposed by [<xref ref-type="bibr" rid="CR13">13</xref>], which can extract replicated associations through joint analysis of multiple GWAS data sets and annotation information. Heller and Yekutieli [<xref ref-type="bibr" rid="CR14">14</xref>] extended the two-group model [<xref ref-type="bibr" rid="CR15">15</xref>] and suggested a generalized empirical Bayes approach, called repfdr, for discovering replicated signals in GWAS. Heller et al. [<xref ref-type="bibr" rid="CR16">16</xref>] also presented the R package repfdr that provides a flexible and efficient implementation of the method in Heller and Yekutieli [<xref ref-type="bibr" rid="CR14">14</xref>]. In fact, replicability analysis is a multiple testing problem which involves testing hundreds of null hypotheses that correspond to SNPs without replicated associations. The traditional multiple testing procedures for replicability analysis essentially involve two steps: ranking the hypotheses based on appropriate multiple testing statistics (such as <italic>p</italic>-values) and then choosing a suitable cutoff along with the rankings to ensure the FDR is controlled at the pre-specified level.</p>
<p>It should be pointed out that all these existing approaches assume that the multiple testing statistics (such as <italic>p</italic>-values) are independent in each study, which is obviously unreasonable in practice. For example, in GWAS, since the adjacent genomic loci tend to co-segregate in meiosis, the disease-associated SNPs are always clustered and locally dependent. Wei and Li [<xref ref-type="bibr" rid="CR17">17</xref>] pointed out that the efficiency of analysis of large-scale genomic data can be evidently enhanced by exploiting genomic dependency information properly. It also has been shown that ignoring the dependence among the multiple testing statistics will decrease the statistical accuracy and testing efficiency in multiple testing [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR20">20</xref>]. Hence a reasonable multiple testing statistic for a given SNP should depend on data from neighboring SNPs in replicability analysis and it is worthy of developing a multiple testing procedure that can take into account the dependency information among adjacent SNPs for each study in replicability analysis.</p>
<p>Recently, the hidden Markov model (HMM) has been successfully applied to large-scale multiple testing under dependence [<xref ref-type="bibr" rid="CR20">20</xref>]. Since the Markov chain is an effective tool for modelling the clustered and locally dependent structure, it has been successfully applid in GWAS [<xref ref-type="bibr" rid="CR21">21</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. Inspired by their works, we utilize the Cartesian hidden Markov model (CHMM) to characterize the dependence among adjacent SNPs for each study in replicability analysis. Based on CHMM, we develop a novel multiple testing procedure which is referred to as replicated local index of significance (repLIS) for replicability analysis across two studies. The statistics involved in repLIS can be calculated highly effectively by using the forward-backward algorithm. Simulation studies show that our repLIS procedure can control the FDR at the nominal level and enjoys a higher efficiency compared with its competitors. We also successfully apply our repLIS procedure in replicability analyses of psychiatric disorders data sets collected by Psychiatric Genomics Consortium (PGC) and Wellcome Trust Case Control Consortium (WTCCC).</p>
</sec>
<sec id="Sec2" sec-type="results">
<title>Results</title>
<sec id="Sec3">
<title>Application of detecting the pleiotropy effect</title>
<p>So far, accumulating evidence suggests that many different diseases or traits share the similar genetic architectures and are usually affected by some of the same genetic variants [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>]. This phenomenon is referred to as “pleiotropy". It is meaningful to jointly analyze several GWAS data sets to detect the SNPs with pleiotropy information. The cross-disorder group of Psychiatric Genomics Consortium (PGC) is aim to investigate the genetic associations between five psychiatric disorders, including attention deficit-hyperactivity disorder (ADHD), autism spectrum disorder (ASD), bipolar disorder (BD), major depressive disorder (MDD), and schizophrenia (SCZ) [<xref ref-type="bibr" rid="CR24">24</xref>, <xref ref-type="bibr" rid="CR25">25</xref>]. It has been shown that there exists the pleiotropy effect between BD and SCZ [<xref ref-type="bibr" rid="CR13">13</xref>, <xref ref-type="bibr" rid="CR26">26</xref>]. We apply our proposed repLIS procedure to detect the SNPs with pleiotropy effect between BD and SCZ in the data sets collected by the PGC. The <italic>p</italic>-values are available for 2,427,220 SNPs in BD and 1,252,901 SNPs in SCZ, in which 1,064,235 SNPs are used both in BD and SCZ. In this study, we aim to detect the SNPs with pleiotropy effect between BD and SCZ.</p>
<p>Since both repfdr and our repLIS procedure are based on <italic>z</italic>-values, we first calculate the <italic>z</italic>-values transformed by the corresponding <italic>p</italic>-values. In order to avoid the situation that the <italic>z</italic>-value is infinity, we set the <italic>p</italic>-values to be 0.99 if they are recorded to be 1 in the data sets. We compare the results given by repfdr and repLIS for detecting the SNPs with pleiotropy effect. Wei et al. [<xref ref-type="bibr" rid="CR21">21</xref>] suggested that combining the testing results from several chromosomes is more efficient. Hence we apply the repLIS procedure to calculate the repLIS statistics on each chromosome separately, while the ranking of repLIS statistics is based on all the chromosomes of interest. The Manhattan plots are shown in Fig. <xref ref-type="fig" rid="Fig1">1</xref>, and the horizontal line for each panel is drawn such that there are 100 SNPs with the values of <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$-\log _{10}\left (\widehat {repLIS}\right)$\end{document}</tex-math><mml:math id="M2"><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">repLIS</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq1.gif"></inline-graphic></alternatives></inline-formula> or <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$-\log _{10}\left (\widehat {repfdr}\right)$\end{document}</tex-math><mml:math id="M4"><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">repfdr</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq2.gif"></inline-graphic></alternatives></inline-formula> above the line. In Fig. <xref ref-type="fig" rid="Fig1">1</xref>, we can see from panel (b) that the SNPs above the horizontal line concentrate on chromosome 3 and chromosome 10. This indicates that the SNPs identified by repfdr procedure with strong pleiotropy effect are located on chromosomes 3 and 10. Indeed, most of the Top 100 SNPs discovered by repfdr are clustered in the genes IHIH1, IHIH3, GNL3, PBRM1, NEK4, GLT8D1 (on chromosome 3) and ANK3 (on chromosome 10). In addition to these genes identified by repfdr procedure, our repLIS procedure further discoverd genes SYNE1 on chromosome 6 and TENM4 on chromosome 11 with strong pleiotropy effect between BD and SCZ. The findings here support several genetic associations to genes for BD and/or SCZ. For instance, the gene SYNE1 provides instructions for making a protein called Syne-1 which is especially critical in the brain and plays a role in the maintenance of the part of the brain that coordinates movement. It has been shown that SYNE1 is one of the implicated genes in the etiology of BD [<xref ref-type="bibr" rid="CR25">25</xref>]. Another gene TENM4 (also named ODZ4) has been identified to be co-expressed with miR-708. It has been reported that a single variant located near the miR-708 may have a role in susceptibility to BD and SCZ [<xref ref-type="bibr" rid="CR27">27</xref>].
<fig id="Fig1"><label>Fig. 1</label><caption><p>The Manhattan plots for repLIS procedure and repfdr procedure. The horizontal line for each panel is drawn such that there are 100 SNPs with the values of <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$-\log _{10}\left (\widehat {repLIS}\right)$\end{document}</tex-math><mml:math id="M6"><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">repLIS</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq3.gif"></inline-graphic></alternatives></inline-formula> or <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$-\log _{10}\left (\widehat {repfdr}\right)$\end{document}</tex-math><mml:math id="M8"><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mo>log</mml:mo></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:munder><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mover accent="false"><mml:mrow><mml:mtext mathvariant="italic">repfdr</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq4.gif"></inline-graphic></alternatives></inline-formula> above the line. <bold>a</bold> The SNPs above the horizontal line concentrate on chromosome 3, 6, 10 and 11 in the Manhattan plots for repLIS procedure. <bold>b</bold> The SNPs above the horizontal line concentrate on chromosome 3 and 10 in the Manhattan plots for repfdr procedure</p></caption><graphic id="MO1" xlink:href="12859_2019_2707_Fig1_HTML"></graphic></fig>
</p>
</sec>
<sec id="Sec4">
<title>Application of discovering the replicated association</title>
<p>Bipolar disorder (BD) is a manic depressive illness that causes periods of depression and periods of elevated mood. In this section, we further apply our repLIS procedure to the replicability analysis of BD data sets from PGC and Wellcome Trust Case Control Consortium (WTCCC). The data sets collected by WTCCC contain 1998 cases and 3004 controls, among which there are 1504 control samples from the 1958 Birth Cohort (58C) and the other control samples from UK Blood Service (UKBS).</p>
<p>We first conduct a series of procedures for quality control on WTCCC data sets. We eliminate 130 samples from the BD cohort, 24 samples from the 58C cohort and 42 samples from the UKBS cohort owing to the high missing rate, overall heterozygosity, and non-European ancestry. In addition, we remove the SNPs in accordance with the exclusion list provided by WTCCC and exclude the SNPs with minor allele frequency less than 0.05. We fit the logistic regression model for each SNP and obtain the <italic>p</italic>-value of testing for the association between the SNP and the disease of interest. Taking the intersection of SNPs in PGC and WTCCC yields to 361,665 SNPs that are available for replicability analysis.</p>
<p>Since it is unfeasible to validate the true FDR level in real data analysis, we choose an alternative measure, the efficiency of ranking replicated signals, for comparisons. Consortium et al. [<xref ref-type="bibr" rid="CR28">28</xref>] have identified fourteen BD-susceptibility SNPs that are showing strong or moderate evidence of associations with BD, among which eleven SNPs are simultaneously identified by [<xref ref-type="bibr" rid="CR29">29</xref>]. We focused on these fourteen SNPs and treated them as relevant SNPs. The performance of replicability analysis procedure is assessed by the ranks of these fourteen relevant SNPs as well as the number of relevant SNPs that are selected by top <italic>k</italic> significant SNPs. Table <xref ref-type="table" rid="Tab1">1</xref> presents the results of repLIS and repfdr in identifying the relevant SNPs when top <italic>k</italic>=500. repLIS identifies eight of the fourteen relevant SNPs, whereas repfdr only identifies five of those SNPs. Four relevant SNPs (rs7570682; rs1375144; rs2953145; rs10982256) are identified by repLIS only, whereas one SNP (rs3761218) is identified by repfdr only. We can observe that there is a significant improvement of rankings for most of these SNPs with replicated associations when conducting repLIS procedure. For instance, rs420259 that is reported to have a strong association with BD [<xref ref-type="bibr" rid="CR28">28</xref>] ranks 255th by repfdr procedure and 115th by repLIS procedure.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Results of repfdr and repLIS procedure when top <italic>k</italic>=500</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">SNP ID</th><th align="left">Chr</th><th align="left">repfdr ranks</th><th align="left">repLIS ranks</th><th align="left">repfdr values</th><th align="left">repLIS values</th></tr></thead><tbody><tr><td align="left">rs7570682</td><td align="left">2</td><td align="left">−</td><td align="left">
<bold>35</bold>
</td><td align="left">1</td><td align="left">3.7e-2</td></tr><tr><td align="left">rs1375144</td><td align="left">2</td><td align="left">−</td><td align="left">
<bold>24</bold>
</td><td align="left">1</td><td align="left">3.1e-2</td></tr><tr><td align="left">rs2953145</td><td align="left">2</td><td align="left">−</td><td align="left">
<bold>25</bold>
</td><td align="left">1</td><td align="left">3.2e-2</td></tr><tr><td align="left">rs4276227<sup><italic>s</italic></sup></td><td align="left">3</td><td align="left">105</td><td align="left">
<bold>64</bold>
</td><td align="left">6.4e-3</td><td align="left">4.5e-2</td></tr><tr><td align="left">rs683395<sup><italic>s</italic></sup></td><td align="left">3</td><td align="left">99</td><td align="left">
<bold>51</bold>
</td><td align="left">6.1e-3</td><td align="left">4.3e-2</td></tr><tr><td align="left">rs10982256</td><td align="left">9</td><td align="left">−</td><td align="left">
<bold>305</bold>
</td><td align="left">1</td><td align="left">7.9e-2</td></tr><tr><td align="left">rs1344484</td><td align="left">16</td><td align="left">49</td><td align="left">
<bold>15</bold>
</td><td align="left">1.9e-3</td><td align="left">2.3e-2</td></tr><tr><td align="left">rs420259</td><td align="left">16</td><td align="left">255</td><td align="left">
<bold>115</bold>
</td><td align="left">1.5e-2</td><td align="left">5.4e-2</td></tr><tr><td align="left">rs3761218</td><td align="left">20</td><td align="left">233</td><td align="left">−</td><td align="left">1.4e-2</td><td align="left">9.9e-1</td></tr></tbody></table><table-wrap-foot><p><sup><italic>s</italic></sup> The SNPs that are only identified by [<xref ref-type="bibr" rid="CR28">28</xref>] and others are simultaneously identified by [<xref ref-type="bibr" rid="CR29">29</xref>]. ’ −’ denotes a relevant SNP non-identified by the corresponding procedure. There is a significant improvement of rankings for most of these SNPs with replicated associations when conducting repLIS procedure</p></table-wrap-foot></table-wrap>
</p>
<p>To further illustrate the superiority of repLIS is achieved by leveraging information from adjacent SNPs via a Markov chain, we focused on the adjacent SNPs of rs420259, and selected the five adjacent SNPs on each side of rs420259 as relevant SNPs. We plotted the sensitivity curve in Fig. <xref ref-type="fig" rid="Fig2">2</xref> as described in Simulation II, and obtained very similar results.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The sensitivity curves yielded by repLIS and repfdr in real data analysis. The results are almost coincide with those in Simulation II</p></caption><graphic id="MO2" xlink:href="12859_2019_2707_Fig2_HTML"></graphic></fig>
</p>
</sec>
</sec>
<sec id="Sec5" sec-type="discussion">
<title>Discussion</title>
<p>In this paper, we propose a novel multiple testing procedure, called repLIS procedure, for replicability analysis across two studies. The repLIS procedure can characterize the local dependence structure among adjacent SNPs via a four-state Markov chain. Based on the CHMM, the multiple testing statistics (repLIS statistics) can be calculated efficiently by using the forward-backward algorithm. When the parameters of CHMM are known, the theoretical results showed that our repLIS procedure is valid and optimal in the sense that repLIS procedure can control the FDR at the pre-specified level <italic>α</italic> and has the smallest FNR among all <italic>α</italic>-level multiple testing procedures. In reality, the parameters of CHMM are usually unknown and hence we further provided the detailed EM algorithm to estimate the parameters of CHMM.</p>
<p>Both the simulation studies and real data analysis exhibit that the repLIS procedure is valid and more efficient by employing the dependency information among adjacent SNPs. Some of the SNPs identified by repLIS have been verified by other researchers. For example, a large number of literatures confirm that rs420259 is really relevant to BD [<xref ref-type="bibr" rid="CR29">29</xref>–<xref ref-type="bibr" rid="CR31">31</xref>]. However, some of the other SNPs identified by repLIS have not been verified in previous research (e.g., rs206731), and further experiments need to be conducted to verify the research findings.</p>
<p>The repLIS procedure is implemented by using the R code. We give a brief description of the source code in Additional file <xref ref-type="media" rid="MOESM1">1</xref>, and all core code of repLIS procedure are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/wpf19890429/large-scale-multiple-testing-via-CHMM">https://github.com/wpf19890429/large-scale-multiple-testing-via-CHMM</ext-link>).</p>
</sec>
<sec id="Sec6" sec-type="conclusion">
<title>Conclusions</title>
<p>Our repLIS procedure can also be extended in several ways. First, it might be a strong assumption that the transition probability (1) is invariant across the whole two studies. It would be of interest to generalize our repLIS from a homogeneous Markov chain to a nonhomogeneous Markov chain or even a Markov random field. Second, the EM algorithm for estimating the parameters of CHMM is a heuristic algorithm and may lead to a local optimum in some situations. The Markov Chain Monte Carlo (MCMC) algorithm which are not relying on the starting point may give rise to a bright way for estimating these parameters. Finally, although this paper considered the repLIS procedure for replicability analysis across two studies, extensions to more than two studies are straightforward by utilizing a multi-dimensional Markov chain to describe the local dependence structure. However, a new issue will arise in multiple testing, since the computation is intractable when the dimension is high. It is desirable to develop a procedure that can handle replicability analysis with a multitude of studies.</p>
</sec>
<sec id="Sec7">
<title>Methods</title>
<sec id="Sec8">
<title>Replicability analysis in the framework of multiple testing</title>
<p>In order to express the problem explicitly, we first make a brief description of the framework for replicability analysis across two studies in GWAS. Suppose there are <italic>m</italic> SNPs to be investigated in each study. For the <italic>i</italic>th study (<italic>i</italic>=1,2), let <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{H_{i,j}\right \}^{m}_{j=1}$\end{document}</tex-math><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq5.gif"></inline-graphic></alternatives></inline-formula> be the underlying states of the hypotheses, where <italic>H</italic><sub><italic>i</italic>,<italic>j</italic></sub>=1 indicates that the <italic>j</italic>th SNP is associated with the phenotype of interest and <italic>H</italic><sub><italic>i</italic>,<italic>j</italic></sub>=0 otherwise. For the <italic>j</italic>th SNP, we are interested in examining the following null hypothesis 
<disp-formula id="Equa"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\mathcal{H}^{0j}_{NR}: \left(H_{1,j},H_{2,j}\right)\in \left\{(0,0),(1,0),(0,1) \right\}, $$ \end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equa.gif"></graphic></alternatives></disp-formula> and we call <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}^{0j}_{NR}$\end{document}</tex-math><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq6.gif"></inline-graphic></alternatives></inline-formula> the no replicability null hypothesis showing that the SNP is associated with the phenotype in at most one study. The goal of the replicability analysis in GWAS is to discover as many SNPs that are associated with phenotype in both studies as possible [<xref ref-type="bibr" rid="CR14">14</xref>]. In this paper, we handle this problem in the framework of multiple testing under dependence since the disease-associated SNPs are always clustered and dependent. Specifically, we aim to develop a multiple testing procedure that can discover the SNPs with replicated associations (i.e. (<italic>H</italic><sub>1,<italic>j</italic></sub>,<italic>H</italic><sub>2,<italic>j</italic></sub>)=(1,1)) as many as possible, while the FDR is controlled at the pre-specified level. To this end, we define the FDR as follows: 
<disp-formula id="Equb"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{FDR}=E\left[\frac{\sum^{m}_{j=1}I_{\left(\left(H_{1,j},H_{2,j}\right)\in \{(0,0),(1,0),(0,1)\}\right)}\delta_{j}}{\sum^{m}_{j=1}\delta_{j}}\right], $$ \end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mtext>FDR</mml:mtext><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mfrac><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equb.gif"></graphic></alternatives></disp-formula> where <italic>δ</italic><sub><italic>j</italic></sub>=1 indicates that the <italic>j</italic>th SNP is claimed to be associated with the phenotype in both studies and <italic>δ</italic><sub><italic>j</italic></sub>=0 otherwise. Correspondingly, the marginal false discovery rate (mFDR) is defined as: 
<disp-formula id="Equc"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{mFDR}=\frac{E\left[\sum^{m}_{j=1}I_{\left(\left(H_{1,j},H_{2,j}\right)\in \{(0,0),(1,0),(0,1)\}\right)}\delta_{j}\right]}{E\left[\sum^{m}_{j=1}\delta_{j}\right]}. $$ \end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mtext>mFDR</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equc.gif"></graphic></alternatives></disp-formula></p>
<p>Since the mFDR is asymptotically equivalent to the FDR in the sense that <inline-formula id="IEq7"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {mFDR}=\text {FDR}+O\left (1/\sqrt {m}\right)$\end{document}</tex-math><mml:math id="M20"><mml:mtext>mFDR</mml:mtext><mml:mo>=</mml:mo><mml:mtext>FDR</mml:mtext><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq7.gif"></inline-graphic></alternatives></inline-formula> under some mild conditions [<xref ref-type="bibr" rid="CR32">32</xref>], hereafter, we mainly focus on developing a multiple testing procedure that can control the mFDR at the pre-specified level for replicability analysis.</p>
</sec>
<sec id="Sec9">
<title>The Cartesian hidden Markov model</title>
<p>Let <italic>z</italic><sub><italic>i</italic>,<italic>j</italic></sub> be the observed <italic>z</italic>-value of the <italic>j</italic>th SNP in the <italic>i</italic>th association study, which can be obtained by using appropriate transformation. Specifically, <italic>z</italic><sub><italic>i</italic>,<italic>j</italic></sub> can be transformed from <italic>Φ</italic><sup>−1</sup>(1−<italic>p</italic><sub><italic>i</italic>,<italic>j</italic></sub>), where <italic>Φ</italic><sup>−1</sup> is the inverse of the standard normal distribution and <italic>p</italic><sub><italic>i</italic>,<italic>j</italic></sub> is the <italic>p</italic>-value of the <italic>j</italic>th SNP in the <italic>i</italic>th association study, for <italic>i</italic>=1,2, and <italic>j</italic>=1,…,<italic>m</italic>.</p>
<p>The Markov chain, which is an effective tool for modelling the clustered and locally dependent structure among disease-assocaited SNPs, has been widely used in the literatures [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. We assume that <inline-formula id="IEq8"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{\left (H_{1,j},H_{2,j}\right)\right \}^{m}_{j=1}$\end{document}</tex-math><mml:math id="M22"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq8.gif"></inline-graphic></alternatives></inline-formula> is a four-state stationary, irreducible and aperiodic Markov chain with the transition probability 
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ A_{uv}=P\left(\left(H_{1,j+1},H_{2,j+1}\right)=v|\left(H_{1,j},H_{2,j}\right)=u \right),  $$ \end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">uv</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>|</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equ1.gif"></graphic></alternatives></disp-formula></p>
<p>where <italic>u</italic>,<italic>v</italic>∈{(0,0),(1,0),(0,1),(1,1)}. We further assume that the observed <italic>z</italic>-values <inline-formula id="IEq9"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{\left (z_{1,j},z_{2,j}\right)\right \}^{m}_{j=1}$\end{document}</tex-math><mml:math id="M26"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq9.gif"></inline-graphic></alternatives></inline-formula> are conditionally independent given the hypotheses states <inline-formula id="IEq10"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{\left (H_{1,j},H_{2,j}\right)\right \}^{m}_{j=1}$\end{document}</tex-math><mml:math id="M28"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq10.gif"></inline-graphic></alternatives></inline-formula>, namely, 
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {{\begin{aligned} P\left(\left\{\left(z_{1,j},z_{2,j}\right)\right\}^{m}_{j=1} | \left\{\left(H_{1,j},H_{2,j}\right)\right\}^{m}_{j=1} \right) =\prod\limits^{m}_{j=1}P\left(z_{1,j}|H_{1,j}\right)\prod\limits^{m}_{j=1}P\left(z_{2,j}|H_{2,j}\right). \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M30"><mml:mspace width="-17.0pt"></mml:mspace><mml:mtable><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equ2.gif"></graphic></alternatives></disp-formula></p>
<p>The Markov chain <inline-formula id="IEq11"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{\left (H_{1,j},H_{2,j}\right)\right \}^{m}_{j=1}$\end{document}</tex-math><mml:math id="M32"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq11.gif"></inline-graphic></alternatives></inline-formula> with the dependence model (<xref ref-type="" rid="Equ2">2</xref>) is called Cartesian hidden Markov model (CHMM) [<xref ref-type="bibr" rid="CR33">33</xref>]. The structure of the CHMM can be intuitively understood with a graphical model as follows in Fig. <xref ref-type="fig" rid="Fig3">3</xref>.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Graphical representation of the CHMM</p></caption><graphic id="MO3" xlink:href="12859_2019_2707_Fig3_HTML"></graphic></fig>
</p>
<p>Following [<xref ref-type="bibr" rid="CR20">20</xref>–<xref ref-type="bibr" rid="CR22">22</xref>], we suppose that the corresponding random variable <italic>Z</italic><sub><italic>i</italic>,<italic>j</italic></sub> follows the two-component mixture model: 
<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ Z_{i,j}|H_{i,j}\sim \left(1-H_{i,j}\right)f_{i0}+H_{i,j}f_{i1},  $$ \end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equ3.gif"></graphic></alternatives></disp-formula></p>
<p>where <italic>f</italic><sub><italic>i</italic>0</sub> and <italic>f</italic><sub><italic>i</italic>1</sub> are the conditional probability densities of <italic>Z</italic><sub><italic>i</italic>,<italic>j</italic></sub> given <italic>H</italic><sub><italic>i</italic>,<italic>j</italic></sub>=0 and <italic>H</italic><sub><italic>i</italic>,<italic>j</italic></sub>=1, respectively. In practice, we usually assume that <italic>f</italic><sub>10</sub> and <italic>f</italic><sub>20</sub> are the densities of the standard normal distribution <italic>N</italic>(0,1), and <italic>f</italic><sub>11</sub> and <italic>f</italic><sub>21</sub> are the densities of the normal distributions <inline-formula id="IEq12"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N\left (\mu _{1},\sigma ^{2}_{1}\right)$\end{document}</tex-math><mml:math id="M36"><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq12.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$N\left (\mu _{2},\sigma ^{2}_{2}\right)$\end{document}</tex-math><mml:math id="M38"><mml:mi>N</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq13.gif"></inline-graphic></alternatives></inline-formula>, respectively.</p>
<p>Let <italic>π</italic>=(<italic>π</italic><sub>00</sub>,<italic>π</italic><sub>10</sub>,<italic>π</italic><sub>01</sub>,<italic>π</italic><sub>11</sub>) be the initial distribution of the four-state Markov chain, where <italic>π</italic><sub><italic>st</italic></sub>=<italic>P</italic>((<italic>H</italic><sub>1,1</sub>,<italic>H</italic><sub>2,1</sub>)=(<italic>s</italic>,<italic>t</italic>)), for <italic>s</italic>,<italic>t</italic>=0,1. For convenience, let <inline-formula id="IEq14"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vartheta =(\pi,\mathcal {A},\mathcal {F})$\end{document}</tex-math><mml:math id="M40"><mml:mi>𝜗</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>π</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">F</mml:mi><mml:mo>)</mml:mo></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq14.gif"></inline-graphic></alternatives></inline-formula> denote the parameters of the CHMM, where <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {A}=\left \{A_{uv}\right \}_{4\times 4}$\end{document}</tex-math><mml:math id="M42"><mml:mi mathvariant="script">A</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">uv</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq15.gif"></inline-graphic></alternatives></inline-formula> with <italic>u</italic>,<italic>v</italic>∈{(0,0),(1,0),(0,1),(1,1)} and <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {F}=\left (f_{10},f_{11},f_{20},f_{21}\right)$\end{document}</tex-math><mml:math id="M44"><mml:mi mathvariant="script">F</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>11</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>21</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq16.gif"></inline-graphic></alternatives></inline-formula>.</p>
</sec>
<sec id="Sec10">
<title>The repLIS procedure for replicability analysis</title>
<p>In this section, we develop the multiple testing procedure for replicability analysis by studying the connection between the multiple testing and weighted classification problems. Consider the loss function of the weighted classification problem with respect to replicability analysis as 
<disp-formula id="Equd"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {\begin{aligned} L_{\lambda} \left(\left\{H_{1,j}\right\}^{m}_{j=1},\left\{H_{2,j}\right\}^{m}_{j=1},\left\{\delta_{j}\right\}^{m}_{j=1} \right) &amp; =\frac{1}{m}\sum\limits^{m}_{j=1}\left\{\lambda\left[\left(1-H_{1,j}\right)\left(1-H_{2,j}\right)\right.\right.\\ &amp; \quad\left.+ H_{1,j}\left(1-H_{2,j}\right)+\left(1-H_{1,j}\right)H_{2,j}\right]\delta_{j} \\ &amp;\quad+ \left. H_{1,j}H_{2,j}(1-\delta_{j})\right\}, \end{aligned}} $$ \end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mspace width="-17.0pt"></mml:mspace><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>λ</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mfenced close="" open="{" separators=""><mml:mrow><mml:mi>λ</mml:mi><mml:mfenced close="" open="[" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"></mml:mspace><mml:mfenced close="]" open="" separators=""><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1em"></mml:mspace><mml:mo>+</mml:mo><mml:mfenced close="}" open="" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equd.gif"></graphic></alternatives></disp-formula> where <italic>λ</italic> is the relative cost of false positive to false negative, and <italic>δ</italic><sub><italic>j</italic></sub> was defined in the above section and we call (<italic>δ</italic><sub>1</sub>,…,<italic>δ</italic><sub><italic>m</italic></sub>)∈{0,1}<sup><italic>m</italic></sup> the classification rule for replicability analysis here. By some simple derivations, the optimal classification rule, which minimizes the expectation of the loss function, is obtained as 
<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ \delta_{j}\left(\Lambda_{j},1/\lambda\right)=I_{\left(\Lambda_{j}&lt;1/\lambda\right)}, ~~ \text{for} ~ j=1, \dots, m  $$ \end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"></mml:mspace><mml:mspace width="1em"></mml:mspace><mml:mtext>for</mml:mtext><mml:mspace width="1em"></mml:mspace><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equ4.gif"></graphic></alternatives></disp-formula></p>
<p>where 
<disp-formula id="Eque"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\Lambda_{j}=\frac{P\left(\mathcal{H}^{0j}_{NR} \text{~is ~true~} \big |\{z_{1,i}\}^{m}_{i=1},\{z_{2,i}\}^{m}_{i=1} \right)}{1-P\left(\mathcal{H}^{0j}_{NR} \text{~is ~true~} \big | \{z_{1,i}\}^{m}_{i=1},\{z_{2,i}\}^{m}_{i=1} \right)} $$ \end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:msub><mml:mrow><mml:mi>Λ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mtext>is true</mml:mtext><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open="|" separators=""><mml:mrow></mml:mrow></mml:mfenced></mml:mstyle><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mtext>is true</mml:mtext><mml:mstyle mathsize="1.19em"><mml:mfenced close="" open="|" separators=""><mml:mrow></mml:mrow></mml:mfenced></mml:mstyle><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Eque.gif"></graphic></alternatives></disp-formula> is called the optimal classification statistic in the weighted classification problem, and <italic>I</italic><sub>(·)</sub> is an indicator function.</p>
<p>Following the work of [<xref ref-type="bibr" rid="CR34">34</xref>], it is not difficult to show that the optimal classification statistic is also optimal for replicability analysis in the sense that the multiple testing procedure based on the optimal classification statistics with a suitable cutoff can control the mFDR at the pre-specified level <italic>α</italic> and has the smallest mFNR among all <italic>α</italic>-level multiple testing procedures. Since <italic>Λ</italic><sub><italic>j</italic></sub> is increasing with <inline-formula id="IEq17"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$P\left (\mathcal {H}^{0j}_{NR} \text {~is ~true~} |\left \{z_{1,i}\right \}^{m}_{i=1},\left \{z_{2,i}\right \}^{m}_{i=1}\right)$\end{document}</tex-math><mml:math id="M52"><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mtext>is true</mml:mtext><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq17.gif"></inline-graphic></alternatives></inline-formula>, we can also define the optimal multiple testing statistic for replicability analysis as 
<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {{\begin{aligned} \text{repLIS}_{j}=P \left(\mathcal{H}^{0j}_{NR} \text{~is ~true~} \left|\{z_{1,i}\}^{m}_{i=1},\left\{z_{2,i}\right\}\right.^{m}_{i=1} \right), ~~ \text{for}~ j=1, \dots, m. \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M54"><mml:mspace width="-17.0pt"></mml:mspace><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mtext>repLIS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mtext>is true</mml:mtext><mml:msubsup><mml:mrow><mml:mfenced close="" open="|" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1em"></mml:mspace><mml:mspace width="1em"></mml:mspace><mml:mtext>for</mml:mtext><mml:mspace width="1em"></mml:mspace><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equ5.gif"></graphic></alternatives></disp-formula></p>
<p>Denote by repLIS<sub>(1)</sub>, repLIS<sub>(2)</sub>,…,repLIS<sub>(<italic>m</italic>)</sub> the ordered repLIS values and <inline-formula id="IEq18"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}^{0(1)}_{NR}$\end{document}</tex-math><mml:math id="M56"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq18.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq19"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}^{0(2)}_{NR}, \dots, \mathcal {H}^{0(m)}_{NR}$\end{document}</tex-math><mml:math id="M58"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq19.gif"></inline-graphic></alternatives></inline-formula> the corresponding no replicability null hypotheses. The repLIS procedure for replicability analysis is: 
<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$ {{\begin{aligned} \text{{let}~} l=\max \left\{t: \frac{1}{t}\sum\limits^{t}_{j=1} \text{repLIS}_{(j)} \leq\alpha \right\}; ~\text{then~ reject~all~} \mathcal{H}^{0(j)}_{NR}, j=1, \dots, l. \end{aligned}}}  $$ \end{document}</tex-math><mml:math id="M60"><mml:mspace width="-17.0pt"></mml:mspace><mml:mtable><mml:mtr><mml:mtd><mml:mtext>let</mml:mtext><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mo>max</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi>t</mml:mi><mml:mo>:</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mtext>repLIS</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfenced><mml:mo>;</mml:mo><mml:mspace width="1em"></mml:mspace><mml:mtext>then reject all</mml:mtext><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:munderover><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>l.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equ6.gif"></graphic></alternatives></disp-formula></p>
<p>It is necessary to note that, to focus on the main ideas, we restrict attention to repLIS in testing two GWAS studies. Extending repLIS to multiple GWAS studies (≥3) is formally straightforward, but requires additional computations.</p>
<p>The following theorem shows that repLIS procedure is asymptotically optimal. The proof of the theorem is outlined in Additional file <xref ref-type="media" rid="MOESM2">2</xref>.</p>
<sec id="d29e3448">
<title>
<bold>Theorem 1</bold>
</title>
<p>Consider the Cartesian hidden Markov model (1)-(2) and define the testing statistics <inline-formula id="IEq20"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\text {repLIS}_{j}=P\left (\left (H_{1,j},H_{2,j}\right)\in \{(0,0),(1,0),(0,1)\} |\{z_{1,i}\}^{m}_{i=1},\left \{z_{2,i}\right \}^{m}_{i=1}\right)$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mtext>repLIS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>}</mml:mo><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq20.gif"></inline-graphic></alternatives></inline-formula> for <italic>j</italic>=1,…,<italic>m</italic>. Let repLIS<sub>(1)</sub>, repLIS<sub>(2)</sub>,…,repLIS<sub>(<italic>m</italic>)</sub> be the ordered repLIS values and <inline-formula id="IEq21"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}^{0(1)}_{NR}$\end{document}</tex-math><mml:math id="M64"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq21.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq22"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}^{0(2)}_{NR}, \dots, \mathcal {H}^{0(m)}_{NR}$\end{document}</tex-math><mml:math id="M66"><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="script">ℋ</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">NR</mml:mtext></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>(</mml:mo><mml:mi>m</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq22.gif"></inline-graphic></alternatives></inline-formula> be the corresponding no replicability null hypotheses. Then the repLIS procedure (6) controls FDR at <italic>α</italic>. Moreover, the FNR yielded by repLIS procedure is <italic>β</italic><sup>∗</sup>+<italic>o</italic>(1), where <italic>β</italic><sup>∗</sup> is the smallest FNR level among all <italic>α</italic>-level FDR multiple testing procedures.</p>
</sec>
</sec>
<sec id="Sec11">
<title>The forward-backward algorithm for computing repLIS</title>
<p>When the parameters of CHMM are known, repLIS statistics can be calculated by utilizing the forward-backward algorithm. Specifically, the repLIS statistic for the <italic>j</italic>th SNP can be expressed as: 
<disp-formula id="Equf"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{repLIS}_{j}=1-\frac{\alpha_{j}(1,1)\beta_{j}(1,1)}{\sum^{1}_{p=0}\sum^{1}_{q=0}\alpha_{j}(p,q)\beta_{j}(p,q)}, $$ \end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:msub><mml:mrow><mml:mtext>repLIS</mml:mtext></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equf.gif"></graphic></alternatives></disp-formula> where the forward variable <inline-formula id="IEq23"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\alpha _{j}(p,q)=P\left ({\vphantom {\left \{z_{1,i}\right \}^{j}_{i=1},\left \{z_{2,i}\right \}^{j}_{i=1}}}\left (H_{1,j},H_{2,j}\right)=\right. \left.(p,q),\left \{z_{1,i}\right \}^{j}_{i=1},\left \{z_{2,i}\right \}^{j}_{i=1}\right)$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close="" open="(" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mfenced><mml:mfenced close=")" open="" separators=""><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq23.gif"></inline-graphic></alternatives></inline-formula> and the backward variable <inline-formula id="IEq24"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\beta _{j}(p,q)=P\left (\left \{z_{1,i}\right \}^{m}_{i=j+1},\left \{z_{2,i}\right \}^{m}_{i=j+1}|\left (H_{1,j},H_{2,j}\right)=(p,q)\right)$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq24.gif"></inline-graphic></alternatives></inline-formula> can be calculated by using the following recursive formulas: 
<disp-formula id="Equg"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\alpha_{j+1}(p,q)=\sum^{1}_{s=0}\sum^{1}_{t=0}\alpha_{j}(s,t)f_{1p}\left(z_{1,j+1}\right)f_{2q}\left(z_{2,j+1}\right)A_{(s,t)(p,q)}, $$ \end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mspace width="-15.0pt"></mml:mspace><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equg.gif"></graphic></alternatives></disp-formula><disp-formula id="Equh"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\beta_{j}(p,q)=\sum^{1}_{s=0}\sum^{1}_{t=0}\beta_{j+1}(s,t)f_{1s}\left(z_{1,j+1}\right)f_{2t}\left(z_{2,j+1}\right)A_{(p,q)(s,t)}. $$ \end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mspace width="-15.0pt"></mml:mspace><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equh.gif"></graphic></alternatives></disp-formula></p>
</sec>
<sec id="Sec12">
<title>The EM algorithm for estimating the parameters of CHMM</title>
<p>In reality, the parameters <italic>𝜗</italic> of the CHMM are not usually known. We use the plug-in <inline-formula id="IEq25"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\widehat {\text {repLIS}}$\end{document}</tex-math><mml:math id="M78"><mml:mover accent="false"><mml:mrow><mml:mtext>repLIS</mml:mtext></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq25.gif"></inline-graphic></alternatives></inline-formula> yielded by utilizing the maximum likelihood estimates to replace the true parameters for replicated analysis. In this section, we provide details of the EM algorithm for estimating the parameters of CHMM. For simplicity, let <inline-formula id="IEq26"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\sum \limits _{H_{1,*};H_{2,*}}=\sum \limits _{H_{1,1},H_{1,2},\dots,H_{1,m}} \sum \limits _{H_{2,1},H_{2,2},\dots,H_{2,m}}$\end{document}</tex-math><mml:math id="M80"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq26.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {Z}=\left (\left \{z_{1,j}\right \}^{m}_{j=1},\left \{z_{2,j}\right \}^{m}_{j=1}\right)$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="script">Z</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq27.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq28"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\mathcal {H}=\left (\left \{H_{1,j}\right \}^{m}_{j=1},\left \{H_{2,j}\right \}^{m}_{j=1}\right)$\end{document}</tex-math><mml:math id="M84"><mml:mi mathvariant="script">ℋ</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq28.gif"></inline-graphic></alternatives></inline-formula>.</p>
<p>The full likelihood can be expressed as: 
<disp-formula id="Equi"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} L(\vartheta;\mathcal{Z},\mathcal{H})&amp;\,=\,&amp;P_{\vartheta}\left(\left\{z_{1,j}\right\}^{m}_{j=1},\!\left\{z_{2,j}\right\}^{m}_{j=1},\!\left\{H_{1,j}\right\}^{m}_{j=1},\!\left\{H_{2,j}\right\}^{m}_{j=1}\right)\\ &amp;=&amp;P_{\vartheta}\left(H_{1,1},H_{2,1}\right)\prod^{m}_{j=1}f_{1H_{1,j}}\left(z_{1,j}\right)\prod^{m}_{j=1}f_{2H_{2,j}}\left(z_{2,j}\right)\\ &amp;&amp;\times \prod^{m-1}_{j=1}A_{\left(H_{1,j},H_{2,j}\right)\left(H_{1,j+1},H_{2,j+1}\right)}. \end{array} $$ \end{document}</tex-math><mml:math id="M86"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>𝜗</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">ℋ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd class="eqnarray-2"><mml:mspace width="0.3em"></mml:mspace><mml:mo>=</mml:mo><mml:mspace width="0.3em"></mml:mspace></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"></mml:mtd><mml:mtd class="eqnarray-2"></mml:mtd><mml:mtd class="eqnarray-3"><mml:mo>×</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mi>.</mml:mi></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equi.gif"></graphic></alternatives></disp-formula></p>
<p>We first initialize the parameters <inline-formula id="IEq29"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\vartheta ^{(0)}= \left (\pi ^{(0)},\mathcal {A}^{(0)},\mathcal {F}^{(0)}\right)$\end{document}</tex-math><mml:math id="M88"><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">F</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq29.gif"></inline-graphic></alternatives></inline-formula>. In the E-step of the <italic>t</italic>th iteration, we calculate the following <italic>Q</italic>(<italic>𝜗</italic>,<italic>𝜗</italic><sup>(<italic>t</italic>)</sup>) function: 
<disp-formula id="Equj"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} Q\left(\vartheta,\vartheta^{(t)}\right)&amp;=&amp;\sum\limits_{H_{1,*};H_{2,*}}\log P_{\vartheta}(\mathcal{Z},\mathcal{H})P_{\vartheta^{(t)}}(\mathcal{Z},\mathcal{H})\\ &amp;=&amp;\sum\limits_{H_{1,*};H_{2,*}}\log P_{\vartheta}\left(H_{1,1},H_{2,1}\right)P_{\vartheta^{(t)}}(\mathcal{Z},\mathcal{H})\\ &amp;&amp;+\sum\limits_{H_{1,*};H_{2,*}}\left[\sum^{m}_{j=1}\log \left.\left(f_{1,H_{1,j}}\left(z_{1,j}\right)f_{2,H_{2,j}}(z_{2,j}\right)\right)\right]P_{\vartheta^{(t)}}(\mathcal{Z},\mathcal{H})\\ &amp;&amp;+\sum\limits_{H_{1,*};H_{2,*}}\left[\sum^{m-1}_{j=1}\log A_{\left(H_{1,j},H_{2,j}\right)\left(H_{1,j+1},H_{2,j+1}\right)} \right]P_{\vartheta^{(t)}}(\mathcal{Z},\mathcal{H}) \end{array} $$ \end{document}</tex-math><mml:math id="M90"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:mi>Q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>𝜗</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">ℋ</mml:mi><mml:mo>)</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">ℋ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">ℋ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"></mml:mtd><mml:mtd class="eqnarray-2"></mml:mtd><mml:mtd class="eqnarray-3"><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:mfenced close=")" open="" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">ℋ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"></mml:mtd><mml:mtd class="eqnarray-2"></mml:mtd><mml:mtd class="eqnarray-3"><mml:mo>+</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>∗</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo>log</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">ℋ</mml:mi><mml:mo>)</mml:mo></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equj.gif"></graphic></alternatives></disp-formula></p>
<p>In the M-step of the <italic>t</italic>th iteration, maximizing <italic>Q</italic>(<italic>𝜗</italic>,<italic>𝜗</italic><sup>(<italic>t</italic>)</sup>) yields to 
<disp-formula id="Equk"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\vartheta^{(t+1)}=\arg\max\limits_{\vartheta}Q\left(\vartheta,\vartheta^{(t)}\right). $$ \end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mrow><mml:mo>max</mml:mo></mml:mrow><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow></mml:munder><mml:mi>Q</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>𝜗</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:mi>.</mml:mi></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equk.gif"></graphic></alternatives></disp-formula> Specifically, using the Lagrange multiplier method yields to 
<disp-formula id="Equl"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\begin{array}{@{}rcl@{}} \pi^{(t+1)}_{u} &amp;=&amp; P_{\vartheta^{(t)}}\left(H_{1,1},H_{2,1}\right)=u|\mathcal{Z}), \\ A^{(t+1)}_{uv} &amp;\,=\,&amp; \frac{\sum^{m-1}_{j=1}P_{\vartheta^{(t)}}\left(\left(H_{1,j},H_{2,j}\right)\,=\,u,\left(H_{1,j+1},H_{2,j+1}\right)\,=\,v|\mathcal{Z}\right)} {\sum^{m-1}_{j=1}P_{\vartheta^{(t)}}\left(\left(H_{1,j},H_{2,j}\right)=u|\mathcal{Z}\right)}, \\ \mu^{(t+1)}_{i} &amp;=&amp; \frac{\sum^{m}_{j=1}z_{i,j}P_{\vartheta^{(t)}}\left(H_{i,j}=1|\mathcal{Z}\right)} {\sum^{m}_{j=1}P_{\vartheta^{(t)}}\left(H_{i,j}=1|\mathcal{Z}\right)}, \\ \sigma^{2(t+1)}_{i} &amp;= &amp;\frac{\sum^{m}_{j=1}\left(z_{i,j}-\mu^{(t+1)}_{i}\right)^{2}P_{\vartheta^{(t)}}\left(H_{i,j}=1|\mathcal{Z}\right)} {\sum^{m}_{j=1}P_{\vartheta^{(t)}}\left(H_{i,j}=1|\mathcal{Z}\right)}, \end{array} $$ \end{document}</tex-math><mml:math id="M94"><mml:mtable class="eqnarray" columnalign="left center right"><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">Z</mml:mi><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">uv</mml:mtext></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mspace width="0.3em"></mml:mspace><mml:mo>=</mml:mo><mml:mspace width="0.3em"></mml:mspace></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.3em"></mml:mspace><mml:mo>=</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mspace width="0.3em"></mml:mspace><mml:mo>=</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mi>v</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi mathvariant="script">Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi mathvariant="script">Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd class="eqnarray-1"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mtd><mml:mtd class="eqnarray-2"><mml:mo>=</mml:mo></mml:mtd><mml:mtd class="eqnarray-3"><mml:mfrac><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi mathvariant="script">Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>𝜗</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi mathvariant="script">Z</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd><mml:mtd><mml:mtext></mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equl.gif"></graphic></alternatives></disp-formula></p>
<p>for <italic>i</italic>=1,2 and <italic>u</italic>,<italic>v</italic>∈{(0,0),(1,0),(0,1),(1,1)}.</p>
</sec>
</sec>
<sec id="Sec13">
<title>Simulation studies</title>
<sec id="Sec14">
<title>Simulation I</title>
<p>In this section, we explore the numerical performance of our novel procedures: the oracle repLIS (repLIS.or) and data-driven repLIS (repLIS) procedures, and two existing multiple testing procedures for replicability analysis in testing two GWAS studies, including the Benjamini-Hochberg procedure (BH) [<xref ref-type="bibr" rid="CR11">11</xref>] and the repfdr procedure (repfdr) [<xref ref-type="bibr" rid="CR14">14</xref>]. We also carried out further simulation studies for repLIS in testing three GWAS studies. The detailed simulation results are displayed in Additional file <xref ref-type="media" rid="MOESM2">2</xref> and they are almost coincide with those for testing two GWAS studies. We compare these multiple testing procedures in detecting replicated signals from three aspects. First, we check whether or not the FDR values yielded by different procedures are controlled at the pre-specified level <italic>α</italic>, where <italic>α</italic> is set to be 0.1 and 0.02 in the simulation, and the results for <italic>α</italic>=0.02 are illustrated in Additional file <xref ref-type="media" rid="MOESM2">2</xref>. Second, we compare the FNR and the average number of true positives (ATP). In general, a valid procedure (the FDR value is contronlled at the pre-specified level) is efficient if it allows for a small FNR value and a large ATP value. In Simulation I, we consider two scenarios based on whether or not the tests of all the SNPs are independent in each study. Third, we investigate the ranking efficiency of these procedures in Scenario 2 of Simulation I. The simulation results are based on 200 replications in Simulation I and the number of tests (i.e. <italic>m</italic>) in each study is 10000 for all the simulations.</p>
<sec id="Sec15">
<title>Scenario 1: independent tests</title>
<p>In this scenario, we set <italic>σ</italic><sub>1</sub>=<italic>σ</italic><sub>2</sub>=1 and <italic>μ</italic><sub>2</sub>=4. The joint states of the hypotheses across two studies <inline-formula id="IEq30"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{\left (H_{1,j},H_{2,j}\right)\right \}^{m}_{j=1}$\end{document}</tex-math><mml:math id="M96"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq30.gif"></inline-graphic></alternatives></inline-formula> are generated from the Multinomial distribution <italic>M</italic><italic>u</italic><italic>l</italic><italic>t</italic><italic>i</italic>(10000,(0.4,0.2,0.2,0.2)). We vary <italic>μ</italic><sub>1</sub> from 2.0 to 3.0 with an increment 0.5 and exhibit the simulation results in Fig. <xref ref-type="fig" rid="Fig4">4</xref>. In Fig. <xref ref-type="fig" rid="Fig4">4</xref>, we can see from panel (a) that all four procedures can control the FDR level at the pre-specified level 0.1 approximately. Although the data-driven repLIS procedure has the largest FDR, it is still acceptable (FDR = 0.115). We can also observe that the empirical Bayes procedure repfdr is slightly conservative and the BH procedure leads to a quite small FDR value. These results indicate that our novel procedures are still valid for replicated analysis even the tests are independent in each study. The results revealed from panel (b) and (c) in Fig. <xref ref-type="fig" rid="Fig4">4</xref> show that: (1) The FNR yielded by these procedures are decreasing when <italic>μ</italic><sub>1</sub> varies from 2.0 to 3.0; (2) The ATP yielded by these procedures are increasing when <italic>μ</italic><sub>1</sub> varies from 2.0 to 3.0; (3) The FNR and ATP yielded by oracle repLIS procedure, data-driven repLIS procedure, and repfdr procedure are almost the same. We can conclude that our proposed procedures (repLIS.or and repLIS) are as efficient as repfdr when the tests are independent in each study.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Simulation results in Scenario 1. <bold>a</bold> The FDR levels of all four procedures are controlled at 0.1 approximately, and BH procedure is quite conservative. <bold>b</bold> The FNR yielded by oracle repLIS procedure, data-driven repLIS procedure and repfdr procedure are almost the same, and all of them are smaller than that of BH procedure. <bold>c</bold> The ATP yielded by oracle repLIS procedure, data-driven repLIS procedure and repfdr procedure are almost the same, and all of them are larger than that of BH procedure</p></caption><graphic id="MO4" xlink:href="12859_2019_2707_Fig4_HTML"></graphic></fig>
</p>
</sec>
<sec id="Sec16">
<title>Scenario 2: locally dependent tests</title>
<p>In this scenario, we set <italic>σ</italic><sub>1</sub>=<italic>σ</italic><sub>2</sub>=1, <italic>μ</italic><sub>2</sub>=2, and vary <italic>μ</italic><sub>1</sub> from 3 to 5 with an increment 1. Consider the CHMM (1)-(3) and the joint states of the hypotheses across two studies <inline-formula id="IEq31"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$\left \{\left (H_{1,j},H_{2,j}\right)\right \}^{m}_{j=1}$\end{document}</tex-math><mml:math id="M98"><mml:msubsup><mml:mrow><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2019_2707_Article_IEq31.gif"></inline-graphic></alternatives></inline-formula> are generated with the following transition matrix 
<disp-formula id="Equm"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$A=\left(\begin{array}{cccc} 0.7 &amp; 0.1 &amp; 0.1 &amp; 0.1\\ 0.1 &amp; 0.7 &amp; 0.1 &amp; 0.1\\ 0.1 &amp; 0.1 &amp; 0.7 &amp; 0.1\\ 0.1 &amp; 0.1 &amp; 0.8-A_{(1, 1)(1, 1)} &amp; A_{(1, 1)(1, 1)}\\ \end{array} \right), $$ \end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mtable class="array" columnalign="left"><mml:mtr><mml:mtd><mml:mn>0.7</mml:mn></mml:mtd><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd><mml:mn>0.7</mml:mn></mml:mtd><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd><mml:mn>0.7</mml:mn></mml:mtd><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd><mml:mn>0.1</mml:mn></mml:mtd><mml:mtd><mml:mn>0.8</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equm.gif"></graphic></alternatives></disp-formula> and the initial distribution <italic>π</italic> is set to be (0.25,0.25,0.25,0.25). Since the replicated associations are more likely to be clustered, the values of the entries in the diagonal of the transition matrix are set to be large. Here, <italic>A</italic><sub>(1,1)(1,1)</sub> is set to be 0.7, and the numerical results are displayed in Fig. <xref ref-type="fig" rid="Fig5">5</xref>. We further explored the robustness of repLIS under CHMMs by varying <italic>A</italic><sub>(1,1)(1,1)</sub> from 0.5 to 0.7, and the results are illustrated in Additional file <xref ref-type="media" rid="MOESM2">2</xref>.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Simulation results in Scenario 2. <bold>a</bold> The FDR levels of all four procedures are controlled at 0.1, and the FDR yielded by oracle repLIS and data-driven are almost the same. <bold>b</bold> The FNR yielded by repfdr procedure and BH procedure are apparently large. <bold>c</bold> The ATP yielded by repfdr procedure and BH procedure are apparently small</p></caption><graphic id="MO5" xlink:href="12859_2019_2707_Fig5_HTML"></graphic></fig>
</p>
<p>To investigate the robustness of repLIS when the order of Markov dependence is incorrectly specified, we added simulation studies. Without loss of generality, we consider the case where the order of Markov dependence is set to be 2. We choose the setup to be consistent with those in Scenario 2 when possible. The detailed model settings are depicted in Additional file <xref ref-type="media" rid="MOESM2">2</xref>.</p>
<p>From Fig. <xref ref-type="fig" rid="Fig5">5</xref> we can observe that the numerical results are almost coincide with those in Scenario 1, except that there is a significant difference in FNR and ATP values between our procedures (repLIS.or and repLIS) and repfdr procedure. The results reveal that our proposed procedures enjoy a smaller value of FNR and a larger value of ATP compared with their competitors. This indicates that our novel procedures are more efficient in detecting replicated signals when the tests are locally dependent in each study.</p>
<p>It is important to point out that the superiority of repLIS is achieved by characterizing the clustered and locally dependent structure via the Markov chain. Table <xref ref-type="table" rid="Tab2">2</xref> presents the outcomes of repLIS, repfdr, and BH in testing two clusters of replicated signals in Scenario 2 of Simulation I. It can be clearly seen that BH and repfdr can only identify the replicated signals with extremely small <italic>p</italic>-values, whereas repLIS tends to identify the entire cluster of replicated signals. By leveraging information from adjacent SNPs, repLIS are more efficient in detecting replicated signals.
<table-wrap id="Tab2"><label>Table 2</label><caption><p>The significance levels suggested by BH, repfdr and repLIS</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Sequence</th><th align="left">States</th><th align="left">Maximum</th><th align="left">repfdr</th><th align="left">repLIS</th><th align="left">BH</th><th align="left">repfdr</th><th align="left">repLIS</th></tr><tr><th align="left"></th><th align="left"></th><th align="left"><italic>p</italic>-values</th><th align="left">values</th><th align="left">values</th><th align="left">procedure</th><th align="left">procedure</th><th align="left">procedure</th></tr></thead><tbody><tr><td align="left">1027</td><td align="left">∙</td><td align="left">1.94e-1</td><td align="left">5.48e-1</td><td align="left">1.67e-1</td><td align="left">∘</td><td align="left">∘</td><td align="left">∙</td></tr><tr><td align="left">1028</td><td align="left">∙</td><td align="left">4.19e-3</td><td align="left">4.59e-2</td><td align="left">8.78e-3</td><td align="left">∘</td><td align="left">∙</td><td align="left">∙</td></tr><tr><td align="left">1029</td><td align="left">∙</td><td align="left">3.95e-2</td><td align="left">2.28e-1</td><td align="left">5.80e-2</td><td align="left">∘</td><td align="left">∙</td><td align="left">∙</td></tr><tr><td align="left">1030</td><td align="left">∙</td><td align="left">1.13e-1</td><td align="left">3.79e-1</td><td align="left">8.89e-2</td><td align="left">∘</td><td align="left">∘</td><td align="left">∙</td></tr><tr><td align="left">1031</td><td align="left">∙</td><td align="left">3.51e-3</td><td align="left">2.88e-2</td><td align="left">1.89e-2</td><td align="left">∙</td><td align="left">∙</td><td align="left">∙</td></tr><tr><td align="left">⋮</td><td align="left">⋮</td><td align="left">⋮</td><td align="left">⋮</td><td align="left">⋮</td><td align="left">⋮</td><td align="left">⋮</td><td align="left">⋮</td></tr><tr><td align="left">7305</td><td align="left">∙</td><td align="left">1.47e-3</td><td align="left">2.21e-2</td><td align="left">3.48e-3</td><td align="left">∙</td><td align="left">∙</td><td align="left">∙</td></tr><tr><td align="left">7306</td><td align="left">∙</td><td align="left">1.85e-2</td><td align="left">2.16e-1</td><td align="left">4.34e-2</td><td align="left">∘</td><td align="left">∙</td><td align="left">∙</td></tr><tr><td align="left">7307</td><td align="left">∙</td><td align="left">4.56e-2</td><td align="left">2.07e-1</td><td align="left">5.88e-2</td><td align="left">∘</td><td align="left">∙</td><td align="left">∙</td></tr><tr><td align="left">7308</td><td align="left">∙</td><td align="left">1.10e-1</td><td align="left">3.73e-1</td><td align="left">9.81e-2</td><td align="left">∘</td><td align="left">∘</td><td align="left">∙</td></tr><tr><td align="left">7309</td><td align="left">∙</td><td align="left">3.01e-2</td><td align="left">3.35e-1</td><td align="left">6.96e-2</td><td align="left">∘</td><td align="left">∘</td><td align="left">∙</td></tr><tr><td align="left">7310</td><td align="left">∙</td><td align="left">3.04e-4</td><td align="left">8.18e-3</td><td align="left">1.04e-2</td><td align="left">∙</td><td align="left">∙</td><td align="left">∙</td></tr></tbody></table><table-wrap-foot><p>’ ∘’ denotes a null hypothesis or an acceptance and ’ ∙’ denotes a non-null hypothesis or a rejection. By exploiting the dependence information among adjacent SNPs, repLIS procedure tends to select disease-associated SNPs in clusters</p></table-wrap-foot></table-wrap>
</p>
</sec>
</sec>
<sec id="Sec17">
<title>Ranking efficiency</title>
<p>The efficiency of ranking hypotheses is another measure that was widely used to perform comparison for different multiple testing procedures. In general, an efficient multiple testing procedure enjoys a ranked list where the non-nulls concentrate on the top of the ranked list. In this section, we use the ROC curve to compare the efficiency of ranking non-null hypotheses for different procedures. Figure <xref ref-type="fig" rid="Fig6">6</xref> shows the results of the comparison for two cases that the tests of all the SNPs are independent (panel (a)) and are not independent (panel (b)) in each study, respectively. We can see that the ROC curves of our procedures dominate these of repfdr and BH procedures in panel (b). This implies that our repLIS procedures lead to a more efficient hypotheses ranking, especially when the tests of all the SNPs are not independent in each study.
<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparisons of ranking efficiency. <bold>a</bold> The ROC curves under the model settings: <bold><italic>μ</italic></bold><sub><bold><italic>1</italic></bold></sub>=2.5,<bold><italic>μ</italic></bold><sub><bold><italic>2</italic></bold></sub>=4,<italic>σ</italic><sub><bold><italic>1</italic></bold></sub>=<italic>σ</italic><sub><bold><italic>2</italic></bold></sub>=<bold><italic>1</italic></bold> and the tests of all the SNPs are independent. <bold>b</bold> The ROC curves under the model settings: <bold><italic>μ</italic></bold><sub><bold><italic>1</italic></bold></sub>=3,<bold><italic>μ</italic></bold><sub><bold><italic>2</italic></bold></sub>=2,<italic>σ</italic><sub><bold><italic>1</italic></bold></sub>=<italic>σ</italic><sub><bold><italic>2</italic></bold></sub>=<bold><italic>1</italic></bold> and the tests of all the SNPs are under Markov dependence</p></caption><graphic id="MO6" xlink:href="12859_2019_2707_Fig6_HTML"></graphic></fig>
</p>
</sec>
<sec id="Sec18">
<title>Simulation II</title>
<p>In this section, we perform additional simulations to evaluate the performance of our repLIS procedure on a more realistic simulated data. In order to obtain a simulated data for two GWAS studies with more realistic LD patterns, we generate two genotype pools by randomly matching 340 haplotypes from the subjects of JPT+CHB (Japanese in Tokyo, Japan and Han Chinese in Beijing, China) and 410 haplotypes from the subjects of CEU+TSI (Utah residents with Northern and Western European ancestry from the CEPH collection and Toscani in Italia) collected by HapMap3 [<xref ref-type="bibr" rid="CR35">35</xref>], respectively. To focus on the main points, we select six SNPs from a region of the chromosome 7 (consists of 10000 SNPs) as disease causal SNPs. Specifically, the three SNPs, 1200th, 1500th, 1800th, are chosen to be far away and the others, 6500th, 6504th, 6508th, are chosen to be clustered. The disease status <italic>Y</italic> is generated by using a logistic regression model: 
<disp-formula id="Equn"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document} $$\text{logit}(P(Y=1|G))=\beta_{0}+\sum\limits^{6}_{i=1}\beta_{i}G_{i}, $$ \end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mtext>logit</mml:mtext><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mi>G</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>G</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic position="anchor" xlink:href="12859_2019_2707_Article_Equn.gif"></graphic></alternatives></disp-formula> where <italic>G</italic>=(<italic>G</italic><sub>1</sub>,<italic>G</italic><sub>2</sub>,...,<italic>G</italic><sub>6</sub>)<sup><italic>T</italic></sup> and <italic>G</italic><sub><italic>i</italic></sub> is the corresponding genotype of the <italic>i</italic>th causal SNPs. We set <italic>β</italic><sub>0</sub>=−8 and <italic>β</italic><sub>1</sub>=<italic>β</italic><sub>2</sub>=...=<italic>β</italic><sub>6</sub>= log(2) so that the prevalence of the disease is controlled at 0.04. The performance of replicability analysis procedure is assessed by the selection rate of relevant SNPs, and the relevant SNPs are refered to as the three adjacent SNPs on each side of a causal SNP. The sensitivity is defined as the percentages of relevant SNPs that are selected by top <italic>k</italic> SNPs. The simulation is repeated for 100 times and the results are displayed in Fig. <xref ref-type="fig" rid="Fig7">7</xref>.
<fig id="Fig7"><label>Fig. 7</label><caption><p>The sensitivity curves yielded by repLIS and repfdr in Simulation II. The three SNPs, 1200th, 1500th, 1800th, are chosen to be far away and the others, 6500th, 6504th, 6508th, are chosen to be clustered. The performance of replicability analysis procedure is assessed by the selection rate of relevant SNPs, which are defined as the three adjacent SNPs on each side of a causal SNP. The sensitivity is defined as the percentages of relevant SNPs that are selected by top <italic>k</italic> SNPs</p></caption><graphic id="MO7" xlink:href="12859_2019_2707_Fig7_HTML"></graphic></fig>
</p>
<p>From Fig. <xref ref-type="fig" rid="Fig7">7</xref> we can observe that the sensitivities yielded by our repLIS are uniformly larger than those of repfdr. This indicates that repLIS achieves a higher ranking efficiency and can discover more replicated signals at the same number of rejections.</p>
</sec>
</sec>
<sec sec-type="supplementary-material">
<title>Additional file</title>
<sec id="Sec19">
<p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="12859_2019_2707_MOESM1_ESM.pdf"><label>Additional file 1</label><caption><p>Brief description of some core code of our repLIS procedure. repLIS is a program to perform replicability analysis in genome-wide association studies, which is written in R code. Here, repLIS program is designed for one chromosome or a segment of chromosome. For the analysis of multiple chromosomes, firstly, the users can make the parallel computing for them, then complete the global analysis by combining all results from multiple chromosomes. (PDF 151 kb)</p></caption></media></supplementary-material>
</p>
<p>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="12859_2019_2707_MOESM2_ESM.pdf"><label>Additional file 2</label><caption><p>Proof of Theorem 1 and additional simulations. We give a brief proof of Theorem 1 in Additional file <xref ref-type="media" rid="MOESM2">2</xref>. The asymptotic optimality can be derived without essential difficulty by extending the proof of Theorem 6 in [<xref ref-type="bibr" rid="CR20">20</xref>]. We also carried out additional simulation studies to investigate the numerical performance of repLIS in various model settings. (PDF 249 kb)</p></caption></media></supplementary-material>
</p>
</sec>
</sec>
</body>
<back>
<glossary>
<title>Abbreviations</title>
<def-list>
<def-item>
<term>GWAS</term>
<def>
<p>Genome-wide association studies</p>
</def>
</def-item>
<def-item>
<term>CHMM</term>
<def>
<p>Cartesian hidden Markov model</p>
</def>
</def-item>
<def-item>
<term>SNPs</term>
<def>
<p>Single nucleotide polymorphisms</p>
</def>
</def-item>
<def-item>
<term>BH</term>
<def>
<p>The Benjamini-Hochberg procedure</p>
</def>
</def-item>
<def-item>
<term>repLIS</term>
<def>
<p>The replicated local index of significance procedure</p>
</def>
</def-item>
<def-item>
<term>FDR</term>
<def>
<p>False discovery rate</p>
</def>
</def-item>
<def-item>
<term>FNR</term>
<def>
<p>False non-discovery rate</p>
</def>
</def-item>
<def-item>
<term>MCMC</term>
<def>
<p>Markov chain Monte Carlo algorithm</p>
</def>
</def-item>
<def-item>
<term>PGC</term>
<def>
<p>Psychiatric Genomics Consortium</p>
</def>
</def-item>
<def-item>
<term>WTCCC</term>
<def>
<p>Wellcome trust case control consortium</p>
</def>
</def-item>
<def-item>
<term>ADHD</term>
<def>
<p>Attention deficit-hyperactivity disorder</p>
</def>
</def-item>
<def-item>
<term>ASD</term>
<def>
<p>Autism spectrum disorder</p>
</def>
</def-item>
<def-item>
<term>BD</term>
<def>
<p>Bipolar disorder</p>
</def>
</def-item>
<def-item>
<term>MDD</term>
<def>
<p>Major depressive disorder</p>
</def>
</def-item>
<def-item>
<term>SCZ</term>
<def>
<p>Schizophrenia</p>
</def>
</def-item>
</def-list>
</glossary>
<ack>
<title>Acknowledgements</title>
<p>None.</p>
<sec id="d29e7402">
<title>Funding</title>
<p>This work is supported in part by the National Natural Science Foundation of China Grants 11771072 and 11371083. The funders did not play any roles in the design of the study, in the collection, analysis, or in writing the manuscript.</p>
</sec>
<sec id="d29e7407" sec-type="data-availability">
<title>Availability of data and materials</title>
<p>The psychiatric disorders data sets can get from (<ext-link ext-link-type="uri" xlink:href="http://www.med.unc.edu/pgc/results-and-downloads">http://www.med.unc.edu/pgc/results-and-downloads</ext-link>). The GWAS data sets of the WTCCC Consortium are delivered upon request and are issued subject to conditions by the WTCCC Consortium (<ext-link ext-link-type="uri" xlink:href="https://www.wtccc.org.uk/">https://www.wtccc.org.uk/</ext-link>). The implementations of repLIS procedure are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/wpf19890429/large-scale-multiple-testing-via-CHMM">https://github.com/wpf19890429/large-scale-multiple-testing-via-CHMM</ext-link>).</p>
</sec>
</ack>
<notes notes-type="author-contribution">
<title>Authors’ contributions</title>
<p>PW: idea initiation, method development, manuscript writing and data analysis; WZ: idea initiation, method development and manuscript writing; All authors read and approved the final manuscript.</p>
</notes>
<notes notes-type="COI-statement">
<sec>
<title>Ethics approval and consent to participate</title>
<p>Not applicable.</p>
</sec>
<sec>
<title>Consent for publication</title>
<p>Not applicable.</p>
</sec>
<sec>
<title>Competing interests</title>
<p>The authors declare that they have no competing interests.</p>
</sec>
<sec>
<title>Publisher’s Note</title>
<p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
</sec>
</notes>
<ref-list id="Bib1">
<title>References</title>
<ref id="CR1">
<label>1</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Klein</surname>
<given-names>RJ</given-names>
</name>
<name>
<surname>Zeiss</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Chew</surname>
<given-names>EY</given-names>
</name>
<name>
<surname>Tsai</surname>
<given-names>J-Y</given-names>
</name>
<name>
<surname>Sackler</surname>
<given-names>RS</given-names>
</name>
<name>
<surname>Haynes</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Henning</surname>
<given-names>AK</given-names>
</name>
<name>
<surname>SanGiovanni</surname>
<given-names>JP</given-names>
</name>
<name>
<surname>Mane</surname>
<given-names>SM</given-names>
</name>
<name>
<surname>Mayne</surname>
<given-names>ST</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Complement factor h polymorphism in age-related macular degeneration</article-title>
<source/>Science
          <year>2005</year>
<volume>308</volume>
<issue>5720</issue>
<fpage>385</fpage>
<lpage>9</lpage>
<pub-id pub-id-type="doi">10.1126/science.1109557</pub-id>
<pub-id pub-id-type="pmid">15761122</pub-id>
</element-citation>
</ref>
<ref id="CR2">
<label>2</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>MacArthur</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Bowler</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Cerezo</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Gil</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Hall</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Hastings</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Junkins</surname>
<given-names>H</given-names>
</name>
<name>
<surname>McMahon</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Milano</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Morales</surname>
<given-names>J</given-names>
</name>
<etal></etal>
</person-group>
<article-title>The new nhgri-ebi catalog of published genome-wide association studies (gwas catalog)</article-title>
<source/>Nucleic Acids Res
          <year>2016</year>
<volume>45</volume>
<issue>D1</issue>
<fpage>896</fpage>
<lpage>901</lpage>
<pub-id pub-id-type="doi">10.1093/nar/gkw1133</pub-id>
</element-citation>
</ref>
<ref id="CR3">
<label>3</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Visscher</surname>
<given-names>PM</given-names>
</name>
<name>
<surname>Brown</surname>
<given-names>MA</given-names>
</name>
<name>
<surname>McCarthy</surname>
<given-names>MI</given-names>
</name>
<name>
<surname>Yang</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Five years of gwas discovery</article-title>
<source/>Am J Hum Genet
          <year>2012</year>
<volume>90</volume>
<issue>1</issue>
<fpage>7</fpage>
<lpage>24</lpage>
<pub-id pub-id-type="doi">10.1016/j.ajhg.2011.11.029</pub-id>
<pub-id pub-id-type="pmid">22243964</pub-id>
</element-citation>
</ref>
<ref id="CR4">
<label>4</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Vattikuti</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Guo</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Chow</surname>
<given-names>CC</given-names>
</name>
</person-group>
<article-title>Heritability and genetic correlations explained by common snps for metabolic syndrome traits</article-title>
<source/>PLoS Genet
          <year>2012</year>
<volume>8</volume>
<issue>3</issue>
<fpage>1002637</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pgen.1002637</pub-id>
</element-citation>
</ref>
<ref id="CR5">
<label>5</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Voight</surname>
<given-names>BF</given-names>
</name>
<name>
<surname>Scott</surname>
<given-names>LJ</given-names>
</name>
<name>
<surname>Steinthorsdottir</surname>
<given-names>V</given-names>
</name>
<name>
<surname>Morris</surname>
<given-names>AP</given-names>
</name>
<name>
<surname>Dina</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Welch</surname>
<given-names>RP</given-names>
</name>
<name>
<surname>Zeggini</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Huth</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Aulchenko</surname>
<given-names>YS</given-names>
</name>
<name>
<surname>Thorleifsson</surname>
<given-names>G</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Twelve type 2 diabetes susceptibility loci identified through large-scale association analysis</article-title>
<source/>Nat Genet
          <year>2010</year>
<volume>42</volume>
<issue>7</issue>
<fpage>579</fpage>
<lpage>89</lpage>
<pub-id pub-id-type="doi">10.1038/ng.609</pub-id>
<pub-id pub-id-type="pmid">20581827</pub-id>
</element-citation>
</ref>
<ref id="CR6">
<label>6</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Heller</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Bogomolov</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Benjamini</surname>
<given-names>Y</given-names>
</name>
</person-group>
<article-title>Deciding whether follow-up studies have replicated findings in a preliminary large-scale omics study</article-title>
<source/>Proc Natl Acad Sci
          <year>2014</year>
<volume>111</volume>
<issue>46</issue>
<fpage>16262</fpage>
<lpage>7</lpage>
<pub-id pub-id-type="doi">10.1073/pnas.1314814111</pub-id>
<pub-id pub-id-type="pmid">25368172</pub-id>
</element-citation>
</ref>
<ref id="CR7">
<label>7</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>McCarthy</surname>
<given-names>MI</given-names>
</name>
<name>
<surname>Abecasis</surname>
<given-names>GR</given-names>
</name>
<name>
<surname>Cardon</surname>
<given-names>LR</given-names>
</name>
<name>
<surname>Goldstein</surname>
<given-names>DB</given-names>
</name>
<name>
<surname>Little</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Ioannidis</surname>
<given-names>JP</given-names>
</name>
<name>
<surname>Hirschhorn</surname>
<given-names>JN</given-names>
</name>
</person-group>
<article-title>Genome-wide association studies for complex traits: consensus, uncertainty and challenges</article-title>
<source/>Nat Rev Genet
          <year>2008</year>
<volume>9</volume>
<issue>5</issue>
<fpage>356</fpage>
<lpage>69</lpage>
<pub-id pub-id-type="doi">10.1038/nrg2344</pub-id>
<pub-id pub-id-type="pmid">18398418</pub-id>
</element-citation>
</ref>
<ref id="CR8">
<label>8</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Chanock</surname>
<given-names>SJ</given-names>
</name>
<name>
<surname>Manolio</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Boehnke</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Boerwinkle</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Hunter</surname>
<given-names>DJ</given-names>
</name>
<name>
<surname>Thomas</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Hirschhorn</surname>
<given-names>JN</given-names>
</name>
<name>
<surname>Abecasis</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Altshuler</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Bailey-Wilson</surname>
<given-names>JE</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Replicating genotype–phenotype associations</article-title>
<source/>Nature
          <year>2007</year>
<volume>447</volume>
<issue>7145</issue>
<fpage>655</fpage>
<lpage>60</lpage>
<pub-id pub-id-type="doi">10.1038/447655a</pub-id>
<pub-id pub-id-type="pmid">17554299</pub-id>
</element-citation>
</ref>
<ref id="CR9">
<label>9</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Kraft</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Zeggini</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Ioannidis</surname>
<given-names>JP</given-names>
</name>
</person-group>
<article-title>Replication in genome-wide association studies</article-title>
<source/>Stat Sci Rev J Inst Math Stat
          <year>2009</year>
<volume>24</volume>
<issue>4</issue>
<fpage>561</fpage>
<lpage>73</lpage>
</element-citation>
</ref>
<ref id="CR10">
<label>10</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Benjamini</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Heller</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Yekutieli</surname>
<given-names>D</given-names>
</name>
</person-group>
<article-title>Selective inference in complex research</article-title>
<source/>Philos Trans R Soc Lond A Math Phys Eng Sci
          <year>2009</year>
<volume>367</volume>
<issue>1906</issue>
<fpage>4255</fpage>
<lpage>71</lpage>
<pub-id pub-id-type="doi">10.1098/rsta.2009.0127</pub-id>
</element-citation>
</ref>
<ref id="CR11">
<label>11</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Benjamini</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Hochberg</surname>
<given-names>Y</given-names>
</name>
</person-group>
<article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
<source/>J R Stat Soc Ser B Methodol
          <year>1995</year>
<volume>57</volume>
<issue>1</issue>
<fpage>289</fpage>
<lpage>300</lpage>
</element-citation>
</ref>
<ref id="CR12">
<label>12</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bogomolov</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Heller</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>Discovering findings that replicate from a primary study of high dimension to a follow-up study</article-title>
<source/>J Am Stat Assoc
          <year>2013</year>
<volume>108</volume>
<issue>504</issue>
<fpage>1480</fpage>
<lpage>92</lpage>
<pub-id pub-id-type="doi">10.1080/01621459.2013.829002</pub-id>
</element-citation>
</ref>
<ref id="CR13">
<label>13</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Chung</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Yang</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Li</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Gelernter</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Zhao</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>Gpa: a statistical approach to prioritizing gwas results by integrating pleiotropy and annotation</article-title>
<source/>PLoS Genet
          <year>2014</year>
<volume>10</volume>
<issue>11</issue>
<fpage>1004787</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pgen.1004787</pub-id>
</element-citation>
</ref>
<ref id="CR14">
<label>14</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Heller</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Yekutieli</surname>
<given-names>D</given-names>
</name>
</person-group>
<article-title>Replicability analysis for genome-wide association studies</article-title>
<source/>Ann Appl Stat
          <year>2014</year>
<volume>8</volume>
<issue>1</issue>
<fpage>481</fpage>
<lpage>98</lpage>
<pub-id pub-id-type="doi">10.1214/13-AOAS697</pub-id>
</element-citation>
</ref>
<ref id="CR15">
<label>15</label>
<element-citation publication-type="book">
<person-group person-group-type="author">
<name>
<surname>Efron</surname>
<given-names>B</given-names>
</name>
</person-group>
<source/>Large-scale inference: Empirical bayes methods for estimation, testing, and prediction
          <year>2012</year>
<publisher-loc>Cambridge</publisher-loc>
<publisher-name>Cambridge University Press</publisher-name>
</element-citation>
</ref>
<ref id="CR16">
<label>16</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Heller</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Yaacoby</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Yekutieli</surname>
<given-names>D</given-names>
</name>
</person-group>
<article-title>repfdr: a tool for replicability analysis for genome-wide association studies</article-title>
<source/>Bioinformatics
          <year>2014</year>
<volume>30</volume>
<issue>20</issue>
<fpage>2971</fpage>
<lpage>2</lpage>
<pub-id pub-id-type="doi">10.1093/bioinformatics/btu434</pub-id>
<pub-id pub-id-type="pmid">25012182</pub-id>
</element-citation>
</ref>
<ref id="CR17">
<label>17</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wei</surname>
<given-names>Z</given-names>
</name>
<name>
<surname>Li</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>A hidden spatial-temporal markov random filed model for network-based analysis of time course gene expression eata</article-title>
<source/>Ann Appl Stat
          <year>2008</year>
<volume>2</volume>
<issue>1</issue>
<fpage>408</fpage>
<lpage>29</lpage>
<pub-id pub-id-type="doi">10.1214/07--AOAS145</pub-id>
</element-citation>
</ref>
<ref id="CR18">
<label>18</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Owen</surname>
<given-names>AB</given-names>
</name>
</person-group>
<article-title>Variance of the number of false discoveries</article-title>
<source/>J R Stat Soc Ser B Stat Methodol
          <year>2005</year>
<volume>67</volume>
<issue>3</issue>
<fpage>411</fpage>
<lpage>26</lpage>
<pub-id pub-id-type="doi">10.1111/j.1467-9868.2005.00509.x</pub-id>
</element-citation>
</ref>
<ref id="CR19">
<label>19</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Efron</surname>
<given-names>B</given-names>
</name>
</person-group>
<article-title>Correlation and large-scale simultaneous significance testing</article-title>
<source/>J Am Stat Assoc
          <year>2007</year>
<volume>102</volume>
<issue>477</issue>
<fpage>93</fpage>
<lpage>103</lpage>
<pub-id pub-id-type="doi">10.1198/016214506000001211</pub-id>
</element-citation>
</ref>
<ref id="CR20">
<label>20</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Sun</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Cai</surname>
<given-names>T</given-names>
</name>
</person-group>
<article-title>Large-scale multiple testing under dependence</article-title>
<source/>J R Stat Soc Ser B Stat Methodol
          <year>2009</year>
<volume>71</volume>
<issue>2</issue>
<fpage>393</fpage>
<lpage>424</lpage>
<pub-id pub-id-type="doi">10.1111/j.1467-9868.2008.00694.x</pub-id>
</element-citation>
</ref>
<ref id="CR21">
<label>21</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wei</surname>
<given-names>Z</given-names>
</name>
<name>
<surname>Sun</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Wang</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Hakonarson</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>Multiple testing in genome-wide association studies via hidden markov models</article-title>
<source/>Bioinformatics
          <year>2009</year>
<volume>25</volume>
<issue>21</issue>
<fpage>2802</fpage>
<lpage>8</lpage>
<pub-id pub-id-type="doi">10.1093/bioinformatics/btp476</pub-id>
<pub-id pub-id-type="pmid">19654115</pub-id>
</element-citation>
</ref>
<ref id="CR22">
<label>22</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Xiao</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Zhu</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Guo</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Large-scale multiple testing in genome-wide association studies via region-specific hidden markov models</article-title>
<source/>BMC Bioinformatics
          <year>2013</year>
<volume>14</volume>
<issue>1</issue>
<fpage>282</fpage>
<pub-id pub-id-type="doi">10.1186/1471-2105-14-282</pub-id>
<pub-id pub-id-type="pmid">24067069</pub-id>
</element-citation>
</ref>
<ref id="CR23">
<label>23</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wei</surname>
<given-names>Z</given-names>
</name>
</person-group>
<article-title>Hidden markov models for controlling false discovery rate in genome-wide association analysis</article-title>
<source/>Methods Mol Biol
          <year>2012</year>
<volume>802</volume>
<fpage>337</fpage>
<lpage>44</lpage>
<pub-id pub-id-type="doi">10.1007/978-1-61779-400-1_22</pub-id>
<pub-id pub-id-type="pmid">22130891</pub-id>
</element-citation>
</ref>
<ref id="CR24">
<label>24</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ripke</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Wray</surname>
<given-names>NR</given-names>
</name>
<name>
<surname>Lewis</surname>
<given-names>CM</given-names>
</name>
<name>
<surname>Hamilton</surname>
<given-names>SP</given-names>
</name>
<name>
<surname>Weissman</surname>
<given-names>MM</given-names>
</name>
<name>
<surname>Breen</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Byrne</surname>
<given-names>EM</given-names>
</name>
<name>
<surname>Blackwood</surname>
<given-names>DH</given-names>
</name>
<name>
<surname>Boomsma</surname>
<given-names>DI</given-names>
</name>
<name>
<surname>Cichon</surname>
<given-names>S</given-names>
</name>
<etal></etal>
</person-group>
<article-title>A mega-analysis of genome-wide association studies for major depressive disorder</article-title>
<source/>Mol Psychiatry
          <year>2013</year>
<volume>18</volume>
<issue>4</issue>
<fpage>497</fpage>
<lpage>511</lpage>
<pub-id pub-id-type="doi">10.1038/mp.2012.21</pub-id>
<pub-id pub-id-type="pmid">22472876</pub-id>
</element-citation>
</ref>
<ref id="CR25">
<label>25</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Sklar</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Ripke</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Scott</surname>
<given-names>LJ</given-names>
</name>
<name>
<surname>Andreassen</surname>
<given-names>OA</given-names>
</name>
<name>
<surname>Cichon</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Craddock</surname>
<given-names>N</given-names>
</name>
<name>
<surname>Edenberg</surname>
<given-names>HJ</given-names>
</name>
<name>
<surname>Nurnberger Jr</surname>
<given-names>JI</given-names>
</name>
<name>
<surname>Rietschel</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Blackwood</surname>
<given-names>D</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Large-scale genome-wide association analysis of bipolar disorder identifies a new susceptibility locus near odz4</article-title>
<source/>Nat Genet
          <year>2011</year>
<volume>43</volume>
<issue>10</issue>
<fpage>977</fpage>
<lpage>83</lpage>
<pub-id pub-id-type="doi">10.1038/ng.943</pub-id>
<pub-id pub-id-type="pmid">21926972</pub-id>
</element-citation>
</ref>
<ref id="CR26">
<label>26</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Lee</surname>
<given-names>SH</given-names>
</name>
<name>
<surname>Ripke</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Neale</surname>
<given-names>BM</given-names>
</name>
<name>
<surname>Faraone</surname>
<given-names>SV</given-names>
</name>
<name>
<surname>Purcell</surname>
<given-names>SM</given-names>
</name>
<name>
<surname>Perlis</surname>
<given-names>RH</given-names>
</name>
<name>
<surname>Mowry</surname>
<given-names>BJ</given-names>
</name>
<name>
<surname>Thapar</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Goddard</surname>
<given-names>ME</given-names>
</name>
<name>
<surname>Witte</surname>
<given-names>JS</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Genetic relationship between five psychiatric disorders estimated from genome-wide snps</article-title>
<source/>Nat Genet
          <year>2013</year>
<volume>45</volume>
<issue>9</issue>
<fpage>984</fpage>
<lpage>94</lpage>
<pub-id pub-id-type="doi">10.1038/ng.2711</pub-id>
<pub-id pub-id-type="pmid">23933821</pub-id>
</element-citation>
</ref>
<ref id="CR27">
<label>27</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Fiorentino</surname>
<given-names>A</given-names>
</name>
<name>
<surname>O’brien</surname>
<given-names>NL</given-names>
</name>
<name>
<surname>Sharp</surname>
<given-names>SI</given-names>
</name>
<name>
<surname>Curtis</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Bass</surname>
<given-names>NJ</given-names>
</name>
<name>
<surname>McQuillin</surname>
<given-names>A</given-names>
</name>
</person-group>
<article-title>Genetic variation in the mir-708 gene and its binding targets in bipolar disorder</article-title>
<source/>Bipolar Disord
          <year>2016</year>
<volume>18</volume>
<issue>8</issue>
<fpage>650</fpage>
<lpage>6</lpage>
<pub-id pub-id-type="doi">10.1111/bdi.12448</pub-id>
<pub-id pub-id-type="pmid">27864917</pub-id>
</element-citation>
</ref>
<ref id="CR28">
<label>28</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Consortium</surname>
<given-names>WTCC</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Genome-wide association study of 14,000 cases of seven common diseases and 3000 shared controls</article-title>
<source/>Nature
          <year>2007</year>
<volume>447</volume>
<issue>7145</issue>
<fpage>661</fpage>
<lpage>78</lpage>
<pub-id pub-id-type="doi">10.1038/nature05911</pub-id>
<pub-id pub-id-type="pmid">17554300</pub-id>
</element-citation>
</ref>
<ref id="CR29">
<label>29</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Jiang</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Zhang</surname>
<given-names>H</given-names>
</name>
</person-group>
<article-title>Propensity score-based nonparametric test revealing genetic variants underlying bipolar disorder</article-title>
<source/>Genet Epidemiol
          <year>2011</year>
<volume>35</volume>
<issue>2</issue>
<fpage>125</fpage>
<lpage>32</lpage>
<pub-id pub-id-type="doi">10.1002/gepi.20558</pub-id>
<pub-id pub-id-type="pmid">21254220</pub-id>
</element-citation>
</ref>
<ref id="CR30">
<label>30</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Dizier</surname>
<given-names>MH</given-names>
</name>
<name>
<surname>Demenais</surname>
<given-names>F</given-names>
</name>
<name>
<surname>Mathieu</surname>
<given-names>F</given-names>
</name>
</person-group>
<article-title>Gain of power of the general regression model compared to cochran-armitage trend tests: simulation study and application to bipolar disorder:</article-title>
<source/>BMC Genet
          <year>2017</year>
<volume>18</volume>
<issue>1</issue>
<fpage>24</fpage>
<pub-id pub-id-type="doi">10.1186/s12863-017-0486-6</pub-id>
<pub-id pub-id-type="pmid">28283021</pub-id>
</element-citation>
</ref>
<ref id="CR31">
<label>31</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Gonzalez</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Gupta</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Villa</surname>
<given-names>E</given-names>
</name>
<name>
<surname>Mallawaarachchi</surname>
<given-names>I</given-names>
</name>
<name>
<surname>Rodriguez</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Ramirez</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Zavala</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Armas</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Dassori</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Contreras</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Replication of genome wide association study (gwas) susceptibility loci in a latino bipolar disorder cohort</article-title>
<source/>Bipolar Disord
          <year>2016</year>
<volume>18</volume>
<issue>6</issue>
<fpage>520</fpage>
<lpage>7</lpage>
<pub-id pub-id-type="doi">10.1111/bdi.12438</pub-id>
<pub-id pub-id-type="pmid">27759212</pub-id>
</element-citation>
</ref>
<ref id="CR32">
<label>32</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Genovese</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Wasserman</surname>
<given-names>L</given-names>
</name>
</person-group>
<article-title>Operating characteristics and extensions of the false discovery rate procedure</article-title>
<source/>J R Stat Soc Ser B Stat Methodol
          <year>2002</year>
<volume>64</volume>
<issue>3</issue>
<fpage>499</fpage>
<lpage>517</lpage>
<pub-id pub-id-type="doi">10.1111/1467-9868.00347</pub-id>
</element-citation>
</ref>
<ref id="CR33">
<label>33</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>White</surname>
<given-names>LB</given-names>
</name>
</person-group>
<article-title>Cartesian hidden markov models with applications</article-title>
<source/>IEEE Trans Sig Process
          <year>1992</year>
<volume>40</volume>
<issue>6</issue>
<fpage>1601</fpage>
<lpage>4</lpage>
<pub-id pub-id-type="doi">10.1109/78.139272</pub-id>
</element-citation>
</ref>
<ref id="CR34">
<label>34</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Sun</surname>
<given-names>W</given-names>
</name>
<name>
<surname>Cai</surname>
<given-names>TT</given-names>
</name>
</person-group>
<article-title>Oracle and adaptive compound decision rules for false discovery rate control</article-title>
<source/>J Am Stat Assoc
          <year>2007</year>
<volume>102</volume>
<issue>479</issue>
<fpage>901</fpage>
<lpage>12</lpage>
<pub-id pub-id-type="doi">10.1198/016214507000000545</pub-id>
</element-citation>
</ref>
<ref id="CR35">
<label>35</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Consortium</surname>
<given-names>TIH</given-names>
</name>
</person-group>
<article-title>The international hapmap project</article-title>
<source/>Nature
          <year>2003</year>
<volume>426</volume>
<fpage>789</fpage>
<lpage>96</lpage>
<pub-id pub-id-type="doi">10.1038/nature02168</pub-id>
<pub-id pub-id-type="pmid">14685227</pub-id>
</element-citation>
</ref>
</ref-list>
</back>
</article>
</pmc-articleset>