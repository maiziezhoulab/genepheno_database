<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">

<pmc-articleset><article article-type="research-article" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<?properties open_access?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">BMC Med Genomics</journal-id>
<journal-id journal-id-type="iso-abbrev">BMC Med Genomics</journal-id>
<journal-title-group>
<journal-title>BMC Medical Genomics</journal-title>
</journal-title-group>
<issn pub-type="epub">1755-8794</issn>
<publisher>
<publisher-name>BioMed Central</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="pmid">26399736</article-id>
<article-id pub-id-type="pmc">4582350</article-id>
<article-id pub-id-type="publisher-id">1755-8794-8-S3-S3</article-id>
<article-id pub-id-type="doi">10.1186/1755-8794-8-S3-S3</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Refining multivariate disease phenotypes for high chip heritability</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" id="A1">
<name>
<surname>Sun</surname>
<given-names>Jiangwen</given-names>
</name>
<xref ref-type="aff" rid="I1">1</xref>
</contrib>
<contrib contrib-type="author" id="A2">
<name>
<surname>Kranzler</surname>
<given-names>Henry R</given-names>
</name>
<xref ref-type="aff" rid="I2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" id="A3">
<name>
<surname>Bi</surname>
<given-names>Jinbo</given-names>
</name>
<xref ref-type="aff" rid="I1">1</xref>
<email>jinbo@engr.uconn.edu</email>
</contrib>
</contrib-group>
<aff id="I1"><label>1</label>Department of Computer Science and Engineering, University of Connecticut, 371 Fairfield Way, U-4155, Storrs, CT, 06269, USA</aff>
<aff id="I2"><label>2</label>Treatment Research Center, University of Pennsylvania Perelman School of Medicine, 3900 Chestnut Street Philadelphia, PA, 19104, USA</aff>
<pub-date pub-type="collection">
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>9</month>
<year>2015</year>
</pub-date>
<volume>8</volume>
<issue>Suppl 3</issue>
<supplement>
<named-content content-type="supplement-title">Selected articles from the IEEE International Conference on Bioinformatics and Biomedicine (BIBM 2014): Medical Genomics</named-content>
<named-content content-type="supplement-editor">Feng Luo</named-content>
<named-content content-type="supplement-sponsor">Publication of this supplement has not been supported by sponsorship. Information about the source of funding for the publication charges can be found in the individual articles. Articles have undergone the journal's standard peer review process for supplements. The Supplement Editor declares that they have no competing interests.</named-content>
</supplement>
<fpage>S3</fpage>
<lpage>S3</lpage>
<permissions>
<copyright-statement>Copyright © 2015 Sun et al.;</copyright-statement>
<copyright-year>2015</copyright-year>
<copyright-holder>Sun et al.;</copyright-holder>
<license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0">
<license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0">http://creativecommons.org/licenses/by/4.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
</license>
</permissions>
<self-uri xlink:href="http://www.biomedcentral.com/1755-8794/8/S3/S3"></self-uri>
<abstract>
<sec>
<title>Background</title>
<p>Statistical genetics shows that the success of both genetic association studies and genomic prediction methods is positively associated with the heritability of the trait used in the analysis. Identifying highly heritable components of a complex disease can thus enhance genetic studies of the disease. Existing heritable component analysis methods use data from related individuals to compute linearly-combined traits to maximize heritability. Recent advances in acquiring genome-wide markers have enhanced heritability estimation using genotypic data from apparently unrelated individuals, which is referred to as the chip heritability. Novel statistical models are thus needed to identify disease components (subtypes) with high chip heritability.</p>
</sec>
<sec>
<title>Methods</title>
<p>We propose an optimization approach to identify highly heritable components of a complex disease as a function of multiple clinical variables. The heritability of the components is estimated directly from unrelated individuals using their genome-wide single nucleotide polymorphisms. The proposed approach can also model the fixed effects due to covariates, such as age and race, so that the derived traits have high chip heritability after correcting for fixed effects. A new sequential quadratic programming algorithm is developed to efficiently solve the proposed optimization problem.</p>
</sec>
<sec>
<title>Results</title>
<p>The proposed algorithm was validated both in simulations and the analysis of a real-world dataset that was aggregated from genetic studies of cocaine, opoid, and alcohol dependence. Simulation studies demonstrated that the proposed approach could identify the hypothesized component from multiple synthesized features. A case study on cocaine dependence (CD) identified a quantitative trait that achieved chip heritability of 0.86 estimated using a cross-validation process. This quantitative trait corresponded to the likelihood of an individual's membership in a CD subtype. Clinical analysis showed that the subtype enclosed individuals who reported heavy use of cocaine but few withdrawal symptoms.</p>
</sec>
<sec>
<title>Conclusions</title>
<p>Extensive experiments on both synthetic and real-world data demonstrate the effectiveness of the proposed approach as a means to find meaningful disease components with high chip heritability.</p>
</sec>
</abstract>
<kwd-group>
<kwd>phenotype-genotype association analysis</kwd>
<kwd>chip heritability</kwd>
<kwd>quadratic optimization</kwd>
<kwd>heritable component analysis</kwd>
</kwd-group>
<conference>
<conf-date>2-5 November 2014</conf-date>
<conf-name>IEEE International Conference on Bioinformatics and Biomedicine (BIBM 2014)</conf-name>
<conf-loc>Belfast, UK</conf-loc>
</conference>
</article-meta>
</front>
<body>
<sec sec-type="intro">
<title>Introduction</title>
<p>Identifying genetic variation that underlies complex diseases has important implications in medicine. To date, genome-wide association studies (GWAS) have had limited success in dissecting the genetic etiology of complex diseases. For instance, very few associations identified for substance use disorders at a genome-wide significant level have been replicated [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>]. Complex disorders are often characterized by multiple disease indicators. For example, to diagnose whether a patient has a lifetime drug dependence disorder, clinicians interview the patient to understand his or her drug use behaviors, the negative consequences of the drug use, the treatment history and other co-occuring medical conditions. All of these clinical variables are used to arrive at a diagnosis of dependence on a certain drug [<xref ref-type="bibr" rid="B4">4</xref>]. There is substantial variation in these variables in the disease population, and these variables also present different levels of heritability, i.e., some are more genetically influenced than others. This phenotypic heterogeneity diminishes evidence of genetic association. Statistical genetics also shows that the success of most gene discovery studies is positively associated with the heritability of the trait used in the association analysis [<xref ref-type="bibr" rid="B5">5</xref>]. Hence, identifying more homogeneous and highly heritable components of a complex disease could enhance the association analysis.</p>
<p>The ability to translate genotype information into a quantitative prediction of disease phenotypes is important for precision medicine [<xref ref-type="bibr" rid="B6">6</xref>]. Genomic prediction methods that predict a phenotype based on genome-wide single nucleotide polymorphisms (SNPs) may provide a suitable analytic tool [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. These methods expand the traditional single-marker-regression-based GWAS model for detecting few variants of large effect to multi-marker predictive models with many variants of small effect. The predictive ability of genomic prediction methods relies on several factors, especially trait heritability [<xref ref-type="bibr" rid="B9">9</xref>]. If we identify higly heritable components of a complex disease, it could also improve the utility of genomic prediction methods to predict subtypes (defined by the components) of the disease.</p>
<p>Because the success of both association analysis and genomic prediction is dependent on the trait heritability, heritability can be a valid target for refining multivariate disease phenotypes. The narrow-sense heritability <italic>h</italic><sup>2 </sup>is defined by the percentage of phenotypic variance that is due to additive genetic effects [<xref ref-type="bibr" rid="B10">10</xref>]. The broad-sense heritability <italic>H</italic><sup>2 </sup>is defined as the overall genetic contribution to the phenotypic variation. The heritability of a quantitative trait is commonly estimated from related individuals in pedigrees. Recent advances in acquiring dense genome-wide genetic markers have enhanced heritability estimation from apparently unrelated individuals using their genome-wide SNPs. The SNP-based heritability, often referred to as the chip heritability, is defined as the portion of the phenotypic variation that can be explained by the genotyped genetic markers [<xref ref-type="bibr" rid="B11">11</xref>]. It has been argued that estimating <italic>h</italic><sup>2 </sup>from unrelated individuals has an advantage over traditional pedigree-based methods because the estimated chip <italic>h</italic><sup>2 </sup>corresponds only to the causal-variant heritability that is tagged by the genotyped SNPs [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B12">12</xref>].</p>
<p>Phenotype refinement is an important but underdeveloped genetics research area. Unsupervised cluster analysis or latent class analysis has been commonly used to partition a study population into subgroups based on clinical variables [<xref ref-type="bibr" rid="B13">13</xref>-<xref ref-type="bibr" rid="B18">18</xref>]. This approach can create subgroups of individuals that differ in clinical symptoms and features, but may have limited utility in genetic analysis. Because genetic data are not used during the creation of the subgroups, the resultant subtypes (subgroups) are not guaranteed to have high heritability, and hence may not be informative for genetic association.</p>
<p>More relevant to this present work, a number of prior methods identify the principal components of clinical data that are heritable, and characterize the components by linear combinations of clinical variables [<xref ref-type="bibr" rid="B19">19</xref>-<xref ref-type="bibr" rid="B23">23</xref>]. Thus, these methods are often called heritable component analysis. All existing methods decompose the variance of clinical data into two components: the variance due to additive genetic effects estimated from pedigrees; and the variance due to other effects (residuals). Then, they solve a generalized eigen-decomposition problem to identify the linear combination of the clinical variables that maximizes the ratio of additive-genetic variance versus the residual variance, thus leading to high heritability of the resultant linearly combined trait. Nearly all of these methods use pedigree-based heritability estimation (an exception is [<xref ref-type="bibr" rid="B23">23</xref>]), and all assume a genetic model that is based on a single causal variant, an assumption that is commonly violated for complex diseases.</p>
<p>Although the latest heritable component analysis method [<xref ref-type="bibr" rid="B23">23</xref>] is effective and computationally efficient, a fundamental question is how much heritability of the derived trait can be explained by the genotyped SNPs. Because GWAS and genomic predictions mainly utilize the genotyped SNPs, the utility of the derived trait may be limited by a low chip heritability. Thus, novel statistical models are needed to directly target high chip heritability. In this paper, we propose an approach to identify the components of a multivariate disease phenotype that maximizes the chip <italic>h</italic><sup>2</sup>. To estimate the chip heritability of a given trait, the latest methods use the restricted maximum likelihood (REML) method, which assumes that the trait follows a mixed effect model with random genetic effects, and fixed effects due to covariates, such as age, sex and race [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B12">12</xref>]. To identify a trait of high chip <italic>h</italic><sup>2</sup>, we need to solve the inverse problem of (chip) heritability estimation. In other words, we now search for a trait (e.g., a linearly-combined trait) so that its chip heritability is high when estimated using the REML method. Directly solving the inverse problem leads to a quadratic optimization problem that can be optimized efficiently via a sequential quadratic programming algorithm. We validated the proposed approach in simulations as well as in the analysis of a real-world dataset that was aggregated from genetic studies of cocaine, opioid, and alcohol dependence. Our experimental results demonstrated the effectiveness and generalizability of the proposed approach.</p>
</sec>
<sec sec-type="methods">
<title>Methods</title>
<sec>
<title>The proposed statistical model</title>
<p>Given a set of <italic>n </italic>subjects, we denote their trait values of a quantitative trait <italic>y </italic>by a vector <bold>y </bold>of length <italic>n</italic>. We use a matrix <bold>Z</bold><italic><sub>n×m </sub></italic>to represent their standardized genotypic data at <italic>m </italic>genetic markers, and <bold>C</bold><italic><sub>n×p </sub></italic>to represent their data on <italic>p </italic>covariates. The matrix <bold>Z </bold>is calculated from the genotypic data as follows. Let <italic>f<sub>j </sub></italic>be the frequency of reference allele at the <italic>j</italic>-th genetic variant, <italic>r<sub>ij </sub></italic>be the number of copies of reference allele that the <italic>i</italic>-th subject has at the <italic>j</italic>-th locus. The standardized geno-type <italic>z<sub>ij </sub></italic>is calculated as <inline-formula><mml:math id="M1" name="1755-8794-8-S3-S3-i1" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-bin">-</mml:mo><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">1</mml:mtext></mml:mstyle><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>[<xref ref-type="bibr" rid="B8">8</xref>]. The chip heritability estimation method assumes the following mixed-effect linear model [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B12">12</xref>] that characterizes how a phenotype is related to genotypes and covariates:</p>
<p>
<disp-formula id="bmcM1">
<label>(1)</label>
<mml:math id="M2" name="1755-8794-8-S3-S3-i2" overflow="scroll">
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>y</mml:mi>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mi>C</mml:mi>
</mml:mstyle>
<mml:mi>β</mml:mi>
<mml:mstyle mathvariant="bold">
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mi>Z</mml:mi>
<mml:mi>u</mml:mi>
<mml:mo class="MathClass-bin">+</mml:mo>
</mml:mstyle>
<mml:mi>ε</mml:mi>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>where <bold><italic>ε </italic></bold>is a vector of length <italic>n</italic>, which specifies residual effects. In Eq.(1), all covariates create fixed effects (fixed <bold><italic>β</italic></bold>) on the phenotype whereas genetic effects are random (random <bold>u</bold>). Assume that <bold>u </bold>and <bold><italic>ε </italic></bold>follow Gaussian distributions: <bold>u </bold>~ <italic>N </italic>(<bold>0</bold>, <bold>I<inline-formula><mml:math id="M3" name="1755-8794-8-S3-S3-i3" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></bold>) and <italic><bold>ε </bold>~ N </italic>(<bold>0</bold>, <bold>I<inline-formula><mml:math id="M4" name="1755-8794-8-S3-S3-i4" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula></bold>). Then, the covariance of <bold>y </bold>between individuals, denoted by <bold>Ω</bold><italic><sub>n×n</sub></italic>, can be calculated as:</p>
<p>
<disp-formula id="bmcM2">
<label>(2)</label>
<mml:math id="M5" name="1755-8794-8-S3-S3-i5" overflow="scroll">
<mml:mrow>
<mml:mtext>Ω</mml:mtext>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">Z</mml:mtext>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">Z</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>u</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">I</mml:mtext>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>Let <inline-formula><mml:math id="M6" name="1755-8794-8-S3-S3-i6" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> be the phenotypic variance attributable to all of the <italic>m </italic>genetic causal variants. Then, we have <inline-formula><mml:math id="M7" name="1755-8794-8-S3-S3-i7" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mi>m</mml:mi><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Let <bold>G </bold>= <bold>ZZ</bold><italic><sup>T </sup>/m</italic>, which is referred to as the genetic relationship matrix (GRM) among subjects determined by the causal variants. Then Eq. (2) can be re-written as:</p>
<p>
<disp-formula id="bmcM3">
<label>(3)</label>
<mml:math id="M8" name="1755-8794-8-S3-S3-i8" overflow="scroll">
<mml:mrow>
<mml:mtext>Ω</mml:mtext>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mstyle mathvariant="bold">
<mml:mi>G</mml:mi>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext>
</mml:mstyle>
</mml:mrow>
</mml:msup>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mstyle mathvariant="bold">
<mml:mi>I</mml:mi>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>where<inline-formula><mml:math id="M9" name="1755-8794-8-S3-S3-i9" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and<inline-formula><mml:math id="M10" name="1755-8794-8-S3-S3-i10" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> can be estimated by the REML method [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B11">11</xref>]. The chip her-itability estimated on the <italic>m </italic>causal variants is computed as<inline-formula><mml:math id="M11" name="1755-8794-8-S3-S3-i11" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="MathClass-rel">=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="MathClass-bin">/</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M12" name="1755-8794-8-S3-S3-i12" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="MathClass-rel">=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo class="MathClass-bin">+</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is the total phenotypic variance. Because the causal variants of <italic>y </italic>are usually unknown for a trait, recent research has proposed to estimate a GRM using genome-wide SNPs [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B12">12</xref>].</p>
<p>The main idea of REML for estimating the variance components is to first eliminate the fixed effect due to covariates from the observed values of <italic>y </italic>and then estimate the variance components from the random effect part. The REML finds <italic>n </italic>basis vectors represented by columns of a matrix <bold>L</bold><italic><sub>n×n</sub></italic>. This matrix has two sub-matrices <bold>L </bold>= [<bold>L</bold><sub>1 </sub><bold>L</bold><sub>2</sub>] with <bold>L</bold><sub>1 </sub>of size <italic>n × p </italic>and <bold>L</bold><sub>2 </sub>of size <italic>n × </italic>(<italic>n − p</italic>). The two sub-matrices satisfy <inline-formula><mml:math id="M13" name="1755-8794-8-S3-S3-i13" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>L</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>I</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo class="MathClass-bin">×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="M14" name="1755-8794-8-S3-S3-i14" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>L</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. Let<inline-formula><mml:math id="M15" name="1755-8794-8-S3-S3-i15" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">y</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">˜</mml:mo></mml:mover><mml:mo class="MathClass-rel">=</mml:mo><mml:msup><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">L</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">y</mml:mtext></mml:mstyle></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="M16" name="1755-8794-8-S3-S3-i16" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:msubsup><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">L</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">y</mml:mtext></mml:mstyle></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M17" name="1755-8794-8-S3-S3-i17" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>Ỹ</mml:mi></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>L</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula>. It can be derived that <bold>ỹ</bold> follows the following multivariate Gaussian distribution given the multivariate Gaussian assumption of <bold>y</bold>:</p>
<p>
<disp-formula>
<mml:math id="M18" name="1755-8794-8-S3-S3-i18" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mfenced close="]" open="[">
<mml:mrow>
<mml:mtable class="gathered">
<mml:mtr>
<mml:mtd>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:mfenced>
<mml:mo class="MathClass-rel">~</mml:mo>
<mml:mi>N</mml:mi>
<mml:mfenced open="(">
<mml:mrow>
<mml:mfenced close="]" open="[">
<mml:mrow>
<mml:mtable class="gathered">
<mml:mtr>
<mml:mtd>
<mml:mi>β</mml:mi>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mn>0</mml:mn>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:mfenced>
</mml:mrow>
</mml:mfenced>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:mfenced close=")">
<mml:mrow>
<mml:mfenced open="[">
<mml:mrow>
<mml:mtable class="gathered">
<mml:mtr>
<mml:mtd>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:mfenced>
<mml:mfenced close="]">
<mml:mrow>
<mml:mtable class="gathered">
<mml:mtr>
<mml:mtd>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:msubsup>
<mml:mrow>
<mml:mi>L</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:mfenced>
</mml:mrow>
</mml:mfenced>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>We have <inline-formula><mml:math id="M19" name="1755-8794-8-S3-S3-i19" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-rel">~</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mn>0</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:msubsup><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">L</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mtext>Ω</mml:mtext><mml:msub><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">L</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:math></inline-formula> and the conditional distribution:</p>
<p>
<disp-formula>
<mml:math id="M20" name="1755-8794-8-S3-S3-i20" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">~</mml:mo>
<mml:mi>N</mml:mi>
<mml:mfenced close=")" open="(">
<mml:mrow>
<mml:mi>β</mml:mi>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mtext>Ω</mml:mtext>
<mml:mi>C</mml:mi>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:mfenced>
<mml:mi>.</mml:mi>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>Then, the log likelihood of <bold>ỹ</bold> can be decomposed into:</p>
<p>
<disp-formula>
<mml:math id="M21" name="1755-8794-8-S3-S3-i21" overflow="scroll">
<mml:mrow>
<mml:mi>ℓ</mml:mi>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">;</mml:mo>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ℓ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">;</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>ℓ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">;</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>Where ℓ<sub>2 </sub>is not a function of the fixed-effect parameter <bold><italic>β</italic></bold>. The two variance components, i.e.,<inline-formula><mml:math id="M22" name="1755-8794-8-S3-S3-i22" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and<inline-formula><mml:math id="M23" name="1755-8794-8-S3-S3-i23" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> can be estimated by maximizing <italic>l</italic><sub>2</sub>, and there is no additional information in ℓ<sub>1 </sub>for estimating the variance components. Once <inline-formula><mml:math id="M24" name="1755-8794-8-S3-S3-i24" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M25" name="1755-8794-8-S3-S3-i25" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are estimated, a generalized least squares estimate of <bold><italic>β </italic></bold>can be obtained as:</p>
<p>
<disp-formula>
<mml:math id="M26" name="1755-8794-8-S3-S3-i26" overflow="scroll">
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mi>β</mml:mi>
</mml:mrow>
<mml:mo class="MathClass-op">^</mml:mo>
</mml:mover>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">1</mml:mtext>
</mml:mstyle>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mi>.</mml:mi>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>The second log likelihood component <italic>ℓ</italic><sub>2 </sub>is calculated as (after removing constant):</p>
<p>
<disp-formula>
<mml:math id="M27" name="1755-8794-8-S3-S3-i27" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ℓ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">;</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">ln</mml:mtext>
</mml:mstyle>
<mml:mo>|</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mspace class="tmspace" width="2.36043pt"></mml:mspace>
<mml:msubsup>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mi>.</mml:mi>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>It has been shown in an early work [<xref ref-type="bibr" rid="B25">25</xref>] that when <inline-formula><mml:math id="M28" name="1755-8794-8-S3-S3-i28" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>L</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>I</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo class="MathClass-bin">×</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M29" name="1755-8794-8-S3-S3-i29" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>L</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we have</p>
<p>
<disp-formula>
<mml:math id="M30" name="1755-8794-8-S3-S3-i30" overflow="scroll">
<mml:mrow>
<mml:mtext>Ω</mml:mtext>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:msub>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msubsup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">L</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mtext>Ω</mml:mtext>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mtext>Ω</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>Substituting these equations into the calculation of ℓ<sub>2 </sub>yields:</p>
<p>
<disp-formula id="bmcM4">
<label>(4)</label>
<mml:math id="M31" name="1755-8794-8-S3-S3-i31" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>ℓ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:msubsup>
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>e</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-punc">;</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">ln</mml:mtext>
</mml:mstyle>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:mtext>Ω</mml:mtext>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">ln</mml:mtext>
</mml:mstyle>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mtext>Ω</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">y</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">˜</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>P</mml:mi>
<mml:mi>y</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>where <inline-formula><mml:math id="M32" name="1755-8794-8-S3-S3-i32" overflow="scroll"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>P</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:msup><mml:mrow><mml:mtext>Ω</mml:mtext></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo class="MathClass-bin">-</mml:mo><mml:msup><mml:mrow><mml:mtext>Ω</mml:mtext></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:msup><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mtext>Ω</mml:mtext></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mtext>Ω</mml:mtext></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <bold><italic>β </italic></bold>can be obtained by:</p>
<p>
<disp-formula id="bmcM5">
<label>(5)</label>
<mml:math id="M33" name="1755-8794-8-S3-S3-i33" overflow="scroll">
<mml:mrow>
<mml:mi>β</mml:mi>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mtext>Ω</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mtext>Ω</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>y</mml:mi>
</mml:mstyle>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>Given data on <bold>y</bold>, <bold>C </bold>and <bold>Z</bold>, <inline-formula><mml:math id="M34" name="1755-8794-8-S3-S3-i34" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M35" name="1755-8794-8-S3-S3-i35" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are obtained by maximizing the log like-lihood of observing the trait values <inline-formula><mml:math id="M36" name="1755-8794-8-S3-S3-i36" overflow="scroll"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">;</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> which corresponds to maximizing <inline-formula><mml:math id="M37" name="1755-8794-8-S3-S3-i37" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">y</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>[<xref ref-type="bibr" rid="B11">11</xref>]. The chip heritability of a trait <italic>y </italic>is computed using the resultant optimal <inline-formula><mml:math id="M38" name="1755-8794-8-S3-S3-i38" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M39" name="1755-8794-8-S3-S3-i39" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
<p>In our study, however, we solve the inverse problem of the above estimation model. A definitive quantitative trait <italic>y </italic>is not known beforehand but needs to be derived from a set of known clinical variables. Let <bold>X</bold><italic><sub>n×d </sub></italic>be the data matrix of <italic>d </italic>clinical variables <bold>x </bold>for the same <italic>n </italic>subjects as in <bold>Z</bold>. A trait <italic>y </italic>is defined by a linear function of <italic>y </italic>= <bold>w<sup>┬</sup>x </bold>where <bold>w </bold>is the vector of combination coefficients. Correspondingly, the trait values <bold>y </bold>= <bold>Xw</bold>. Unlike the heritability estimation process that finds the best values of <inline-formula><mml:math id="M40" name="1755-8794-8-S3-S3-i40" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M41" name="1755-8794-8-S3-S3-i41" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to maximize the likelihood of observing the values of <italic>y</italic>, the inverse problem searches for the best <bold>w </bold>so to form a trait <bold>y </bold>that maximizes the likelihood, (or equivalently the log likelihood <inline-formula><mml:math id="M42" name="1755-8794-8-S3-S3-i42" overflow="scroll"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">;</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle><mml:mo class="MathClass-punc">,</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mo class="MathClass-punc">,</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>Z</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>), of observing a large heritability, i.e., a large <inline-formula><mml:math id="M43" name="1755-8794-8-S3-S3-i43" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> but small <inline-formula><mml:math id="M44" name="1755-8794-8-S3-S3-i44" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. For simplicity and easy interpretation of the resultant model, here we only consider linear models, but the proposed method can be easily extended to construct non-linear models through kernel mapping [<xref ref-type="bibr" rid="B26">26</xref>].</p>
<p>Notice that the highest possible heritability of a trait <italic>y </italic>is 1 when <inline-formula><mml:math id="M45" name="1755-8794-8-S3-S3-i45" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M46" name="1755-8794-8-S3-S3-i46" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We hence propose to formulate an optimization problem, in which we search for the optimal <bold>w </bold>that maximizes the log likelihood <inline-formula><mml:math id="M47" name="1755-8794-8-S3-S3-i47" overflow="scroll"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">;</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle><mml:mo class="MathClass-punc">,</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mo class="MathClass-punc">,</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>Z</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> (or equivalently, <inline-formula><mml:math id="M48" name="1755-8794-8-S3-S3-i48" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">,</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-punc">;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">y</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-punc">,</mml:mo></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>) of observing <inline-formula><mml:math id="M49" name="1755-8794-8-S3-S3-i49" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M50" name="1755-8794-8-S3-S3-i50" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. According to Eq.(3), the covariance matrix <bold>Ω </bold>= <bold>G </bold>when <inline-formula><mml:math id="M51" name="1755-8794-8-S3-S3-i51" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M52" name="1755-8794-8-S3-S3-i52" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We substitute the values of these parameters into the log likelihood Eq.(4), and remove any constant terms. The resultant maximization problem is equivalent to the following minimization problem:</p>
<p>
<disp-formula id="bmcM6">
<label>(6)</label>
<mml:math id="M53" name="1755-8794-8-S3-S3-i53" overflow="scroll">
<mml:mrow>
<mml:munder class="msub">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">min</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>W</mml:mi>
</mml:mstyle>
</mml:mrow>
</mml:munder>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>P</mml:mi>
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>where <bold>P </bold>is calculated as:</p>
<p>
<disp-formula id="bmcM7">
<label>(7)</label>
<mml:math id="M54" name="1755-8794-8-S3-S3-i54" overflow="scroll">
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>P</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>G</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>G</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>G</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>C</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>G</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mi>.</mml:mi>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>When <inline-formula><mml:math id="M55" name="1755-8794-8-S3-S3-i55" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M56" name="1755-8794-8-S3-S3-i56" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, we have <inline-formula><mml:math id="M57" name="1755-8794-8-S3-S3-i57" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> because <inline-formula><mml:math id="M58" name="1755-8794-8-S3-S3-i58" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-bin">+</mml:mo><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> This requires to impose a constraint to the optimization problem so that the total phenotypic variance that is due to either genetic or environmental effect should be scaled to1. An estimate of <inline-formula><mml:math id="M59" name="1755-8794-8-S3-S3-i59" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> can be obtained by calculating the sample variance after correcting for the covariate effects as <inline-formula><mml:math id="M60" name="1755-8794-8-S3-S3-i60" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-bin">-</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>β</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-bin">-</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>β</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Since <bold><italic>β </italic></bold>can be estimated according to Eq.(5), by substituting the <bold><italic>β </italic></bold>value, <inline-formula><mml:math id="M61" name="1755-8794-8-S3-S3-i61" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> can be computed by</p>
<p>
<disp-formula>
<mml:math id="M62" name="1755-8794-8-S3-S3-i62" overflow="scroll">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mo class="MathClass-op">^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">(</mml:mtext>
</mml:mstyle>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>J</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>J</mml:mi>
</mml:mstyle>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">)</mml:mtext>
</mml:mstyle>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>where <inline-formula><mml:math id="M63" name="1755-8794-8-S3-S3-i63" overflow="scroll"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>J</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>I</mml:mi></mml:mstyle><mml:mo class="MathClass-bin">-</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:msup><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mtext>Ω</mml:mtext></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mtext>Ω</mml:mtext></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. To further simplify the notation, denote</p>
<p>
<disp-formula id="bmcM8">
<label>(8)</label>
<mml:math id="M64" name="1755-8794-8-S3-S3-i64" overflow="scroll">
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>Q</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>J</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>J</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>Then</p>
<p>
<disp-formula>
<mml:math id="M65" name="1755-8794-8-S3-S3-i65" overflow="scroll">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mi>σ</mml:mi>
</mml:mrow>
<mml:mo class="MathClass-op">^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>p</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>Q</mml:mi>
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
<mml:mi>.</mml:mi>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>Combining the objective function and the constraint together, the proposed optimization problem is formulated as:</p>
<p>
<disp-formula id="bmcM9">
<label>(9)</label>
<mml:math id="M66" name="1755-8794-8-S3-S3-i66" overflow="scroll">
<mml:mrow>
<mml:mtable class="array" columnlines="none" equalcolumns="false" equalrows="false">
<mml:mtr>
<mml:mtd class="array" columnalign="center">
<mml:munder class="msub">
<mml:mrow>
<mml:mtext class="textsf" mathvariant="sans-serif">min</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
</mml:munder>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>P</mml:mi>
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd class="array" columnalign="center">
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">subject</mml:mtext>
</mml:mstyle>
<mml:mspace class="thinspace" width="0.3em"></mml:mspace>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">to</mml:mtext>
</mml:mstyle>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>Q</mml:mi>
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mn>1</mml:mn>
<mml:mi>.</mml:mi>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>According to statistical learning theory [<xref ref-type="bibr" rid="B26">26</xref>], only maximizing the training heritability (by minimizing Eq.(9)), the resultant model may overfit the training data <bold>X</bold>. If overfitting occurs, the optimal <bold>w </bold>of Eq.(9) may correspond to a trait that has high heritability on the data that is used to train the linear model, but when the model is applied to a new sample, the trait has low heritability. In order to prevent overfitting and identify a trait with high heritability that can generalize, we incorporate a regularizer <italic>R</italic>(<bold>w</bold>) in our formulation (9). The optimization problem becomes:</p>
<p>
<disp-formula id="bmcM10">
<label>(10)</label>
<mml:math id="M67" name="1755-8794-8-S3-S3-i67" overflow="scroll">
<mml:mrow>
<mml:mtable class="array" columnlines="none" equalcolumns="false" equalrows="false">
<mml:mtr>
<mml:mtd class="array" columnalign="left">
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:mspace class="thinspace" width="0.3em"></mml:mspace>
<mml:munder class="msub">
<mml:mrow>
<mml:mtext class="textsf" mathvariant="sans-serif">min</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
</mml:munder>
</mml:mtd>
<mml:mtd class="array" columnalign="left">
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>P</mml:mi>
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mi>R</mml:mi>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd class="array" columnalign="left">
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">subject to</mml:mtext>
</mml:mstyle>
</mml:mtd>
<mml:mtd class="array" columnalign="left">
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>Q</mml:mi>
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>where <italic>λ </italic>is a hyper-parameter and needs to be tuned, and <inline-formula><mml:math id="M68" name="1755-8794-8-S3-S3-i68" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>and <inline-formula><mml:math id="M69" name="1755-8794-8-S3-S3-i69" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>are included to pre-balance the two items in the objective function. The value of <italic>λ </italic>can either be chosen by users according to domain knowledge or determined using a crossvalidation process as done in our experiments. According to learning theory [<xref ref-type="bibr" rid="B26">26</xref>], minimizing <inline-formula><mml:math id="M70" name="1755-8794-8-S3-S3-i70" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>P</mml:mi><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula> corresponds to empirical risk minimization, whereas minimizing the objective in Eq.(10) corresponds to structural risk minimization that improves the generalizability of the resultant model. There are many different ways to define <italic>R</italic>(<bold>w</bold>) [<xref ref-type="bibr" rid="B23">23</xref>]. The <italic>L</italic><sub>2 </sub>vector norm defined by <inline-formula><mml:math id="M71" name="1755-8794-8-S3-S3-i71" overflow="scroll"><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">|</mml:mo><mml:msubsup><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-rel">=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is a common choice. The <italic>L</italic><sub>1 </sub>vector norm defined by <inline-formula><mml:math id="M72" name="1755-8794-8-S3-S3-i72" overflow="scroll"><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">|</mml:mo><mml:msub><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:msub><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">|</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow></mml:math></inline-formula> can be a better choice when model sparsity is required to select variables for use in the model. In more complicated applications where variables may be grouped and feature selection among groups is expected, a structured regularizer, such as the group lasso <inline-formula><mml:math id="M73" name="1755-8794-8-S3-S3-i73" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:munderover><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:math></inline-formula>, can be used where <inline-formula><mml:math id="M74" name="1755-8794-8-S3-S3-i74" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> contains the indices of variables belonging to a group <italic>k</italic>.</p>
</sec>
<sec>
<title>Optimization algorithm</title>
<p>In this paper, we use the <italic>L</italic><sub>1 </sub>norm penalty <inline-formula><mml:math id="M75" name="1755-8794-8-S3-S3-i75" overflow="scroll"><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">|</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">|</mml:mo><mml:msub><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to be <italic>R</italic>(<bold>w</bold>), and develop an efficient algorithm to solve the resultant optimization problem as follows:</p>
<p>
<disp-formula id="bmcM11">
<label>(11)</label>
<mml:math id="M76" name="1755-8794-8-S3-S3-i76" overflow="scroll">
<mml:mrow>
<mml:mtable class="array" columnlines="none" equalcolumns="false" equalrows="false">
<mml:mtr>
<mml:mtd class="array" columnalign="left">
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:mspace class="tmspace" width="2.36043pt"></mml:mspace>
<mml:munder class="msub">
<mml:mrow>
<mml:mtext class="textsf" mathvariant="sans-serif">min</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
</mml:munder>
</mml:mtd>
<mml:mtd class="array" columnalign="left">
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>P</mml:mi>
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif"> + </mml:mtext>
</mml:mstyle>
<mml:mfrac>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-rel">|</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mo class="MathClass-rel">|</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd class="array" columnalign="left">
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif"> subject</mml:mtext>
</mml:mstyle>
<mml:mspace class="thinspace" width="0.3em"></mml:mspace>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">to</mml:mtext>
</mml:mstyle>
</mml:mtd>
<mml:mtd class="array" columnalign="left">
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>Q</mml:mi>
<mml:mi>X</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>w</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mn>1</mml:mn>
<mml:mi>.</mml:mi>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>The algorithm we will describe next, although is designed for Problem (11), can be modified to solve Problem (10) that may take another form of the regularizers.</p>
<p>Due to the use of the <inline-formula><mml:math id="M77" name="1755-8794-8-S3-S3-i77" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> norm, the objective function in Problem (11) is not continuously differentiable and a gradient decent type of approach cannot be applied directly. A well known strategy to overcome this obstacle is to decompose <bold>w </bold>into two parts: <bold>w </bold>= <bold>u </bold><italic>− </italic><bold>v</bold>, where both <bold>u </bold>and <bold>v </bold>are vectors of the same size as that of <bold>w</bold>, and all the components in <bold>u </bold>and <bold>v </bold>are required to be non-negative (i.e., <bold>u </bold><italic>≥ </italic>0, and <bold>v </bold><italic>≥ </italic>0). Because<inline-formula><mml:math id="M78" name="1755-8794-8-S3-S3-i78" overflow="scroll"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi><mml:mi>w</mml:mi></mml:mstyle><mml:mo class="MathClass-rel">=</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi><mml:mi>u</mml:mi></mml:mstyle><mml:mo class="MathClass-bin">-</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>X</mml:mi><mml:mi>v</mml:mi></mml:mstyle></mml:mrow></mml:math></inline-formula>, we denote <bold><italic>γ </italic></bold>= [<bold>u</bold><italic><sup>T </sup></italic>, <bold>v</bold><italic><sup>T </sup></italic>]<italic><sup>T </sup></italic>, <bold>H </bold>= [<bold>X</bold><italic>, −</italic><bold>X</bold>], and then we have <bold>Xw </bold>= <bold>H<italic>γ</italic></bold>. By the change of variables, Problem (11) can be equivalently re-written as:</p>
<p>
<disp-formula id="bmcM12">
<label>(12)</label>
<mml:math id="M79" name="1755-8794-8-S3-S3-i79" overflow="scroll">
<mml:mrow>
<mml:mtable class="aligned">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:munder class="msub">
<mml:mrow>
<mml:mtext class="textsf" mathvariant="sans-serif">min</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="bold">γ</mml:mi>
</mml:mrow>
</mml:munder>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:mi>f</mml:mi>
<mml:mo class="MathClass-rel">:</mml:mo>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">H</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mi mathvariant="bold">P</mml:mi>
<mml:mi mathvariant="bold">H</mml:mi>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mi mathvariant="bold">γ</mml:mi>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:munderover accent="false" accentunder="false">
<mml:mrow>
<mml:mo> ∑</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:munderover>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mtd>
<mml:mtd columnalign="right"></mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">subject to </mml:mtext>
</mml:mstyle>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">:</mml:mo>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:msup>
<mml:mrow>
<mml:mi mathvariant="bold">γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">H</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">QH</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mi mathvariant="bold">γ</mml:mi>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right">
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mo class="MathClass-rel">:</mml:mo>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">:</mml:mo>
</mml:mtd>
<mml:mtd columnalign="left">
<mml:mi mathvariant="bold">γ</mml:mi>
<mml:mo class="MathClass-rel">≥</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd columnalign="right"></mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>where <italic>f </italic>denotes the objective function, <italic>g</italic>'s denote the constraints, and <italic>e </italic>= 2<italic>d </italic>+ 1, indicating the number of constraints in that group. It is straightforward to show that Eq.(12) is equivalent to Eq.(11) in the sense that at optimality <bold>w </bold>= <bold>u </bold><italic>− </italic><bold>v </bold>=<bold><italic>γ</italic></bold>(1 : <italic>d</italic>) <italic>− <bold>γ</bold></italic>(<italic>d </italic>+ 1 : 2<italic>d</italic>). When Eq.(12) reaches optimality, at least one of the two components <italic>u<sub>i </sub></italic>and <italic>v<sub>i </sub></italic>at ny <italic>i</italic>-th position of the two vectors will be 0. Otherwise, by setting <inline-formula><mml:math id="M80" name="1755-8794-8-S3-S3-i80" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M81" name="1755-8794-8-S3-S3-i81" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ṽ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> if <italic>u<sub>i </sub>≥ v<sub>i</sub></italic>, or <inline-formula><mml:math id="M82" name="1755-8794-8-S3-S3-i82" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M83" name="1755-8794-8-S3-S3-i83" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ṽ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>if <italic>u<sub>i </sub>&lt; v<sub>i</sub></italic>, we obtain a better solution with<inline-formula><mml:math id="M84" name="1755-8794-8-S3-S3-i84" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ũ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M85" name="1755-8794-8-S3-S3-i85" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ṽ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> than (<bold>u</bold>, <bold>v</bold>). Therefore, at optimality, <inline-formula><mml:math id="M86" name="1755-8794-8-S3-S3-i86" overflow="scroll"><mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-bin">+</mml:mo><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munderover><mml:mo class="MathClass-rel">|</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">=</mml:mo><mml:msub><mml:mrow><mml:mfenced close="∥" open="∥"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">w</mml:mtext></mml:mstyle></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> Then, Eq.(12) becomes exactly the same as Eq.(11).</p>
<p>Eq.(12) is not a convex problem because of the quadratic equality constraint. However, it can be efficiently solved using a sequential quadratic programming (SQP) algorithm [<xref ref-type="bibr" rid="B27">27</xref>] because both of the objective and constraints are either in a quadratic or a linear form. The gradient of the objective and constraint functions with respect to <italic>γ </italic>can be calculated as:</p>
<p>
<disp-formula>
<mml:math id="M87" name="1755-8794-8-S3-S3-i87" overflow="scroll">
<mml:mrow>
<mml:mtable class="gathered">
<mml:mtr>
<mml:mtd>
<mml:mo class="MathClass-op">∇</mml:mo>
<mml:mi>f</mml:mi>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>H</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>P</mml:mi>
<mml:mi>H</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mi>γ</mml:mi>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mi>λ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>d</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mstyle mathvariant="bold">
<mml:mi>1</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mo class="MathClass-op">∇</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mn>2</mml:mn>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>H</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>Q</mml:mi>
<mml:mi>H</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mi>γ</mml:mi>
<mml:mo class="MathClass-punc">,</mml:mo>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd>
<mml:mo class="MathClass-op">∇</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mo class="MathClass-rel">:</mml:mo>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mstyle mathvariant="bold">
<mml:mi>I</mml:mi>
</mml:mstyle>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">.</mml:mtext>
</mml:mstyle>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd></mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>Let <bold><italic>α </italic></bold>be the Lagrange multipliers, the Lagrangian function of this problem can be written as:</p>
<p>
<disp-formula>
<mml:math id="M88" name="1755-8794-8-S3-S3-i88" overflow="scroll">
<mml:mrow>
<mml:mi mathvariant="script">L</mml:mi>
<mml:mfenced close=")" open="(">
<mml:mrow>
<mml:mi>γ</mml:mi>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:mi>α</mml:mi>
</mml:mrow>
</mml:mfenced>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:munder class="msub">
<mml:mrow>
<mml:mo> ∑</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:munder>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-punc">;</mml:mo>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>and the Hessian of the Lagrangian function with respect to <bold><italic>γ </italic></bold>is computed as:</p>
<p>
<disp-formula>
<mml:math id="M89" name="1755-8794-8-S3-S3-i89" overflow="scroll">
<mml:mrow>
<mml:msubsup>
<mml:mrow>
<mml:mo class="MathClass-op">∇</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mi mathvariant="script">L</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msubsup>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mn>2</mml:mn>
<mml:msup>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">H</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>T</mml:mi>
</mml:mrow>
</mml:msup>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:mfrac>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">P</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mi>n</mml:mi>
</mml:mrow>
</mml:mfrac>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">Q</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">H</mml:mtext>
</mml:mstyle>
<mml:mi>.</mml:mi>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>We iteratively search for the optimal solution to Eq.(12). In the <italic>t</italic>-th iteration, we have the iterates <italic><bold>γ</bold><sub>t </sub></italic>and <italic><bold>α</bold><sub>t</sub></italic>, and we first solve the following quadratic program to find the moving direction for <bold><italic>γ </italic></bold>and <bold><italic>α</italic></bold>,</p>
<p>
<disp-formula id="bmcM13">
<label>(13)</label>
<mml:math id="M90" name="1755-8794-8-S3-S3-i90" overflow="scroll">
<mml:mrow>
<mml:mtable class="array" columnlines="none" equalcolumns="false" equalrows="false">
<mml:mtr>
<mml:mtd class="array" columnalign="left">
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:mspace class="thinspace" width="0.3em"></mml:mspace>
<mml:munder class="msub">
<mml:mrow>
<mml:mtext class="textsf" mathvariant="sans-serif">min</mml:mtext>
</mml:mrow>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>p</mml:mi>
</mml:mstyle>
</mml:mrow>
</mml:munder>
</mml:mtd>
<mml:mtd class="array" columnalign="left">
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mo class="MathClass-op">∇</mml:mo>
<mml:mi>f</mml:mi>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">T</mml:mtext>
</mml:mstyle>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>p</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mfrac>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:mfrac>
<mml:msup>
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>p</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">T</mml:mtext>
</mml:mstyle>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mo class="MathClass-op">∇</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>2</mml:mn>
</mml:mrow>
</mml:msup>
<mml:mi mathvariant="script">L</mml:mi>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>p</mml:mi>
</mml:mstyle>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd class="array" columnalign="left">
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">subject to</mml:mtext>
</mml:mstyle>
</mml:mtd>
<mml:mtd class="array" columnalign="left">
<mml:mo class="MathClass-op">∇</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">T</mml:mtext>
</mml:mstyle>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>p</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:mn>0</mml:mn>
</mml:mtd>
</mml:mtr>
<mml:mtr>
<mml:mtd class="array" columnalign="left"></mml:mtd>
<mml:mtd class="array" columnalign="left">
<mml:mo class="MathClass-op">∇</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:msup>
<mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
</mml:mrow>
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textsf" mathvariant="sans-serif">T</mml:mtext>
</mml:mstyle>
</mml:mrow>
</mml:msup>
<mml:mstyle mathvariant="bold">
<mml:mi>p</mml:mi>
</mml:mstyle>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>g</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>i</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mo class="MathClass-rel">≻</mml:mo>
<mml:mn>0</mml:mn>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:mi>i</mml:mi>
<mml:mo class="MathClass-rel">∈</mml:mo>
<mml:mfenced close="]" open="[">
<mml:mrow>
<mml:mn>2</mml:mn>
<mml:mo class="MathClass-rel">:</mml:mo>
<mml:mi>e</mml:mi>
</mml:mrow>
</mml:mfenced>
<mml:mi>.</mml:mi>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>The optimal solution <inline-formula><mml:math id="M91" name="1755-8794-8-S3-S3-i91" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mstyle></mml:math></inline-formula> to the problem (13) will give the next moving direction for <bold><italic>γ</italic></bold>, along which the objective of Problem (12) can be decreased. Let<inline-formula><mml:math id="M92" name="1755-8794-8-S3-S3-i92" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">q</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:math></inline-formula> be the optimal Lagrange multipliers of the problem (13) corresponding to <inline-formula><mml:math id="M93" name="1755-8794-8-S3-S3-i93" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:math></inline-formula>. The next moving direction of <bold><italic>α </italic></bold>is calculated as<inline-formula><mml:math id="M94" name="1755-8794-8-S3-S3-i94" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">q</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. After the moving directions are computed, we then employ a line search method described in [<xref ref-type="bibr" rid="B27">27</xref>] to find the optimal searching step size <italic>s </italic>and update <bold><italic>γ </italic></bold>and <bold><italic>α </italic></bold>as follows:</p>
<p>
<disp-formula id="bmcM14">
<label>(14)</label>
<mml:math id="M95" name="1755-8794-8-S3-S3-i95" overflow="scroll">
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>γ</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mi>s</mml:mi>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle class="text">
<mml:mtext class="textbf" mathvariant="bold">p</mml:mtext>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-punc">,</mml:mo>
<mml:mspace class="quad" width="1em"></mml:mspace>
<mml:msub>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mrow>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-rel">=</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-bin">+</mml:mo>
<mml:mi>s</mml:mi>
<mml:mrow>
<mml:mo class="MathClass-open">(</mml:mo>
<mml:mrow>
<mml:msub>
<mml:mrow>
<mml:mover accent="true">
<mml:mrow>
<mml:mstyle mathvariant="bold">
<mml:mi>q</mml:mi>
</mml:mstyle>
</mml:mrow>
<mml:mo class="MathClass-op">^</mml:mo>
</mml:mover>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo class="MathClass-bin">-</mml:mo>
<mml:msub>
<mml:mrow>
<mml:mi>α</mml:mi>
</mml:mrow>
<mml:mrow>
<mml:mi>t</mml:mi>
</mml:mrow>
</mml:msub>
</mml:mrow>
<mml:mo class="MathClass-close">)</mml:mo>
</mml:mrow>
<mml:mi>.</mml:mi>
</mml:mrow>
</mml:math>
</disp-formula>
</p>
<p>We summarize the proposed algorithm in Algorithm 1. It has been proved that a SQP based algorithm can converge to a local minimizer <inline-formula><mml:math id="M96" name="1755-8794-8-S3-S3-i96" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>γ</mml:mi></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:math></inline-formula> of the optimization problem (12) [<xref ref-type="bibr" rid="B28">28</xref>].</p>
<p><bold>Algorithm 1 </bold>A sequential quadratic programming approach to solving Problem (11)</p>
</sec>
<sec>
<title>Data sets</title>
<p>We validated the proposed approach in both simulations and the analysis of a real-world data set that was aggregated from multiple genetic studies of cocaine dependence (CD).</p>
<sec>
<title>Cocaine use and related behaviors data</title>
<p>We used the <italic>Semi-Structured Assessment for Drug Dependence and Alcoholism </italic>(SSADDA) dataset aggregated from genetic studies of drug dependence to evaluate the proposed algorithm. The SSADDA subjects were recruited from multiple sites, including the University of Connecticut Health Center, Yale University School of Medicine, the University of Pennsylvania School of Medicine, McLean Hospital and the Medical University of South Carolina. All subjects participated using procedures approved by the institutional review board at each participating site. There were 6,621 subjects genotyped with a total of 1,140,420 SNPs genome-wide. Among the subjects, 2,674 were stratified into the African American population using STRUCTURE software v2.3 [<xref ref-type="bibr" rid="B29">29</xref>], and only these subjects were used in our experiments to avoid spurious findings due to population structure. We removed 537 subjects who had other family members in the data so the GRM was computed for unrelated individuals.</p>
<p><bold>Input: Z</bold>, <bold>C</bold>, <bold>X</bold>, <italic>λ</italic></p>
<p>Output: <italic>γ</italic></p>
<p>1. Calculate <bold>P </bold>according to Eq.(7), and <bold>Q </bold>according to Eq.(8).</p>
<p>2. Initialize <bold><italic>γ </italic></bold>with <bold>u </bold>= <bold>1</bold>, <bold>v </bold>= <bold>0</bold>.</p>
<p>3. Initialize the Lagrange multipliers <bold><italic>α </italic></bold>= 1.</p>
<p>4. Evaluate <italic>f</italic>, <inline-formula><mml:math id="M97" name="1755-8794-8-S3-S3-i97" overflow="scroll"><mml:mrow><mml:mo class="MathClass-op">∇</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:math></inline-formula>, ∇<italic>g<sub>i </sub></italic>and <inline-formula><mml:math id="M98" name="1755-8794-8-S3-S3-i98" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo class="MathClass-op">∇</mml:mo></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">2</mml:mtext></mml:mstyle></mml:mrow></mml:msup><mml:mi mathvariant="script">L</mml:mi></mml:mrow></mml:math></inline-formula>with the current <bold><italic>γ </italic></bold>and <bold><italic>α</italic></bold>.</p>
<p>5. Solve Problem (13) to obtain <inline-formula><mml:math id="M99" name="1755-8794-8-S3-S3-i99" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">p</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M100" name="1755-8794-8-S3-S3-i100" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>q</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>.</p>
<p>6. Perform a line search to find the searching step size <italic>s</italic>.</p>
<p>7. Update <bold><italic>γ </italic></bold>and <bold><italic>α </italic></bold>as in Eq.(14). Repeat 4-7 until <bold><italic>γ </italic></bold>reaches a fixed point.</p>
<p>A series of data cleaning steps were performed to ensure the quality of genotypic markers. Markers that meet any of the following conditions were excluded: low call rate (<italic>&lt;</italic>98% subjects received values for the marker), G/C and A/T markers (to avoid strand issues), deviation from Hardy-Weinberg equilibrium at <italic>p &lt;</italic>10<italic><sup>−8</sup></italic>, significant cohort calling discrepancy and being monomorphic. We also removed non-autosomal markers, so that only markers from the 22 autosomal chromosomes were used in the analysis. After these data cleaning steps, 690,864 SNPs remained. Genetic relationship was estimated for each pair of subjects by the genome-wide complex trait analysis (GCTA) software [<xref ref-type="bibr" rid="B11">11</xref>] using all 690,864 SNPs. We then excluded 385 subjects whose relatedness to some subjects was greater than 0.025 (corresponding to the relatedness of second cousins). The remaining sample, 1,752 subjects, was used in our analysis.</p>
<p>All subjects were interviewed with a computer-assisted assessment system called the SSADDA [<xref ref-type="bibr" rid="B4">4</xref>], which consists of survey questions designed for cocaine use and related behaviors. All subjects were reported to have used cocaine in their lifetime. The responses to those questions in the SSADDA led to the definition of thirteen important cocaine use related variables, based on which a diagnosis of CD was determined. There were seven binary variables as listed below, which represent the seven cocaine dependence criteria in DSM-IV.</p>
<p>• <italic>F1 </italic>- tolerance to cocaine;</p>
<p>• <italic>F2 </italic>- withdrawal from cocaine;</p>
<p>• <italic>F3 </italic>- using cocaine in larger amounts or over longer period than intended;</p>
<p>• <italic>F4 </italic>- persistent desire or unsuccessful efforts to cut down or control cocaine use;</p>
<p>• <italic>F5 </italic>- great amount of time spent in activities necessary to obtain, use or recover from the effects of cocaine;</p>
<p>• <italic>F6 </italic>- gave up or reduced important social, occupational, or recreational activities because of cocaine use;</p>
<p>• <italic>F7 </italic>- cocaine use despite knowledge of persistent or recurrent physical or psychological problems likely to have been caused or exacerbated by cocaine. In our experiments, positive responses to the seven variables were coded by 1 and negative responses were coded by 0. We also included six continuous variables in the analysis as listed below:</p>
<p>• <italic>F8 </italic>- number of cocaine symptom endorsed;</p>
<p>• <italic>F9 </italic>- age when first used cocaine;</p>
<p>• <italic>F10 </italic>- age when last used cocaine;</p>
<p>• <italic>F11 </italic>- age when first diagnosed with DSM-IV cocaine dependence;</p>
<p>• <italic>F12 </italic>- age when last diagnosed with DSM-IV cocaine dependence;</p>
<p>• <italic>F13 </italic>- transition time in years between the first cocaine use and the first cocaine dependence diagnosis.</p>
<p>All these variables were normalized to the range of [0, 1] in the analysis.</p>
</sec>
</sec>
<sec>
<title>Synthetic data</title>
<p>Following the same design principle used in the simulations for testing chip heritability in [<xref ref-type="bibr" rid="B8">8</xref>], we used the real-life genotypic data in the CD study but synthesized phenotypic data. We simulated quantitative traits based on the mixed-effect linear model shown in Eq.(1). We first synthesized a dataset that contained 5 phenotypic features, all of which were created with moderate to high heritability, and were used to form a quantitative trait of very high heritability reaching 0.8. We then added irrelevant features, which varied mainly due to covariates, to create five other simulated datasets. These datasets consisted of 10, 20, 30, 40 and 50 features where only the first 5 of them were used in the model of the final trait. These datasets were used to determine whether the proposed algorithm could identify the right features for use in the model.</p>
<p>To synthesize features with genetic effects, we randomly picked 2,000 of the 690,864 SNPs in the cocaine use data set and used them as the causal variants of these features. The random effect coefficient <italic>u<sub>j </sub></italic>associated with each of the 2,000 markers was generated independently by sampling from the standard normal distribution <italic>N </italic>(0, 1). The residual component <italic>ε<sub>i </sub></italic>for each individual was drawn from the normal distribution of mean 0 and variance var(<bold>z</bold><italic><sub>i</sub></italic><bold>u</bold>)(1<italic>/h</italic><sup>2 </sup><italic>− </italic>1) where <bold>z</bold><italic><sub>i </sub></italic>is the <italic>i</italic>-th row of <bold>Z</bold>, var(<italic>·</italic>) is the sample variance of a random variable and <italic>h</italic><sup>2 </sup>is the heritability of the feature. To synthesize features with no genetic effects, we ignored the term <bold>Zu </bold>in Eq.(1) and created <italic>ε </italic>by randomly sampling from the standard normal distribution. To further synthesize features with fixed covariate effects, we used sex and age of the individuals in the CD study as the covariates, and arbitrarily set their effects, i.e., the <italic>β </italic>coefficients, to 0.2 and 0.5.</p>
<p>We evaluated the proposed method in two different experimental settings:</p>
<p><bold>Setting 1: </bold>This setting assumed that there were no covariate effects in the quantitative trait. The five relevant features were simulated as follows. We used the procedure described in the above paragraph to create four features with <italic>h</italic><sup>2 </sup>equal to 0.2: <bold>x</bold><sub>1</sub><italic>, · · · </italic>, <bold>x</bold><sub>4</sub>. Then we simulated the final quantitative trait <bold>y</bold><sub>1 </sub>with <italic>h</italic><sup>2 </sup>= 0.8 using the same procedure. A five-entry weight vector was created with arbitrary values, such as <bold>w </bold>= [0.22, 0.67, 0.60, 0.30, 0.22], used in our experiments. Then, the fifth feature was directly computed as <inline-formula><mml:math id="M101" name="1755-8794-8-S3-S3-i101" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-rel">=</mml:mo><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo class="MathClass-bin">-</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-bin">/</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. By simulating the data in this way, we knew that there was at least one linear combination of the five features in the data that would result in a composite trait (i.e., <bold>y</bold><sub>1</sub>) with <italic>h</italic><sup>2 </sup>of 0.8. Hence, if our approach worked, it should at least find this linear combination if there was no any other one that gave even higher <italic>h</italic><sup>2</sup>. Note that the heritability of the fifth feature had to depend on the empirical estimation, but given how it was created, there were genetic effects in this feature.</p>
<p>We then created 45 other features that had no genetic effects, and added a certain number of these features to the original 5 features to create 5 other datasets. Hence, there were in total 6 datasets for 1,752 subjects with 5, 10, 20, 30, 40 and 50 features. We used this set of data (i.e., the discovery set) in training to retrieve the combination models. Then we repeated the above procedure to create another independent set of data (i.e., the validation set) to validate the resultant models.</p>
<p><bold>Setting 2: </bold>This setting assumed that the two covariates, sex and age, had fixed effects to the features and the final trait. We generated 5 features by adding fixed effects to the 5 useful features created in Setting 1. Because fixed effects do not change <italic>h</italic><sup>2 </sup>of a trait, we computed a composite trait <bold>y</bold><sub>2 </sub>using the same pre-specified weight vector <bold>w </bold>that was used in Setting 1. We then created 45 other features with only covariate effects using the procedure described early on. Five other datasets were generated consisting of 10, 20, 30, 40 and 50 features. Note that the optimal weight vector for these datasets should have zero entries for all features except the first 5 features that were synthesized. Similarly, a discovery suite of the six datasets and another suite of them were synthesized using the same procedure for training and validation, respectively.</p>
<p>We estimated the chip <italic>h</italic><sup>2 </sup>of the features created in the synthetic datasets using GCTA software. The four features synthesized with a pre-specified <italic>h</italic><sup>2 </sup>= 0.2 had empirical chip <italic>h</italic><sup>2 </sup>values 0.2 <italic>± </italic>0.01 in these datasets. The chip <italic>h</italic><sup>2 </sup>estimate of the fifth feature was 0.57 in the discovery set and 0.6 in the validation set. Because fixed effects do not affect trait heritability, the five relevant features and the final quantitative traits had the same empirical chip <italic>h</italic><sup>2 </sup>in Settings 1 and 2. The features simulated with no genetic effects had <italic>h</italic><sup>2 </sup>estimates that ranged from 0 to 0.05, and most of these features had estimates less than 10<sup><italic>−</italic>5</sup>.</p>
</sec>
</sec>
<sec>
<title>The proposed analyses</title>
<p>We first validated the proposed approach in a variety of experiments with the synthetic data. Then we applied our approach to the real-life cocaine use data to identify important components or subtypes of the disease defined by linear combinations of clinical features. Such a combination can be used to define a disease subtype because it produces a quantitative trait for each individual, which amounts to the membership likelihood of the individual in a subtype. Because the actual causal variants were known for synthetic data, we calculated the GRM of the individuals directly using the causal variants. In the case study for CD, because the real causal variants were unknown, we followed the commonly-used procedure in the literature on chip heritability estimation [<xref ref-type="bibr" rid="B30">30</xref>] and computed the GRM using all 690,864 SNPs that remained in the data. All of the reported chip heritability was estimated using GCTA software.</p>
<p><bold>Tuning of the hyperparameter: </bold>For both the simulation and the CD case study, we performed 10 times three-fold cross validation (CV) to help determine a proper value of <italic>λ</italic>. At each fold of the CV, a linear model was derived by running the proposed method on 2/3 of the data in the dataset, and then tested on the remaining 1/3 of the data. The cross validated <italic>h</italic><sup>2 </sup>of the derived trait was estimated using only subjects in the remaining 1/3 of the data which was not used to train the model. We ran the same CV process for each pre-specified choice of <italic>λ </italic>(the choices we used are reported in the results section) and chose the <italic>λ </italic>value that gave a trait of the highest cross validated <italic>h</italic><sup>2 </sup>for each experimental setting.</p>
<p><bold>Evaluation metrics: </bold>We reported and investigated the CV performance (including the mean values and standard deviations of the validation <italic>h</italic><sup>2 </sup>obtained in the CV process described above) for each <italic>λ </italic>choice in each experiment. Once the best value of <italic>λ </italic>was chosen through the cross validation for a dataset, we applied the proposed approach with the best <italic>λ </italic>to the entire data in the dataset to derive a quantitative trait. The chip heritability of this trait was estimated using the separately-synthesized validation datasets in simulations and by another cross validation process in the case study. In other words, in simulations, we estimated the valiation chip <italic>h</italic><sup>2 </sup>using the trait values computed by the linear model on the newly-synthesized validation samples. In the CD case study, we computed the trait <italic>h</italic><sup>2 </sup>using SNPs of 2/3 of the subjects randomly sampled from the dataset and repeated the random sampling 10 times to report the averaged <italic>h</italic><sup>2 </sup>value. We named this process the evaluation CV. Moreover, besides the heritability as a major evaluation metric, we also measured the effectiveness of our approach by comparing the derived trait models and the linear model implanted in the simulated data. We calculated the squared difference between the learned weights <inline-formula><mml:math id="M102" name="1755-8794-8-S3-S3-i102" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">w</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:math></inline-formula> and the true weights <bold>w</bold>, i.e., <inline-formula><mml:math id="M103" name="1755-8794-8-S3-S3-i103" overflow="scroll"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">SE</mml:mtext></mml:mstyle><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">w</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mspace class="tmspace" width="2.36043pt"></mml:mspace><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">|</mml:mo><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">w</mml:mtext></mml:mstyle><mml:mo class="MathClass-bin">-</mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover><mml:mo class="MathClass-rel">|</mml:mo><mml:msubsup><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and the mean of squared residuals <inline-formula><mml:math id="M104" name="1755-8794-8-S3-S3-i104" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">y</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:mo class="MathClass-rel">=</mml:mo><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo class="MathClass-bin">/</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-bin">-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext class="textbf" mathvariant="bold">w</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, and reported the values in plots. Additional evaluation steps were conducted in the case study to clinically interpret the resultant quantitative trait (see the later paragraph).</p>
<p><bold>Comparison: </bold>The validated chip <italic>h</italic><sup>2 </sup>of our derived traits was compared with that of all quantitative features in the data in both simulations and the CD case study. In each of the experiments, our derived trait was also compared with the commonly-used disease phenotype, often referred to as a symptom count, which was the quantitative trait created by equal weighted aggregation of all features in the data. Given that no prior method existed to identify heritable disease components using the genome-wide SNPs, on the real-life cocaine use data, we compared our approach with a recently published method [<xref ref-type="bibr" rid="B23">23</xref>] that aimed to derive linearly-combined traits using pedigrees of related individuals. This comparison considered whether a pedigree-based heritable component analysis method can identify a disease component with a chip heritability comparable to that found by our approach. As multi-member families were included in the original cocaine use dataset, i.e., a superset of the sample used by our approach, it was feasible to apply the method in [<xref ref-type="bibr" rid="B23">23</xref>] to derive a trait. Then we computed the trait values on the unrelated individuals used by our approach to compare the chip <italic>h</italic><sup>2 </sup>of the two approaches using the evaluation CV. Note that the prior pedigree-based approach was actually given a favor because it used the superset of 2,674 subjects (unrelated individuals were treated as one-member pedigrees) to derive the trait in comparison with our approach that used only the 1,752 unrelated individuals.</p>
<p><bold>Clinical interpretation: </bold>It is very important to understand the clinical implications of the quantitative trait (or an empirical subtype) derived by our approach from the aggregated CD study data. From prior work [<xref ref-type="bibr" rid="B17">17</xref>,<xref ref-type="bibr" rid="B31">31</xref>], we identified three key steps to ensure the clinical validity of an empirical subtype. We first examined the specific features selected by our approach for use in the model. Second, we studied the distribution (or histogram) of the quantitative scores among the 1,752 subjects. From the distribution plot, we examined whether there were obvious subgroups of the scores. Third, the subgroups of subjects were characterized and compared on 11 of the most important clinical variables reflecting cocaine use and related behaviors including both the features selected and those not selected for use in the linear model. The individuals receiving very high or very low values of the quantitative trait may show the most representative features of the subtype.</p>
</sec>
<sec sec-type="results">
<title>Results</title>
<sec>
<title>Simulations</title>
<p>We pre-specified 21 different <italic>λ </italic>values ranging from 0 to 0.04 with step size 0.002 for use in the cross-validation tuning process. The validation or test <italic>h</italic><sup>2 </sup>for each <italic>λ </italic>choice was plotted for each of the six datasets in Figure 1 (for Setting 1 where data were generated without covariate effects) and Figure 2 (for Setting 2 where data were generated with covariate effects). The mean, median, and the standard deviations of the test <italic>h</italic><sup>2 </sup>values in the cross validation were plotted for each tested <italic>λ</italic>. These two figures show that our approach could identify components (quantitative traits) with test <italic>h</italic><sup>2 </sup>estimate of ~ 0.8, which was the heritability of the implanted heritable component (the simulated true model), for all datasets even with many irrelevant features in some of the datasets for both settings. This result demonstrates that our approach identified highly heritable disease components and could successfully correct for fixed covariate effects.</p>
<p>In addition, both Figures 1 and 2 show that there was overfitting of the learned models to the training data when <italic>λ </italic>was too small, especially when the number of irrelevant features grew to 25, 35 and 45. The larger the number of irrelevant features in the data, the more severe was the overfitting seen when <italic>λ </italic>was small. On the other hand, when <italic>λ </italic>was too large, underfitting could occur, so the test <italic>h</italic><sup>2 </sup>showed a peak in most of the plotted curves. The best choice of <italic>λ </italic>for the six datasets (sorted from the smallest number of features in the data to the largest number of features) were 0, 0, 0, 0.002, 0.004 and 0.004 for Setting 1, and 0, 0, 0, 0,002, 0.004 and 0.006 for Setting 2.</p>
<fig id="F1" position="float">
<label>Figure 1</label>
<caption>
<p><bold>Simulation study: the <bold>testing </bold><italic>h</italic><sup>2 </sup>of the quantitative traits developed in three-fold cross validation with varying <italic>λ </italic>and total number of phenotypic features in setting 1, in which datasets are simulated without covariate effect on the phenotypic features</bold>.</p>
</caption>
<graphic xlink:href="1755-8794-8-S3-S3-1"></graphic>
</fig>
<fig id="F2" position="float">
<label>Figure 2</label>
<caption>
<p><bold>Simulation study: the <bold>testing </bold><italic>h</italic><sup>2 </sup>of the quantitative traits developed in three-fold cross validation with varying <italic>λ </italic>and total number of phenotypic features in setting 2, in which datasets are simulated with covariate effect on the phenotypic features</bold>.</p>
</caption>
<graphic xlink:href="1755-8794-8-S3-S3-2"></graphic>
</fig>
<p>Then <italic>λ </italic>was set to the optimal value for each of the six datasets, and we re-ran the algorithm to generate the final quantitative trait from each dataset. We then compared the chip <italic>h</italic><sup>2 </sup>between these derived traits and the commonly used disease traits, such as individual features and the equally weighted aggregation of individual features. The results are shown in Figure 3 where all <italic>h</italic><sup>2 </sup>values were estimated using only the <italic>validation </italic>datasets. Results from both settings are shown. For all the datasets and for both settings, our approach could recover the quantitative traits of <italic>h</italic><sup>2 </sup>close to 0.8. When the number of irrelevant features in the data increased, the <italic>h</italic><sup>2 </sup>values of the derived traits decreased as expected. Typically, when more irrelevant features were included in the data, the learning problem became more challenging. Because covariates do not affect <italic>h</italic><sup>2 </sup>estimate when their effect is properly corrected during the estimation, we did not differentiate the two settings when discussing and comparing the <italic>h</italic><sup>2 </sup>values of individual features and the aggregated traits. Recall that in our simulation, the highest chip <italic>h</italic><sup>2 </sup>of individual features was 0.6 in validation. Figure 3 also included this most heritable feature for comparison. Among the traits derived by equally weighted aggregation, the one developed from the 5-feature dataset reached the highest <italic>h</italic><sup>2 </sup>(= 0.66). As expected, chip <italic>h</italic><sup>2 </sup>of these traits decreased along with the increasing number of irrelevant features. The trait developed from the 50-feature dataset had the lowest <italic>h</italic><sup>2 </sup>(= 0.28). These results demonstrate that our approach could identify quantitative traits that are more heritable (i.e., with high chip heritability) than those commonly used. The squared difference (error) between learned weights and the optimal (implanted) weights: SE(<bold>w</bold>) together with the squared error between the derived traits and simulated traits: SE(<bold>y</bold>) are presented in Figure 4. The results from both settings are provided. We observed that clearly when the number of irrelevant features increased, the noisier data made the learning problem more difficult, and SE(<bold>y</bold>) and SE(<bold>w</bold>) increased in both of the settings.</p>
<fig id="F3" position="float">
<label>Figure 3</label>
<caption>
<p><bold>Simulation study: comparison of <italic>h</italic><sup>2 </sup>of commonly used traits with that of the quantitative traits derived by the proposed approach with chosen <italic>λ</italic>'s</bold>. Results from both settings (setting 1 - without covariates, setting 2 - with covariates) are shown. For <italic>h</italic><sup>2 </sup>of individual features in each dataset, we show the highest. Because in our simulation the feature that has the highest <italic>h</italic><sup>2 </sup>estimate is shared across all the datasets with varying number of features, the corresponding <italic>h</italic><sup>2 </sup>curve is a straight line. Since covariates do not affect the <italic>h</italic><sup>2 </sup>estimate when their effect is properly corrected for during the estimation, we do not differentiate the two settings and show one curve for traits derived by equal weighted aggregation of individual features in the data and one for individual feature that has the highest <italic>h</italic><sup>2 </sup>estimate.</p>
</caption>
<graphic xlink:href="1755-8794-8-S3-S3-3"></graphic>
</fig>
<fig id="F4" position="float">
<label>Figure 4</label>
<caption>
<p><bold>Simulation study: the square error of feature weights (<bold>w</bold>) in models derived by the proposed approach with chosen <italic>λ</italic>'s: SE(<bold>w</bold>) and that of resulted quantitative traits (<bold>y</bold>): SE(<bold>y</bold>), comparing to the optimal (implanted) model coefficients <inline-formula><mml:math id="M105" name="1755-8794-8-S3-S3-i106" overflow="scroll"><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>and traits <inline-formula><mml:math id="M106" name="1755-8794-8-S3-S3-i107" overflow="scroll"><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">y</mml:mtext></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></bold>. SE(<bold>w</bold>) is calculated as <inline-formula><mml:math id="M107" name="1755-8794-8-S3-S3-i108" overflow="scroll"><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">|</mml:mo><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">w</mml:mtext></mml:mstyle><mml:mo class="MathClass-bin">-</mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover><mml:mo class="MathClass-rel">|</mml:mo><mml:msubsup><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>; and SE(<bold>y</bold>) is calculated as <inline-formula><mml:math id="M108" name="1755-8794-8-S3-S3-i109" overflow="scroll"><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo><mml:mo class="MathClass-rel">|</mml:mo><mml:mstyle class="text"><mml:mtext class="textbf" mathvariant="bold">y</mml:mtext></mml:mstyle><mml:mo class="MathClass-bin">-</mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle></mml:mrow><mml:mo class="MathClass-op">^</mml:mo></mml:mover><mml:mo class="MathClass-rel">|</mml:mo><mml:msubsup><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo class="MathClass-bin">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, where <italic>n </italic>is the total number of subjects in 2 2 the data. Results from both settings (setting 1 - without covariates, setting 2 - with covariates) are shown.</p>
</caption>
<graphic xlink:href="1755-8794-8-S3-S3-4"></graphic>
</fig>
</sec>
<sec>
<title>A case study of cocaine dependence</title>
<p>In this study, we used the same pre-specified <italic>λ </italic>values in the simulations. In all expriments, we used age, sex and the first three principal components of the GRM as covariates. The test <italic>h</italic><sup>2</sup>s of all traits derived for each <italic>λ </italic>choice in the CV process are plotted in Figure 5. It shows that there was overfitting when <italic>λ </italic>was too small as well. The trait derived with <italic>λ </italic>= 0.004 achieved the highest cross-validated <italic>h</italic><sup>2 </sup>on average. We thus derived a model by running our approach with <italic>λ </italic>= 0.004 and all the 1,752 subjects in the data. We examined this model and the resultant quantitative trait as discussed in the proposed analyses section.</p>
<fig id="F5" position="float">
<label>Figure 5</label>
<caption>
<p><bold>Case study on cocaine dataset: the testing <italic>h</italic><sup>2 </sup>of the composite traits derived in three-fold cross validation with varying <italic>λ</italic></bold>.</p>
</caption>
<graphic xlink:href="1755-8794-8-S3-S3-5"></graphic>
</fig>
<p>The weights that each variable received in the model are shown in Figure 6. Of the 13 clinical variables, five (F8 - F12) received a zero coefficient, and were completely ruled out from the model. Variable F13 had an coefficient close to 0 (&lt; 10<sup><italic>−</italic>5</sup>), thus its impact on the resultant trait was minimal. Variables with significant coefficients in the model are the seven cocaine criteria: F3 - using cocaine in larger amounts or over longer period than intended, F2 - withdrawal from cocaine, and F5 - great amount of time spent in activities necessary to obtain, use or recover from the effects of cocaine, had the highest impact on the trait. Both F3 and F5 had negative weights, which indicated that positive response to these two variables would lower the score or value of this trait. In contrast, F2 had a positive coefficient, which indicated that a positive response to this variable would increase the score. Variables F4 - persistent desire or unsuccessful efforts to cut down or control cocaine use, and F1 - tolerance to cocaine, had limited impact on the trait.</p>
<fig id="F6" position="float">
<label>Figure 6</label>
<caption>
<p><bold>Case study on cocaine dataset: the weights of variables in the linear combination learned by the proposed method with <italic>λ </italic>= 4 and the entire sample set</bold>.</p>
</caption>
<graphic xlink:href="1755-8794-8-S3-S3-6"></graphic>
</fig>
<p>The cross validated <italic>h</italic><sup>2 </sup>estimate of the trait derived by the proposed approach is 0.87 (with a standard error of 0.13). For comparison, we ran the approach proposed in [<xref ref-type="bibr" rid="B23">23</xref>], which identifies heritable components with pedigrees as genetic inputs and its formulation also had a hyper-parameter <italic>λ</italic>. For fair comparison, we first ran 10 times cross validation to choose a proper value for <italic>λ</italic>. With this <italic>λ</italic>, we developed a trait using the entire African American sample set. We then estimated the trait <italic>h</italic><sup>2 </sup>using the exact same setting (i.e., GRM and covariates) as for the traits derived by the proposed approach. We estimated the <italic>h</italic><sup>2 </sup>for all six continuous variables in the data using the same setting. All of the <italic>h</italic><sup>2 </sup>values are plotted in Figure 7 together with the trait derived by the proposed approach. The figure clearly shows that the trait derived by the proposed approach had the highest <italic>h</italic><sup>2 </sup>among all compared traits, and was significantly higher than that of the trait derived using the prior approach [<xref ref-type="bibr" rid="B23">23</xref>]. Note that one of the continuous variables in the cocaine use data was the counting of CD criteria. It was defined as the number of positive responses to the seven CD criteria, i.e., a quantitative trait resulting from a linear combination of F1-F7 with equal weights. This trait was reported to be a better trait for genomewide association analysis than the binary CD diagnosis [<xref ref-type="bibr" rid="B1">1</xref>]. The CD diagnosis had a value of <italic>h</italic><sup>2 </sup>close to zero when estimated using our data. These results demonstrate the effectiveness of our approach in identifying disease components with high chip heritability from complex multivariate phenotypes. It is worth noting that the trait with the second highest <italic>h</italic><sup>2 </sup>estimate was the one derived using the prior approach [<xref ref-type="bibr" rid="B23">23</xref>]. This implies that (1) both of these two methods (i.e., the proposed method and the one previously reported [<xref ref-type="bibr" rid="B23">23</xref>]) can identify heritable components with high chip heritability; but (2) the proposed method outperforms as it directly maximizes heritability using genetic variants.</p>
<fig id="F7" position="float">
<label>Figure 7</label>
<caption>
<p><bold>Case study on cocaine dataset: comparison of <italic>h</italic><sup>2</sup>'s of six individual continuous variables in the data, composite traits derived by the approach in </bold>[<xref ref-type="bibr" rid="B23">23</xref>]<bold>and that derived by the proposed approach with <italic>λ </italic>= 2</bold>.</p>
</caption>
<graphic xlink:href="1755-8794-8-S3-S3-7"></graphic>
</fig>
<p>Figure 8 shows the distribution of the trait values (i.e., the membership scores) of the subjects. It shows that based on the scores, the samples can be partitioned into four subgroups. There were 250 subjects (14.27% of total) in Group 1, which had a mean score of -2.22. Group 2 consisted of 323 subjects and comprised 18.44% of the entire sample set. Its mean score was -0.8. Group 3 was the largest one and consisted of 821 subjects (46.86% of the sample). The mean score of this group was -0.2. Group 4 was the smallest, comprised of 237 individuals (13.53% of the sample), with a mean score of 1.22.</p>
<p>To understand the clinical implications of the derived trait, we characterized the four groups using 11 important clinical variables, including the 7 CD criteria (F1-F7), the total number of CD criteria endorsed (F8), age of first cocaine use (F9), age when first diagnosed with DSM-IV CD (F11), and the transition time in years from first cocaine use to first DSM-IV CD diagnosis (F13). The results are summarized in Table 1. Only 5.6% of the subjects in Group 1 had experienced cocaine withdrawal symptoms (F2), despite the face that this group contained heavy cocaine users (as shown by other variables). Most of the subjects (99.6%) in this group reported using cocaine in larger amounts or over a longer period than indended (F3). Moreover, this group had the highest percentage of subjects (96%) who spent a great amount of time in activities related to cocaine (F5). Group 2 had the lowest percentage of subjects (23.6%) with tolerance to cocaine (F1), but the highest percentage of subjects (92.92%) who used cocaine despite knowledge that problems were likely caused by cocaine (F7). Subjects in Group 3 endorsed all of the seven CD criteria with similar percentages (87.04% was the lowest and 90.60% was the highest among the seven criteria). Group 4 had the lowest percentage of subjects who endorsed F3, F5 and F7. Group 4 also had the highest percentage of subjects with persistent desire or unsuccessful attempts to cut down their cocaine use (F4). Group 1 and Group 2 had a similar transition time from first cocaine use to first CD diagnosis (F13): 8.01 years for Group 1 and 8.07 years for Group 2. These were significantly shorter than the transition time in Groups 3 and 4, which were 12.15 years and 15.19 years, respectively.</p>
<table-wrap id="T1" position="float">
<label>Table 1</label>
<caption>
<p>Characteristic of the three subject groups on important clinical variables related to cocaine use.</p>
</caption>
<table frame="hsides" rules="groups">
<thead>
<tr>
<th align="left">Variable</th>
<th align="left">Group1<break></break>250(14.27)</th>
<th align="left">Group2<break></break>339(19.35)</th>
<th align="left">Group3<break></break>926(52.85)</th>
<th align="left">Group4<break></break>237(13.53)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Tolerance to cocaine</td>
<td align="left">124(49.60)</td>
<td align="left">80(23.60)</td>
<td align="left">807(87.15)</td>
<td align="left">123(51.90)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Withdrawal from cocaine</td>
<td align="left">14(5.60)</td>
<td align="left">275(81.12)</td>
<td align="left">813(87.80)</td>
<td align="left">192(81.01)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Using cocaine in larger amounts or over longer period than intended</td>
<td align="left">249(99.60)</td>
<td align="left">323(95.28)</td>
<td align="left">816(88.12)</td>
<td align="left">103(43.46)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Persistent desiring or unsuccessful cutting down cocaine use</td>
<td align="left">223(89.20)</td>
<td align="left">326(96.17)</td>
<td align="left">839(90.60)</td>
<td align="left">233(98.31)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Great amount of time spent in activities related to cocaine</td>
<td align="left">240(96.00)</td>
<td align="left">290(85.55)</td>
<td align="left">823(88.88)</td>
<td align="left">82(34.60)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Gave up or reduced important activities because of cocaine use</td>
<td align="left">170(68.00)</td>
<td align="left">212(62.54)</td>
<td align="left">806(87.04)</td>
<td align="left">156(65.82)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Cocaine use despite knowledge of problems likely caused by cocaine</td>
<td align="left">209(83.60)</td>
<td align="left">315(92.92)</td>
<td align="left">817(88.23)</td>
<td align="left">170(71.73)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Number of CD criteria endorsed</td>
<td align="left">4.92(1.07)</td>
<td align="left">5.37(1.08)</td>
<td align="left">6.18(2.10)</td>
<td align="left">4.47(1.50)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Age when first used cocaine</td>
<td align="left">21.93(6.34)</td>
<td align="left">22.32(6.51)</td>
<td align="left">21.44(5.75)</td>
<td align="left">22.97(8.42)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Age onset of DSM4 cocaine dependence</td>
<td align="left">28.24(7.88)</td>
<td align="left">28.31(7.95)</td>
<td align="left">26.63(6.70)</td>
<td align="left">28.32(8.06)</td>
</tr>
<tr>
<td colspan="5">
<hr/>
</td>
</tr>
<tr>
<td align="left">Transition time in years from first cocaine use to first CD diagnosis</td>
<td align="left">8.01(12.05)</td>
<td align="left">8.07(12.91)</td>
<td align="left">12.15(21.30)</td>
<td align="left">15.19(24.65)</td>
</tr>
</tbody>
</table>
<table-wrap-foot>
<p><italic>N </italic>(%) is shown for the first seven binary variables, where <italic>N </italic>is the number of subjects who are positive on the corresponding variable within a group and % is the percentage of <italic>N </italic>in the group.</p>
<p><italic>µ</italic>(<italic>σ</italic><sup>2</sup>) is shown for the last four continuous variable, where <italic>µ </italic>is the group mean and <italic>σ</italic><sup>2 </sup>the standard deviation.</p>
</table-wrap-foot>
</table-wrap>
<fig id="F8" position="float">
<label>Figure 8</label>
<caption>
<p><bold>Case study on cocaine dataset: the distribution of scores for the composite trait derived by the proposed method with <italic>λ </italic>= 2 and the entire sample set</bold>.</p>
</caption>
<graphic xlink:href="1755-8794-8-S3-S3-8"></graphic>
</fig>
</sec>
</sec>
<sec sec-type="conclusions">
<title>Conclusion</title>
<p>We developed an approach to identify composite traits from multivariate phenotypes that are highly heritable, as estimated using genome-wide SNPs. The trait we derived is in the form of a linear combination of variables related to the phenotype, that is <bold>y </bold>= <bold>Xw</bold>. A quadratic optimization problem was formulated, in which optimal <bold>w </bold>was sought to optimize the log likelihood for estimating variance components in REML. In this formulation, variance components are set to their ideal values with the additive genetic variance component <inline-formula><mml:math id="M109" name="1755-8794-8-S3-S3-i105" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> equal to 1 and other components equal to 0. To avoid overfitting, we incorporated a regularization term in our formulation. An efficient algorithm based on the sequential quadratic programming framework was developed to solve the proposed optimization problem. We evaluated the proposed approach on both synthetic and real world data. The empirical results demonstrate the effectiveness of our approach as a means to identify traits with much higher chip <italic>h</italic><sup>2 </sup>than commonly-used disease phenotypes.</p>
<p>In this paper, the pairwise genetic relationship among subjects was estimated from genome-wide SNPs. However, it can also be estimated from SNPs restricted to a specific region, such as on a particular chromosome or in genes related to a pathway, to explore the genetic architecture of a trait. When SNPs within a specific region are used, the trait resulting from the proposed approach will achieve the maximized genetic variance component corresponding to this region. In an application, such as substance dependence, there are known pathways involved, so it may be of utility to determine whether there is a composite trait, the variance of which can be largely explained by the variants within the pathways. This will be a future application of our approach.</p>
</sec>
<sec>
<title>Competing interests</title>
<p>The authors Jiangwen Sun and Jinbo Bi declare that they have no competing interests. Henry R Kranzler has served as a consultant or advisory board member for the following companies: Alkermes, Lilly, Lundbeck, Otsuka, and Pfizer. He is a member of the Alcohol Clinical Trials Group of the American Society of Clinical Psychopharmacology, which is supported by Abbvie, Alkermes, Ethypharm, Lilly, Lundbeck, and Pfizer.</p>
</sec>
<sec>
<title>Authors' contributions</title>
<p>JB, HRK and JS designed the overall study of finding heritable disease subtypes. JS and JB designed the new algorithm discussed in this paper. JS implemented the algorithm and performed the data analyses. HRK provided the aggregated drug dependence data and helped in interpreting the results. JS and JB wrote the first draft of this manuscript.</p>
</sec>
</body>
<back>
<sec>
<title>Acknowledgements</title>
<p>This work was supported by NIH grant R01DA037349, NSF grant DBI-1356655, and IIS-1447711. Jinbo Bi was also supported by NSF grants IIS-1320586 and IIS-1407205. Henry R. Kranzler was also supported by NIH grants R01DA030976, R01AA021164, R01AA023192, and R01CA184315.</p>
<p>We thank Joel Gelernter, M.D. from Yale University who was instrumental in recruiting, characterizing, and genotyping the subjects in the SSADDA dataset used here. Kathleen Brady, M.D., Ph.D. of the Medical University of South Carolina, Roger Weiss, M.D., of McLean Hospital and Harvard Medical School, and David Oslin, M.D., of the University of Pennsylvania Perelman School of Medicine oversaw study recruitment at their respective sites. That work was supported by NIH grants R01AA011330, R01AA017535, R01DA012690, R01DA018432, and R01DA012849.</p>
<p>Publication costs for this article were funded by NIH grant R01DA037349.</p>
<p>This article has been published as part of BMC <italic>Medical Genomics </italic>Volume 8 Supplement 3, 2015: Selected articles from the IEE International Conference on Bioinformatics and Biomedicine (BIBM 2014): Medical Genomics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/bmcmedgenomics/supplements/8/S3">http://www.biomedcentral.com/bmcmedgenomics/supplements/8/S3</ext-link>.</p>
</sec>
<ref-list>
<ref id="B1">
<mixed-citation publication-type="other">
<name>
<surname>Gelernter</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Sherva</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Koesterer</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Almasy</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Zhao</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Kranzler</surname>
<given-names>HR</given-names>
</name>
<name>
<surname>Farrer</surname>
<given-names>L</given-names>
</name>
<article-title>Genome-wide association study of cocaine dependence and related traits: Fam53b identified as a risk gene</article-title>
<source/>Mol Psychiatry
          <year>2013</year>
</mixed-citation>
</ref>
<ref id="B2">
<mixed-citation publication-type="journal">
<name>
<surname>Gelernter</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Kranzler</surname>
<given-names>HR</given-names>
</name>
<name>
<surname>Sherva</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Koesterer</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Almasy</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Zhao</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Farrer</surname>
<given-names>LA</given-names>
</name>
<article-title>Genome-wide association study of opioid dependence: multiple associations mapped to calcium and potassium pathways</article-title>
<source/>Biol Psychiatry
          <year>2014</year>
<volume>76</volume>
<issue>1</issue>
<fpage>66</fpage>
<lpage>74</lpage>
<pub-id pub-id-type="doi">10.1016/j.biopsych.2013.08.034</pub-id>
<pub-id pub-id-type="pmid">24143882</pub-id>
</mixed-citation>
</ref>
<ref id="B3">
<mixed-citation publication-type="journal">
<name>
<surname>Treutlein</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Rietschel</surname>
<given-names>M</given-names>
</name>
<article-title>Genome-wide association studies of alcohol dependence and substance use disorders</article-title>
<source/>Curr Psychiatry Rep
          <year>2011</year>
<volume>13</volume>
<issue>2</issue>
<fpage>147</fpage>
<lpage>55</lpage>
<pub-id pub-id-type="doi">10.1007/s11920-011-0176-4</pub-id>
<pub-id pub-id-type="pmid">21253885</pub-id>
</mixed-citation>
</ref>
<ref id="B4">
<mixed-citation publication-type="journal">
<name>
<surname>Pierucci-Lagha</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Gelernter</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Chan</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Arias</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Cubells</surname>
<given-names>JF</given-names>
</name>
<name>
<surname>Farrer</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Kranzler</surname>
<given-names>HR</given-names>
</name>
<article-title>Reliability of dsm-iv diagnostic criteria using the semi-structured assessment for drug dependence and alcoholism (ssadda)</article-title>
<source/>Drug Alcohol Depend
          <year>2007</year>
<volume>91</volume>
<issue>1</issue>
<fpage>85</fpage>
<lpage>90</lpage>
<pub-id pub-id-type="doi">10.1016/j.drugalcdep.2007.04.014</pub-id>
<pub-id pub-id-type="pmid">17590536</pub-id>
</mixed-citation>
</ref>
<ref id="B5">
<mixed-citation publication-type="book">
<name>
<surname>Balding</surname>
<given-names>DJ</given-names>
</name>
<name>
<surname>Bishop</surname>
<given-names>MJ</given-names>
</name>
<name>
<surname>Cannings</surname>
<given-names>C</given-names>
</name>
<source/>Handbook of Statistical Genetics
          <year>2007</year>
<edition>3</edition>
<publisher-name>John Wiley &amp; Sons, Chichester, England; Hoboken, NJ</publisher-name>
</mixed-citation>
</ref>
<ref id="B6">
<mixed-citation publication-type="journal">
<name>
<surname>de los Campos</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Gianola</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Allison</surname>
<given-names>DB</given-names>
</name>
<article-title>Predicting genetic predisposition in humans: the promise of whole-genome markers</article-title>
<source/>Nature Reviews Genetics
          <year>2010</year>
<volume>11</volume>
<issue>12</issue>
<fpage>880</fpage>
<lpage>886</lpage>
<pub-id pub-id-type="doi">10.1038/nrg2898</pub-id>
<pub-id pub-id-type="pmid">21045869</pub-id>
</mixed-citation>
</ref>
<ref id="B7">
<mixed-citation publication-type="journal">
<name>
<surname>Meuwissen</surname>
<given-names>TH</given-names>
</name>
<name>
<surname>Hayes</surname>
<given-names>BJ</given-names>
</name>
<name>
<surname>Goddard</surname>
<given-names>ME</given-names>
</name>
<article-title>Prediction of total genetic value using genome-wide dense marker maps</article-title>
<source/>Genetics
          <year>2001</year>
<volume>157</volume>
<issue>4</issue>
<fpage>1819</fpage>
<lpage>1829</lpage>
<pub-id pub-id-type="pmid">11290733</pub-id>
</mixed-citation>
</ref>
<ref id="B8">
<mixed-citation publication-type="journal">
<name>
<surname>Yang</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Montgomery</surname>
<given-names>GW</given-names>
</name>
<name>
<surname>Goddard</surname>
<given-names>ME</given-names>
</name>
<name>
<surname>Visscher</surname>
<given-names>PM</given-names>
</name>
<name>
<surname>Benyamin</surname>
<given-names>B</given-names>
</name>
<name>
<surname>McEvoy</surname>
<given-names>BP</given-names>
</name>
<name>
<surname>Gordon</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Henders</surname>
<given-names>AK</given-names>
</name>
<name>
<surname>Nyholt</surname>
<given-names>DR</given-names>
</name>
<name>
<surname>Madden</surname>
<given-names>PA</given-names>
</name>
<name>
<surname>Heath</surname>
<given-names>AC</given-names>
</name>
<name>
<surname>Martin</surname>
<given-names>NG</given-names>
</name>
<article-title>Common SNPs explain a large proportion of the heritability for human height</article-title>
<source/>Nature Genetics
          <year>2010</year>
<volume>42</volume>
<issue>7</issue>
<fpage>565</fpage>
<pub-id pub-id-type="doi">10.1038/ng.608</pub-id>
<pub-id pub-id-type="pmid">20562875</pub-id>
</mixed-citation>
</ref>
<ref id="B9">
<mixed-citation publication-type="journal">
<name>
<surname>Makowsky</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Pajewski</surname>
<given-names>NM</given-names>
</name>
<name>
<surname>Klimentidis</surname>
<given-names>YC</given-names>
</name>
<name>
<surname>Vazquez</surname>
<given-names>AI</given-names>
</name>
<name>
<surname>Duarte</surname>
<given-names>CW</given-names>
</name>
<name>
<surname>Allison</surname>
<given-names>DB</given-names>
</name>
<name>
<surname>de los Campos</surname>
<given-names>G</given-names>
</name>
<article-title>Beyond missing heritability: prediction of complex traits</article-title>
<source/>PLoS Genetics
          <year>2011</year>
<volume>7</volume>
<issue>4</issue>
<fpage>1002051</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pgen.1002051</pub-id>
</mixed-citation>
</ref>
<ref id="B10">
<mixed-citation publication-type="journal">
<name>
<surname>Hill</surname>
<given-names>WG</given-names>
</name>
<name>
<surname>Wray</surname>
<given-names>NR</given-names>
</name>
<article-title>Heritability in the genomics era-concepts and misconceptions</article-title>
<source/>Nature Reviews Genetics
          <year>2008</year>
<volume>9</volume>
<issue>4</issue>
<fpage>255</fpage>
<lpage>266</lpage>
<pub-id pub-id-type="doi">10.1038/nrg2322</pub-id>
<pub-id pub-id-type="pmid">18319743</pub-id>
</mixed-citation>
</ref>
<ref id="B11">
<mixed-citation publication-type="journal">
<name>
<surname>Yang</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Lee</surname>
<given-names>SH</given-names>
</name>
<name>
<surname>Goddard</surname>
<given-names>ME</given-names>
</name>
<name>
<surname>Visscher</surname>
<given-names>PM</given-names>
</name>
<article-title>Gcta: a tool for genome-wide complex trait analysis</article-title>
<source/>Am J Hum Genet
          <year>2011</year>
<volume>88</volume>
<issue>1</issue>
<fpage>76</fpage>
<lpage>82</lpage>
<pub-id pub-id-type="doi">10.1016/j.ajhg.2010.11.011</pub-id>
<pub-id pub-id-type="pmid">21167468</pub-id>
</mixed-citation>
</ref>
<ref id="B12">
<mixed-citation publication-type="journal">
<name>
<surname>Speed</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Hemani</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Johnson</surname>
<given-names>MR</given-names>
</name>
<name>
<surname>Balding</surname>
<given-names>DJ</given-names>
</name>
<article-title>Improved heritability estimation from genome-wide SNPs</article-title>
<source/>American Journal of Human Genetics
          <year>2012</year>
<volume>91</volume>
<issue>6</issue>
<fpage>1011</fpage>
<lpage>1021</lpage>
<pub-id pub-id-type="doi">10.1016/j.ajhg.2012.10.010</pub-id>
<pub-id pub-id-type="pmid">23217325</pub-id>
</mixed-citation>
</ref>
<ref id="B13">
<mixed-citation publication-type="journal">
<name>
<surname>Kranzler</surname>
<given-names>HR</given-names>
</name>
<name>
<surname>Wilcox</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Weiss</surname>
<given-names>RD</given-names>
</name>
<name>
<surname>Brady</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Hesselbrock</surname>
<given-names>V</given-names>
</name>
<name>
<surname>Rounsaville</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Farrer</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Gelernter</surname>
<given-names>J</given-names>
</name>
<article-title>The validity of cocaine dependence subtypes</article-title>
<source/>Addict Behav
          <year>2008</year>
<volume>33</volume>
<issue>1</issue>
<fpage>41</fpage>
<lpage>53</lpage>
<pub-id pub-id-type="doi">10.1016/j.addbeh.2007.05.011</pub-id>
<pub-id pub-id-type="pmid">17582692</pub-id>
</mixed-citation>
</ref>
<ref id="B14">
<mixed-citation publication-type="journal">
<name>
<surname>Bi</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Gelernter</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Sun</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Kranzler</surname>
<given-names>HR</given-names>
</name>
<article-title>Comparing the utility of homogeneous subtypes of cocaine use and related behaviors with dsm-iv cocaine dependence as traits for genetic association analysis</article-title>
<source/>Am J Med Genet B Neuropsychiatr Genet
          <year>2014</year>
<volume>165B</volume>
<issue>2</issue>
<fpage>148</fpage>
<lpage>56</lpage>
<pub-id pub-id-type="pmid">24339190</pub-id>
</mixed-citation>
</ref>
<ref id="B15">
<mixed-citation publication-type="other">
<name>
<surname>Sun</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Bi</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Chan</surname>
<given-names>G</given-names>
</name>
<name>
<surname>Oslin</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Farrer</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Gelernter</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Kranzler</surname>
<given-names>HR</given-names>
</name>
<article-title>Improved methods to identify stable, highly heritable subtypes of opioid use and related behaviors</article-title>
<source/>Addictive Behaviors
          <year>2012</year>
</mixed-citation>
</ref>
<ref id="B16">
<mixed-citation publication-type="journal">
<name>
<surname>Gelernter</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Panhuysen</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Wilcox</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Hesselbrock</surname>
<given-names>V</given-names>
</name>
<name>
<surname>Rounsaville</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Poling</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Weiss</surname>
<given-names>R</given-names>
</name>
<name>
<surname>Sonne</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Zhao</surname>
<given-names>H</given-names>
</name>
<name>
<surname>Farrer</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Kranzler</surname>
<given-names>HR</given-names>
</name>
<article-title>Genomewide linkage scan for opioid dependence and related traits</article-title>
<source/>American Journal of Human Genetics
          <year>2006</year>
<volume>78</volume>
<issue>5</issue>
<fpage>759</fpage>
<lpage>769</lpage>
<pub-id pub-id-type="doi">10.1086/503631</pub-id>
<pub-id pub-id-type="pmid">16642432</pub-id>
</mixed-citation>
</ref>
<ref id="B17">
<mixed-citation publication-type="journal">
<name>
<surname>Babor</surname>
<given-names>TF</given-names>
</name>
<name>
<surname>Caetano</surname>
<given-names>R</given-names>
</name>
<article-title>Subtypes of substance dependence and abuse: implications for diagnostic classification and empirical research</article-title>
<source/>Addiction (Abingdon, England)
          <year>2006</year>
<volume>101</volume>
<fpage>104</fpage>
<lpage>10</lpage>
</mixed-citation>
</ref>
<ref id="B18">
<mixed-citation publication-type="journal">
<name>
<surname>Hu</surname>
<given-names>VW</given-names>
</name>
<name>
<surname>Addington</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Hyman</surname>
<given-names>A</given-names>
</name>
<article-title>Novel autism subtype-dependent genetic variants are revealed by quantitative trait and subphenotype association analyses of published gwas data</article-title>
<source/>PloS ONE
          <year>2011</year>
<volume>6</volume>
<issue>4</issue>
<fpage>19067</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pone.0019067</pub-id>
</mixed-citation>
</ref>
<ref id="B19">
<mixed-citation publication-type="journal">
<name>
<surname>Ott</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Rabinowitz</surname>
<given-names>D</given-names>
</name>
<article-title>A principal-components approach based on heritability for combining phenotype information</article-title>
<source/>Hum Hered
          <year>1999</year>
<volume>49</volume>
<issue>2</issue>
<fpage>106</fpage>
<lpage>11</lpage>
<pub-id pub-id-type="doi">10.1159/000022854</pub-id>
<pub-id pub-id-type="pmid">10077732</pub-id>
</mixed-citation>
</ref>
<ref id="B20">
<mixed-citation publication-type="journal">
<name>
<surname>Wang</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Fang</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Jin</surname>
<given-names>M</given-names>
</name>
<article-title>A ridge penalized principal-components approach based on heritability for high-dimensional data</article-title>
<source/>Hum Hered
          <year>2007</year>
<volume>64</volume>
<issue>3</issue>
<fpage>182</fpage>
<lpage>91</lpage>
<pub-id pub-id-type="doi">10.1159/000102991</pub-id>
<pub-id pub-id-type="pmid">17536212</pub-id>
</mixed-citation>
</ref>
<ref id="B21">
<mixed-citation publication-type="journal">
<name>
<surname>Klei</surname>
<given-names>L</given-names>
</name>
<name>
<surname>Luca</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Devlin</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Roeder</surname>
<given-names>K</given-names>
</name>
<article-title>Pleiotropy and principal components of heritability combine to increase power for association analysis</article-title>
<source/>Genet Epidemiol
          <year>2008</year>
<volume>32</volume>
<issue>1</issue>
<fpage>9</fpage>
<lpage>19</lpage>
<pub-id pub-id-type="doi">10.1002/gepi.20257</pub-id>
<pub-id pub-id-type="pmid">17922480</pub-id>
</mixed-citation>
</ref>
<ref id="B22">
<mixed-citation publication-type="journal">
<name>
<surname>Oualkacha</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Labbe</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Ciampi</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Roy</surname>
<given-names>MA</given-names>
</name>
<name>
<surname>Maziade</surname>
<given-names>M</given-names>
</name>
<article-title>Principal components of heritability for high dimension quantitative traits and general pedigrees</article-title>
<source/>Statistical Applications in Genetics and Molecular Biology
          <year>2012</year>
<volume>11</volume>
<issue>2</issue>
</mixed-citation>
</ref>
<ref id="B23">
<mixed-citation publication-type="book">
<name>
<surname>Sun</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Bi</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Kranzler</surname>
<given-names>HR</given-names>
</name>
<article-title>Quadratic optimization to identify highly heritable quantitative traits from complex phenotypic features</article-title>
<source/>Proceedings of the 19th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining KDD '13
          <year>2013</year>
<publisher-name>ACM, New York, NY, USA</publisher-name>
<fpage>811</fpage>
<lpage>819</lpage>
</mixed-citation>
</ref>
<ref id="B24">
<mixed-citation publication-type="journal">
<name>
<surname>Patterson</surname>
<given-names>HD</given-names>
</name>
<name>
<surname>Thompson</surname>
<given-names>R</given-names>
</name>
<article-title>Recovery of inter-block information when block sizes are unequal</article-title>
<source/>Biometrika
          <year>1971</year>
<volume>58</volume>
<issue>3</issue>
<fpage>545</fpage>
<lpage>554</lpage>
<pub-id pub-id-type="doi">10.1093/biomet/58.3.545</pub-id>
</mixed-citation>
</ref>
<ref id="B25">
<mixed-citation publication-type="journal">
<name>
<surname>Verbyla</surname>
<given-names>AP</given-names>
</name>
<article-title>A conditional derivation of residual maximum likelihood</article-title>
<source/>Australian Journal of Statistics
          <year>1990</year>
<volume>32</volume>
<issue>2</issue>
<fpage>227</fpage>
<lpage>230</lpage>
<comment>doi:10.1111/j.1467-842X.1990.tb01015.x</comment>
<pub-id pub-id-type="doi">10.1111/j.1467-842X.1990.tb01015.x</pub-id>
</mixed-citation>
</ref>
<ref id="B26">
<mixed-citation publication-type="journal">
<name>
<surname>Vapnik</surname>
<given-names>VN</given-names>
</name>
<article-title>An overview of statistical learning theory</article-title>
<source/>IEEE Transactions on Neural Networks
          <year>1999</year>
<volume>10</volume>
<issue>5</issue>
<fpage>988</fpage>
<lpage>999</lpage>
<pub-id pub-id-type="doi">10.1109/72.788640</pub-id>
<pub-id pub-id-type="pmid">18252602</pub-id>
</mixed-citation>
</ref>
<ref id="B27">
<mixed-citation publication-type="book">
<name>
<surname>Nocedal</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Wright</surname>
<given-names>SJ</given-names>
</name>
<source/>Numerical Optimization
          <year>2006</year>
<edition>2</edition>
<publisher-name>Springer, New York</publisher-name>
</mixed-citation>
</ref>
<ref id="B28">
<mixed-citation publication-type="book">
<name>
<surname>Nocedal</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Wright</surname>
<given-names>SJ</given-names>
</name>
<source/>Numerical Optimization
          <year>2006</year>
<publisher-name>Springer, New York</publisher-name>
</mixed-citation>
</ref>
<ref id="B29">
<mixed-citation publication-type="journal">
<name>
<surname>Pritchard</surname>
<given-names>JK</given-names>
</name>
<name>
<surname>Stephens</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Donnelly</surname>
<given-names>P</given-names>
</name>
<article-title>Inference of population structure using multilocus genotype data</article-title>
<source/>Genetics
          <year>2000</year>
<volume>155</volume>
<issue>2</issue>
<fpage>945</fpage>
<lpage>59</lpage>
<pub-id pub-id-type="pmid">10835412</pub-id>
</mixed-citation>
</ref>
<ref id="B30">
<mixed-citation publication-type="journal">
<name>
<surname>Yang</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Benyamin</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Visscher</surname>
<given-names>PM</given-names>
</name>
<article-title>Common snps explain a large proportion of the heritability for human height</article-title>
<source/>Nat Genet
          <year>2010</year>
<volume>42</volume>
<issue>7</issue>
<fpage>565</fpage>
<lpage>9</lpage>
<pub-id pub-id-type="doi">10.1038/ng.608</pub-id>
<pub-id pub-id-type="pmid">20562875</pub-id>
</mixed-citation>
</ref>
<ref id="B31">
<mixed-citation publication-type="journal">
<name>
<surname>Hesselbrock</surname>
<given-names>VM</given-names>
</name>
<name>
<surname>Hesselbrock</surname>
<given-names>MN</given-names>
</name>
<article-title>Are there empirically supported and clinically useful subtypes of alcohol dependence?</article-title>
<source/>Addiction
          <year>2006</year>
<volume>101</volume>
<issue>Suppl 1</issue>
<fpage>97</fpage>
<lpage>103</lpage>
<pub-id pub-id-type="pmid">16930165</pub-id>
</mixed-citation>
</ref>
</ref-list>
</back>
</article>
</pmc-articleset>