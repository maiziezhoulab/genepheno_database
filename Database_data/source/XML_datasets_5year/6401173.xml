<?xml version="1.0" ?>
<!DOCTYPE pmc-articleset PUBLIC "-//NLM//DTD ARTICLE SET 2.0//EN" "https://dtd.nlm.nih.gov/ncbi/pmc/articleset/nlm-articleset-2.0.dtd">

<pmc-articleset><article article-type="research-article" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<?properties open_access?>
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">Nat Commun</journal-id>
<journal-id journal-id-type="iso-abbrev">Nat Commun</journal-id>
<journal-title-group>
<journal-title>Nature Communications</journal-title>
</journal-title-group>
<issn pub-type="epub">2041-1723</issn>
<publisher>
<publisher-name>Nature Publishing Group UK</publisher-name>
<publisher-loc>London</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="pmid">30837457</article-id>
<article-id pub-id-type="pmc">6401173</article-id>
<article-id pub-id-type="publisher-id">8890</article-id>
<article-id pub-id-type="doi">10.1038/s41467-019-08890-y</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A theoretical framework for controlling complex microbial communities</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9802-8567</contrib-id>
<name>
<surname>Angulo</surname>
<given-names>Marco Tulio</given-names>
</name>
<address>
<email>mangulo@im.unam.mx</email>
</address>
<xref ref-type="aff" rid="Aff1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3803-8760</contrib-id>
<name>
<surname>Moog</surname>
<given-names>Claude H.</given-names>
</name>
<xref ref-type="aff" rid="Aff2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2728-4907</contrib-id>
<name>
<surname>Liu</surname>
<given-names>Yang-Yu</given-names>
</name>
<address>
<email>yyl@channing.harvard.edu</email>
</address>
<xref ref-type="aff" rid="Aff3">3</xref>
<xref ref-type="aff" rid="Aff4">4</xref>
</contrib>
<aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2159 0001</institution-id><institution-id institution-id-type="GRID">grid.9486.3</institution-id><institution>CONACyT – Institute of Mathematics, </institution><institution>Universidad Nacional Autónoma de México, </institution></institution-wrap>Juriquilla, Querétaro, 76230 Mexico </aff>
<aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.503212.7</institution-id><institution>Laboratoire des Sciences du Numérique de Nantes, </institution></institution-wrap>UMR CNRS 6004, Nantes, 44321 France </aff>
<aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0378 8294</institution-id><institution-id institution-id-type="GRID">grid.62560.37</institution-id><institution>Channing Division of Network Medicine, </institution><institution>Brigham and Women’s Hospital and Harvard Medical School, </institution></institution-wrap>Boston, MA 02115 USA </aff>
<aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2106 9910</institution-id><institution-id institution-id-type="GRID">grid.65499.37</institution-id><institution>Center for Cancer Systems Biology, </institution><institution>Dana-Farber Cancer Institute, </institution></institution-wrap>Boston, MA 02115 USA </aff>
</contrib-group>
<pub-date pub-type="epub">
<day>5</day>
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="pmc-release">
<day>5</day>
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="collection">
<year>2019</year>
</pub-date>
<volume>10</volume>
<elocation-id>1045</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>5</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>6</day>
<month>2</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-statement>© The Author(s) 2019</copyright-statement>
<license license-type="OpenAccess">
<license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p>
</license>
</permissions>
<abstract id="Abs1">
<p id="Par1">Microbes form complex communities that perform critical roles for the integrity of their environment or the well-being of their hosts. Controlling these microbial communities can help us restore natural ecosystems and maintain healthy human microbiota. However, the lack of an efficient and systematic control framework has limited our ability to manipulate these microbial communities. Here we fill this gap by developing a control framework based on the new notion of structural accessibility. Our framework uses the ecological network of the community to identify minimum sets of its driver species, manipulation of which allows controlling the whole community. We numerically validate our control framework on large communities, and then we demonstrate its application for controlling the gut microbiota of gnotobiotic mice infected with <italic>Clostridium difficile</italic> and the core microbiota of the sea sponge <italic>Ircinia oros</italic>. Our results provide a systematic pipeline to efficiently drive complex microbial communities towards desired states.</p>
</abstract>
<abstract abstract-type="web-summary" id="Abs2">
<p id="Par2">Controlling microbial communities could help restore ecosystems and maintain healthy microbiota. Here, the authors introduce the notion of structural accessibility and develop a framework to identify minimal sets of driver species, manipulation of which could allow control of a microbial community.</p>
</abstract>
<custom-meta-group>
<custom-meta>
<meta-name>issue-copyright-statement</meta-name>
<meta-value>© The Author(s) 2019</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="Sec1" sec-type="introduction">
<title>Introduction</title>
<p id="Par3">Microorganisms form complex communities that play critical roles in maintaining the well-being of their hosts or the integrity of their environment<sup><xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR4">4</xref></sup>. Disrupting these microbial communities can have severe consequences. In humans, for example, a disruption to the gut microbiota—the aggregate of microorganisms residing in our intestine—is associated with several disorders including irritable bowel syndrome, <italic>Clostridium difficile</italic> Infection (CDI), autism, obesity, and cavernous cerebral malformations<sup><xref ref-type="bibr" rid="CR5">5</xref>–<xref ref-type="bibr" rid="CR7">7</xref></sup>. For agriculture crops, a disruption of rhizosphere microbiota can reduce their disease resistance and hence decrease the overall crop yield<sup><xref ref-type="bibr" rid="CR8">8</xref>,<xref ref-type="bibr" rid="CR9">9</xref></sup>. In the oceans, a disruption to their microbiota can impact global climate by altering carbon sequestration rates<sup><xref ref-type="bibr" rid="CR3">3</xref>,<xref ref-type="bibr" rid="CR4">4</xref>,<xref ref-type="bibr" rid="CR10">10</xref></sup>. Driving disrupted microbial communities back to their healthy states could offer novel solutions to prevent and treat complex human diseases, enhance sustainable agriculture, and regulate global warming<sup><xref ref-type="bibr" rid="CR11">11</xref>,<xref ref-type="bibr" rid="CR12">12</xref></sup>. For instance, inoculating soil microbes can restore terrestrial ecosystems<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>, and fecal microbiota transplantation (FMT) is so far the most successful therapy for treating recurrent CDI<sup><xref ref-type="bibr" rid="CR14">14</xref></sup>. Despite the success of these empirical strategies, a broad application of microbial-manipulation strategies will be possible only if we can efficiently control large complex microbial communities<sup><xref ref-type="bibr" rid="CR15">15</xref></sup>.</p>
<p id="Par4">There are two big challenges down the road. First, an efficient control method should only manipulate a minimum set of species in the community. However, we still lack a systematic method to identify minimum sets of those “driver species” whose control can help us drive a whole community to desired states. Here, we use the term “species” without necessarily representing the lowest major taxonomic rank. One could also organize microbes by strains, genera, or operational taxonomical units. Second, even when those driver species have been identified, designing the control strategy that should be applied to them (e.g., how their abundance needs to be manipulated) for driving the community towards the desired state remains difficult. This difficulty arises because of the inherent complexity of microbial dynamics and our limited knowledge of them.</p>
<p id="Par5">To address those two challenges, here we develop a control framework using the ecological network underlying the microbial community. First, we introduce the new notion of “structural accessibility”, which generalizes the notion of structural linear controllability<sup><xref ref-type="bibr" rid="CR16">16</xref>,<xref ref-type="bibr" rid="CR17">17</xref></sup> to systems with nonlinear dynamics. Then, we derive a complete graph-theoretical  characterization of structural accessibility. This result enables  us to efficiently identify minimum sets of driver species of any microbial community purely from the topology of its underlying ecological network, even if some microbial interactions are missing and its population dynamics is unknown. Once the driver species are identified, we systematically design feedback control strategies to drive a microbial community towards the desired state, even if its dynamics is not precisely known. We numerically validated our control framework in large microbial communities, analyzing its performance for different parameters of the community (e.g., the connectivity of its underlying ecological network), and for errors in the ecological network used to identify the driver species. Finally, we demonstrate our framework by controlling the core microbiota of the sea sponge <italic>Ircinia oros</italic>, and restoring the gut microbiota of gnotobiotic mice infected by <italic>Clostridium difficile</italic>. Our results provide a rational and systematic framework to control microbial communities and other complex ecosystems.</p>
</sec>
<sec id="Sec2" sec-type="results">
<title>Results</title>
<sec id="Sec3">
<title>Modeling controlled microbial communities</title>
<p id="Par6">Our framework focuses on the impact that manipulating a subset of species has on the abundances of other species. We thus consider a microbial community whose state at time <italic>t</italic> is determined from the abundance profile <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x(t) \in {\Bbb R}^N$$\end{document}</tex-math><mml:math id="M2"><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq1.gif"></inline-graphic></alternatives></inline-formula> of its <italic>N</italic> species, where the <italic>i</italic>-th entry <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>) represents the abundance of the <italic>i</italic>-th species at time <italic>t</italic>. The state evolves according to some population dynamics<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x(t) = f(x(t)),$$\end{document}</tex-math><mml:math display="block" id="M4"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic position="anchor" xlink:href="41467_2019_8890_Article_Equ1.gif"></graphic></alternatives></disp-formula>where the function <inline-formula id="IEq2"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f:{\Bbb R}^N \to {\Bbb R}^N$$\end{document}</tex-math><mml:math id="M6"><mml:mi>f</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq2.gif"></inline-graphic></alternatives></inline-formula> models the species intrinsic growth and the inter/intra-species interactions of the community (see Supplementary Note <xref ref-type="media" rid="MOESM1">1</xref> for details). For most microbial communities <italic>f</italic> is unknown and difficult to infer given the many interaction mechanisms between microbes<sup><xref ref-type="bibr" rid="CR18">18</xref></sup>. Thus, we assume that <italic>f</italic>(<italic>x</italic>) is some unknown meromorphic function of <italic>x</italic> (i.e., the quotient of analytic functions). This assumption is very mild as it is satisfied by most population dynamics models<sup><xref ref-type="bibr" rid="CR19">19</xref></sup>.</p>
<p id="Par7">Instead of knowing the population dynamics of the microbial community, we assume we know its underlying ecological network <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G} = ({\mathrm{X}},{\mathrm{E}})$$\end{document}</tex-math><mml:math id="M8"><mml:mi mathvariant="script">G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq3.gif"></inline-graphic></alternatives></inline-formula>. This network is a directed graph where nodes X = {x<sub>1</sub>, …, x<sub><italic>N</italic></sub>} represent species, and edges (x<sub><italic>j</italic></sub> → x<sub><italic>i</italic></sub>) ∈ E denote that the <italic>j</italic>-th species has a direct ecological impact (i.e., direct promotion or inhibition of growth) on the <italic>i</italic>-th species (Fig. <xref ref-type="fig" rid="Fig1">1a</xref>). Mapping ecological networks requires performing mono- and co-culture experiments<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR21">21</xref></sup>, using system identification techniques with time-resolved abundance data<sup><xref ref-type="bibr" rid="CR22">22</xref>,<xref ref-type="bibr" rid="CR23">23</xref></sup>, or using steady-state abundance data via a recently developed inference method<sup><xref ref-type="bibr" rid="CR24">24</xref></sup>. In general, ecological networks are different from correlation networks<sup><xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR25">25</xref></sup> because correlation does not imply causation<sup><xref ref-type="bibr" rid="CR26">26</xref>,<xref ref-type="bibr" rid="CR27">27</xref></sup>. <fig id="Fig1"><label>Fig. 1</label><caption><p>Controlling a microbial community. <bold>a</bold> Ecological network <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}$$\end{document}</tex-math><mml:math id="M10"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq4.gif"></inline-graphic></alternatives></inline-formula> for a toy microbial community of <italic>N</italic> = 3 species (green, yellow, blue). The controlled ecological network <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M12"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq5.gif"></inline-graphic></alternatives></inline-formula> contains <italic>M</italic> = 1 control input actuating the third species. <bold>b</bold> Initial and desired abundance profiles (bars). Controlling the community consists in driving its state from the initial state <italic>x</italic><sub>0</sub> to the desired state <italic>x</italic><sub>d</sub>, represented by two points in the state space of the community. <bold>c</bold> In the continuous control scheme, the control inputs <italic>u</italic>(<italic>t</italic>) are continuous signals modifying the growth of the actuated species. The controlled population dynamics of this community is given by <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x_1 = 0.1 + x_1(1 - x_1/5)(x_1/3 - 1) - (0.1x_1x_3)/(1 + x_3)$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>5</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>3</mml:mn><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0.1</mml:mn><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq6.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x_2 = 0.1 + x_2(1 - x_2/4)(x_2 - 1) + (x_2x_3)/(1 + x_3)$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∕</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq7.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq8"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x_3 = x_3(1 - x_3/2)(x_3 - 1) + u$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>u</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq8.gif"></inline-graphic></alternatives></inline-formula>. In the absence of control, this community has two equilibria <inline-formula id="IEq9"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_0 = (3.14,4.58,1)^ \top$$\end{document}</tex-math><mml:math id="M20"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3.14</mml:mn><mml:mo>,</mml:mo><mml:mn>4.58</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq9.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{\mathrm{d}} = (4.57,4.73,2)^ \top$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>4.57</mml:mn><mml:mo>,</mml:mo><mml:mn>4.73</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq10.gif"></inline-graphic></alternatives></inline-formula>, chosen as the initial and desired states, respectively. <bold>d</bold> In the impulsive control scheme, the control inputs <italic>u</italic>(<italic>t</italic>) are impulses applied at the intervention instants <inline-formula id="IEq11"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Bbb T} = \{ t_1,t_2, \cdots \}$$\end{document}</tex-math><mml:math id="M24"><mml:mi mathvariant="double-struck">T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq11.gif"></inline-graphic></alternatives></inline-formula>, instantaneously changing the abundance of the actuated species. The controlled population dynamics is the same as in panel (<bold>c</bold>), except that <inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x_3 = x_3(1 - x_3/2)(x_3 - 1)$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>∕</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq12.gif"></inline-graphic></alternatives></inline-formula> and <italic>x</italic><sub>3</sub>(<italic>t</italic><sup>+</sup>) = <italic>x</italic><sub>3</sub>(<italic>t</italic>) + <italic>u</italic>(<italic>t</italic>) if <inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in {\Bbb T} = \{ 5,10,15\}$$\end{document}</tex-math><mml:math id="M28"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq13.gif"></inline-graphic></alternatives></inline-formula>. Under this controlled population dynamics, our mathematical formalism identifies x<sub>3</sub> as the solo driver species needed to drive this microbial community (Example 1 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>)</p></caption><graphic id="d29e1205" xlink:href="41467_2019_8890_Fig1_HTML"></graphic></fig></p>
<p id="Par8">Controlling the community consists in driving its state from an initial value <inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_0 = x(0) \in {\Bbb R}^N$$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq14.gif"></inline-graphic></alternatives></inline-formula> at <italic>t</italic> = 0 (e.g., a “diseased” state) towards the desired value <inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{\mathrm{d}} \in {\Bbb R}^N$$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq15.gif"></inline-graphic></alternatives></inline-formula> (e.g., the “healthy” state, Fig. <xref ref-type="fig" rid="Fig1">1b</xref>). We assume that the community will not evolve by itself to <italic>x</italic><sub>d</sub>. To drive the community, we use <italic>M</italic> control inputs <inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u(t) \in {\Bbb R}^M$$\end{document}</tex-math><mml:math id="M34"><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq16.gif"></inline-graphic></alternatives></inline-formula> directly affecting certain species that we call “actuated species” (Fig. <xref ref-type="fig" rid="Fig1">1a</xref>). Control inputs encode a combination of <italic>M</italic> control actions applied at time <italic>t</italic>. We consider four possible control actions. If <italic>u</italic><sub><italic>j</italic></sub>(<italic>t</italic>) &lt; 0, the <italic>j</italic>-th control action at time <italic>t</italic> can be a bacteriostatic agent or bactericide, decreasing the abundance<sup><xref ref-type="bibr" rid="CR28">28</xref></sup> of the species it actuates. If <italic>u</italic><sub><italic>j</italic></sub>(<italic>t</italic>) &gt; 0, the <italic>j</italic>-th control action at time <italic>t</italic> can be a prebiotic<sup><xref ref-type="bibr" rid="CR29">29</xref></sup> or transplantation, stimulating the growth or engrafting a consortium of the species it actuates, respectively. Probiotics administration<sup><xref ref-type="bibr" rid="CR30">30</xref></sup> and FMTs<sup><xref ref-type="bibr" rid="CR14">14</xref></sup> are examples of transplantations. To specify the species actuated by each control input we introduce the controlled ecological network <inline-formula id="IEq17"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{{\kern 1pt} c{\kern 1pt} } = ({\mathrm{X}} \cup {\mathrm{U}},{\mathrm{E}} \cup {\mathrm{B}})$$\end{document}</tex-math><mml:math id="M36"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mo>∪</mml:mo><mml:mi mathvariant="normal">U</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">E</mml:mi><mml:mo>∪</mml:mo><mml:mi mathvariant="normal">B</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq17.gif"></inline-graphic></alternatives></inline-formula>. Here, U = {u<sub>1</sub>, …, u<sub><italic>M</italic></sub>} are the control input nodes and (u<sub><italic>j</italic></sub> → x<sub><italic>i</italic></sub>) ∈ B denotes that the <italic>j</italic>-th control input actuates the <italic>i</italic>-th species (Fig. <xref ref-type="fig" rid="Fig1">1a</xref>).</p>
<p id="Par9">We introduce two control schemes describing how the control inputs change the species abundance (see Supplementary Note <xref ref-type="media" rid="MOESM1">1</xref> for details). The first control scheme models a combination of prebiotics (if <italic>u</italic><sub><italic>j</italic></sub>(<italic>t</italic>) &gt; 0) and bacteriostatic agents (if <italic>u</italic><sub><italic>j</italic></sub>(<italic>t</italic>) &lt; 0) as continuous control inputs modifying the growth of the actuated species (Fig. <xref ref-type="fig" rid="Fig1">1c</xref>):<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x(t) = f\left( {x(t)} \right) + g\left( {x(t)} \right)u(t),\quad t \in {\Bbb R}.$$\end{document}</tex-math><mml:math display="block" id="M38"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"></mml:mspace><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi><mml:mo>.</mml:mo></mml:math><graphic position="anchor" xlink:href="41467_2019_8890_Article_Equ2.gif"></graphic></alternatives></disp-formula></p>
<p id="Par10">The second control scheme models a combination of transplantations (if <italic>u</italic><sub><italic>j</italic></sub>(<italic>t</italic>) &gt; 0) and bactericides (if <italic>u</italic><sub><italic>j</italic></sub>(<italic>t</italic>) &lt; 0) applied at discrete intervention instants <inline-formula id="IEq18"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Bbb T} = \{ t_1,t_2, \cdots \}$$\end{document}</tex-math><mml:math id="M40"><mml:mi mathvariant="double-struck">T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq18.gif"></inline-graphic></alternatives></inline-formula>, rendering impulsive control inputs that instantaneously modify the abundance of the actuated species (Fig. <xref ref-type="fig" rid="Fig1">1d</xref>):<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x(t) = f\left( {x(t)} \right)\,{\mathrm{if}}\,t\not \in {\Bbb T},\quad x(t^ + ) = x(t) + g\left( {x(t)} \right)u(t)\,{\mathrm{if}}\,t \in {\Bbb T}.$$\end{document}</tex-math><mml:math display="block" id="M42"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mspace width="0.3em"></mml:mspace><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.3em"></mml:mspace><mml:mi>t</mml:mi><mml:mo>∉</mml:mo><mml:mi mathvariant="double-struck">T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"></mml:mspace><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>g</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfenced><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.3em"></mml:mspace><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.3em"></mml:mspace><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">T</mml:mi><mml:mo>.</mml:mo></mml:math><graphic position="anchor" xlink:href="41467_2019_8890_Article_Equ3.gif"></graphic></alternatives></disp-formula></p>
<p id="Par11">Above, <italic>x</italic>(<italic>t</italic><sup>+</sup>) denotes the state “right after time <italic>t</italic>”, so <italic>x</italic>(<italic>t</italic>) “jumps” at <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in {\Bbb T}$$\end{document}</tex-math><mml:math id="M44"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq19.gif"></inline-graphic></alternatives></inline-formula> if <italic>u</italic>(<italic>t</italic>) ≠ 0. The pair {<italic>f</italic>, <italic>g</italic>} characterizes both control schemes, describing the controlled population dynamics of the microbial community. The function <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g:{\Bbb R}^N \to {\Bbb R}^{N \times M}$$\end{document}</tex-math><mml:math id="M46"><mml:mi>g</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq20.gif"></inline-graphic></alternatives></inline-formula> models the direct susceptibility of the species to the control actions. The <italic>j</italic>-th control input actuates the <italic>i</italic>-th species if <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{ij}\not \equiv 0$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≢</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq21.gif"></inline-graphic></alternatives></inline-formula>. Because <italic>g</italic> is typically unknown, we just assume that <italic>g</italic>(<italic>x</italic>) is some unknown meromorphic function of <italic>x</italic> such that <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{ij}\not \equiv 0$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≢</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq22.gif"></inline-graphic></alternatives></inline-formula> iff (u<sub><italic>j</italic></sub> → x<sub><italic>i</italic></sub>) ∈ B.</p>
<p id="Par12">Notice that when all species are directly controlled (i.e., an independent control input actuates each species), the whole microbial community can easily be driven to the desired state. Fortunately, as we show next, actuating all the species is far from being necessary. Thanks to the inter-species interactions encoded in the ecological network <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}$$\end{document}</tex-math><mml:math id="M52"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq23.gif"></inline-graphic></alternatives></inline-formula>, we can identify minimum sets of species that we need to actuate in order to drive the whole community. We call those species “driver species”.</p>
</sec>
<sec id="Sec4">
<title>Identifying driver species</title>
<p id="Par13">To understand when a set of actuated species is a set of driver species, consider the three-species community with Generalized Lotka–Volterra (GLV) population dynamics of Fig. <xref ref-type="fig" rid="Fig2">2a</xref>. This toy community has one control input actuating x<sub>3</sub>. Actuating only this species creates an autonomous element—namely, a constraint between some species abundances that the control input cannot break, confining the state of the community to a low-dimensional manifold (Fig. <xref ref-type="fig" rid="Fig2">2a</xref>, right). More precisely, our mathematical formalism reveals that <italic>ξ</italic> = <italic>x</italic><sub>1</sub><italic>x</italic><sub>2</sub> is the autonomous element (Example 2 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>). Indeed, differentiating <italic>ξ</italic> with respect to time yields <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot \xi = x_1x_2(1 - x_3) + x_1x_2( - 1 + x_3) \equiv 0$$\end{document}</tex-math><mml:math id="M54"><mml:mover accent="true"><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≡</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq24.gif"></inline-graphic></alternatives></inline-formula>, confining the community to <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ x \in {\Bbb R}^3|x_1x_2 = x_1(0)x_2(0)\}$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq25.gif"></inline-graphic></alternatives></inline-formula>. Intuitively, the autonomous element exists because the control input cannot change <italic>x</italic><sub>1</sub> without changing <italic>x</italic><sub>2</sub> in a predefined way, making it impossible to drive the community in the three-dimensional state space. This observation indicates that x<sub>3</sub> alone cannot be a driver species for this community. Introducing a second control input actuating x<sub>1</sub> helps the community jump out of the low-dimensional manifold eliminating the autonomous element, allowing us to drive this community to any desired state with positive abundance (Fig. <xref ref-type="fig" rid="Fig2">2b</xref>, and Example 6 in Supplementary Note <xref ref-type="media" rid="MOESM1">5</xref>). Therefore, {x<sub>1</sub>, x<sub>3</sub>} is a minimum set of driver species for this community.<fig id="Fig2"><label>Fig. 2</label><caption><p>Autonomous elements constrain the state of microbial communities, characterizing their driver species. <bold>a</bold> A three-species community with GLV dynamics <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x_1 = x_1( - 1 + x_3)$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq26.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x_2 = x_2(1 - x_3)$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq27.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x_3 = x_3( - 0.5 + 1.5x_3)$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn><mml:mo>+</mml:mo><mml:mn>1.5</mml:mn><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq28.gif"></inline-graphic></alternatives></inline-formula>. For actuating x<sub>3</sub>, we consider the impulsive control scheme with <italic>x</italic><sub>3</sub>(<italic>t</italic><sup>+</sup>) = <italic>x</italic><sub>3</sub>(<italic>t</italic>) + <italic>u</italic><sub>1</sub>(<italic>t</italic>) for <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in {\Bbb T}$$\end{document}</tex-math><mml:math id="M64"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq29.gif"></inline-graphic></alternatives></inline-formula>. With this controlled population dynamics, our mathematical formalism reveals the autonomous element <italic>x</italic><sub>1</sub><italic>x</italic><sub>2</sub> that constraints the state of this microbial community to the low-dimensional manifold <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ x \in {\Bbb R}^3|x_1x_2 = x_1(0)x_2(0)\}$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>∣</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq30.gif"></inline-graphic></alternatives></inline-formula> (gray) for all control inputs. Five state trajectories (in colors) with random control inputs illustrate this fact. Hence, {x<sub>3</sub>} alone cannot be a set of driver species for this controlled population dynamics. <bold>b</bold> Including a second control input <italic>u</italic><sub>2</sub>(<italic>t</italic>) actuating x<sub>1</sub> (i.e., <italic>x</italic><sub>1</sub>(<italic>t</italic><sup>+</sup>) = <italic>x</italic><sub>1</sub>(<italic>t</italic>) + <italic>u</italic><sub>2</sub>(<italic>t</italic>) for <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in {\Bbb T}$$\end{document}</tex-math><mml:math id="M68"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq31.gif"></inline-graphic></alternatives></inline-formula>) eliminates the autonomous element, since the state of the microbial community (colors) can explore a three-dimensional space (gray). Hence {x<sub>1</sub>, x<sub>3</sub>} is a minimum set of driver species for this community with GLV dynamics. <bold>c</bold> We proved that, generically, increasing the complexity of the controlled population dynamics cannot create autonomous elements. In this example, increasing the deformation size <italic>C</italic> from the GLV in panel (<bold>a</bold>) (with <italic>C</italic> = 0) to the controlled population dynamics in Fig. <xref ref-type="fig" rid="Fig1">1</xref> (with <italic>C</italic> &gt; 0) eliminates the autonomous element that was present by actuating x<sub>3</sub> alone (Example 1 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>). Therefore, increasing the complexity of the population dynamics makes {x<sub>3</sub>} a solo driver species</p></caption><graphic id="d29e2478" xlink:href="41467_2019_8890_Fig2_HTML"></graphic></fig></p>
<p id="Par14">In the general case of <italic>N</italic> species and <italic>M</italic> control inputs, we define a set of actuated species as a set of driver species if the corresponding controlled population dynamics {<italic>f</italic>, <italic>g</italic>} lacks autonomous elements. For linear dynamics {<italic>f</italic>(<italic>x</italic>), <italic>g</italic>(<italic>x</italic>)} = {<italic>Ax</italic>, <italic>B</italic>}, <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A \in {\Bbb R}^{N \times N}$$\end{document}</tex-math><mml:math id="M70"><mml:mi>A</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq32.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B \in {\Bbb R}^{N \times M}$$\end{document}</tex-math><mml:math id="M72"><mml:mi>B</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq33.gif"></inline-graphic></alternatives></inline-formula>, the absence of autonomous elements is equivalent to their controllability<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>—the ability to drive the system between any two states, easily verified using Kalman’s condition <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{rank}}\,[B,AB, \cdots, A^{N - 1}B] = N$$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="normal">rank</mml:mi><mml:mspace width="0.3em"></mml:mspace><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq34.gif"></inline-graphic></alternatives></inline-formula>. In the case of nonlinear dynamics, the absence of autonomous elements can be characterized using a mathematical formalism based on differential one-forms (see Methods and Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>). For the continuous control scheme of Eq. (<xref ref-type="" rid="Equ2">2</xref>), the conditions for the absence of autonomous elements are well understood as they define when a system is accessible<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>, a cornerstone concept in nonlinear control theory. Because it is more natural to control microbial communities with impulsive control actions, in this paper we extended the study of autonomous elements to the impulsive control systems of Eq. (<xref ref-type="" rid="Equ3">3</xref>). We first introduced a definition of autonomous elements for impulsive control systems (Definition 3 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>). We then characterized necessary and sufficient conditions for the absence of autonomous elements in a controlled population dynamics (Theorem 2 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>). To our surprise, the conditions for the absence of autonomous elements for the continuous and the impulsive control schemes are identical (Remark 2 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>). This result means that transplantations and bactericides (impulsive control actions) can be as effective as prebiotics and bacteriostatic agents (continuous control actions).</p>
</sec>
<sec id="Sec5">
<title>Structural accessibility characterizes the generic absence of autonomous elements</title>
<p id="Par15">In general, it remains extremely difficult finding a pair {<italic>f</italic>, <italic>g</italic>} that models the controlled population dynamics of a microbial community. This fact might suggest it is impossible to predict if the controlled community has autonomous elements or not, making it impossible to identify its driver species. We now show that this seemingly unavoidable limitation can be solved using the topology of the controlled ecological network of the community.</p>
<p id="Par16">Define the network <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}_{f,g} = ({\mathrm{X}} \cup {\mathrm{U}},{\mathrm{E}}_{f,g} \cup {\mathrm{B}}_{f,g})$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi><mml:mo>∪</mml:mo><mml:mi mathvariant="normal">U</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">B</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq35.gif"></inline-graphic></alternatives></inline-formula> associated with {<italic>f</italic>, <italic>g</italic>} as follows: (x<sub><italic>j</italic></sub> → x<sub><italic>i</italic></sub>) ∈ E<sub><italic>f</italic>,<italic>g</italic></sub> if <italic>x</italic><sub><italic>j</italic></sub> appears in the right-hand side of <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot x_i$$\end{document}</tex-math><mml:math id="M78"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq36.gif"></inline-graphic></alternatives></inline-formula> in Eq. (<xref ref-type="" rid="Equ2">2</xref>) or <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic><sup>+</sup>) in Eq. (<xref ref-type="" rid="Equ3">3</xref>). Similarly, (u<sub><italic>j</italic></sub> → x<sub><italic>i</italic></sub>) ∈ B<sub><italic>f</italic>,<italic>g</italic></sub> if <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g_{ij}\not \equiv 0$$\end{document}</tex-math><mml:math id="M80"><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≢</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq37.gif"></inline-graphic></alternatives></inline-formula>. Using this definition, we next describe the class <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq38.gif"></inline-graphic></alternatives></inline-formula> of all possible controlled population dynamics that a controlled microbial community can have given we know its <inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M84"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq39.gif"></inline-graphic></alternatives></inline-formula>. Mathematically, <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M86"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq40.gif"></inline-graphic></alternatives></inline-formula> contains all base models {<italic>f</italic><sup>*</sup>, <italic>g</italic><sup>*</sup>} such that <inline-formula id="IEq41"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}_{f^{\ast},g^ \ast } = {\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq41.gif"></inline-graphic></alternatives></inline-formula>, together with all deformations {<italic>f</italic>, <italic>g</italic>} of each of those base models. The base models characterize the simplest controlled population dynamics that the community can have, leading us to choose them as controlled GLV models with constant susceptibilities:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f_i^ \ast (x) = r_ix_i + \mathop {\sum}\limits_{j = 1}^N a_{ij}x_ix_j,\quad g_{ij}^ \ast (x) = b_{ij},$$\end{document}</tex-math><mml:math display="block" id="M90"><mml:msubsup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"></mml:mspace><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic position="anchor" xlink:href="41467_2019_8890_Article_Equ4.gif"></graphic></alternatives></disp-formula>for <italic>i</italic> = 1, …, <italic>N</italic>. The parameters <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A = (a_{ij}) \in {\Bbb R}^{N \times N}$$\end{document}</tex-math><mml:math id="M92"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq42.gif"></inline-graphic></alternatives></inline-formula>, <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = (r_i) \in {\Bbb R}^N$$\end{document}</tex-math><mml:math id="M94"><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq43.gif"></inline-graphic></alternatives></inline-formula>, and <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B = (b_{ij}) \in {\Bbb R}^{N \times M}$$\end{document}</tex-math><mml:math id="M96"><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq44.gif"></inline-graphic></alternatives></inline-formula> represent the interaction matrix, the intrinsic growth rate vector, and the susceptibility matrix of the community, respectively. As the simplest population dynamics, the GLV model has been applied to microbial communities in lakes, soils, and human bodies<sup><xref ref-type="bibr" rid="CR14">14</xref>,<xref ref-type="bibr" rid="CR15">15</xref>,<xref ref-type="bibr" rid="CR20">20</xref>,<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR38">38</xref></sup>.</p>
<p id="Par17">A deformation of {<italic>f</italic><sup>*</sup>, <italic>g</italic><sup>*</sup>} is any meromorphic pair {<italic>f</italic>, <italic>g</italic>} such that: (i) <inline-formula id="IEq45"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}_{f,g} = {\cal G}_{f^{\ast},g^{\ast}}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq45.gif"></inline-graphic></alternatives></inline-formula>; (ii) there exists a finite set of parameters <inline-formula id="IEq46"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta \in {\Bbb R}^C$$\end{document}</tex-math><mml:math id="M100"><mml:mi>θ</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq46.gif"></inline-graphic></alternatives></inline-formula> such that <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ f(x),g(x)\} = \{ \tilde f(x;\theta ),\tilde g(x;\theta )\}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq47.gif"></inline-graphic></alternatives></inline-formula>; and (iii) the identity <inline-formula id="IEq48"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ \tilde f(x;0),\tilde g(x;0)\} = \{ f^ \ast (x),g^ \ast (x)\}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq48.gif"></inline-graphic></alternatives></inline-formula> holds. The smallest integer <italic>C</italic> ≥ 0 satisfying these three conditions is called the size of the deformation. A general class of controlled population dynamics are deformations of Eq. (<xref ref-type="" rid="Equ4">4</xref>), including<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hskip-5pt}f_i(x;\theta ) = \, \theta _{i,1} 	+ x_i\left( { - r_i - \theta _{i,2}x_i} \right)\left( {\theta _{i,3}x_i - 1} \right) \\ 	 \!\!\!\!\!\!\!\!\!+ \mathop {\sum}\limits_{j = 1}^N a_{ij}\frac{{x_ix_j}}{{1 + \theta _{ij,4} + \theta _{ij,5}x_i + \theta _{ij,6}x_ix_j + \theta _{ij,7}x_j}},$$\end{document}</tex-math><mml:math display="block" id="M106"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>;</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mspace width="0.3em"></mml:mspace><mml:mspace width="0.3em"></mml:mspace><mml:mspace width="0.3em"></mml:mspace><mml:mspace width="0.3em"></mml:mspace><mml:mspace width="0.3em"></mml:mspace><mml:mspace width="0.3em"></mml:mspace><mml:mspace width="0.3em"></mml:mspace><mml:mspace width="0.3em"></mml:mspace><mml:mspace width="0.3em"></mml:mspace><mml:mo>+</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math><graphic position="anchor" xlink:href="41467_2019_8890_Article_Equ5.gif"></graphic></alternatives></disp-formula>for <italic>i</italic> = 1, …, <italic>N</italic>. Above, <italic>θ</italic><sub><italic>i</italic>,1</sub> are migration rates from/to neighboring habitats, <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{i,2}^{ - 1}$$\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq49.gif"></inline-graphic></alternatives></inline-formula> are the carrying capacities of the environment, <inline-formula id="IEq50"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta _{i,3}^{ - 1}$$\end{document}</tex-math><mml:math id="M110"><mml:msubsup><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq50.gif"></inline-graphic></alternatives></inline-formula> are the Allee constants, and <inline-formula id="IEq51"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ \theta _{ij,k}\} _{k = 4}^7$$\end{document}</tex-math><mml:math id="M112"><mml:msubsup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>θ</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mn>7</mml:mn></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq51.gif"></inline-graphic></alternatives></inline-formula> characterize the functional responses<sup><xref ref-type="bibr" rid="CR39">39</xref></sup>. <italic>θ</italic><sub><italic>i</italic>,1</sub> &gt; 0 also models species like <italic>C. difficile</italic> that sporulate into “inactive” forms and then recover. “Higher-order interactions” (e.g., <italic>θ</italic><sub><italic>i</italic></sub><italic>x</italic><sub><italic>i</italic></sub><italic>x</italic><sub><italic>j</italic></sub><italic>x</italic><sub><italic>k</italic></sub><italic>)</italic> and susceptibilities mediated by species abundance (e.g., <italic>g</italic><sub><italic>ij</italic></sub>(<italic>x</italic>;<italic>θ</italic>) = <italic>b</italic><sub><italic>ij</italic></sub> + <italic>θ</italic><sub><italic>ijk</italic></sub><italic>x</italic><sub><italic>k</italic></sub>) are deformations as well.</p>
<p id="Par18">We call <inline-formula id="IEq52"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M114"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq52.gif"></inline-graphic></alternatives></inline-formula> structurally accessible if almost all of its base models and almost all of their deformations lack autonomous elements. This definition means that except for a zero-measure set of “singularities,” all the controlled population dynamics that the community may take have to lack autonomous elements. The conditions under which <inline-formula id="IEq53"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M116"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq53.gif"></inline-graphic></alternatives></inline-formula> is structurally accessible are fully characterized using our mathematical formalism and they depend only on <inline-formula id="IEq54"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M118"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq54.gif"></inline-graphic></alternatives></inline-formula> (see Methods and Supplementary Note <xref ref-type="media" rid="MOESM1">3</xref>). Hence, if <inline-formula id="IEq55"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M120"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq55.gif"></inline-graphic></alternatives></inline-formula> is structurally accessible, hereafter we also call <inline-formula id="IEq56"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M122"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq56.gif"></inline-graphic></alternatives></inline-formula> structurally accessible. We first proved that, generically, increasing the size of a deformation cannot create autonomous elements (Proposition 1 in Supplementary Note <xref ref-type="media" rid="MOESM1">3</xref>). See also Fig. <xref ref-type="fig" rid="Fig2">2c</xref> for an illustration. This result reduces the search for autonomous elements to the deformations in <inline-formula id="IEq57"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M124"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq57.gif"></inline-graphic></alternatives></inline-formula> with minimum size <italic>C</italic> = 0 (i.e., all base models whose graph matches <inline-formula id="IEq58"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M126"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq58.gif"></inline-graphic></alternatives></inline-formula>). Finally, we proved that <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M128"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq59.gif"></inline-graphic></alternatives></inline-formula> is structurally accessible if and only if <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M130"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq60.gif"></inline-graphic></alternatives></inline-formula> satisfies the following two graph–theoretical conditions: (i) each species is the end-node of a path that starts at a control input node; and (ii) there is a disjoint union of cycles (excluding self-loops) and paths that cover all species nodes (Theorem 3 of Supplementary Note <xref ref-type="media" rid="MOESM1">3</xref>). Note that the conditions for structural accessibility depend on the chosen base model.</p>
<p id="Par19">Structural accessibility is a nonlinear generalization of “structural controllability” for linear systems<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. The latter notion has received increasing attention in Network Science<sup><xref ref-type="bibr" rid="CR17">17</xref></sup>. Interestingly, the two graph–theoretical conditions for structural accessibility are almost the same as those for structural linear controllability<sup><xref ref-type="bibr" rid="CR16">16</xref></sup>. The key difference is that for structural linear controllability self-loops (corresponding to intrinsic nodal dynamics) can be used to satisfy condition (ii). See Remark 4 in Supplementary Note <xref ref-type="media" rid="MOESM1">3</xref> for more details.</p>
</sec>
<sec id="Sec6">
<title>Identifying minimum sets of driver species in microbial communities</title>
<p id="Par20">The above result provides a complete graph-characterization of driver species: a set of actuated species is a set of driver species (for all but a zero-measure set of controlled population dynamics that the community may have) if and only if its corresponding <inline-formula id="IEq61"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M132"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq61.gif"></inline-graphic></alternatives></inline-formula> satisfies the two graph–theoretical conditions. See Fig. <xref ref-type="fig" rid="Fig3">3</xref> for an illustration. With this characterization, one can apply the maximum matching algorithm directly to <inline-formula id="IEq62"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}$$\end{document}</tex-math><mml:math id="M134"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq62.gif"></inline-graphic></alternatives></inline-formula> to calculate the minimum number of control inputs needed to ensure the structural accessibility of <inline-formula id="IEq63"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M136"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq63.gif"></inline-graphic></alternatives></inline-formula>, as did in the structural linear controllability case<sup><xref ref-type="bibr" rid="CR17">17</xref>,<xref ref-type="bibr" rid="CR40">40</xref></sup>. However, this may not provide a minimum set of driver species because one control input may actuate multiple species. Fortunately, we can dedicate one control input to one species. Therefore, we adapted the notion of a “feasible dedicated input configuration”<sup><xref ref-type="bibr" rid="CR41">41</xref></sup> and a polynomial-time algorithm (combining maximum matching with a strongly connected component decomposition of <inline-formula id="IEq64"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}$$\end{document}</tex-math><mml:math id="M138"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq64.gif"></inline-graphic></alternatives></inline-formula>) to identify one minimum set of driver species (Methods and Supplementary Note <xref ref-type="media" rid="MOESM1">4</xref>). Note that once <inline-formula id="IEq65"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M140"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq65.gif"></inline-graphic></alternatives></inline-formula> is structurally accessible, it cannot lose its structural accessibility when new edges are added to it. This observation implies that the driver species can be identified from an “incomplete” ecological network (e.g., containing only high-confidence interactions).<fig id="Fig3"><label>Fig. 3</label><caption><p>Identifying driver species. For each network, a minimum set of driver species is shown providing a disjoint union of paths (purple) and cycles (green) covering all species nodes (see Supplementary Table <xref ref-type="media" rid="MOESM1">1</xref> for the species name). Thus, the resulting controlled ecological network is structurally accessible. Self-loops are omitted from these networks to improve readability. <bold>a</bold> Inferred ecological network of the gut microbiota of germ-free mice pre-colonized with a mixture of human commensal bacterial type strains and then infected with <italic>C. difficile</italic> (species 7), as in ref. <sup><xref ref-type="bibr" rid="CR22">22</xref></sup>
<bold>b</bold> Inferred ecological network of the core microbiota of the sea sponge <italic>Ircinia oros</italic>, as in ref. <sup><xref ref-type="bibr" rid="CR23">23</xref></sup></p></caption><graphic id="d29e4106" xlink:href="41467_2019_8890_Fig3_HTML"></graphic></fig></p>
</sec>
<sec id="Sec7">
<title>Driving the driver species</title>
<p id="Par21">We next calculate the control inputs to be applied to a set of driver species for driving the whole community towards the desired state <italic>x</italic><sub>d</sub>. We will show that it is more efficient to calculate impulsive control inputs. To calculate these impulsive control inputs <inline-formula id="IEq66"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ u(t_k),t_k \in {\Bbb T}\}$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">T</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq66.gif"></inline-graphic></alternatives></inline-formula> we adopt a model predictive control (MPC) approach<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. Based on the current state of the community <italic>x</italic>(<italic>t</italic><sub><italic>k</italic></sub>) at <inline-formula id="IEq67"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_k \in {\Bbb T}$$\end{document}</tex-math><mml:math id="M144"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">T</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq67.gif"></inline-graphic></alternatives></inline-formula>, we use knowledge of its controlled population dynamics {<italic>f</italic>, <italic>g</italic>} to predict the sequence of states <inline-formula id="IEq68"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{X}}_{k,L} = \{ {\hat{x}} (t_{k + 1}), \cdots,{\hat{x}}(t_{k + L + 1})\}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq68.gif"></inline-graphic></alternatives></inline-formula> that the community will take in response to a sequence of <italic>L</italic> impulsive control inputs <inline-formula id="IEq69"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{k,L} = \{ u(t_k), \cdots,u(t_{k + L - 1})\}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq69.gif"></inline-graphic></alternatives></inline-formula>. The prediction horizon <italic>L</italic> &gt; 0 determines how far into the future we predict. Then, we choose <inline-formula id="IEq70"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u(t_k) = u_1^ \ast (t_k)$$\end{document}</tex-math><mml:math id="M150"><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq70.gif"></inline-graphic></alternatives></inline-formula> where <inline-formula id="IEq71"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u_1^ \ast (t_k)$$\end{document}</tex-math><mml:math id="M152"><mml:msubsup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq71.gif"></inline-graphic></alternatives></inline-formula> is the first element of the optimal control sequence <inline-formula id="IEq72"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{k,L}^ \ast$$\end{document}</tex-math><mml:math id="M154"><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq72.gif"></inline-graphic></alternatives></inline-formula> calculated as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{k,L}^ \ast = {\mathrm{arg}}\mathop {\mathrm{min}}\limits_{U_{k,L} \in {\Bbb R}^{M \times L}} J_{x_{\mathrm{d}}}({\hat{X}}_{k,L},U_{k,L})\ {\mathrm{subject}}\,{\mathrm{to}}\ U_{k,L} \in {\mathrm{\Omega }}.$$\end{document}</tex-math><mml:math display="block" id="M156"><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">arg</mml:mi><mml:munder><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1em"></mml:mspace><mml:mi mathvariant="normal">subject</mml:mi><mml:mspace width="0.3em"></mml:mspace><mml:mi mathvariant="normal">to</mml:mi><mml:mspace width="1em"></mml:mspace><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>.</mml:mo></mml:math><graphic position="anchor" xlink:href="41467_2019_8890_Article_Equ6.gif"></graphic></alternatives></disp-formula></p>
<p id="Par22">Here, <inline-formula id="IEq73"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{\Omega }} \subseteq {\Bbb R}^{M \times L}$$\end{document}</tex-math><mml:math id="M158"><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>⊆</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq73.gif"></inline-graphic></alternatives></inline-formula> specifies constraints in the control inputs, and <inline-formula id="IEq74"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{x_{\mathrm{d}}}$$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq74.gif"></inline-graphic></alternatives></inline-formula> is some cost function penalizing deviations of the predicted trajectory <inline-formula id="IEq75"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{X}}_{k,L}$$\end{document}</tex-math><mml:math id="M162"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq75.gif"></inline-graphic></alternatives></inline-formula> from <italic>x</italic><sub>d</sub>. For example, the cost function <inline-formula id="IEq76"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{x_{\mathrm{d}}}({\hat{X}}_{k,L},U_{k,L}) = \| {{\hat{x}} (t_{k + L + 1}) - x_{\mathrm{d}}} \|$$\end{document}</tex-math><mml:math id="M164"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∥</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub><mml:mo>∥</mml:mo></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq76.gif"></inline-graphic></alternatives></inline-formula> penalizes the deviations of the predicted final state. By recalculating <inline-formula id="IEq77"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{k,L}^ \ast$$\end{document}</tex-math><mml:math id="M166"><mml:msubsup><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq77.gif"></inline-graphic></alternatives></inline-formula> at each <italic>t</italic><sub><italic>k</italic></sub> using the actual state of the community the MPC creates a feedback loop enhancing its robustness against prediction errors<sup><xref ref-type="bibr" rid="CR42">42</xref></sup>. The prediction horizon can be chosen based on the controlled population dynamics of the community (Methods). For <italic>L</italic> = 1, this methodology is similar to ref. <sup><xref ref-type="bibr" rid="CR43">43</xref></sup>. Equation (<xref ref-type="" rid="Equ6">6</xref>) is a finite-dimensional optimization problem that can be solved using algorithms like DIRECT<sup><xref ref-type="bibr" rid="CR44">44</xref></sup>. Solving the analogous optimization problem for continuous control inputs is more challenging because the optimization is over the infinite-dimensional space of continuous functions.</p>
<p id="Par23">We illustrate the above MPC strategy driving the microbial community of Fig. <xref ref-type="fig" rid="Fig1">1</xref> with its solo driver species. According to its dynamics, <italic>L</italic> = 3 impulsive control inputs are sufficient (see caption in Fig. <xref ref-type="fig" rid="Fig1">1</xref>, and Example 4 in Supplementary Note <xref ref-type="media" rid="MOESM1">5</xref>). We chose  <inline-formula id="IEq78"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{x_{\mathrm{d}}}({\hat{X}}_{k,L},U_{k,L}) = \left\| {\hat{x}}(t_{k,L}) - x_{\mathrm{d}} \right\|_{2}$$\end{document}</tex-math><mml:math id="M168"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mfenced close="∥" open="∥" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq78.gif"></inline-graphic></alternatives></inline-formula>. Solving Eq. (<xref ref-type="" rid="Equ6">6</xref>) using DIRECT yields the nonlinear MPC strategy <italic>u</italic><sup>*</sup>(<italic>t</italic><sub>1</sub>) = −0.8815, <italic>u</italic><sup>*</sup>(<italic>t</italic><sub>2</sub>) = 2.0089 and <italic>u</italic><sup>*</sup>(<italic>t</italic><sub>3</sub>) = −10<sup>−4</sup> (pink in Fig. <xref ref-type="fig" rid="Fig4">4a</xref>). We compared the performance of two other control strategies. The first strategy uses one transplantation to increase the abundance of the driver species to its desired value, reminiscent of one probiotic administration restoring its “healthy” abundance (purple in Fig. <xref ref-type="fig" rid="Fig4">4a</xref>). The second control strategy ignores the driver species, setting the abundance of the two non-driver species to their desired values (blue in Fig. <xref ref-type="fig" rid="Fig4">4a</xref>).<fig id="Fig4"><label>Fig. 4</label><caption><p>Success and failure of different control strategies. <bold>a</bold> Three control strategies for driving the microbial community of Fig. <xref ref-type="fig" rid="Fig1">1a</xref> toward the desired state. First, MPC applied to the identified driver species {x<sub>3</sub>} (pink dots). The second control strategy increases the abundance of the driver species to match its value at the desired state <italic>x</italic><sub>3</sub>(<italic>t</italic><sub>1</sub>) = <italic>x</italic><sub>3,d</sub> (purple dots). The third control strategy does not actuate the driver species, but actuates the other two species {x<sub>1</sub>, x<sub>2</sub>} by setting their abundance to their desired values (i.e., <italic>x</italic><sub>1</sub>(<italic>t</italic><sub><italic>k</italic></sub>) = <italic>x</italic><sub>1,d</sub> and <italic>x</italic><sub>2</sub>(<italic>t</italic><sub><italic>k</italic></sub>) = <italic>x</italic><sub>2,d</sub>, solid and hollow blue dots, respectively). <bold>b</bold> Response of the microbial community to these three control strategies. Here and in panel (<bold>d</bold>), the “jumps” produced by the control inputs are depicted by dashed lines. The equilibria of the population dynamics are shown as gray dots. Only the MPC applied to the driver species succeeds in driving the community to <italic>x</italic><sub>d</sub>. <bold>c</bold> Control strategies obtained by using the linear MPC with parameters <inline-formula id="IEq79"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q = {\mathrm{diag}}(20,1,10)$$\end{document}</tex-math><mml:math id="M170"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq79.gif"></inline-graphic></alternatives></inline-formula> and different values for <italic>R</italic>: 10<sup>−4</sup> (pink), 10<sup>−3</sup> (green), 10<sup>−2</sup> (blue). <bold>d</bold> Trajectories of the controlled community using the linear MPC strategies described in panel (<bold>c</bold>). Colors correspond to the different values of <italic>R</italic></p></caption><graphic id="d29e5106" xlink:href="41467_2019_8890_Fig4_HTML"></graphic></fig></p>
<p id="Par24">Among the above three control strategies, only the nonlinear MPC applied to the driver species succeeds (Fig. <xref ref-type="fig" rid="Fig4">4b</xref>). This strategy succeeds in a somewhat unconventional way: although the driver species is more abundant in the desired state than in the initial state, the first control action decreases its abundance further. Such control action lets the non-driver species reach their desired abundances and, once that happens, the abundance of the driver species is finally increased to its desired value (pink in Fig. <xref ref-type="fig" rid="Fig4">4b</xref>). Just restoring the abundance of the driver species succeeds in driving x<sub>2</sub> and x<sub>3</sub>, but it fails to drive x<sub>1</sub> to the desired abundance (purple in Fig. <xref ref-type="fig" rid="Fig4">4b</xref>). Ignoring the driver species is the worst control strategy, failing to drive any of the three species to their desired values (blue in Fig. <xref ref-type="fig" rid="Fig4">4b</xref>). This toy example demonstrates the advantage of identifying and actuating driver species.</p>
</sec>
<sec id="Sec8">
<title>Driving large communities with uncertain dynamics</title>
<p id="Par25">Solving the non-convex optimization problem of Eq. (<xref ref-type="" rid="Equ6">6</xref>) is challenging as <italic>N</italic> or <italic>L</italic> increase, and it also requires knowing {<italic>f</italic>, <italic>g</italic>}, which may be impossible for large communities. We next circumvent these two drawbacks leveraging the network underlying the controlled microbial community.</p>
<p id="Par26">Consider we can obtain a weighted adjacency matrix <inline-formula id="IEq80"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{A}} \in {\Bbb R}^{N \times N}$$\end{document}</tex-math><mml:math id="M172"><mml:mi>Â</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq80.gif"></inline-graphic></alternatives></inline-formula> from <inline-formula id="IEq81"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}$$\end{document}</tex-math><mml:math id="M174"><mml:mi mathvariant="script">G</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq81.gif"></inline-graphic></alternatives></inline-formula>, providing a proxy for its interaction matrix. Without additional knowledge of the community,  we just assume that we can increase or decrease the abundance of each driver species. We thus use <inline-formula id="IEq82"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{B}} \in \{ 0,1\} ^{N \times M}$$\end{document}</tex-math><mml:math id="M176"><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq82.gif"></inline-graphic></alternatives></inline-formula> as a proxy for the susceptibility matrix, with <italic>b</italic><sub><italic>ij</italic></sub> = 1 if the <italic>j</italic>-th control input actuates the <italic>i</italic>-th driver species. By rewriting <inline-formula id="IEq83"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ f(x),g(x)\} = \{{\hat{A}}x + w_x,{\hat{B}} + w_u\}$$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>Â</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq83.gif"></inline-graphic></alternatives></inline-formula>, we use <inline-formula id="IEq84"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ {\hat{A}}x,{\hat{B}}\}$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>Â</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq84.gif"></inline-graphic></alternatives></inline-formula> to provide a linear prediction for the response of the community to the control inputs. Here, <inline-formula id="IEq85"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_x = f - {\hat{A}}x$$\end{document}</tex-math><mml:math id="M182"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>-</mml:mo><mml:mi>Â</mml:mi><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq85.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq86"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$w_u = g - {\hat{B}}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq86.gif"></inline-graphic></alternatives></inline-formula> are considered as “perturbations”. Using <inline-formula id="IEq87"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ {\hat{A}}x,{\hat{B}}\}$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>Â</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq87.gif"></inline-graphic></alternatives></inline-formula>, we design a linear MPC by solving Eq. (<xref ref-type="" rid="Equ6">6</xref>) with the quadratic cost function<disp-formula id="Equa"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{x_{\mathrm{d}}}({\hat{X}}_{k,\infty },U_{k,\infty }) = \mathop {\sum}\limits_{i = k}^\infty \left[ {{\hat{x}}(t_i) - x_{\mathrm{d}}} \right]^ \top Q\left[ {{\hat{x}}(t_i) - x_{\mathrm{d}}} \right] + u(t_i)^ \top Ru(t_i).$$\end{document}</tex-math><mml:math display="block" id="M188"><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover accent="false" accentunder="false"><mml:mrow><mml:mo> ∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:msup><mml:mrow><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mi>Q</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi>u</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mi>R</mml:mi><mml:mi>u</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic position="anchor" xlink:href="41467_2019_8890_Article_Equa.gif"></graphic></alternatives></disp-formula></p>
<p id="Par27">Above, the positive definite matrices <inline-formula id="IEq88"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q = Q^ \top \in {\Bbb R}^{N \times N}$$\end{document}</tex-math><mml:math id="M190"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq88.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq89"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R = R^ \top \in {\Bbb R}^{M \times M}$$\end{document}</tex-math><mml:math id="M192"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq89.gif"></inline-graphic></alternatives></inline-formula> are design parameters. <italic>Q</italic> penalizes the deviations of the predicted trajectory from the desired state, and <italic>R</italic> penalizes the control inputs magnitude. Under this scenario, Eq. (<xref ref-type="" rid="Equ6">6</xref>) can be solved in closed form<sup><xref ref-type="bibr" rid="CR45">45</xref></sup> yielding the linear MPC <italic>u</italic>(<italic>t</italic><sub><italic>k</italic></sub>) = <italic>Kx</italic>(<italic>t</italic><sub><italic>k</italic></sub>), where <inline-formula id="IEq90"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K \in {\Bbb R}^{M \times N}$$\end{document}</tex-math><mml:math id="M194"><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq90.gif"></inline-graphic></alternatives></inline-formula> is the solution of a Riccati equation (Supplementary Note <xref ref-type="media" rid="MOESM1">6</xref>). Since the Ricatti equation can be efficiently solved for large <italic>N</italic>, the linear MPC can be calculated for large communities. This linear MPC is robust against (<italic>w</italic><sub><italic>x</italic></sub>, <italic>w</italic><sub><italic>u</italic></sub>) and it allows calculating the control inputs for the continuous control scheme (Supplementary Note <xref ref-type="media" rid="MOESM1">6</xref>). However, its performance strongly depends on the chosen <inline-formula id="IEq91"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\hat{A}}, {\hat{B}})$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Â</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq91.gif"></inline-graphic></alternatives></inline-formula> and the distance to the desired state (Supplementary Note <xref ref-type="media" rid="MOESM1">6</xref>).</p>
<p id="Par28">We applied the linear MPC for driving the toy three-species community of Fig. <xref ref-type="fig" rid="Fig1">1,</xref> assuming its dynamics is uncertain. Considering the ecological network of this community and its nonlinear population dynamics, we chose <inline-formula id="IEq92"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{A}} = ( - 0.5,\, 0, - 0.1;0, - 5,1;0,0, - 1)$$\end{document}</tex-math><mml:math id="M198"><mml:mi>Â</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>0.1</mml:mn><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq92.gif"></inline-graphic></alternatives></inline-formula> as a proxy for its interaction matrix. Here <inline-formula id="IEq93"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{A}}$$\end{document}</tex-math><mml:math id="M200"><mml:mi>Â</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq93.gif"></inline-graphic></alternatives></inline-formula> is a rough approximation of the linearization of the population dynamics at the desired state given by (−0.37, 0, −0.05; 0, −5. 31, 0.52; 0, 0, −1). Choosing <inline-formula id="IEq94"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q = {\mathrm{diag}}(20,1,10)$$\end{document}</tex-math><mml:math id="M202"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">diag</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq94.gif"></inline-graphic></alternatives></inline-formula>, we compared the performance of three different linear MPCs obtained with <italic>R</italic> = 10<sup>−4</sup>, 10<sup>−3</sup>, 10<sup>−2</sup> (Fig. <xref ref-type="fig" rid="Fig4">4c</xref>). For <italic>R</italic> = 10<sup>−4</sup>, without using knowledge of the population dynamics, the performance of the linear MPC (pink in Fig. <xref ref-type="fig" rid="Fig4">4d</xref>) is very similar to the performance of the nonlinear MPC that uses full knowledge of the nonlinear population dynamics (pink in Fig. <xref ref-type="fig" rid="Fig4">4b</xref>). This success illustrates the robustness of the linear MPC against the perturbations. As <italic>R</italic> increases, the performance of the linear MPC deteriorates (green and blue in Fig. <xref ref-type="fig" rid="Fig4">4d</xref>).</p>
</sec>
<sec id="Sec9">
<title>Numerical validation on large uncertain microbial communities</title>
<p id="Par29">To validate our control framework for large communities, we built communities of <italic>N</italic> = 100 species having random directed Erdös–Rényi ecological networks with connectivity <italic>c</italic> ∈ [0, 1], see Fig. <xref ref-type="fig" rid="Fig5">5a</xref>. The network edge-weights were  chosen from a normal distribution with zero mean and standard deviation <italic>σ</italic> &gt; 0, where <italic>σ</italic> characterizes the typical interspecies interaction strength. Negative self-loops with weights −1 were added to each species. We used this ecological network to identify the driver species of the community, and its corresponding weighted adjacency matrix as the interaction matrix to construct the linear MPC. We simulated the population dynamics of these communities using Eq. (<xref ref-type="" rid="Equ5">5</xref>) ensuring all share <inline-formula id="IEq95"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{\mathrm{d}} \in {\Bbb R}^N$$\end{document}</tex-math><mml:math id="M204"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq95.gif"></inline-graphic></alternatives></inline-formula> as equilibrium. The resulting communities have nonlinear population dynamics, and their linearization at the desired state is different from the interaction matrix used for the linear MPC (Supplementary Note <xref ref-type="media" rid="MOESM1">8</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Numerical validation on large microbial communities. <bold>a</bold> Example of the ecological network for a random microbial community with <italic>N</italic> = 100 species (<italic>c</italic> = 0.03). A minimum set of <italic>M</italic> = 6 driver species is shown in purple. The desired state is chosen as <inline-formula id="IEq96"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{\mathrm{d}} = (1, \cdots ,1)^ \top$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq96.gif"></inline-graphic></alternatives></inline-formula>. <bold>b</bold> With a random initial abundance <italic>x</italic><sub>0</sub> at distance <italic>d</italic> = 0.4 from the desired state, the uncontrolled microbial community does not reach <italic>x</italic><sub>d</sub>. <bold>c</bold>, <bold>d</bold> For the same community and initial abundance as in panel (<bold>b</bold>), we apply the control input generated by the linear MPC (panel <bold>c</bold>) to the six identified driver species. This control strategy drives the community to <italic>x</italic><sub>d</sub> (panel <bold>d</bold>). <bold>e</bold>, <bold>f</bold>, <bold>h</bold> Mean success rate as a function of <italic>d</italic>. Error bars denote the standard error of the mean. Parameters are: <italic>c</italic> = 0.025, <italic>θ</italic><sub>max</sub> = 0.05 for panel (<bold>e</bold>), <italic>σ</italic> = 0.8, <italic>θ</italic><sub><italic>max</italic></sub> = 0.05 for panel (<bold>f</bold>), and <italic>c</italic> = 0.025, <italic>σ</italic> = 0.8, <italic>θ</italic><sub><italic>max</italic></sub> = 0.05 for panel (<bold>h</bold>). <bold>g</bold> Success rate as function of the proportion <italic>M</italic>/<italic>N</italic> of driver species. Black dots show the success rate of 7700 random communities. Pink shows the mean success rate</p></caption><graphic id="d29e6120" xlink:href="41467_2019_8890_Fig5_HTML"></graphic></fig></p>
<p id="Par30">To quantify the success of our control framework on a given community, we generated 300 initial species abundances that are uniformly distributed at a distance <italic>d</italic> &gt; 0 from <italic>x</italic><sub>d</sub>. The success rate at distance <italic>d</italic> is defined as the proportion of those initial conditions that are driven to <italic>x</italic><sub>d</sub> only when the linear MPC is applied to a minimum set of driver species of the community (Fig. <xref ref-type="fig" rid="Fig5">5b–d</xref>). Namely, we discard all initial conditions that naturally evolve to <italic>x</italic><sub>d</sub>. Finally, we calculated the mean success rate by averaging the success rate over 100 random communities (see Supplementary Note <xref ref-type="media" rid="MOESM1">8</xref> for details).</p>
<p id="Par31">The mean success rate is close to 1 for small <italic>d</italic> regardless of the community’s parameters (Fig. <xref ref-type="fig" rid="Fig5">5e, f</xref>), confirming the theoretical guarantee that the linear MPC succeeds if <italic>d</italic> is small enough. The mean success rate decreases as <italic>σ</italic> increases, especially for large distances (Fig. <xref ref-type="fig" rid="Fig5">5e</xref>). Since increasing <italic>σ</italic> damages the stability of the population dynamics<sup><xref ref-type="bibr" rid="CR46">46</xref></sup>, this result suggests that microbial communities become “harder” to control as they lose stability. The mean success rate is higher in communities with low connectivity (Fig. <xref ref-type="fig" rid="Fig5">5f</xref>). In general, the size of a minimum set of driver species increases as <italic>c</italic> decreases, indicating that the success rate increases as the number of driver species increases. Indeed, regardless of <italic>d</italic>, our control framework attains a mean success rate &gt;0.8 provided that at least 6 from 100 species are driver species (Fig. <xref ref-type="fig" rid="Fig5">5g</xref>). This result suggests that the success rate can be enhanced by actuating a few additional species. Finally, to investigate the robustness of our control framework to errors in the ecological network, we randomly rewired each of its edges with probability <italic>p</italic> ∈ [0,1] (e.g., <italic>p</italic> = 0.05 corresponds to a 5% error). The success rate deteriorates but remains larger than zero despite large errors (Fig. <xref ref-type="fig" rid="Fig5">5h</xref>), showing the robustness of our control framework. However, a 5% error decreases the mean success rate in about 30%, emphasizing the importance of accurately mapping ecological networks for controlling microbial communities.</p>
</sec>
<sec id="Sec10">
<title>Application</title>
<p id="Par32">We analyzed the ecological network of the gut microbiota of germ-free mice that were  pre-colonized with a mixture of human commensal bacterial type strains and then infected with <italic>C. difficile</italic> spores<sup><xref ref-type="bibr" rid="CR22">22</xref></sup>. In Fig. <xref ref-type="fig" rid="Fig3">3a</xref>, we identified a minimum set of five driver species in this 14-species community: <italic>Ruminococcus obeum</italic> (x<sub>1</sub>), <italic>Raphitoma mirabilis</italic> (x<sub>12</sub>), <italic>Bacteroides ovatus</italic> (x<sub>2</sub>), <italic>Clostridium</italic>
<italic>ramosum</italic> (x<sub>6</sub>), and <italic>Akkermansia muciniphila</italic> (x<sub>10</sub>). We also used the ecological network underlying the core microbiota of the sea sponge <italic>I. oros</italic><sup><xref ref-type="bibr" rid="CR23">23</xref></sup>, finding ten driver species in this twenty-species community (Fig. <xref ref-type="fig" rid="Fig3">3b</xref>).</p>
<p id="Par33">We studied by simulation the efficacy of the identified driver species and the linear MPC for driving these two microbial communities, assuming that their dynamics are uncertain (see Supplementary Note <xref ref-type="media" rid="MOESM1">7</xref> for details of the simulation). For the mice gut microbiota, our framework succeeds in driving the community from an initial state where <italic>C. difficile</italic> is overabundant towards the desired state with a better balance of species (Fig. <xref ref-type="fig" rid="Fig6">6a, c</xref>). Similar results were obtained for controlling the core microbiota of <italic>I. oros</italic> (Fig. <xref ref-type="fig" rid="Fig6">6b, d</xref>). These results show again that the linear MPC method is robust enough to drive nonlinear microbial communities.<fig id="Fig6"><label>Fig. 6</label><caption><p>Controlling host-associated microbial communities. The controlled population dynamics of both microbial communities were simulated using the controlled GLV equations (see Supplementary Note <xref ref-type="media" rid="MOESM1">7</xref> for details). The intrinsic growth rates were adjusted such that the community has an initial “diseased” equilibrium state <italic>x</italic><sub>0</sub> in which one species (<italic>C. difficile</italic> for the mice gut microbiota) is overabundant compared to the rest of species. We chose the desired state <italic>x</italic><sub>d</sub> as another equilibrium with a more balanced abundance profile. For each microbial community, we used the minimum set of driver species identified in Fig. <xref ref-type="fig" rid="Fig3">3</xref>. <bold>a</bold>, <bold>b</bold> Control inputs obtained using the linear MPC for the impulsive and continuous control schemes. <bold>c</bold>, <bold>d</bold> Projection of the high-dimensional abundance profiles (states of the microbial communities) into their first three principal components (PCs). See Supplementary Figure <xref ref-type="media" rid="MOESM1">1</xref> for the temporal response of each species. The calculated control strategies applied to the driver species succeed in driving the community to the desired state, using either continuous or impulsive control</p></caption><graphic id="d29e6318" xlink:href="41467_2019_8890_Fig6_HTML"></graphic></fig></p>
</sec>
</sec>
<sec id="Sec11" sec-type="discussion">
<title>Discussion</title>
<p id="Par34">Our theoretical framework allows systematically and efficiently controlling microbial communities towards desired states by identifying their driver species. Identifying the driver species of a microbial community only requires knowledge of its underlying ecological network. Note that there could be multiple different minimum sets of driver species for the same community. If the cost of choosing any species as a driver species is known, a combinatorial optimization scheme will allow selecting the best minimum driver species set. We emphasize that the driver species discussed here may not coincide with other notions in ecology such as keystone<sup><xref ref-type="bibr" rid="CR47">47</xref>,<xref ref-type="bibr" rid="CR48">48</xref></sup> or core<sup><xref ref-type="bibr" rid="CR49">49</xref></sup> species. For example, the selection of driver species do not directly depend on their abundances, while keystone species do<sup><xref ref-type="bibr" rid="CR47">47</xref></sup>.</p>
<p id="Par35">For large uncertain communities, the linear model predictive controller gives a robust and efficient way to calculate the control inputs. The performance of this controller could be further improved by modeling the susceptibility of species to the control actions (e.g., pharmacokinetics). In such case, different control actions could be modeled by different pairs {<italic>f</italic>, <italic>g</italic>}, making the conditions for the absence of autonomous elements different for continuous and impulsive control actions. Control algorithms based on reinforcement learning<sup><xref ref-type="bibr" rid="CR50">50</xref></sup> (RL) could provide even better performance. Our characterization of minimum sets of driver species will help to efficiently apply those control algorithms to microbial communities, as RL algorithms require specifying the “driver variables” they can actuate<sup><xref ref-type="bibr" rid="CR51">51</xref></sup>. Here, controlling small synthetic communities could provide valuable insights for designing such controllers. We also note that altering the ecological network or obtaining a “simplified” network, in the spirit of refs. <sup><xref ref-type="bibr" rid="CR52">52</xref>,<xref ref-type="bibr" rid="CR53">53</xref></sup>, could be complementary control approaches (e.g., for reducing the minimum number of driver species).</p>
<p id="Par36">It has been suggested that the success of ecosystem management strategies could be predicted using the notion of controllability<sup><xref ref-type="bibr" rid="CR54">54</xref></sup>. However, this notion is somewhat inadequate for microbial communities and other biological systems. By their nature, biological systems cannot be fully controllable because there are states they cannot reach (e.g., states with negative abundances). Furthermore, since dynamic models for microbial communities are nonlinear and uncertain, it is impossible even to test if those systems are controllable. Structural accessibility overcomes these two limitations, generalizing the notion of accessibility<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> to systems with uncertain dynamics. Counterintuitively, our mathematical formalism suggests that communities with more complicated population dynamics (i.e., deformations with larger size) require fewer driver species. However, using fewer driver species could complicate the design of control strategies (Remark 9 in Supplementary Note <xref ref-type="media" rid="MOESM1">5</xref>). Indeed, by choosing an adequate base model<sup><xref ref-type="bibr" rid="CR55">55</xref></sup> and making mild assumptions on the dynamics (i.e., <italic>f</italic> and <italic>g</italic> are meromorphic functions), our framework can identify minimum sets of “driver variables” for general nonlinear systems when their underlying networks are known (see Supplementary Note <xref ref-type="media" rid="MOESM1">9</xref> for an example of a small gene regulatory network).</p>
<p id="Par37">There are two limitations in our current framework for controlling microbial communities. First, stochastic effects are considered negligible. Incorporating stochastic effects yields stochastic differential equations for which the notion of autonomous elements still needs to be mathematically formulated. We anticipate that this is quite challenging, but definitely merits further studies. Second, our current framework does not explicitly model the dynamics of resources provided to and/or chemicals produced by the microbial species<sup><xref ref-type="bibr" rid="CR56">56</xref>–<xref ref-type="bibr" rid="CR63">63</xref></sup>. Our characterization of driver species only applies to some instances of resource-based models, e.g., the classical MacArthur’s consumer-resource model<sup><xref ref-type="bibr" rid="CR64">64</xref></sup> when the resource dynamics is much faster than the species dynamics<sup><xref ref-type="bibr" rid="CR65">65</xref></sup>. For general resource-based models, identifying their driver species requires analyzing a new kind of “output accessibility” that characterizes the absence of autonomous elements in the species abundances and ignores autonomous elements in the resource abundances. Then, the notion of “structural output accessibility” (i.e., generic output accessibility given an adequate base model) would provide a nonlinear counterpart of linear target controllability<sup><xref ref-type="bibr" rid="CR66">66</xref></sup>. Structural output accessibility could allow us to identify driver species and/or “driver resources” of a community from knowing the bipartite interaction network of species and resources. This is beyond the scope of this work and deserves dedicated efforts.</p>
<p id="Par38">To fully harvest the benefits of controlling microbial communities, a stronger synergy between microbial ecology and control theory is necessary. We hope that this work will catalyze new interdisciplinary approaches that enhance our ability to control complex microbial communities inside and around us.</p>
</sec>
<sec id="Sec12">
<title>Methods</title>
<sec id="Sec13">
<title>Detecting autonomous elements in the continuous control scheme</title>
<p id="Par39">For the continuous control systems of Eq. (<xref ref-type="" rid="Equ2">2</xref>), the notion of autonomous elements and the conditions for their absence are well understood, since they define when a system is accessible (see Supplementary Note <xref ref-type="media" rid="MOESM1">2.2</xref> and ref. <sup><xref ref-type="bibr" rid="CR31">31</xref></sup> for details). An autonomous element for Eq. (<xref ref-type="" rid="Equ2">2</xref>) is a non-constant function <italic>ξ</italic>(<italic>x</italic>) such that there exists an integer <italic>ν</italic> ≥ 0 and a meromorphic function <italic>F</italic> such that <inline-formula id="IEq97"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F(\xi,\dot \xi, \cdots,\xi ^{(\nu )}) = 0$$\end{document}</tex-math><mml:math id="M208"><mml:mi>F</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ν</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq97.gif"></inline-graphic></alternatives></inline-formula>. In words, an autonomous element <italic>ξ</italic> is an “internal variable” of the system that evolves completely unaffected by the control inputs. System (2) is said accessible if it has no autonomous element<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>.</p>
<p id="Par40">The absence of autonomous elements can be characterized by using a mathematical formalism based on differential one-forms<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. Consider the set of meromorphic functions <inline-formula id="IEq98"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal K}$$\end{document}</tex-math><mml:math id="M210"><mml:mi mathvariant="script">K</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq98.gif"></inline-graphic></alternatives></inline-formula> in the variables <inline-formula id="IEq99"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ x,u,\dot u,\ddot u, \cdots \}$$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mo>,</mml:mo><mml:mi>ü</mml:mi><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq99.gif"></inline-graphic></alternatives></inline-formula>, and the sets of differential symbols <inline-formula id="IEq100"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{d}}x = ({\mathrm{d}}x_1, \cdots,{\mathrm{d}}x_N)^{\top}$$\end{document}</tex-math><mml:math id="M214"><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq100.gif"></inline-graphic></alternatives></inline-formula> and <inline-formula id="IEq101"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{d}}u = ({\mathrm{d}}u_1, \cdots,{\mathrm{d}}u_M)^{\top}$$\end{document}</tex-math><mml:math id="M216"><mml:mi mathvariant="normal">d</mml:mi><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"></mml:mspace><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq101.gif"></inline-graphic></alternatives></inline-formula>. Let <inline-formula id="IEq102"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal X} = {\mathrm{span}}_{\cal K} \{{\mathrm{d}}x \}$$\end{document}</tex-math><mml:math id="M218"><mml:mi mathvariant="script">X</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">span</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq102.gif"></inline-graphic></alternatives></inline-formula> be the vector space spanned over <inline-formula id="IEq103"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal K}$$\end{document}</tex-math><mml:math id="M220"><mml:mi mathvariant="script">K</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq103.gif"></inline-graphic></alternatives></inline-formula> by the elements of <italic>dx</italic>, intuitively playing the role of “all functions of state variables”. Any <inline-formula id="IEq104"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega \in {\cal X}$$\end{document}</tex-math><mml:math id="M222"><mml:mi>ω</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq104.gif"></inline-graphic></alternatives></inline-formula> is a “one-form”<sup><xref ref-type="bibr" rid="CR31">31</xref></sup> (see Supplementary Note <xref ref-type="media" rid="MOESM1">2.1</xref> for details). In this setting, the chain rule provides a way to formally operate with one-forms, such as taking time derivatives: if <inline-formula id="IEq105"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\omega = \beta ^ \top {\mathrm{d}}x$$\end{document}</tex-math><mml:math id="M224"><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq105.gif"></inline-graphic></alternatives></inline-formula> then <inline-formula id="IEq106"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dot \omega : = \dot \beta ^ \top {\mathrm{d}}x + \beta ^ \top {\mathrm{d}}\dot x$$\end{document}</tex-math><mml:math id="M226"><mml:mover accent="true"><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mo>⊤</mml:mo></mml:mrow></mml:msup><mml:mi mathvariant="normal">d</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq106.gif"></inline-graphic></alternatives></inline-formula>. To identify the presence of autonomous elements in the dynamics with continuous control of Eq. (<xref ref-type="" rid="Equ2">2</xref>), one calculates the sequence of subspaces <inline-formula id="IEq107"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_k \subset {\cal X}$$\end{document}</tex-math><mml:math id="M228"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>⊂</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq107.gif"></inline-graphic></alternatives></inline-formula> defined recursively by<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_k = \{ \omega \in {\cal H}_k|\dot \omega \in {\cal H}_k\},\quad k \ge 1,$$\end{document}</tex-math><mml:math display="block" id="M230"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>ω</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∣</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>ω</mml:mi></mml:mrow><mml:mrow><mml:mo>˙</mml:mo></mml:mrow></mml:mover><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"></mml:mspace><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:math><graphic position="anchor" xlink:href="41467_2019_8890_Article_Equ7.gif"></graphic></alternatives></disp-formula>starting with <inline-formula id="IEq108"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_1 = {\cal X}$$\end{document}</tex-math><mml:math id="M232"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="script">X</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq108.gif"></inline-graphic></alternatives></inline-formula>. Then, one can prove that Eq. (<xref ref-type="" rid="Equ2">2</xref>) lacks autonomous elements if and only if there exists an integer <italic>k</italic><sup>*</sup> such that <inline-formula id="IEq109"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_{k^ \ast } = \{ 0\}$$\end{document}</tex-math><mml:math id="M234"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq109.gif"></inline-graphic></alternatives></inline-formula>, see ref. <sup><xref ref-type="bibr" rid="CR31">31</xref></sup> (page 49, Thm.3.17).</p>
</sec>
<sec id="Sec14">
<title>Detecting autonomous elements in the impulsive control scheme</title>
<p id="Par41">For the impulsive control systems of Eq. (<xref ref-type="" rid="Equ3">3</xref>) the notions of autonomous elements and accessibility are rather unexplored. Recall that an autonomous element is an internal variable of the system that is completely unaffected by the control actions. To introduce a  suitable definition of autonomous element for the impulsive control systems, note that the control inputs cause “jumps” in the actuated variables (i.e., discontinuities). These jumps are propagated to other state variables by the continuous dynamics. Thus, we define an autonomous element of Eq. (<xref ref-type="" rid="Equ3">3</xref>) as a non-constant function <italic>ξ</italic>(<italic>x</italic>) such that <italic>ξ</italic>(<italic>x</italic>(<italic>t</italic>)), <inline-formula id="IEq110"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in {\Bbb R}$$\end{document}</tex-math><mml:math id="M236"><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq110.gif"></inline-graphic></alternatives></inline-formula>, is a <inline-formula id="IEq111"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal C}^\infty$$\end{document}</tex-math><mml:math id="M238"><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq111.gif"></inline-graphic></alternatives></inline-formula> function (i.e., infinitely differentiable function) under any impulsive input (see Supplementary Note <xref ref-type="media" rid="MOESM1">2.3</xref> for details). By analogy to the case of continuous control, we say that system (3) is accessible if it has no autonomous element according to the above definition.</p>
<p id="Par42">To characterize the accessibility of impulsive control systems, we built the sequence of subspaces <inline-formula id="IEq112"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_k$$\end{document}</tex-math><mml:math id="M240"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq112.gif"></inline-graphic></alternatives></inline-formula> of all functions of the state variables that can be differentiated at least (<italic>k</italic> − 1) times (see details in Supplementary Note <xref ref-type="media" rid="MOESM1">2.3</xref>). The functions belonging to the limit <inline-formula id="IEq113"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_\infty$$\end{document}</tex-math><mml:math id="M242"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq113.gif"></inline-graphic></alternatives></inline-formula> are the autonomous elements of the system, since they are completely unaffected by the control inputs. Consequently, because the limit subspace <inline-formula id="IEq114"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_\infty$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq114.gif"></inline-graphic></alternatives></inline-formula> is also “integrable” (informally, it does not contain “fictitious” autonomous elements), accessibility is equivalent to the condition <inline-formula id="IEq115"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_\infty = \{ 0\}$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq115.gif"></inline-graphic></alternatives></inline-formula> (see Theorem 2 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>). We further prove that the limit <inline-formula id="IEq116"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_\infty$$\end{document}</tex-math><mml:math id="M248"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq116.gif"></inline-graphic></alternatives></inline-formula> is attained in a finite step (i.e., there exists a finite <italic>k</italic><sup>*</sup> such that <inline-formula id="IEq117"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_{k^ \ast } = {\cal H}_{k^ \ast + 1} = \cdots = {\cal H}_\infty$$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>⋯</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq117.gif"></inline-graphic></alternatives></inline-formula>).</p>
<p id="Par43">We illustrate the above formalism using the three-species microbial community of Fig. <xref ref-type="fig" rid="Fig1">1</xref> where x<sub>3</sub> is the actuated species (see caption for its population dynamics). To compute the sequence <inline-formula id="IEq118"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_k$$\end{document}</tex-math><mml:math id="M252"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq118.gif"></inline-graphic></alternatives></inline-formula>, one starts by definition with <inline-formula id="IEq119"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_1 = {\mathrm{span}}_{\cal K}\{ {\mathrm{d}} x_1,{\mathrm{d}}x_2,{\mathrm{d}}x_3\}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">span</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq119.gif"></inline-graphic></alternatives></inline-formula>. Next, <inline-formula id="IEq120"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_2$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq120.gif"></inline-graphic></alternatives></inline-formula> are all one-forms in <inline-formula id="IEq121"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_1$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq121.gif"></inline-graphic></alternatives></inline-formula> that can be differentiated once (i.e., they are continuous, so they are not directly affected by <italic>u</italic>). Because <italic>u</italic> actuates x<sub>3</sub>, we get <inline-formula id="IEq122"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_2 = {\mathrm{span}}_{\cal K}\{{\mathrm{d}}x_2,{\mathrm{d}}x_1\}$$\end{document}</tex-math><mml:math id="M260"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">span</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq122.gif"></inline-graphic></alternatives></inline-formula>. Similarly, <inline-formula id="IEq123"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_3$$\end{document}</tex-math><mml:math id="M262"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq123.gif"></inline-graphic></alternatives></inline-formula> are all those one-forms in <inline-formula id="IEq124"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_2$$\end{document}</tex-math><mml:math id="M264"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq124.gif"></inline-graphic></alternatives></inline-formula> that can be differentiated twice (i.e., their first derivative is continuous), yielding <inline-formula id="IEq125"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_3 = {\mathrm{span}}_{\cal K}\{ x_2{\mathrm{d}} x_1 + x_1{\mathrm{d}} x_2\}$$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">span</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq125.gif"></inline-graphic></alternatives></inline-formula>. Finally, <inline-formula id="IEq126"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal H}_4 = \{ 0\}$$\end{document}</tex-math><mml:math id="M268"><mml:msub><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq126.gif"></inline-graphic></alternatives></inline-formula> (see details in Example 1 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref>). This implies that the controlled population dynamics is free of autonomous elements and hence it is accessible. See also Example 2 in Supplementary Note <xref ref-type="media" rid="MOESM1">2</xref> for a community with autonomous elements.</p>
</sec>
<sec id="Sec15">
<title>Detecting autonomous elements without knowledge of the population dynamics</title>
<p id="Par44">When the controlled population dynamics of the microbial community is unknown, we consider the class <inline-formula id="IEq127"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M270"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq127.gif"></inline-graphic></alternatives></inline-formula> of all controlled dynamics that the community may have given we know its controlled ecological network. Identifying the presence of autonomous elements in the full class <inline-formula id="IEq128"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}$$\end{document}</tex-math><mml:math id="M272"><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq128.gif"></inline-graphic></alternatives></inline-formula> becomes possible thanks to so-called “generic properties” of meromorphic functions<sup><xref ref-type="bibr" rid="CR31">31</xref></sup>. This is a mathematical property implying that a meromorphic function will satisfy a certain condition in almost all points of its domain—that is, everywhere except for a zero-measure set of “singularities”—provided that such condition holds at a single point. We exploited this property to prove that, generically, increasing the size <italic>C</italic> of a deformation cannot create new autonomous elements (Proposition 1 in Supplementary Note <xref ref-type="media" rid="MOESM1">3</xref>). See Fig. <xref ref-type="fig" rid="Fig2">2c</xref> for an illustration. This result allows us to only search for autonomous elements on the subset <inline-formula id="IEq129"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}_0 \subset {\frak D}$$\end{document}</tex-math><mml:math id="M274"><mml:msub><mml:mrow><mml:mi mathvariant="fraktur">D</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>⊂</mml:mo><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq129.gif"></inline-graphic></alternatives></inline-formula> of all <inline-formula id="IEq130"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{ f,g\} \in {\frak D}$$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>g</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>∈</mml:mo><mml:mi mathvariant="fraktur">D</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq130.gif"></inline-graphic></alternatives></inline-formula> with size <italic>C</italic> = 0, corresponding to all base controlled GLV models of Eq. (<xref ref-type="" rid="Equ4">4</xref>). Finally, we proved that the generic absence of autonomous elements in <inline-formula id="IEq131"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\frak D}_0$$\end{document}</tex-math><mml:math id="M278"><mml:msub><mml:mrow><mml:mi mathvariant="fraktur">D</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq131.gif"></inline-graphic></alternatives></inline-formula> can be determined only from the topology of the controlled ecological network <inline-formula id="IEq132"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}^{\mathrm{c}}$$\end{document}</tex-math><mml:math id="M280"><mml:msup><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq132.gif"></inline-graphic></alternatives></inline-formula> (Theorem 3 in Supplementary Note <xref ref-type="media" rid="MOESM1">3</xref>).</p>
</sec>
<sec id="Sec16">
<title>Identifying a minimum set of driver species</title>
<p id="Par45">Let <inline-formula id="IEq133"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal G}({\mathrm{X}})$$\end{document}</tex-math><mml:math id="M282"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq133.gif"></inline-graphic></alternatives></inline-formula> be the subgraph obtained by removing all self-loops from the ecological network <inline-formula id="IEq134"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\cal G}({\mathrm{X}})$$\end{document}</tex-math><mml:math id="M284"><mml:mi mathvariant="script">G</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq134.gif"></inline-graphic></alternatives></inline-formula> of the (uncontrolled) community. Let <inline-formula id="IEq135"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal B}({\mathrm{X}}^ - \cup {\mathrm{X}}^ + )$$\end{document}</tex-math><mml:math id="M286"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msup><mml:mo>∪</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq135.gif"></inline-graphic></alternatives></inline-formula> be the bipartite representation of <inline-formula id="IEq136"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal G}({\mathrm{X}})$$\end{document}</tex-math><mml:math id="M288"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">X</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq136.gif"></inline-graphic></alternatives></inline-formula>, built by placing the edge <inline-formula id="IEq137"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({\mathrm{x}}_j^{+},{\mathrm{x}}_{i}^{-})$$\end{document}</tex-math><mml:math id="M290"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq137.gif"></inline-graphic></alternatives></inline-formula> in <inline-formula id="IEq138"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal B}$$\end{document}</tex-math><mml:math id="M292"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq138.gif"></inline-graphic></alternatives></inline-formula> if the directed edge (x<sub><italic>j</italic></sub> → x<sub><italic>i</italic></sub>) is in <inline-formula id="IEq139"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal G}$$\end{document}</tex-math><mml:math id="M294"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq139.gif"></inline-graphic></alternatives></inline-formula>. Then, to identify a minimum set of driver species, we applied the notion of a “dedicated input configuration” introduced in ref. <sup><xref ref-type="bibr" rid="CR41">41</xref></sup> (see details in Supplementary Note <xref ref-type="media" rid="MOESM1">4</xref>).</p>
<p id="Par46">A strongly connected component (SCC) is said “non-top linked” if it has no incoming edges from other SCCs. Let <italic>M</italic><sup>*</sup> be a maximum matching in <inline-formula id="IEq140"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal B}$$\end{document}</tex-math><mml:math id="M296"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq140.gif"></inline-graphic></alternatives></inline-formula>. Then, a non-top linked SCC is said to be “top assignable” with respect to <italic>M</italic><sup>*</sup> if it contains at least one right-unmatched node in <italic>M</italic><sup>*</sup>. Let Z ⊆ X be the set of right-unmatched nodes of some maximum matching of <inline-formula id="IEq141"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal B}$$\end{document}</tex-math><mml:math id="M298"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">B</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq141.gif"></inline-graphic></alternatives></inline-formula> with maximum top assignability. Let W ⊆ X be a set consisting of one state node from each non-top linked SCC of <inline-formula id="IEq142"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal G}$$\end{document}</tex-math><mml:math id="M300"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq142.gif"></inline-graphic></alternatives></inline-formula> not already present in Z. Then, we prove that X<sub><italic>D</italic></sub> ⊆ X is a minimum set of driver species if and only if there exist two disjoint subsets Z and W as defined above, such that X<sub><italic>D</italic></sub> = Z ∪ W (Proposition 3 in Supplementary Note <xref ref-type="media" rid="MOESM1">4</xref>). Using this result, we applied Algorithm 1 of ref. <sup><xref ref-type="bibr" rid="CR41">41</xref></sup> to <inline-formula id="IEq143"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde {\cal G}$$\end{document}</tex-math><mml:math id="M302"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq143.gif"></inline-graphic></alternatives></inline-formula> to obtain a minimum set of driver species. This algorithm is implemented in Julia as the DriverSpecies function in the DriverSpeciesModule package. This algorithm is illustrated for communities of <italic>N</italic> = 100 species in Fig. <xref ref-type="fig" rid="Fig5">5a</xref> and Supplementary Fig. <xref ref-type="media" rid="MOESM1">2</xref>.</p>
</sec>
<sec id="Sec17">
<title>Choosing the prediction horizon</title>
<p id="Par47">To choose the prediction horizon <italic>L</italic> for the nonlinear MPC we proved there are two possible cases (Theorem 4 in Supplementary Note <xref ref-type="media" rid="MOESM1">5</xref>). First, when the community can be driven to <italic>x</italic><sub>d</sub> using <italic>L</italic> &lt; ∞ impulsive control inputs. Second, when the community can only be asymptotically driven to <italic>x</italic><sub>d</sub>, meaning that <inline-formula id="IEq146"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L \gg N$$\end{document}</tex-math><mml:math id="M304"><mml:mi>L</mml:mi><mml:mo>≫</mml:mo><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="41467_2019_8890_Article_IEq146.gif"></inline-graphic></alternatives></inline-formula> should be chosen sufficiently large. This second case could be circumvented by increasing the number of actuated species (Remark 8 in Supplementary Note <xref ref-type="media" rid="MOESM1">5</xref>).</p>
</sec>
<sec id="Sec18">
<title>Reporting summary</title>
<p id="Par48">Further information on experimental design is available in the <xref ref-type="media" rid="MOESM3">Nature Research Reporting Summary</xref> linked to this article.</p>
</sec>
<sec id="Sec018">
<title>Code availability</title>
<p id="Par048">A Julia implementation of the algorithm for identifying a minimum set of driver species, as well as all other functions necessary to reproduce the results of the paper, is provided at the GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/mtangulo/DriverSpecies">https://github.com/mtangulo/DriverSpecies</ext-link>.</p>
</sec>
</sec>
<sec sec-type="supplementary-material">
<title>Supplementary information</title>
<sec id="Sec19">
<p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="41467_2019_8890_MOESM1_ESM.pdf"><caption><p>Supplementary Information</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="41467_2019_8890_MOESM2_ESM.pdf"><caption><p>Peer Review File</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="41467_2019_8890_MOESM3_ESM.pdf"><caption><p>Reporting Summary</p></caption></media></supplementary-material>
</p>
</sec>
</sec>
</body>
<back>
<fn-group>
<fn>
<p><bold>Journal peer review information</bold>: <italic>Nature Communications</italic> thanks the anonymous reviewers for their contribution to the peer review of this work. Peer reviewer reports are available.</p>
</fn>
<fn>
<p><bold>Publisher’s note:</bold> Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
</fn>
</fn-group>
<sec>
<title>Supplementary information</title>
<p><bold>Supplementary Information</bold> accompanies this paper at 10.1038/s41467-019-08890-y.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>M.T.A. acknowledges the financial support from CONACyT, Mexico, and L2SN, France. The authors thank Jorge X. Velasco, Jorge Zañudo, Jean-Jacques Slotine, Chuliang Song, and Yandong Xiao for valuable comments and discussions.</p>
</ack>
<notes notes-type="author-contribution">
<title>Author contributions</title>
<p>Y.-Y.L. initiated the project. M.T.A. and Y.-Y.L. conceived and designed the project together. M.T.A. and C.H.M. did the theoretical analysis. M.T.A. did the numerical analysis. M.T.A. and Y.-Y.L. wrote the manuscript. C.H.M. edited the manuscript.</p>
</notes>
<notes notes-type="data-availability">
<title>Data availability</title>
<p>All the experimental datasets analyzed in this study are publicly available.</p>
</notes>
<notes notes-type="COI-statement">
<sec id="FPar1">
<title>Competing interests</title>
<p>The authors declare no competing interests.</p>
</sec>
</notes>
<ref-list id="Bib1">
<title>References</title>
<ref id="CR1">
<label>1.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Pepper</surname>
<given-names>JW</given-names>
</name>
<name>
<surname>Rosenfeld</surname>
<given-names>S</given-names>
</name>
</person-group>
<article-title>The emerging medical ecology of the human gut microbiome</article-title>
<source/>Trends Ecol. Evol.
          <year>2012</year>
<volume>27</volume>
<fpage>381</fpage>
<lpage>384</lpage>
<pub-id pub-id-type="doi">10.1016/j.tree.2012.03.002</pub-id>
<pub-id pub-id-type="pmid">22537667</pub-id>
</element-citation>
</ref>
<ref id="CR2">
<label>2.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>DeLeon-Rodriguez</surname>
<given-names>N</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Microbiome of the upper troposphere: species composition and prevalence, effects of tropical storms, and atmospheric implications</article-title>
<source/>Proc. Natl. Acad. Sci. U.S.A.
          <year>2013</year>
<volume>110</volume>
<fpage>2575</fpage>
<lpage>2580</lpage>
<pub-id pub-id-type="doi">10.1073/pnas.1212089110</pub-id>
<pub-id pub-id-type="pmid">23359712</pub-id>
</element-citation>
</ref>
<ref id="CR3">
<label>3.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Buchan</surname>
<given-names>A</given-names>
</name>
<name>
<surname>LeCleir</surname>
<given-names>GR</given-names>
</name>
<name>
<surname>Gulvik</surname>
<given-names>CA</given-names>
</name>
<name>
<surname>González</surname>
<given-names>JM</given-names>
</name>
</person-group>
<article-title>Master recyclers: features and functions of bacteria associated with phytoplankton blooms</article-title>
<source/>Nat. Rev. Microbiol.
          <year>2014</year>
<volume>12</volume>
<fpage>686</fpage>
<lpage>698</lpage>
<pub-id pub-id-type="doi">10.1038/nrmicro3326</pub-id>
<pub-id pub-id-type="pmid">25134618</pub-id>
</element-citation>
</ref>
<ref id="CR4">
<label>4.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Hultman</surname>
<given-names>J</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Multi-omics of permafrost, active layer and thermokarst bog soil microbiomes</article-title>
<source/>Nature
          <year>2015</year>
<volume>521</volume>
<fpage>208</fpage>
<lpage>212</lpage>
<pub-id pub-id-type="doi">10.1038/nature14238</pub-id>
<pub-id pub-id-type="pmid">25739499</pub-id>
</element-citation>
</ref>
<ref id="CR5">
<label>5.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Karczewski</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Poniedziałek</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Adamski</surname>
<given-names>Z</given-names>
</name>
<name>
<surname>Rzymski</surname>
<given-names>P</given-names>
</name>
</person-group>
<article-title>The effects of the microbiota on the host immune system</article-title>
<source/>Autoimmunity
          <year>2014</year>
<volume>47</volume>
<fpage>494</fpage>
<lpage>504</lpage>
<pub-id pub-id-type="doi">10.3109/08916934.2014.938322</pub-id>
<pub-id pub-id-type="pmid">25019177</pub-id>
</element-citation>
</ref>
<ref id="CR6">
<label>6.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Cox</surname>
<given-names>LM</given-names>
</name>
<name>
<surname>Blaser</surname>
<given-names>MJ</given-names>
</name>
</person-group>
<article-title>Antibiotics in early life and obesity</article-title>
<source/>Nat. Rev. Endocrinol.
          <year>2015</year>
<volume>11</volume>
<fpage>182</fpage>
<lpage>190</lpage>
<pub-id pub-id-type="doi">10.1038/nrendo.2014.210</pub-id>
<pub-id pub-id-type="pmid">25488483</pub-id>
</element-citation>
</ref>
<ref id="CR7">
<label>7.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Tang</surname>
<given-names>AT</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Endothelial tlr4 and the microbiome drive cerebral cavernous malformations</article-title>
<source/>Nature
          <year>2017</year>
<volume>545</volume>
<fpage>305</fpage>
<lpage>310</lpage>
<pub-id pub-id-type="doi">10.1038/nature22075</pub-id>
<pub-id pub-id-type="pmid">28489816</pub-id>
</element-citation>
</ref>
<ref id="CR8">
<label>8.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>East</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>Microbiome: soil science comes to life</article-title>
<source/>Nature
          <year>2013</year>
<volume>501</volume>
<fpage>S18</fpage>
<lpage>S19</lpage>
<pub-id pub-id-type="doi">10.1038/501S18a</pub-id>
<pub-id pub-id-type="pmid">24067761</pub-id>
</element-citation>
</ref>
<ref id="CR9">
<label>9.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Mueller</surname>
<given-names>UG</given-names>
</name>
<name>
<surname>Sachs</surname>
<given-names>JL</given-names>
</name>
</person-group>
<article-title>Engineering microbiomes to improve plant and animal health</article-title>
<source/>Trends Microbiol.
          <year>2015</year>
<volume>23</volume>
<fpage>606</fpage>
<lpage>617</lpage>
<pub-id pub-id-type="doi">10.1016/j.tim.2015.07.009</pub-id>
<pub-id pub-id-type="pmid">26422463</pub-id>
</element-citation>
</ref>
<ref id="CR10">
<label>10.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Guidi</surname>
<given-names>L</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Plankton networks driving carbon export in the oligotrophic ocean</article-title>
<source/>Nature
          <year>2016</year>
<volume>532</volume>
<fpage>465</fpage>
<lpage>470</lpage>
<pub-id pub-id-type="doi">10.1038/nature16942</pub-id>
<pub-id pub-id-type="pmid">26863193</pub-id>
</element-citation>
</ref>
<ref id="CR11">
<label>11.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Alivisatos</surname>
<given-names>AP</given-names>
</name>
<etal></etal>
</person-group>
<article-title>A unified initiative to harness earth’s microbiomes</article-title>
<source/>Science
          <year>2015</year>
<volume>350</volume>
<fpage>507</fpage>
<lpage>508</lpage>
<pub-id pub-id-type="doi">10.1126/science.aac8480</pub-id>
<pub-id pub-id-type="pmid">26511287</pub-id>
</element-citation>
</ref>
<ref id="CR12">
<label>12.</label>
<mixed-citation publication-type="other">Dubilier, N., McFall-Ngai, M. &amp; Zhao, L. Create a global microbiome effort. <italic>Nature</italic><bold>526</bold>, 631–634 (2015).</mixed-citation>
</ref>
<ref id="CR13">
<label>13.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Wubs</surname>
<given-names>EJ</given-names>
</name>
<name>
<surname>van der Putten</surname>
<given-names>WH</given-names>
</name>
<name>
<surname>Bosch</surname>
<given-names>M</given-names>
</name>
<name>
<surname>Bezemer</surname>
<given-names>TM</given-names>
</name>
</person-group>
<article-title>Soil inoculation steers restoration of terrestrial ecosystems</article-title>
<source/>Nat. Plants
          <year>2016</year>
<volume>2</volume>
<fpage>16107</fpage>
<pub-id pub-id-type="doi">10.1038/nplants.2016.107</pub-id>
<pub-id pub-id-type="pmid">27398907</pub-id>
</element-citation>
</ref>
<ref id="CR14">
<label>14.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Buffie</surname>
<given-names>CG</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Precision microbiome reconstitution restores bile acid mediated resistance to <italic>Clostridium difficile</italic></article-title>
<source/>Nature
          <year>2015</year>
<volume>517</volume>
<fpage>205</fpage>
<lpage>208</lpage>
<pub-id pub-id-type="doi">10.1038/nature13828</pub-id>
<pub-id pub-id-type="pmid">25337874</pub-id>
</element-citation>
</ref>
<ref id="CR15">
<label>15.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Gibson</surname>
<given-names>TE</given-names>
</name>
<name>
<surname>Bashan</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Cao</surname>
<given-names>HT</given-names>
</name>
<name>
<surname>Weiss</surname>
<given-names>ST</given-names>
</name>
<name>
<surname>Liu</surname>
<given-names>YY</given-names>
</name>
</person-group>
<article-title>On the origins and control of community types in the human microbiome</article-title>
<source/>PLoS Comput. Biol.
          <year>2016</year>
<volume>12</volume>
<fpage>e1004688</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1004688</pub-id>
<pub-id pub-id-type="pmid">26866806</pub-id>
</element-citation>
</ref>
<ref id="CR16">
<label>16.</label>
<mixed-citation publication-type="other">Lin, C. T. Structural controllability. <italic>IEEE Trans. Autom. Control</italic><bold>19</bold>, 201–208 (1974).</mixed-citation>
</ref>
<ref id="CR17">
<label>17.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Liu</surname>
<given-names>YY</given-names>
</name>
<name>
<surname>Barab´asi</surname>
<given-names>AL</given-names>
</name>
</person-group>
<article-title>Control principles of complex systems</article-title>
<source/>Rev. Mod. Phys.
          <year>2016</year>
<volume>88</volume>
<fpage>035006</fpage>
<pub-id pub-id-type="doi">10.1103/RevModPhys.88.035006</pub-id>
</element-citation>
</ref>
<ref id="CR18">
<label>18.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Phelan</surname>
<given-names>VV</given-names>
</name>
<name>
<surname>Liu</surname>
<given-names>WT</given-names>
</name>
<name>
<surname>Pogliano</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Dorrestein</surname>
<given-names>PC</given-names>
</name>
</person-group>
<article-title>Microbial metabolic exchange—the chemotype-to-phenotype link</article-title>
<source/>Nat. Chem. Biol.
          <year>2012</year>
<volume>8</volume>
<fpage>26</fpage>
<lpage>35</lpage>
<pub-id pub-id-type="doi">10.1038/nchembio.739</pub-id>
</element-citation>
</ref>
<ref id="CR19">
<label>19.</label>
<mixed-citation publication-type="other">Turchin, P. <italic>Complex Population Dynamics: A Theoretical/Empirical Synthesis</italic>, Vol. 35 (Princeton University Press, 2003), Princeton, New Jersey.</mixed-citation>
</ref>
<ref id="CR20">
<label>20.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Faust</surname>
<given-names>K</given-names>
</name>
<name>
<surname>Raes</surname>
<given-names>J</given-names>
</name>
</person-group>
<article-title>Microbial interactions: from networks to models</article-title>
<source/>Nat. Rev. Microbiol.
          <year>2012</year>
<volume>10</volume>
<fpage>538</fpage>
<lpage>550</lpage>
<pub-id pub-id-type="doi">10.1038/nrmicro2832</pub-id>
<pub-id pub-id-type="pmid">22796884</pub-id>
</element-citation>
</ref>
<ref id="CR21">
<label>21.</label>
<mixed-citation publication-type="other">Friedman, J., Higgins, L. M. &amp; Gore, J. Community structure follows simple assembly rules in microbial microcosms. <italic>Nat. Ecol. Evol.</italic><bold>1</bold>, 0109 (2017).</mixed-citation>
</ref>
<ref id="CR22">
<label>22.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bucci</surname>
<given-names>V</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Mdsine: microbial dynamical systems inference engine for microbiome timeseries analyses</article-title>
<source/>Genome Biol.
          <year>2016</year>
<volume>17</volume>
<fpage>121</fpage>
<pub-id pub-id-type="doi">10.1186/s13059-016-0980-6</pub-id>
<pub-id pub-id-type="pmid">27259475</pub-id>
</element-citation>
</ref>
<ref id="CR23">
<label>23.</label>
<mixed-citation publication-type="other">Thomas, T. et al. Diversity, structure and convergent evolution of the global sponge microbiome. <italic>Nat. Commun.</italic><bold>7</bold>, 11870 (2016).</mixed-citation>
</ref>
<ref id="CR24">
<label>24.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Xiao</surname>
<given-names>Y</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Mapping the ecological networks of microbial communities</article-title>
<source/>Nat. Commun.
          <year>2017</year>
<volume>8</volume>
<fpage>2042</fpage>
<pub-id pub-id-type="doi">10.1038/s41467-017-02090-2</pub-id>
<pub-id pub-id-type="pmid">29229902</pub-id>
</element-citation>
</ref>
<ref id="CR25">
<label>25.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Friedman</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Alm</surname>
<given-names>EJ</given-names>
</name>
</person-group>
<article-title>Inferring correlation networks from genomic survey data</article-title>
<source/>PLoS Comput. Biol.
          <year>2012</year>
<volume>8</volume>
<fpage>e1002687</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1002687</pub-id>
<pub-id pub-id-type="pmid">23028285</pub-id>
</element-citation>
</ref>
<ref id="CR26">
<label>26.</label>
<mixed-citation publication-type="other">Sugihara, G. et al. Detecting causality in complex ecosystems. <italic>Science</italic><bold>338</bold>, 446–500 (2012).</mixed-citation>
</ref>
<ref id="CR27">
<label>27.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Berry</surname>
<given-names>D</given-names>
</name>
<name>
<surname>Widder</surname>
<given-names>S</given-names>
</name>
</person-group>
<article-title>Deciphering microbial interactions and detecting keystone species with co-occurrence networks</article-title>
<source/>Front. Microbiol.
          <year>2014</year>
<volume>5</volume>
<fpage>219</fpage>
<pub-id pub-id-type="doi">10.3389/fmicb.2014.00219</pub-id>
<pub-id pub-id-type="pmid">24904535</pub-id>
</element-citation>
</ref>
<ref id="CR28">
<label>28.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Waksman</surname>
<given-names>SA</given-names>
</name>
</person-group>
<article-title>What is an antibiotic or an antibiotic substance?</article-title>
<source/>Mycologia
          <year>1947</year>
<volume>39</volume>
<fpage>565</fpage>
<lpage>569</lpage>
<pub-id pub-id-type="doi">10.1080/00275514.1947.12017635</pub-id>
<pub-id pub-id-type="pmid">20264541</pub-id>
</element-citation>
</ref>
<ref id="CR29">
<label>29.</label>
<mixed-citation publication-type="other">Oremland, R. S. &amp; Capone, D. G. Use of specific inhibitors in biogeochemistry and microbial ecology. In <italic>Advances in Microbial Ecology</italic> 285–383 (Springer, 1988), Plenum Press, New York.</mixed-citation>
</ref>
<ref id="CR30">
<label>30.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Schrezenmeir</surname>
<given-names>J</given-names>
</name>
<name>
<surname>de Vrese</surname>
<given-names>M</given-names>
</name>
</person-group>
<article-title>Probiotics, prebiotics, and synbiotics approaching a definition</article-title>
<source/>Am. J. Clin. Nutr.
          <year>2001</year>
<volume>73</volume>
<fpage>361S</fpage>
<lpage>364S</lpage>
<pub-id pub-id-type="doi">10.1093/ajcn/73.2.361s</pub-id>
</element-citation>
</ref>
<ref id="CR31">
<label>31.</label>
<mixed-citation publication-type="other">Conte, G., Moog, C. H. &amp; Perdon, A. M. <italic>Algebraic Methods for Nonlinear Control Systems</italic> (Springer Science &amp; Business Media, 2007), London.</mixed-citation>
</ref>
<ref id="CR32">
<label>32.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Moore</surname>
<given-names>JC</given-names>
</name>
<name>
<surname>de Ruiter</surname>
<given-names>PC</given-names>
</name>
<name>
<surname>Hunt</surname>
<given-names>HW</given-names>
</name>
<name>
<surname>Coleman</surname>
<given-names>DC</given-names>
</name>
<name>
<surname>Freckman</surname>
<given-names>DW</given-names>
</name>
</person-group>
<article-title>Microcosms and soil ecology: critical linkages between fields studies and modelling food webs</article-title>
<source/>Ecology
          <year>1996</year>
<volume>77</volume>
<fpage>694</fpage>
<lpage>705</lpage>
<pub-id pub-id-type="doi">10.2307/2265494</pub-id>
</element-citation>
</ref>
<ref id="CR33">
<label>33.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Mounier</surname>
<given-names>J</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Microbial interactions within a cheese microbial community</article-title>
<source/>Appl. Environ. Microbiol.
          <year>2008</year>
<volume>74</volume>
<fpage>172</fpage>
<lpage>181</lpage>
<pub-id pub-id-type="doi">10.1128/AEM.01338-07</pub-id>
<pub-id pub-id-type="pmid">17981942</pub-id>
</element-citation>
</ref>
<ref id="CR34">
<label>34.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Stein</surname>
<given-names>RR</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Ecological modeling from time-series inference: insight into dynamics and stability of intestinal microbiota</article-title>
<source/>PLoS Comput. Biol.
          <year>2013</year>
<volume>9</volume>
<fpage>e1003388</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1003388</pub-id>
<pub-id pub-id-type="pmid">24348232</pub-id>
</element-citation>
</ref>
<ref id="CR35">
<label>35.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Gerber</surname>
<given-names>GK</given-names>
</name>
</person-group>
<article-title>The dynamic microbiome</article-title>
<source/>FEBS Lett.
          <year>2014</year>
<volume>588</volume>
<fpage>4131</fpage>
<lpage>4139</lpage>
<pub-id pub-id-type="doi">10.1016/j.febslet.2014.02.037</pub-id>
<pub-id pub-id-type="pmid">24583074</pub-id>
</element-citation>
</ref>
<ref id="CR36">
<label>36.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Coyte</surname>
<given-names>KZ</given-names>
</name>
<name>
<surname>Schluter</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Foster</surname>
<given-names>KR</given-names>
</name>
</person-group>
<article-title>The ecology of the microbiome: networks, competition, and stability</article-title>
<source/>Science
          <year>2015</year>
<volume>350</volume>
<fpage>663</fpage>
<lpage>666</lpage>
<pub-id pub-id-type="doi">10.1126/science.aad2602</pub-id>
<pub-id pub-id-type="pmid">26542567</pub-id>
</element-citation>
</ref>
<ref id="CR37">
<label>37.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Bashan</surname>
<given-names>A</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Universality of human microbial dynamics</article-title>
<source/>Nature
          <year>2016</year>
<volume>534</volume>
<fpage>259</fpage>
<lpage>262</lpage>
<pub-id pub-id-type="doi">10.1038/nature18301</pub-id>
<pub-id pub-id-type="pmid">27279224</pub-id>
</element-citation>
</ref>
<ref id="CR38">
<label>38.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Dam</surname>
<given-names>P</given-names>
</name>
<name>
<surname>Fonseca</surname>
<given-names>LL</given-names>
</name>
<name>
<surname>Konstantinidis</surname>
<given-names>KT</given-names>
</name>
<name>
<surname>Voit</surname>
<given-names>EO</given-names>
</name>
</person-group>
<article-title>Dynamic models of the complex microbial metapopulation of lake mendota</article-title>
<source/>npj Syst. Biol. Appl.
          <year>2016</year>
<volume>2</volume>
<fpage>16007</fpage>
<pub-id pub-id-type="doi">10.1038/npjsba.2016.7</pub-id>
<pub-id pub-id-type="pmid">28725469</pub-id>
</element-citation>
</ref>
<ref id="CR39">
<label>39.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Jost</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Ellner</surname>
<given-names>SP</given-names>
</name>
</person-group>
<article-title>Testing for predator dependence in predator–prey dynamics: a nonparametric approach</article-title>
<source/>Proc. R. Soc. Lond. B Biol. Sci.
          <year>2000</year>
<volume>267</volume>
<fpage>1611</fpage>
<lpage>1620</lpage>
<pub-id pub-id-type="doi">10.1098/rspb.2000.1186</pub-id>
</element-citation>
</ref>
<ref id="CR40">
<label>40.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Liu</surname>
<given-names>YY</given-names>
</name>
<name>
<surname>Slotine</surname>
<given-names>JJ</given-names>
</name>
<name>
<surname>Barabási</surname>
<given-names>AL</given-names>
</name>
</person-group>
<article-title>Controllability of complex networks</article-title>
<source/>Nature
          <year>2011</year>
<volume>473</volume>
<fpage>167</fpage>
<lpage>173</lpage>
<pub-id pub-id-type="doi">10.1038/nature10011</pub-id>
<pub-id pub-id-type="pmid">21562557</pub-id>
</element-citation>
</ref>
<ref id="CR41">
<label>41.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Pequito</surname>
<given-names>SD</given-names>
</name>
<etal></etal>
</person-group>
<article-title>A framework for structural input/output and control configuration selection in large-scale systems</article-title>
<source/>IEEE Trans. Autom. Contr.
          <year>2016</year>
<volume>61</volume>
<fpage>303</fpage>
<lpage>318</lpage>
<pub-id pub-id-type="doi">10.1109/TAC.2015.2437525</pub-id>
</element-citation>
</ref>
<ref id="CR42">
<label>42.</label>
<mixed-citation publication-type="other">Camacho, E. F. &amp; Alba, C. B. <italic>Model Predictive Control</italic> (Springer Science &amp; Business Media, 2013), London.</mixed-citation>
</ref>
<ref id="CR43">
<label>43.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Cornelius</surname>
<given-names>SP</given-names>
</name>
<name>
<surname>Kath</surname>
<given-names>WL</given-names>
</name>
<name>
<surname>Motter</surname>
<given-names>AE</given-names>
</name>
</person-group>
<article-title>Realistic control of network dynamics</article-title>
<source/>Nat. Commun.
          <year>2013</year>
<volume>4</volume>
<fpage>1942</fpage>
<pub-id pub-id-type="doi">10.1038/ncomms2939</pub-id>
<pub-id pub-id-type="pmid">23803966</pub-id>
</element-citation>
</ref>
<ref id="CR44">
<label>44.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Jones</surname>
<given-names>DR</given-names>
</name>
<name>
<surname>Perttunen</surname>
<given-names>CD</given-names>
</name>
<name>
<surname>Stuckman</surname>
<given-names>BE</given-names>
</name>
</person-group>
<article-title>Lipschitzian optimization without the Lipschitz constant</article-title>
<source/>J. Optim. Theory Appl.
          <year>1993</year>
<volume>79</volume>
<fpage>157</fpage>
<lpage>181</lpage>
<pub-id pub-id-type="doi">10.1007/BF00941892</pub-id>
</element-citation>
</ref>
<ref id="CR45">
<label>45.</label>
<mixed-citation publication-type="other">Åström, K. J. &amp; Murray, R. M. <italic>Feedback Systems: An Introduction for Scientists and Engineers</italic> (Princeton University Press, 2010), Princeton, New Jersey.</mixed-citation>
</ref>
<ref id="CR46">
<label>46.</label>
<mixed-citation publication-type="other">May, R. M. <italic>Stability and Complexity in Model Ecosystems</italic>, Vol. 6 (Princeton University Press, 2001), Princeton, New Jersey.</mixed-citation>
</ref>
<ref id="CR47">
<label>47.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Power</surname>
<given-names>ME</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Challenges in the quest for keystones: identifying keystone species is difficult but essential to understanding how loss of species will affect ecosystems</article-title>
<source/>Bioscience
          <year>1996</year>
<volume>46</volume>
<fpage>609</fpage>
<lpage>620</lpage>
<pub-id pub-id-type="doi">10.2307/1312990</pub-id>
</element-citation>
</ref>
<ref id="CR48">
<label>48.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Ortiz</surname>
<given-names>M</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Quantifying keystone species complexes: ecosystem-based conservation management in the King George Island (Antarctic Peninsula)</article-title>
<source/>Ecol. Indic.
          <year>2017</year>
<volume>81</volume>
<fpage>453</fpage>
<lpage>460</lpage>
<pub-id pub-id-type="doi">10.1016/j.ecolind.2017.06.016</pub-id>
</element-citation>
</ref>
<ref id="CR49">
<label>49.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Jain</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Krishna</surname>
<given-names>S</given-names>
</name>
</person-group>
<article-title>Crashes, recoveries, and core shifts in a model of evolving networks</article-title>
<source/>Phys. Rev. E
          <year>2002</year>
<volume>65</volume>
<fpage>026103</fpage>
<pub-id pub-id-type="doi">10.1103/PhysRevE.65.026103</pub-id>
</element-citation>
</ref>
<ref id="CR50">
<label>50.</label>
<element-citation publication-type="book">
<person-group person-group-type="author">
<name>
<surname>Sutton</surname>
<given-names>RS</given-names>
</name>
<name>
<surname>Barto</surname>
<given-names>AG</given-names>
</name>
</person-group>
<source/>Introduction to Reinforcement Learning
          <year>1998</year>
<publisher-loc>Cambridge</publisher-loc>
<publisher-name>MIT Press</publisher-name>
</element-citation>
</ref>
<ref id="CR51">
<label>51.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Mnih</surname>
<given-names>V</given-names>
</name>
<etal></etal>
</person-group>
<article-title>Human-level control through deep reinforcement learning</article-title>
<source/>Nature
          <year>2015</year>
<volume>518</volume>
<fpage>529</fpage>
<lpage>533</lpage>
<pub-id pub-id-type="doi">10.1038/nature14236</pub-id>
<pub-id pub-id-type="pmid">25719670</pub-id>
</element-citation>
</ref>
<ref id="CR52">
<label>52.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Campbell</surname>
<given-names>C</given-names>
</name>
<name>
<surname>Albert</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>Stabilization of perturbed Boolean network attractors through compensatory interactions</article-title>
<source/>BMC Syst. Biol.
          <year>2014</year>
<volume>8</volume>
<fpage>53</fpage>
<pub-id pub-id-type="doi">10.1186/1752-0509-8-53</pub-id>
<pub-id pub-id-type="pmid">24885780</pub-id>
</element-citation>
</ref>
<ref id="CR53">
<label>53.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Zañudo</surname>
<given-names>JG</given-names>
</name>
<name>
<surname>Albert</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>An effective network reduction approach to find the dynamical repertoire of discrete dynamic networks</article-title>
<source/>Chaos: Interdiscip. J. Nonlinear Sci.
          <year>2013</year>
<volume>23</volume>
<fpage>025111</fpage>
<pub-id pub-id-type="doi">10.1063/1.4809777</pub-id>
</element-citation>
</ref>
<ref id="CR54">
<label>54.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Loehle</surname>
<given-names>C</given-names>
</name>
</person-group>
<article-title>Control theory and the management of ecosystems</article-title>
<source/>J. Appl. Ecol.
          <year>2006</year>
<volume>43</volume>
<fpage>957</fpage>
<lpage>966</lpage>
<pub-id pub-id-type="doi">10.1111/j.1365-2664.2006.01208.x</pub-id>
</element-citation>
</ref>
<ref id="CR55">
<label>55.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Barzel</surname>
<given-names>B</given-names>
</name>
<name>
<surname>Barabási</surname>
<given-names>AL</given-names>
</name>
</person-group>
<article-title>Universality in network dynamics</article-title>
<source/>Nat. Phys.
          <year>2013</year>
<volume>9</volume>
<fpage>673</fpage>
<pub-id pub-id-type="doi">10.1038/nphys2741</pub-id>
</element-citation>
</ref>
<ref id="CR56">
<label>56.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Posfai</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Taillefumier</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Wingreen</surname>
<given-names>NS</given-names>
</name>
</person-group>
<article-title>Metabolic trade-offs promote diversity in a model ecosystem</article-title>
<source/>Phys. Rev. Lett.
          <year>2017</year>
<volume>118</volume>
<fpage>028103</fpage>
<pub-id pub-id-type="doi">10.1103/PhysRevLett.118.028103</pub-id>
<pub-id pub-id-type="pmid">28128613</pub-id>
</element-citation>
</ref>
<ref id="CR57">
<label>57.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Taillefumier</surname>
<given-names>T</given-names>
</name>
<name>
<surname>Posfai</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Meir</surname>
<given-names>Y</given-names>
</name>
<name>
<surname>Wingreen</surname>
<given-names>NS</given-names>
</name>
</person-group>
<article-title>Microbial consortia at steady supply</article-title>
<source/>eLife
          <year>2017</year>
<volume>6</volume>
<fpage>e22644</fpage>
<pub-id pub-id-type="doi">10.7554/eLife.22644</pub-id>
<pub-id pub-id-type="pmid">28473032</pub-id>
</element-citation>
</ref>
<ref id="CR58">
<label>58.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Butler</surname>
<given-names>S</given-names>
</name>
<name>
<surname>ODwyer</surname>
<given-names>JP</given-names>
</name>
</person-group>
<article-title>Stability criteria for complex microbial communities</article-title>
<source/>Nat. Commun.
          <year>2018</year>
<volume>9</volume>
<fpage>2970</fpage>
<pub-id pub-id-type="doi">10.1038/s41467-018-05308-z</pub-id>
<pub-id pub-id-type="pmid">30061657</pub-id>
</element-citation>
</ref>
<ref id="CR59">
<label>59.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Good</surname>
<given-names>BH</given-names>
</name>
<name>
<surname>Martis</surname>
<given-names>S</given-names>
</name>
<name>
<surname>Hallatschek</surname>
<given-names>O</given-names>
</name>
</person-group>
<article-title>Adaptation limits ecological diversification and promotes ecological tinkering during the competition for substitutable resources</article-title>
<source/>Proc. Natl. Acad. Sci. U.S.A.
          <year>2018</year>
<volume>115</volume>
<fpage>E10407</fpage>
<lpage>E10416</lpage>
<pub-id pub-id-type="doi">10.1073/pnas.1807530115</pub-id>
<pub-id pub-id-type="pmid">30322918</pub-id>
</element-citation>
</ref>
<ref id="CR60">
<label>60.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Goyal</surname>
<given-names>A</given-names>
</name>
<name>
<surname>Maslov</surname>
<given-names>S</given-names>
</name>
</person-group>
<article-title>Diversity, stability, and reproducibility in stochastically assembled microbial ecosystems</article-title>
<source/>Phys. Rev. Lett.
          <year>2018</year>
<volume>120</volume>
<fpage>158102</fpage>
<pub-id pub-id-type="doi">10.1103/PhysRevLett.120.158102</pub-id>
<pub-id pub-id-type="pmid">29756882</pub-id>
</element-citation>
</ref>
<ref id="CR61">
<label>61.</label>
<mixed-citation publication-type="other">Tikhonov, M. &amp; Monasson, R. Innovation rather than improvement: a solvable high-dimensional model highlights the limitations of scalar fitness. <italic>J. Stat. Phys.</italic><bold>172</bold>, 74–104 (2018).</mixed-citation>
</ref>
<ref id="CR62">
<label>62.</label>
<mixed-citation publication-type="other">Marsland, R. III et al. Available energy fluxes drive a phase transition in the diversity, stability, and functional structure of microbial communities. <italic>PLoS Comput. Biol.</italic><bold>15</bold>, e1006793 (2018).</mixed-citation>
</ref>
<ref id="CR63">
<label>63.</label>
<mixed-citation publication-type="other">Niehaus, L. et al. Microbial coexistence through chemical-mediated interactions. <italic>bioRxiv</italic> 358481 (2018).</mixed-citation>
</ref>
<ref id="CR64">
<label>64.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>MacArthur</surname>
<given-names>R</given-names>
</name>
</person-group>
<article-title>Species packing and competitive equilibrium for many species</article-title>
<source/>Theor. Popul. Biol.
          <year>1970</year>
<volume>1</volume>
<fpage>1</fpage>
<lpage>11</lpage>
<pub-id pub-id-type="doi">10.1016/0040-5809(70)90039-0</pub-id>
<pub-id pub-id-type="pmid">5527624</pub-id>
</element-citation>
</ref>
<ref id="CR65">
<label>65.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Chesson</surname>
<given-names>P</given-names>
</name>
</person-group>
<article-title>MacArthur’s consumer-resource model</article-title>
<source/>Theor. Popul. Biol.
          <year>1990</year>
<volume>37</volume>
<fpage>26</fpage>
<lpage>38</lpage>
<pub-id pub-id-type="doi">10.1016/0040-5809(90)90025-Q</pub-id>
</element-citation>
</ref>
<ref id="CR66">
<label>66.</label>
<element-citation publication-type="journal">
<person-group person-group-type="author">
<name>
<surname>Gao</surname>
<given-names>J</given-names>
</name>
<name>
<surname>Liu</surname>
<given-names>YY</given-names>
</name>
<name>
<surname>D’souza</surname>
<given-names>RM</given-names>
</name>
<name>
<surname>Barabási</surname>
<given-names>AL</given-names>
</name>
</person-group>
<article-title>Target control of complex networks</article-title>
<source/>Nat. Commun.
          <year>2014</year>
<volume>5</volume>
<fpage>5415</fpage>
<pub-id pub-id-type="doi">10.1038/ncomms6415</pub-id>
<pub-id pub-id-type="pmid">25388503</pub-id>
</element-citation>
</ref>
</ref-list>
</back>
</article>
</pmc-articleset>